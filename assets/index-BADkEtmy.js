function PA(e,r){for(var a=0;a<r.length;a++){const o=r[a];if(typeof o!="string"&&!Array.isArray(o)){for(const c in o)if(c!=="default"&&!(c in e)){const h=Object.getOwnPropertyDescriptor(o,c);h&&Object.defineProperty(e,c,h.get?h:{enumerable:!0,get:()=>o[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const m of h.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function a(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(c){if(c.ep)return;c.ep=!0;const h=a(c);fetch(c.href,h)}})();var Cc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function FA(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var r=e.default;if(typeof r=="function"){var a=function o(){var c=!1;try{c=this instanceof o}catch{}return c?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};a.prototype=r.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(o){var c=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(a,o,c.get?c:{enumerable:!0,get:function(){return e[o]}})}),a}var Jd={exports:{}},Jl={};var ym;function GA(){if(ym)return Jl;ym=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(o,c,h){var m=null;if(h!==void 0&&(m=""+h),c.key!==void 0&&(m=""+c.key),"key"in c){h={};for(var x in c)x!=="key"&&(h[x]=c[x])}else h=c;return c=h.ref,{$$typeof:e,type:o,key:m,ref:c!==void 0?c:null,props:h}}return Jl.Fragment=r,Jl.jsx=a,Jl.jsxs=a,Jl}var wm;function VA(){return wm||(wm=1,Jd.exports=GA()),Jd.exports}var ie=VA(),e0={exports:{}},Tn={};var bm;function qA(){if(bm)return Tn;bm=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),m=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),B=Symbol.iterator;function N(ne){return ne===null||typeof ne!="object"?null:(ne=B&&ne[B]||ne["@@iterator"],typeof ne=="function"?ne:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,X={};function j(ne,fe,De){this.props=ne,this.context=fe,this.refs=X,this.updater=De||k}j.prototype.isReactComponent={},j.prototype.setState=function(ne,fe){if(typeof ne!="object"&&typeof ne!="function"&&ne!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ne,fe,"setState")},j.prototype.forceUpdate=function(ne){this.updater.enqueueForceUpdate(this,ne,"forceUpdate")};function F(){}F.prototype=j.prototype;function te(ne,fe,De){this.props=ne,this.context=fe,this.refs=X,this.updater=De||k}var Q=te.prototype=new F;Q.constructor=te,z(Q,j.prototype),Q.isPureReactComponent=!0;var oe=Array.isArray;function ue(){}var ee={H:null,A:null,T:null,S:null},ce=Object.prototype.hasOwnProperty;function le(ne,fe,De){var Le=De.ref;return{$$typeof:e,type:ne,key:fe,ref:Le!==void 0?Le:null,props:De}}function Qe(ne,fe){return le(ne.type,fe,ne.props)}function Je(ne){return typeof ne=="object"&&ne!==null&&ne.$$typeof===e}function ke(ne){var fe={"=":"=0",":":"=2"};return"$"+ne.replace(/[=:]/g,function(De){return fe[De]})}var at=/\/+/g;function et(ne,fe){return typeof ne=="object"&&ne!==null&&ne.key!=null?ke(""+ne.key):fe.toString(36)}function ve(ne){switch(ne.status){case"fulfilled":return ne.value;case"rejected":throw ne.reason;default:switch(typeof ne.status=="string"?ne.then(ue,ue):(ne.status="pending",ne.then(function(fe){ne.status==="pending"&&(ne.status="fulfilled",ne.value=fe)},function(fe){ne.status==="pending"&&(ne.status="rejected",ne.reason=fe)})),ne.status){case"fulfilled":return ne.value;case"rejected":throw ne.reason}}throw ne}function xe(ne,fe,De,Le,pe){var Me=typeof ne;(Me==="undefined"||Me==="boolean")&&(ne=null);var Bt=!1;if(ne===null)Bt=!0;else switch(Me){case"bigint":case"string":case"number":Bt=!0;break;case"object":switch(ne.$$typeof){case e:case r:Bt=!0;break;case S:return Bt=ne._init,xe(Bt(ne._payload),fe,De,Le,pe)}}if(Bt)return pe=pe(ne),Bt=Le===""?"."+et(ne,0):Le,oe(pe)?(De="",Bt!=null&&(De=Bt.replace(at,"$&/")+"/"),xe(pe,fe,De,"",function(Rt){return Rt})):pe!=null&&(Je(pe)&&(pe=Qe(pe,De+(pe.key==null||ne&&ne.key===pe.key?"":(""+pe.key).replace(at,"$&/")+"/")+Bt)),fe.push(pe)),1;Bt=0;var At=Le===""?".":Le+":";if(oe(ne))for(var It=0;It<ne.length;It++)Le=ne[It],Me=At+et(Le,It),Bt+=xe(Le,fe,De,Me,pe);else if(It=N(ne),typeof It=="function")for(ne=It.call(ne),It=0;!(Le=ne.next()).done;)Le=Le.value,Me=At+et(Le,It++),Bt+=xe(Le,fe,De,Me,pe);else if(Me==="object"){if(typeof ne.then=="function")return xe(ve(ne),fe,De,Le,pe);throw fe=String(ne),Error("Objects are not valid as a React child (found: "+(fe==="[object Object]"?"object with keys {"+Object.keys(ne).join(", ")+"}":fe)+"). If you meant to render a collection of children, use an array instead.")}return Bt}function _e(ne,fe,De){if(ne==null)return ne;var Le=[],pe=0;return xe(ne,Le,"","",function(Me){return fe.call(De,Me,pe++)}),Le}function Ge(ne){if(ne._status===-1){var fe=ne._result;fe=fe(),fe.then(function(De){(ne._status===0||ne._status===-1)&&(ne._status=1,ne._result=De)},function(De){(ne._status===0||ne._status===-1)&&(ne._status=2,ne._result=De)}),ne._status===-1&&(ne._status=0,ne._result=fe)}if(ne._status===1)return ne._result.default;throw ne._result}var qe=typeof reportError=="function"?reportError:function(ne){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var fe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ne=="object"&&ne!==null&&typeof ne.message=="string"?String(ne.message):String(ne),error:ne});if(!window.dispatchEvent(fe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ne);return}console.error(ne)},ft={map:_e,forEach:function(ne,fe,De){_e(ne,function(){fe.apply(this,arguments)},De)},count:function(ne){var fe=0;return _e(ne,function(){fe++}),fe},toArray:function(ne){return _e(ne,function(fe){return fe})||[]},only:function(ne){if(!Je(ne))throw Error("React.Children.only expected to receive a single React element child.");return ne}};return Tn.Activity=R,Tn.Children=ft,Tn.Component=j,Tn.Fragment=a,Tn.Profiler=c,Tn.PureComponent=te,Tn.StrictMode=o,Tn.Suspense=_,Tn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ee,Tn.__COMPILER_RUNTIME={__proto__:null,c:function(ne){return ee.H.useMemoCache(ne)}},Tn.cache=function(ne){return function(){return ne.apply(null,arguments)}},Tn.cacheSignal=function(){return null},Tn.cloneElement=function(ne,fe,De){if(ne==null)throw Error("The argument must be a React element, but you passed "+ne+".");var Le=z({},ne.props),pe=ne.key;if(fe!=null)for(Me in fe.key!==void 0&&(pe=""+fe.key),fe)!ce.call(fe,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&fe.ref===void 0||(Le[Me]=fe[Me]);var Me=arguments.length-2;if(Me===1)Le.children=De;else if(1<Me){for(var Bt=Array(Me),At=0;At<Me;At++)Bt[At]=arguments[At+2];Le.children=Bt}return le(ne.type,pe,Le)},Tn.createContext=function(ne){return ne={$$typeof:m,_currentValue:ne,_currentValue2:ne,_threadCount:0,Provider:null,Consumer:null},ne.Provider=ne,ne.Consumer={$$typeof:h,_context:ne},ne},Tn.createElement=function(ne,fe,De){var Le,pe={},Me=null;if(fe!=null)for(Le in fe.key!==void 0&&(Me=""+fe.key),fe)ce.call(fe,Le)&&Le!=="key"&&Le!=="__self"&&Le!=="__source"&&(pe[Le]=fe[Le]);var Bt=arguments.length-2;if(Bt===1)pe.children=De;else if(1<Bt){for(var At=Array(Bt),It=0;It<Bt;It++)At[It]=arguments[It+2];pe.children=At}if(ne&&ne.defaultProps)for(Le in Bt=ne.defaultProps,Bt)pe[Le]===void 0&&(pe[Le]=Bt[Le]);return le(ne,Me,pe)},Tn.createRef=function(){return{current:null}},Tn.forwardRef=function(ne){return{$$typeof:x,render:ne}},Tn.isValidElement=Je,Tn.lazy=function(ne){return{$$typeof:S,_payload:{_status:-1,_result:ne},_init:Ge}},Tn.memo=function(ne,fe){return{$$typeof:y,type:ne,compare:fe===void 0?null:fe}},Tn.startTransition=function(ne){var fe=ee.T,De={};ee.T=De;try{var Le=ne(),pe=ee.S;pe!==null&&pe(De,Le),typeof Le=="object"&&Le!==null&&typeof Le.then=="function"&&Le.then(ue,qe)}catch(Me){qe(Me)}finally{fe!==null&&De.types!==null&&(fe.types=De.types),ee.T=fe}},Tn.unstable_useCacheRefresh=function(){return ee.H.useCacheRefresh()},Tn.use=function(ne){return ee.H.use(ne)},Tn.useActionState=function(ne,fe,De){return ee.H.useActionState(ne,fe,De)},Tn.useCallback=function(ne,fe){return ee.H.useCallback(ne,fe)},Tn.useContext=function(ne){return ee.H.useContext(ne)},Tn.useDebugValue=function(){},Tn.useDeferredValue=function(ne,fe){return ee.H.useDeferredValue(ne,fe)},Tn.useEffect=function(ne,fe){return ee.H.useEffect(ne,fe)},Tn.useEffectEvent=function(ne){return ee.H.useEffectEvent(ne)},Tn.useId=function(){return ee.H.useId()},Tn.useImperativeHandle=function(ne,fe,De){return ee.H.useImperativeHandle(ne,fe,De)},Tn.useInsertionEffect=function(ne,fe){return ee.H.useInsertionEffect(ne,fe)},Tn.useLayoutEffect=function(ne,fe){return ee.H.useLayoutEffect(ne,fe)},Tn.useMemo=function(ne,fe){return ee.H.useMemo(ne,fe)},Tn.useOptimistic=function(ne,fe){return ee.H.useOptimistic(ne,fe)},Tn.useReducer=function(ne,fe,De){return ee.H.useReducer(ne,fe,De)},Tn.useRef=function(ne){return ee.H.useRef(ne)},Tn.useState=function(ne){return ee.H.useState(ne)},Tn.useSyncExternalStore=function(ne,fe,De){return ee.H.useSyncExternalStore(ne,fe,De)},Tn.useTransition=function(){return ee.H.useTransition()},Tn.version="19.2.3",Tn}var vm;function ff(){return vm||(vm=1,e0.exports=qA()),e0.exports}var Ct=ff(),t0={exports:{}},eu={},n0={exports:{}},r0={};var _m;function jA(){return _m||(_m=1,(function(e){function r(xe,_e){var Ge=xe.length;xe.push(_e);e:for(;0<Ge;){var qe=Ge-1>>>1,ft=xe[qe];if(0<c(ft,_e))xe[qe]=_e,xe[Ge]=ft,Ge=qe;else break e}}function a(xe){return xe.length===0?null:xe[0]}function o(xe){if(xe.length===0)return null;var _e=xe[0],Ge=xe.pop();if(Ge!==_e){xe[0]=Ge;e:for(var qe=0,ft=xe.length,ne=ft>>>1;qe<ne;){var fe=2*(qe+1)-1,De=xe[fe],Le=fe+1,pe=xe[Le];if(0>c(De,Ge))Le<ft&&0>c(pe,De)?(xe[qe]=pe,xe[Le]=Ge,qe=Le):(xe[qe]=De,xe[fe]=Ge,qe=fe);else if(Le<ft&&0>c(pe,Ge))xe[qe]=pe,xe[Le]=Ge,qe=Le;else break e}}return _e}function c(xe,_e){var Ge=xe.sortIndex-_e.sortIndex;return Ge!==0?Ge:xe.id-_e.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var m=Date,x=m.now();e.unstable_now=function(){return m.now()-x}}var _=[],y=[],S=1,R=null,B=3,N=!1,k=!1,z=!1,X=!1,j=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;function Q(xe){for(var _e=a(y);_e!==null;){if(_e.callback===null)o(y);else if(_e.startTime<=xe)o(y),_e.sortIndex=_e.expirationTime,r(_,_e);else break;_e=a(y)}}function oe(xe){if(z=!1,Q(xe),!k)if(a(_)!==null)k=!0,ue||(ue=!0,ke());else{var _e=a(y);_e!==null&&ve(oe,_e.startTime-xe)}}var ue=!1,ee=-1,ce=5,le=-1;function Qe(){return X?!0:!(e.unstable_now()-le<ce)}function Je(){if(X=!1,ue){var xe=e.unstable_now();le=xe;var _e=!0;try{e:{k=!1,z&&(z=!1,F(ee),ee=-1),N=!0;var Ge=B;try{t:{for(Q(xe),R=a(_);R!==null&&!(R.expirationTime>xe&&Qe());){var qe=R.callback;if(typeof qe=="function"){R.callback=null,B=R.priorityLevel;var ft=qe(R.expirationTime<=xe);if(xe=e.unstable_now(),typeof ft=="function"){R.callback=ft,Q(xe),_e=!0;break t}R===a(_)&&o(_),Q(xe)}else o(_);R=a(_)}if(R!==null)_e=!0;else{var ne=a(y);ne!==null&&ve(oe,ne.startTime-xe),_e=!1}}break e}finally{R=null,B=Ge,N=!1}_e=void 0}}finally{_e?ke():ue=!1}}}var ke;if(typeof te=="function")ke=function(){te(Je)};else if(typeof MessageChannel<"u"){var at=new MessageChannel,et=at.port2;at.port1.onmessage=Je,ke=function(){et.postMessage(null)}}else ke=function(){j(Je,0)};function ve(xe,_e){ee=j(function(){xe(e.unstable_now())},_e)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(xe){xe.callback=null},e.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ce=0<xe?Math.floor(1e3/xe):5},e.unstable_getCurrentPriorityLevel=function(){return B},e.unstable_next=function(xe){switch(B){case 1:case 2:case 3:var _e=3;break;default:_e=B}var Ge=B;B=_e;try{return xe()}finally{B=Ge}},e.unstable_requestPaint=function(){X=!0},e.unstable_runWithPriority=function(xe,_e){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var Ge=B;B=xe;try{return _e()}finally{B=Ge}},e.unstable_scheduleCallback=function(xe,_e,Ge){var qe=e.unstable_now();switch(typeof Ge=="object"&&Ge!==null?(Ge=Ge.delay,Ge=typeof Ge=="number"&&0<Ge?qe+Ge:qe):Ge=qe,xe){case 1:var ft=-1;break;case 2:ft=250;break;case 5:ft=1073741823;break;case 4:ft=1e4;break;default:ft=5e3}return ft=Ge+ft,xe={id:S++,callback:_e,priorityLevel:xe,startTime:Ge,expirationTime:ft,sortIndex:-1},Ge>qe?(xe.sortIndex=Ge,r(y,xe),a(_)===null&&xe===a(y)&&(z?(F(ee),ee=-1):z=!0,ve(oe,Ge-qe))):(xe.sortIndex=ft,r(_,xe),k||N||(k=!0,ue||(ue=!0,ke()))),xe},e.unstable_shouldYield=Qe,e.unstable_wrapCallback=function(xe){var _e=B;return function(){var Ge=B;B=_e;try{return xe.apply(this,arguments)}finally{B=Ge}}}})(r0)),r0}var Cm;function HA(){return Cm||(Cm=1,n0.exports=jA()),n0.exports}var i0={exports:{}},Ai={};var Am;function YA(){if(Am)return Ai;Am=1;var e=ff();function r(_){var y="https://react.dev/errors/"+_;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)y+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+_+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(r(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},c=Symbol.for("react.portal");function h(_,y,S){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:R==null?null:""+R,children:_,containerInfo:y,implementation:S}}var m=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function x(_,y){if(_==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Ai.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Ai.createPortal=function(_,y){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(r(299));return h(_,y,null,S)},Ai.flushSync=function(_){var y=m.T,S=o.p;try{if(m.T=null,o.p=2,_)return _()}finally{m.T=y,o.p=S,o.d.f()}},Ai.preconnect=function(_,y){typeof _=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,o.d.C(_,y))},Ai.prefetchDNS=function(_){typeof _=="string"&&o.d.D(_)},Ai.preinit=function(_,y){if(typeof _=="string"&&y&&typeof y.as=="string"){var S=y.as,R=x(S,y.crossOrigin),B=typeof y.integrity=="string"?y.integrity:void 0,N=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;S==="style"?o.d.S(_,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:R,integrity:B,fetchPriority:N}):S==="script"&&o.d.X(_,{crossOrigin:R,integrity:B,fetchPriority:N,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Ai.preinitModule=function(_,y){if(typeof _=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var S=x(y.as,y.crossOrigin);o.d.M(_,{crossOrigin:S,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&o.d.M(_)},Ai.preload=function(_,y){if(typeof _=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var S=y.as,R=x(S,y.crossOrigin);o.d.L(_,S,{crossOrigin:R,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Ai.preloadModule=function(_,y){if(typeof _=="string")if(y){var S=x(y.as,y.crossOrigin);o.d.m(_,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:S,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else o.d.m(_)},Ai.requestFormReset=function(_){o.d.r(_)},Ai.unstable_batchedUpdates=function(_,y){return _(y)},Ai.useFormState=function(_,y,S){return m.H.useFormState(_,y,S)},Ai.useFormStatus=function(){return m.H.useHostTransitionStatus()},Ai.version="19.2.3",Ai}var Em;function WA(){if(Em)return i0.exports;Em=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),i0.exports=YA(),i0.exports}var Tm;function KA(){if(Tm)return eu;Tm=1;var e=HA(),r=ff(),a=WA();function o(t){var i="https://react.dev/errors/"+t;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function h(t){var i=t,u=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(u=i.return),t=i.return;while(t)}return i.tag===3?u:null}function m(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function x(t){if(t.tag===31){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function _(t){if(h(t)!==t)throw Error(o(188))}function y(t){var i=t.alternate;if(!i){if(i=h(t),i===null)throw Error(o(188));return i!==t?null:t}for(var u=t,p=i;;){var C=u.return;if(C===null)break;var T=C.alternate;if(T===null){if(p=C.return,p!==null){u=p;continue}break}if(C.child===T.child){for(T=C.child;T;){if(T===u)return _(C),t;if(T===p)return _(C),i;T=T.sibling}throw Error(o(188))}if(u.return!==p.return)u=C,p=T;else{for(var U=!1,J=C.child;J;){if(J===u){U=!0,u=C,p=T;break}if(J===p){U=!0,p=C,u=T;break}J=J.sibling}if(!U){for(J=T.child;J;){if(J===u){U=!0,u=T,p=C;break}if(J===p){U=!0,p=T,u=C;break}J=J.sibling}if(!U)throw Error(o(189))}}if(u.alternate!==p)throw Error(o(190))}if(u.tag!==3)throw Error(o(188));return u.stateNode.current===u?t:i}function S(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t;for(t=t.child;t!==null;){if(i=S(t),i!==null)return i;t=t.sibling}return null}var R=Object.assign,B=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),X=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),te=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),le=Symbol.for("react.activity"),Qe=Symbol.for("react.memo_cache_sentinel"),Je=Symbol.iterator;function ke(t){return t===null||typeof t!="object"?null:(t=Je&&t[Je]||t["@@iterator"],typeof t=="function"?t:null)}var at=Symbol.for("react.client.reference");function et(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===at?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case z:return"Fragment";case j:return"Profiler";case X:return"StrictMode";case oe:return"Suspense";case ue:return"SuspenseList";case le:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case k:return"Portal";case te:return t.displayName||"Context";case F:return(t._context.displayName||"Context")+".Consumer";case Q:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ee:return i=t.displayName||null,i!==null?i:et(t.type)||"Memo";case ce:i=t._payload,t=t._init;try{return et(t(i))}catch{}}return null}var ve=Array.isArray,xe=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ge={pending:!1,data:null,method:null,action:null},qe=[],ft=-1;function ne(t){return{current:t}}function fe(t){0>ft||(t.current=qe[ft],qe[ft]=null,ft--)}function De(t,i){ft++,qe[ft]=t.current,t.current=i}var Le=ne(null),pe=ne(null),Me=ne(null),Bt=ne(null);function At(t,i){switch(De(Me,i),De(pe,t),De(Le,null),i.nodeType){case 9:case 11:t=(t=i.documentElement)&&(t=t.namespaceURI)?Fg(t):0;break;default:if(t=i.tagName,i=i.namespaceURI)i=Fg(i),t=Gg(i,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}fe(Le),De(Le,t)}function It(){fe(Le),fe(pe),fe(Me)}function Rt(t){t.memoizedState!==null&&De(Bt,t);var i=Le.current,u=Gg(i,t.type);i!==u&&(De(pe,t),De(Le,u))}function ht(t){pe.current===t&&(fe(Le),fe(pe)),Bt.current===t&&(fe(Bt),Kl._currentValue=Ge)}var mt,qt;function Sn(t){if(mt===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);mt=i&&i[1]||"",qt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+mt+t+qt}var Zn=!1;function _n(t,i){if(!t||Zn)return"";Zn=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(i){var it=function(){throw Error()};if(Object.defineProperty(it.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(it,[])}catch(Ye){var ze=Ye}Reflect.construct(t,[],it)}else{try{it.call()}catch(Ye){ze=Ye}t.call(it.prototype)}}else{try{throw Error()}catch(Ye){ze=Ye}(it=t())&&typeof it.catch=="function"&&it.catch(function(){})}}catch(Ye){if(Ye&&ze&&typeof Ye.stack=="string")return[Ye.stack,ze.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=p.DetermineComponentFrameRoot(),U=T[0],J=T[1];if(U&&J){var me=U.split(`
`),$e=J.split(`
`);for(C=p=0;p<me.length&&!me[p].includes("DetermineComponentFrameRoot");)p++;for(;C<$e.length&&!$e[C].includes("DetermineComponentFrameRoot");)C++;if(p===me.length||C===$e.length)for(p=me.length-1,C=$e.length-1;1<=p&&0<=C&&me[p]!==$e[C];)C--;for(;1<=p&&0<=C;p--,C--)if(me[p]!==$e[C]){if(p!==1||C!==1)do if(p--,C--,0>C||me[p]!==$e[C]){var Ze=`
`+me[p].replace(" at new "," at ");return t.displayName&&Ze.includes("<anonymous>")&&(Ze=Ze.replace("<anonymous>",t.displayName)),Ze}while(1<=p&&0<=C);break}}}finally{Zn=!1,Error.prepareStackTrace=u}return(u=t?t.displayName||t.name:"")?Sn(u):""}function zn(t,i){switch(t.tag){case 26:case 27:case 5:return Sn(t.type);case 16:return Sn("Lazy");case 13:return t.child!==i&&i!==null?Sn("Suspense Fallback"):Sn("Suspense");case 19:return Sn("SuspenseList");case 0:case 15:return _n(t.type,!1);case 11:return _n(t.type.render,!1);case 1:return _n(t.type,!0);case 31:return Sn("Activity");default:return""}}function mn(t){try{var i="",u=null;do i+=zn(t,u),u=t,t=t.return;while(t);return i}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Qt=Object.prototype.hasOwnProperty,nr=e.unstable_scheduleCallback,wt=e.unstable_cancelCallback,Er=e.unstable_shouldYield,Bn=e.unstable_requestPaint,kn=e.unstable_now,ai=e.unstable_getCurrentPriorityLevel,hr=e.unstable_ImmediatePriority,Or=e.unstable_UserBlockingPriority,vr=e.unstable_NormalPriority,cr=e.unstable_LowPriority,Nt=e.unstable_IdlePriority,Wt=e.log,Lt=e.unstable_setDisableYieldValue,an=null,tt=null;function xn(t){if(typeof Wt=="function"&&Lt(t),tt&&typeof tt.setStrictMode=="function")try{tt.setStrictMode(an,t)}catch{}}var Xt=Math.clz32?Math.clz32:Jr,En=Math.log,Nn=Math.LN2;function Jr(t){return t>>>=0,t===0?32:31-(En(t)/Nn|0)|0}var In=256,on=262144,Ft=4194304;function Gn(t){var i=t&42;if(i!==0)return i;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function sr(t,i,u){var p=t.pendingLanes;if(p===0)return 0;var C=0,T=t.suspendedLanes,U=t.pingedLanes;t=t.warmLanes;var J=p&134217727;return J!==0?(p=J&~T,p!==0?C=Gn(p):(U&=J,U!==0?C=Gn(U):u||(u=J&~t,u!==0&&(C=Gn(u))))):(J=p&~T,J!==0?C=Gn(J):U!==0?C=Gn(U):u||(u=p&~t,u!==0&&(C=Gn(u)))),C===0?0:i!==0&&i!==C&&(i&T)===0&&(T=C&-C,u=i&-i,T>=u||T===32&&(u&4194048)!==0)?i:C}function fr(t,i){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&i)===0}function hi(t,i){switch(t){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dr(){var t=Ft;return Ft<<=1,(Ft&62914560)===0&&(Ft=4194304),t}function qr(t){for(var i=[],u=0;31>u;u++)i.push(t);return i}function ei(t,i){t.pendingLanes|=i,i!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function ti(t,i,u,p,C,T){var U=t.pendingLanes;t.pendingLanes=u,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=u,t.entangledLanes&=u,t.errorRecoveryDisabledLanes&=u,t.shellSuspendCounter=0;var J=t.entanglements,me=t.expirationTimes,$e=t.hiddenUpdates;for(u=U&~u;0<u;){var Ze=31-Xt(u),it=1<<Ze;J[Ze]=0,me[Ze]=-1;var ze=$e[Ze];if(ze!==null)for($e[Ze]=null,Ze=0;Ze<ze.length;Ze++){var Ye=ze[Ze];Ye!==null&&(Ye.lane&=-536870913)}u&=~it}p!==0&&Dr(t,p,0),T!==0&&C===0&&t.tag!==0&&(t.suspendedLanes|=T&~(U&~i))}function Dr(t,i,u){t.pendingLanes|=i,t.suspendedLanes&=~i;var p=31-Xt(i);t.entangledLanes|=i,t.entanglements[p]=t.entanglements[p]|1073741824|u&261930}function Pr(t,i){var u=t.entangledLanes|=i;for(t=t.entanglements;u;){var p=31-Xt(u),C=1<<p;C&i|t[p]&i&&(t[p]|=i),u&=~C}}function P(t,i){var u=i&-i;return u=(u&42)!==0?1:W(u),(u&(t.suspendedLanes|i))!==0?0:u}function W(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function K(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function M(){var t=_e.p;return t!==0?t:(t=window.event,t===void 0?32:fm(t.type))}function H(t,i){var u=_e.p;try{return _e.p=t,i()}finally{_e.p=u}}var Ee=Math.random().toString(36).slice(2),Ae="__reactFiber$"+Ee,Fe="__reactProps$"+Ee,ut="__reactContainer$"+Ee,Tt="__reactEvents$"+Ee,xt="__reactListeners$"+Ee,dn="__reactHandles$"+Ee,Mt="__reactResources$"+Ee,Gt="__reactMarker$"+Ee;function jt(t){delete t[Ae],delete t[Fe],delete t[Tt],delete t[xt],delete t[dn]}function kt(t){var i=t[Ae];if(i)return i;for(var u=t.parentNode;u;){if(i=u[ut]||u[Ae]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(t=Kg(t);t!==null;){if(u=t[Ae])return u;t=Kg(t)}return i}t=u,u=t.parentNode}return null}function bt(t){if(t=t[Ae]||t[ut]){var i=t.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return t}return null}function Zt(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t.stateNode;throw Error(o(33))}function St(t){var i=t[Mt];return i||(i=t[Mt]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function vt(t){t[Gt]=!0}var Se=new Set,Vt={};function ct(t,i){_t(t,i),_t(t+"Capture",i)}function _t(t,i){for(Vt[t]=i,t=0;t<i.length;t++)Se.add(i[t])}var Ot=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),st={},Ie={};function ye(t){return Qt.call(Ie,t)?!0:Qt.call(st,t)?!1:Ot.test(t)?Ie[t]=!0:(st[t]=!0,!1)}function rt(t,i,u){if(ye(i))if(u===null)t.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":t.removeAttribute(i);return;case"boolean":var p=i.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){t.removeAttribute(i);return}}t.setAttribute(i,""+u)}}function Xe(t,i,u){if(u===null)t.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttribute(i,""+u)}}function He(t,i,u,p){if(p===null)t.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(u);return}t.setAttributeNS(i,u,""+p)}}function We(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zt(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function hn(t,i,u){var p=Object.getOwnPropertyDescriptor(t.constructor.prototype,i);if(!t.hasOwnProperty(i)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var C=p.get,T=p.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return C.call(this)},set:function(U){u=""+U,T.call(this,U)}}),Object.defineProperty(t,i,{enumerable:p.enumerable}),{getValue:function(){return u},setValue:function(U){u=""+U},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function $t(t){if(!t._valueTracker){var i=zt(t)?"checked":"value";t._valueTracker=hn(t,i,""+t[i])}}function en(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var u=i.getValue(),p="";return t&&(p=zt(t)?t.checked?"true":"false":t.value),t=p,t!==u?(i.setValue(t),!0):!1}function he(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var un=/[\n"\\]/g;function Dt(t){return t.replace(un,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function nn(t,i,u,p,C,T,U,J){t.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?t.type=U:t.removeAttribute("type"),i!=null?U==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+We(i)):t.value!==""+We(i)&&(t.value=""+We(i)):U!=="submit"&&U!=="reset"||t.removeAttribute("value"),i!=null?re(t,U,We(i)):u!=null?re(t,U,We(u)):p!=null&&t.removeAttribute("value"),C==null&&T!=null&&(t.defaultChecked=!!T),C!=null&&(t.checked=C&&typeof C!="function"&&typeof C!="symbol"),J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"?t.name=""+We(J):t.removeAttribute("name")}function be(t,i,u,p,C,T,U,J){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(t.type=T),i!=null||u!=null){if(!(T!=="submit"&&T!=="reset"||i!=null)){$t(t);return}u=u!=null?""+We(u):"",i=i!=null?""+We(i):u,J||i===t.value||(t.value=i),t.defaultValue=i}p=p??C,p=typeof p!="function"&&typeof p!="symbol"&&!!p,t.checked=J?t.checked:!!p,t.defaultChecked=!!p,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(t.name=U),$t(t)}function re(t,i,u){i==="number"&&he(t.ownerDocument)===t||t.defaultValue===""+u||(t.defaultValue=""+u)}function ot(t,i,u,p){if(t=t.options,i){i={};for(var C=0;C<u.length;C++)i["$"+u[C]]=!0;for(u=0;u<t.length;u++)C=i.hasOwnProperty("$"+t[u].value),t[u].selected!==C&&(t[u].selected=C),C&&p&&(t[u].defaultSelected=!0)}else{for(u=""+We(u),i=null,C=0;C<t.length;C++){if(t[C].value===u){t[C].selected=!0,p&&(t[C].defaultSelected=!0);return}i!==null||t[C].disabled||(i=t[C])}i!==null&&(i.selected=!0)}}function bn(t,i,u){if(i!=null&&(i=""+We(i),i!==t.value&&(t.value=i),u==null)){t.defaultValue!==i&&(t.defaultValue=i);return}t.defaultValue=u!=null?""+We(u):""}function tn(t,i,u,p){if(i==null){if(p!=null){if(u!=null)throw Error(o(92));if(ve(p)){if(1<p.length)throw Error(o(93));p=p[0]}u=p}u==null&&(u=""),i=u}u=We(i),t.defaultValue=u,p=t.textContent,p===u&&p!==""&&p!==null&&(t.value=p),$t(t)}function Vn(t,i){if(i){var u=t.firstChild;if(u&&u===t.lastChild&&u.nodeType===3){u.nodeValue=i;return}}t.textContent=i}var rr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function On(t,i,u){var p=i.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="":p?t.setProperty(i,u):typeof u!="number"||u===0||rr.has(i)?i==="float"?t.cssFloat=u:t[i]=(""+u).trim():t[i]=u+"px"}function Et(t,i,u){if(i!=null&&typeof i!="object")throw Error(o(62));if(t=t.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||i!=null&&i.hasOwnProperty(p)||(p.indexOf("--")===0?t.setProperty(p,""):p==="float"?t.cssFloat="":t[p]="");for(var C in i)p=i[C],i.hasOwnProperty(C)&&u[C]!==p&&On(t,C,p)}else for(var T in i)i.hasOwnProperty(T)&&On(t,T,i[T])}function yn(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ua(t){return Mr.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function jr(){}var si=null;function oi(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Wn=null,Wr=null;function pi(t){var i=bt(t);if(i&&(t=i.stateNode)){var u=t[Fe]||null;e:switch(t=i.stateNode,i.type){case"input":if(nn(t,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),i=u.name,u.type==="radio"&&i!=null){for(u=t;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Dt(""+i)+'"][type="radio"]'),i=0;i<u.length;i++){var p=u[i];if(p!==t&&p.form===t.form){var C=p[Fe]||null;if(!C)throw Error(o(90));nn(p,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(i=0;i<u.length;i++)p=u[i],p.form===t.form&&en(p)}break e;case"textarea":bn(t,u.value,u.defaultValue);break e;case"select":i=u.value,i!=null&&ot(t,!!u.multiple,i,!1)}}}var rn=!1;function as(t,i,u){if(rn)return t(i,u);rn=!0;try{var p=t(i);return p}finally{if(rn=!1,(Wn!==null||Wr!==null)&&(tc(),Wn&&(i=Wn,t=Wr,Wr=Wn=null,pi(i),t)))for(i=0;i<t.length;i++)pi(t[i])}}function pn(t,i){var u=t.stateNode;if(u===null)return null;var p=u[Fe]||null;if(p===null)return null;u=p[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(t=t.type,p=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!p;break e;default:t=!1}if(t)return null;if(u&&typeof u!="function")throw Error(o(231,i,typeof u));return u}var or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ea=!1;if(or)try{var ji={};Object.defineProperty(ji,"passive",{get:function(){Ea=!0}}),window.addEventListener("test",ji,ji),window.removeEventListener("test",ji,ji)}catch{Ea=!1}var li=null,Ti=null,Va=null;function Si(){if(Va)return Va;var t,i=Ti,u=i.length,p,C="value"in li?li.value:li.textContent,T=C.length;for(t=0;t<u&&i[t]===C[t];t++);var U=u-t;for(p=1;p<=U&&i[u-p]===C[T-p];p++);return Va=C.slice(t,1<p?1-p:void 0)}function Mi(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function Bi(){return!0}function qa(){return!1}function Br(t){function i(u,p,C,T,U){this._reactName=u,this._targetInst=C,this.type=p,this.nativeEvent=T,this.target=U,this.currentTarget=null;for(var J in t)t.hasOwnProperty(J)&&(u=t[J],this[J]=u?u(T):T[J]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Bi:qa,this.isPropagationStopped=qa,this}return R(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Bi)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Bi)},persist:function(){},isPersistent:Bi}),i}var gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tr=Br(gi),ca=R({},gi,{view:0,detail:0}),Is=Br(ca),ja,ss,Ta,Sa=R({},ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:da,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ta&&(Ta&&t.type==="mousemove"?(ja=t.screenX-Ta.screenX,ss=t.screenY-Ta.screenY):ss=ja=0,Ta=t),ja)},movementY:function(t){return"movementY"in t?t.movementY:ss}}),Kn=Br(Sa),Rs=R({},Sa,{dataTransfer:0}),Ha=Br(Rs),Ni=R({},ca,{relatedTarget:0}),os=Br(Ni),Pe=R({},gi,{animationName:0,elapsedTime:0,pseudoElement:0}),Cn=Br(Pe),Nr=R({},gi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ia=Br(Nr),Os=R({},gi,{data:0}),Ya=Br(Os),Ds={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sr(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=Hi[t])?!!i[t]:!1}function da(){return Sr}var mr=R({},ca,{key:function(t){if(t.key){var i=Ds[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=Mi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fa[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:da,charCode:function(t){return t.type==="keypress"?Mi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Mi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Wa=Br(mr),Yi=R({},Sa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qn=Br(Yi),sn=R({},ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:da}),Ms=Br(sn),$n=R({},gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ii=Br($n),Wi=R({},Sa,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=Br(Wi),mi=R({},gi,{newState:0,oldState:0}),Ka=Br(mi),ls=[9,13,27,32],ha=or&&"CompositionEvent"in window,_i=null;or&&"documentMode"in document&&(_i=document.documentMode);var Ki=or&&"TextEvent"in window&&!_i,Qa=or&&(!ha||_i&&8<_i&&11>=_i),ki=" ",Qi=!1;function Ra(t,i){switch(t){case"keyup":return ls.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $i(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xi=!1;function Ri(t,i){switch(t){case"compositionend":return $i(i);case"keypress":return i.which!==32?null:(Qi=!0,ki);case"textInput":return t=i.data,t===ki&&Qi?null:t;default:return null}}function Oa(t,i){if(Xi)return t==="compositionend"||!ha&&Ra(t,i)?(t=Si(),Va=Ti=li=null,Xi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Qa&&i.locale!=="ko"?null:i.data;default:return null}}var ni={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xa(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!ni[t.type]:i==="textarea"}function ui(t,i,u,p){Wn?Wr?Wr.push(p):Wr=[p]:Wn=p,i=lc(i,"onChange"),0<i.length&&(u=new Tr("onChange","change",null,u,p),t.push({event:u,listeners:i}))}var Da=null,Li=null;function Bs(t){kg(t,0)}function zi(t){var i=Zt(t);if(en(i))return t}function xi(t,i){if(t==="change")return i}var Za=!1;if(or){var Ma;if(or){var Zi="oninput"in document;if(!Zi){var Be=document.createElement("div");Be.setAttribute("oninput","return;"),Zi=typeof Be.oninput=="function"}Ma=Zi}else Ma=!1;Za=Ma&&(!document.documentMode||9<document.documentMode)}function pa(){Da&&(Da.detachEvent("onpropertychange",G),Li=Da=null)}function G(t){if(t.propertyName==="value"&&zi(Li)){var i=[];ui(i,Li,t,oi(t)),as(Bs,i)}}function n(t,i,u){t==="focusin"?(pa(),Da=i,Li=u,Da.attachEvent("onpropertychange",G)):t==="focusout"&&pa()}function s(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return zi(Li)}function l(t,i){if(t==="click")return zi(i)}function f(t,i){if(t==="input"||t==="change")return zi(i)}function d(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var g=typeof Object.is=="function"?Object.is:d;function w(t,i){if(g(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var u=Object.keys(t),p=Object.keys(i);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var C=u[p];if(!Qt.call(i,C)||!g(t[C],i[C]))return!1}return!0}function E(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function O(t,i){var u=E(t);t=0;for(var p;u;){if(u.nodeType===3){if(p=t+u.textContent.length,t<=i&&p>=i)return{node:u,offset:i-t};t=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=E(u)}}function L(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?L(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function V(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var i=he(t.document);i instanceof t.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)t=i.contentWindow;else break;i=he(t.document)}return i}function Y(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}var ae=or&&"documentMode"in document&&11>=document.documentMode,ge=null,we=null,Oe=null,Ue=!1;function pt(t,i,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Ue||ge==null||ge!==he(p)||(p=ge,"selectionStart"in p&&Y(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Oe&&w(Oe,p)||(Oe=p,p=lc(we,"onSelect"),0<p.length&&(i=new Tr("onSelect","select",null,i,u),t.push({event:i,listeners:p}),i.target=ge)))}function dt(t,i){var u={};return u[t.toLowerCase()]=i.toLowerCase(),u["Webkit"+t]="webkit"+i,u["Moz"+t]="moz"+i,u}var v={animationend:dt("Animation","AnimationEnd"),animationiteration:dt("Animation","AnimationIteration"),animationstart:dt("Animation","AnimationStart"),transitionrun:dt("Transition","TransitionRun"),transitionstart:dt("Transition","TransitionStart"),transitioncancel:dt("Transition","TransitionCancel"),transitionend:dt("Transition","TransitionEnd")},I={},b={};or&&(b=document.createElement("div").style,"AnimationEvent"in window||(delete v.animationend.animation,delete v.animationiteration.animation,delete v.animationstart.animation),"TransitionEvent"in window||delete v.transitionend.transition);function A(t){if(I[t])return I[t];if(!v[t])return t;var i=v[t],u;for(u in i)if(i.hasOwnProperty(u)&&u in b)return I[t]=i[u];return t}var D=A("animationend"),$=A("animationiteration"),q=A("animationstart"),Z=A("transitionrun"),se=A("transitionstart"),de=A("transitioncancel"),Te=A("transitionend"),je=new Map,lt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lt.push("scrollEnd");function yt(t,i){je.set(t,i),ct(i,[t])}var cn=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},gn=[],Ln=0,Jn=0;function jn(){for(var t=Ln,i=Jn=Ln=0;i<t;){var u=gn[i];gn[i++]=null;var p=gn[i];gn[i++]=null;var C=gn[i];gn[i++]=null;var T=gn[i];if(gn[i++]=null,p!==null&&C!==null){var U=p.pending;U===null?C.next=C:(C.next=U.next,U.next=C),p.pending=C}T!==0&&ga(u,C,T)}}function Qn(t,i,u,p){gn[Ln++]=t,gn[Ln++]=i,gn[Ln++]=u,gn[Ln++]=p,Jn|=p,t.lanes|=p,t=t.alternate,t!==null&&(t.lanes|=p)}function Ji(t,i,u,p){return Qn(t,i,u,p),us(t)}function Lr(t,i){return Qn(t,null,null,i),us(t)}function ga(t,i,u){t.lanes|=u;var p=t.alternate;p!==null&&(p.lanes|=u);for(var C=!1,T=t.return;T!==null;)T.childLanes|=u,p=T.alternate,p!==null&&(p.childLanes|=u),T.tag===22&&(t=T.stateNode,t===null||t._visibility&1||(C=!0)),t=T,T=T.return;return t.tag===3?(T=t.stateNode,C&&i!==null&&(C=31-Xt(u),t=T.hiddenUpdates,p=t[C],p===null?t[C]=[i]:p.push(i),i.lane=u|536870912),T):null}function us(t){if(50<Gl)throw Gl=0,Cd=null,Error(o(185));for(var i=t.return;i!==null;)t=i,i=t.return;return t.tag===3?t.stateNode:null}var Ns={};function Eu(t,i,u,p){this.tag=t,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ci(t,i,u,p){return new Eu(t,i,u,p)}function Po(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ui(t,i){var u=t.alternate;return u===null?(u=Ci(t.tag,i,t.key,t.mode),u.elementType=t.elementType,u.type=t.type,u.stateNode=t.stateNode,u.alternate=t,t.alternate=u):(u.pendingProps=i,u.type=t.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=t.flags&65011712,u.childLanes=t.childLanes,u.lanes=t.lanes,u.child=t.child,u.memoizedProps=t.memoizedProps,u.memoizedState=t.memoizedState,u.updateQueue=t.updateQueue,i=t.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=t.sibling,u.index=t.index,u.ref=t.ref,u.refCleanup=t.refCleanup,u}function uo(t,i){t.flags&=65011714;var u=t.alternate;return u===null?(t.childLanes=0,t.lanes=i,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=u.childLanes,t.lanes=u.lanes,t.child=u.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=u.memoizedProps,t.memoizedState=u.memoizedState,t.updateQueue=u.updateQueue,t.type=u.type,i=u.dependencies,t.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t}function co(t,i,u,p,C,T){var U=0;if(p=t,typeof t=="function")Po(t)&&(U=1);else if(typeof t=="string")U=IA(t,u,Le.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case le:return t=Ci(31,u,i,C),t.elementType=le,t.lanes=T,t;case z:return fo(u.children,C,T,i);case X:U=8,C|=24;break;case j:return t=Ci(12,u,i,C|2),t.elementType=j,t.lanes=T,t;case oe:return t=Ci(13,u,i,C),t.elementType=oe,t.lanes=T,t;case ue:return t=Ci(19,u,i,C),t.elementType=ue,t.lanes=T,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case te:U=10;break e;case F:U=9;break e;case Q:U=11;break e;case ee:U=14;break e;case ce:U=16,p=null;break e}U=29,u=Error(o(130,t===null?"null":typeof t,"")),p=null}return i=Ci(U,u,i,C),i.elementType=t,i.type=p,i.lanes=T,i}function fo(t,i,u,p){return t=Ci(7,t,p,i),t.lanes=u,t}function mf(t,i,u){return t=Ci(6,t,null,i),t.lanes=u,t}function y1(t){var i=Ci(18,null,null,0);return i.stateNode=t,i}function xf(t,i,u){return i=Ci(4,t.children!==null?t.children:[],t.key,i),i.lanes=u,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}var w1=new WeakMap;function ma(t,i){if(typeof t=="object"&&t!==null){var u=w1.get(t);return u!==void 0?u:(i={value:t,source:i,stack:mn(i)},w1.set(t,i),i)}return{value:t,source:i,stack:mn(i)}}var Fo=[],Go=0,Tu=null,vl=0,xa=[],ya=0,ks=null,Ja=1,es="";function cs(t,i){Fo[Go++]=vl,Fo[Go++]=Tu,Tu=t,vl=i}function b1(t,i,u){xa[ya++]=Ja,xa[ya++]=es,xa[ya++]=ks,ks=t;var p=Ja;t=es;var C=32-Xt(p)-1;p&=~(1<<C),u+=1;var T=32-Xt(i)+C;if(30<T){var U=C-C%5;T=(p&(1<<U)-1).toString(32),p>>=U,C-=U,Ja=1<<32-Xt(i)+C|u<<C|p,es=T+t}else Ja=1<<T|u<<C|p,es=t}function yf(t){t.return!==null&&(cs(t,1),b1(t,1,0))}function wf(t){for(;t===Tu;)Tu=Fo[--Go],Fo[Go]=null,vl=Fo[--Go],Fo[Go]=null;for(;t===ks;)ks=xa[--ya],xa[ya]=null,es=xa[--ya],xa[ya]=null,Ja=xa[--ya],xa[ya]=null}function v1(t,i){xa[ya++]=Ja,xa[ya++]=es,xa[ya++]=ks,Ja=i.id,es=i.overflow,ks=t}var yi=null,Ir=null,Xn=!1,$s=null,wa=!1,bf=Error(o(519));function Ls(t){var i=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw _l(ma(i,t)),bf}function _1(t){var i=t.stateNode,u=t.type,p=t.memoizedProps;switch(i[Ae]=t,i[Fe]=p,u){case"dialog":Pn("cancel",i),Pn("close",i);break;case"iframe":case"object":case"embed":Pn("load",i);break;case"video":case"audio":for(u=0;u<ql.length;u++)Pn(ql[u],i);break;case"source":Pn("error",i);break;case"img":case"image":case"link":Pn("error",i),Pn("load",i);break;case"details":Pn("toggle",i);break;case"input":Pn("invalid",i),be(i,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Pn("invalid",i);break;case"textarea":Pn("invalid",i),tn(i,p.value,p.defaultValue,p.children)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||i.textContent===""+u||p.suppressHydrationWarning===!0||Ug(i.textContent,u)?(p.popover!=null&&(Pn("beforetoggle",i),Pn("toggle",i)),p.onScroll!=null&&Pn("scroll",i),p.onScrollEnd!=null&&Pn("scrollend",i),p.onClick!=null&&(i.onclick=jr),i=!0):i=!1,i||Ls(t,!0)}function C1(t){for(yi=t.return;yi;)switch(yi.tag){case 5:case 31:case 13:wa=!1;return;case 27:case 3:wa=!0;return;default:yi=yi.return}}function Vo(t){if(t!==yi)return!1;if(!Xn)return C1(t),Xn=!0,!1;var i=t.tag,u;if((u=i!==3&&i!==27)&&((u=i===5)&&(u=t.type,u=!(u!=="form"&&u!=="button")||zd(t.type,t.memoizedProps)),u=!u),u&&Ir&&Ls(t),C1(t),i===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Ir=Wg(t)}else if(i===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Ir=Wg(t)}else i===27?(i=Ir,Xs(t.type)?(t=Vd,Vd=null,Ir=t):Ir=i):Ir=yi?va(t.stateNode.nextSibling):null;return!0}function ho(){Ir=yi=null,Xn=!1}function vf(){var t=$s;return t!==null&&(Vi===null?Vi=t:Vi.push.apply(Vi,t),$s=null),t}function _l(t){$s===null?$s=[t]:$s.push(t)}var _f=ne(null),po=null,fs=null;function zs(t,i,u){De(_f,i._currentValue),i._currentValue=u}function ds(t){t._currentValue=_f.current,fe(_f)}function Cf(t,i,u){for(;t!==null;){var p=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,p!==null&&(p.childLanes|=i)):p!==null&&(p.childLanes&i)!==i&&(p.childLanes|=i),t===u)break;t=t.return}}function Af(t,i,u,p){var C=t.child;for(C!==null&&(C.return=t);C!==null;){var T=C.dependencies;if(T!==null){var U=C.child;T=T.firstContext;e:for(;T!==null;){var J=T;T=C;for(var me=0;me<i.length;me++)if(J.context===i[me]){T.lanes|=u,J=T.alternate,J!==null&&(J.lanes|=u),Cf(T.return,u,t),p||(U=null);break e}T=J.next}}else if(C.tag===18){if(U=C.return,U===null)throw Error(o(341));U.lanes|=u,T=U.alternate,T!==null&&(T.lanes|=u),Cf(U,u,t),U=null}else U=C.child;if(U!==null)U.return=C;else for(U=C;U!==null;){if(U===t){U=null;break}if(C=U.sibling,C!==null){C.return=U.return,U=C;break}U=U.return}C=U}}function qo(t,i,u,p){t=null;for(var C=i,T=!1;C!==null;){if(!T){if((C.flags&524288)!==0)T=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var U=C.alternate;if(U===null)throw Error(o(387));if(U=U.memoizedProps,U!==null){var J=C.type;g(C.pendingProps.value,U.value)||(t!==null?t.push(J):t=[J])}}else if(C===Bt.current){if(U=C.alternate,U===null)throw Error(o(387));U.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(t!==null?t.push(Kl):t=[Kl])}C=C.return}t!==null&&Af(i,t,u,p),i.flags|=262144}function Su(t){for(t=t.firstContext;t!==null;){if(!g(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function go(t){po=t,fs=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function wi(t){return A1(po,t)}function Iu(t,i){return po===null&&go(t),A1(t,i)}function A1(t,i){var u=i._currentValue;if(i={context:i,memoizedValue:u,next:null},fs===null){if(t===null)throw Error(o(308));fs=i,t.dependencies={lanes:0,firstContext:i},t.flags|=524288}else fs=fs.next=i;return u}var AC=typeof AbortController<"u"?AbortController:function(){var t=[],i=this.signal={aborted:!1,addEventListener:function(u,p){t.push(p)}};this.abort=function(){i.aborted=!0,t.forEach(function(u){return u()})}},EC=e.unstable_scheduleCallback,TC=e.unstable_NormalPriority,Kr={$$typeof:te,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ef(){return{controller:new AC,data:new Map,refCount:0}}function Cl(t){t.refCount--,t.refCount===0&&EC(TC,function(){t.controller.abort()})}var Al=null,Tf=0,jo=0,Ho=null;function SC(t,i){if(Al===null){var u=Al=[];Tf=0,jo=Rd(),Ho={status:"pending",value:void 0,then:function(p){u.push(p)}}}return Tf++,i.then(E1,E1),i}function E1(){if(--Tf===0&&Al!==null){Ho!==null&&(Ho.status="fulfilled");var t=Al;Al=null,jo=0,Ho=null;for(var i=0;i<t.length;i++)(0,t[i])()}}function IC(t,i){var u=[],p={status:"pending",value:null,reason:null,then:function(C){u.push(C)}};return t.then(function(){p.status="fulfilled",p.value=i;for(var C=0;C<u.length;C++)(0,u[C])(i)},function(C){for(p.status="rejected",p.reason=C,C=0;C<u.length;C++)(0,u[C])(void 0)}),p}var T1=xe.S;xe.S=function(t,i){ug=kn(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&SC(t,i),T1!==null&&T1(t,i)};var mo=ne(null);function Sf(){var t=mo.current;return t!==null?t:_r.pooledCache}function Ru(t,i){i===null?De(mo,mo.current):De(mo,i.pool)}function S1(){var t=Sf();return t===null?null:{parent:Kr._currentValue,pool:t}}var Yo=Error(o(460)),If=Error(o(474)),Ou=Error(o(542)),Du={then:function(){}};function I1(t){return t=t.status,t==="fulfilled"||t==="rejected"}function R1(t,i,u){switch(u=t[u],u===void 0?t.push(i):u!==i&&(i.then(jr,jr),i=u),i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,D1(t),t;default:if(typeof i.status=="string")i.then(jr,jr);else{if(t=_r,t!==null&&100<t.shellSuspendCounter)throw Error(o(482));t=i,t.status="pending",t.then(function(p){if(i.status==="pending"){var C=i;C.status="fulfilled",C.value=p}},function(p){if(i.status==="pending"){var C=i;C.status="rejected",C.reason=p}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,D1(t),t}throw yo=i,Yo}}function xo(t){try{var i=t._init;return i(t._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(yo=u,Yo):u}}var yo=null;function O1(){if(yo===null)throw Error(o(459));var t=yo;return yo=null,t}function D1(t){if(t===Yo||t===Ou)throw Error(o(483))}var Wo=null,El=0;function Mu(t){var i=El;return El+=1,Wo===null&&(Wo=[]),R1(Wo,t,i)}function Tl(t,i){i=i.props.ref,t.ref=i!==void 0?i:null}function Bu(t,i){throw i.$$typeof===B?Error(o(525)):(t=Object.prototype.toString.call(i),Error(o(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t)))}function M1(t){function i(Re,Ce){if(t){var Ne=Re.deletions;Ne===null?(Re.deletions=[Ce],Re.flags|=16):Ne.push(Ce)}}function u(Re,Ce){if(!t)return null;for(;Ce!==null;)i(Re,Ce),Ce=Ce.sibling;return null}function p(Re){for(var Ce=new Map;Re!==null;)Re.key!==null?Ce.set(Re.key,Re):Ce.set(Re.index,Re),Re=Re.sibling;return Ce}function C(Re,Ce){return Re=Ui(Re,Ce),Re.index=0,Re.sibling=null,Re}function T(Re,Ce,Ne){return Re.index=Ne,t?(Ne=Re.alternate,Ne!==null?(Ne=Ne.index,Ne<Ce?(Re.flags|=67108866,Ce):Ne):(Re.flags|=67108866,Ce)):(Re.flags|=1048576,Ce)}function U(Re){return t&&Re.alternate===null&&(Re.flags|=67108866),Re}function J(Re,Ce,Ne,nt){return Ce===null||Ce.tag!==6?(Ce=mf(Ne,Re.mode,nt),Ce.return=Re,Ce):(Ce=C(Ce,Ne),Ce.return=Re,Ce)}function me(Re,Ce,Ne,nt){var ln=Ne.type;return ln===z?Ze(Re,Ce,Ne.props.children,nt,Ne.key):Ce!==null&&(Ce.elementType===ln||typeof ln=="object"&&ln!==null&&ln.$$typeof===ce&&xo(ln)===Ce.type)?(Ce=C(Ce,Ne.props),Tl(Ce,Ne),Ce.return=Re,Ce):(Ce=co(Ne.type,Ne.key,Ne.props,null,Re.mode,nt),Tl(Ce,Ne),Ce.return=Re,Ce)}function $e(Re,Ce,Ne,nt){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Ne.containerInfo||Ce.stateNode.implementation!==Ne.implementation?(Ce=xf(Ne,Re.mode,nt),Ce.return=Re,Ce):(Ce=C(Ce,Ne.children||[]),Ce.return=Re,Ce)}function Ze(Re,Ce,Ne,nt,ln){return Ce===null||Ce.tag!==7?(Ce=fo(Ne,Re.mode,nt,ln),Ce.return=Re,Ce):(Ce=C(Ce,Ne),Ce.return=Re,Ce)}function it(Re,Ce,Ne){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=mf(""+Ce,Re.mode,Ne),Ce.return=Re,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case N:return Ne=co(Ce.type,Ce.key,Ce.props,null,Re.mode,Ne),Tl(Ne,Ce),Ne.return=Re,Ne;case k:return Ce=xf(Ce,Re.mode,Ne),Ce.return=Re,Ce;case ce:return Ce=xo(Ce),it(Re,Ce,Ne)}if(ve(Ce)||ke(Ce))return Ce=fo(Ce,Re.mode,Ne,null),Ce.return=Re,Ce;if(typeof Ce.then=="function")return it(Re,Mu(Ce),Ne);if(Ce.$$typeof===te)return it(Re,Iu(Re,Ce),Ne);Bu(Re,Ce)}return null}function ze(Re,Ce,Ne,nt){var ln=Ce!==null?Ce.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return ln!==null?null:J(Re,Ce,""+Ne,nt);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case N:return Ne.key===ln?me(Re,Ce,Ne,nt):null;case k:return Ne.key===ln?$e(Re,Ce,Ne,nt):null;case ce:return Ne=xo(Ne),ze(Re,Ce,Ne,nt)}if(ve(Ne)||ke(Ne))return ln!==null?null:Ze(Re,Ce,Ne,nt,null);if(typeof Ne.then=="function")return ze(Re,Ce,Mu(Ne),nt);if(Ne.$$typeof===te)return ze(Re,Ce,Iu(Re,Ne),nt);Bu(Re,Ne)}return null}function Ye(Re,Ce,Ne,nt,ln){if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return Re=Re.get(Ne)||null,J(Ce,Re,""+nt,ln);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case N:return Re=Re.get(nt.key===null?Ne:nt.key)||null,me(Ce,Re,nt,ln);case k:return Re=Re.get(nt.key===null?Ne:nt.key)||null,$e(Ce,Re,nt,ln);case ce:return nt=xo(nt),Ye(Re,Ce,Ne,nt,ln)}if(ve(nt)||ke(nt))return Re=Re.get(Ne)||null,Ze(Ce,Re,nt,ln,null);if(typeof nt.then=="function")return Ye(Re,Ce,Ne,Mu(nt),ln);if(nt.$$typeof===te)return Ye(Re,Ce,Ne,Iu(Ce,nt),ln);Bu(Ce,nt)}return null}function Ht(Re,Ce,Ne,nt){for(var ln=null,ir=null,Jt=Ce,Mn=Ce=0,Yn=null;Jt!==null&&Mn<Ne.length;Mn++){Jt.index>Mn?(Yn=Jt,Jt=null):Yn=Jt.sibling;var ar=ze(Re,Jt,Ne[Mn],nt);if(ar===null){Jt===null&&(Jt=Yn);break}t&&Jt&&ar.alternate===null&&i(Re,Jt),Ce=T(ar,Ce,Mn),ir===null?ln=ar:ir.sibling=ar,ir=ar,Jt=Yn}if(Mn===Ne.length)return u(Re,Jt),Xn&&cs(Re,Mn),ln;if(Jt===null){for(;Mn<Ne.length;Mn++)Jt=it(Re,Ne[Mn],nt),Jt!==null&&(Ce=T(Jt,Ce,Mn),ir===null?ln=Jt:ir.sibling=Jt,ir=Jt);return Xn&&cs(Re,Mn),ln}for(Jt=p(Jt);Mn<Ne.length;Mn++)Yn=Ye(Jt,Re,Mn,Ne[Mn],nt),Yn!==null&&(t&&Yn.alternate!==null&&Jt.delete(Yn.key===null?Mn:Yn.key),Ce=T(Yn,Ce,Mn),ir===null?ln=Yn:ir.sibling=Yn,ir=Yn);return t&&Jt.forEach(function(no){return i(Re,no)}),Xn&&cs(Re,Mn),ln}function wn(Re,Ce,Ne,nt){if(Ne==null)throw Error(o(151));for(var ln=null,ir=null,Jt=Ce,Mn=Ce=0,Yn=null,ar=Ne.next();Jt!==null&&!ar.done;Mn++,ar=Ne.next()){Jt.index>Mn?(Yn=Jt,Jt=null):Yn=Jt.sibling;var no=ze(Re,Jt,ar.value,nt);if(no===null){Jt===null&&(Jt=Yn);break}t&&Jt&&no.alternate===null&&i(Re,Jt),Ce=T(no,Ce,Mn),ir===null?ln=no:ir.sibling=no,ir=no,Jt=Yn}if(ar.done)return u(Re,Jt),Xn&&cs(Re,Mn),ln;if(Jt===null){for(;!ar.done;Mn++,ar=Ne.next())ar=it(Re,ar.value,nt),ar!==null&&(Ce=T(ar,Ce,Mn),ir===null?ln=ar:ir.sibling=ar,ir=ar);return Xn&&cs(Re,Mn),ln}for(Jt=p(Jt);!ar.done;Mn++,ar=Ne.next())ar=Ye(Jt,Re,Mn,ar.value,nt),ar!==null&&(t&&ar.alternate!==null&&Jt.delete(ar.key===null?Mn:ar.key),Ce=T(ar,Ce,Mn),ir===null?ln=ar:ir.sibling=ar,ir=ar);return t&&Jt.forEach(function(UA){return i(Re,UA)}),Xn&&cs(Re,Mn),ln}function wr(Re,Ce,Ne,nt){if(typeof Ne=="object"&&Ne!==null&&Ne.type===z&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case N:e:{for(var ln=Ne.key;Ce!==null;){if(Ce.key===ln){if(ln=Ne.type,ln===z){if(Ce.tag===7){u(Re,Ce.sibling),nt=C(Ce,Ne.props.children),nt.return=Re,Re=nt;break e}}else if(Ce.elementType===ln||typeof ln=="object"&&ln!==null&&ln.$$typeof===ce&&xo(ln)===Ce.type){u(Re,Ce.sibling),nt=C(Ce,Ne.props),Tl(nt,Ne),nt.return=Re,Re=nt;break e}u(Re,Ce);break}else i(Re,Ce);Ce=Ce.sibling}Ne.type===z?(nt=fo(Ne.props.children,Re.mode,nt,Ne.key),nt.return=Re,Re=nt):(nt=co(Ne.type,Ne.key,Ne.props,null,Re.mode,nt),Tl(nt,Ne),nt.return=Re,Re=nt)}return U(Re);case k:e:{for(ln=Ne.key;Ce!==null;){if(Ce.key===ln)if(Ce.tag===4&&Ce.stateNode.containerInfo===Ne.containerInfo&&Ce.stateNode.implementation===Ne.implementation){u(Re,Ce.sibling),nt=C(Ce,Ne.children||[]),nt.return=Re,Re=nt;break e}else{u(Re,Ce);break}else i(Re,Ce);Ce=Ce.sibling}nt=xf(Ne,Re.mode,nt),nt.return=Re,Re=nt}return U(Re);case ce:return Ne=xo(Ne),wr(Re,Ce,Ne,nt)}if(ve(Ne))return Ht(Re,Ce,Ne,nt);if(ke(Ne)){if(ln=ke(Ne),typeof ln!="function")throw Error(o(150));return Ne=ln.call(Ne),wn(Re,Ce,Ne,nt)}if(typeof Ne.then=="function")return wr(Re,Ce,Mu(Ne),nt);if(Ne.$$typeof===te)return wr(Re,Ce,Iu(Re,Ne),nt);Bu(Re,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint"?(Ne=""+Ne,Ce!==null&&Ce.tag===6?(u(Re,Ce.sibling),nt=C(Ce,Ne),nt.return=Re,Re=nt):(u(Re,Ce),nt=mf(Ne,Re.mode,nt),nt.return=Re,Re=nt),U(Re)):u(Re,Ce)}return function(Re,Ce,Ne,nt){try{El=0;var ln=wr(Re,Ce,Ne,nt);return Wo=null,ln}catch(Jt){if(Jt===Yo||Jt===Ou)throw Jt;var ir=Ci(29,Jt,null,Re.mode);return ir.lanes=nt,ir.return=Re,ir}}}var wo=M1(!0),B1=M1(!1),Us=!1;function Rf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Of(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Ps(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Fs(t,i,u){var p=t.updateQueue;if(p===null)return null;if(p=p.shared,(lr&2)!==0){var C=p.pending;return C===null?i.next=i:(i.next=C.next,C.next=i),p.pending=i,i=us(t),ga(t,null,u),i}return Qn(t,p,i,u),us(t)}function Sl(t,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194048)!==0)){var p=i.lanes;p&=t.pendingLanes,u|=p,i.lanes=u,Pr(t,u)}}function Df(t,i){var u=t.updateQueue,p=t.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var C=null,T=null;if(u=u.firstBaseUpdate,u!==null){do{var U={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};T===null?C=T=U:T=T.next=U,u=u.next}while(u!==null);T===null?C=T=i:T=T.next=i}else C=T=i;u={baseState:p.baseState,firstBaseUpdate:C,lastBaseUpdate:T,shared:p.shared,callbacks:p.callbacks},t.updateQueue=u;return}t=u.lastBaseUpdate,t===null?u.firstBaseUpdate=i:t.next=i,u.lastBaseUpdate=i}var Mf=!1;function Il(){if(Mf){var t=Ho;if(t!==null)throw t}}function Rl(t,i,u,p){Mf=!1;var C=t.updateQueue;Us=!1;var T=C.firstBaseUpdate,U=C.lastBaseUpdate,J=C.shared.pending;if(J!==null){C.shared.pending=null;var me=J,$e=me.next;me.next=null,U===null?T=$e:U.next=$e,U=me;var Ze=t.alternate;Ze!==null&&(Ze=Ze.updateQueue,J=Ze.lastBaseUpdate,J!==U&&(J===null?Ze.firstBaseUpdate=$e:J.next=$e,Ze.lastBaseUpdate=me))}if(T!==null){var it=C.baseState;U=0,Ze=$e=me=null,J=T;do{var ze=J.lane&-536870913,Ye=ze!==J.lane;if(Ye?(Hn&ze)===ze:(p&ze)===ze){ze!==0&&ze===jo&&(Mf=!0),Ze!==null&&(Ze=Ze.next={lane:0,tag:J.tag,payload:J.payload,callback:null,next:null});e:{var Ht=t,wn=J;ze=i;var wr=u;switch(wn.tag){case 1:if(Ht=wn.payload,typeof Ht=="function"){it=Ht.call(wr,it,ze);break e}it=Ht;break e;case 3:Ht.flags=Ht.flags&-65537|128;case 0:if(Ht=wn.payload,ze=typeof Ht=="function"?Ht.call(wr,it,ze):Ht,ze==null)break e;it=R({},it,ze);break e;case 2:Us=!0}}ze=J.callback,ze!==null&&(t.flags|=64,Ye&&(t.flags|=8192),Ye=C.callbacks,Ye===null?C.callbacks=[ze]:Ye.push(ze))}else Ye={lane:ze,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Ze===null?($e=Ze=Ye,me=it):Ze=Ze.next=Ye,U|=ze;if(J=J.next,J===null){if(J=C.shared.pending,J===null)break;Ye=J,J=Ye.next,Ye.next=null,C.lastBaseUpdate=Ye,C.shared.pending=null}}while(!0);Ze===null&&(me=it),C.baseState=me,C.firstBaseUpdate=$e,C.lastBaseUpdate=Ze,T===null&&(C.shared.lanes=0),Hs|=U,t.lanes=U,t.memoizedState=it}}function N1(t,i){if(typeof t!="function")throw Error(o(191,t));t.call(i)}function k1(t,i){var u=t.callbacks;if(u!==null)for(t.callbacks=null,t=0;t<u.length;t++)N1(u[t],i)}var Ko=ne(null),Nu=ne(0);function $1(t,i){t=vs,De(Nu,t),De(Ko,i),vs=t|i.baseLanes}function Bf(){De(Nu,vs),De(Ko,Ko.current)}function Nf(){vs=Nu.current,fe(Ko),fe(Nu)}var ea=ne(null),ba=null;function Gs(t){var i=t.alternate;De(Hr,Hr.current&1),De(ea,t),ba===null&&(i===null||Ko.current!==null||i.memoizedState!==null)&&(ba=t)}function kf(t){De(Hr,Hr.current),De(ea,t),ba===null&&(ba=t)}function L1(t){t.tag===22?(De(Hr,Hr.current),De(ea,t),ba===null&&(ba=t)):Vs()}function Vs(){De(Hr,Hr.current),De(ea,ea.current)}function ta(t){fe(ea),ba===t&&(ba=null),fe(Hr)}var Hr=ne(0);function ku(t){for(var i=t;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||Fd(u)||Gd(u)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var hs=0,Dn=null,xr=null,Qr=null,$u=!1,Qo=!1,bo=!1,Lu=0,Ol=0,Xo=null,RC=0;function Fr(){throw Error(o(321))}function $f(t,i){if(i===null)return!1;for(var u=0;u<i.length&&u<t.length;u++)if(!g(t[u],i[u]))return!1;return!0}function Lf(t,i,u,p,C,T){return hs=T,Dn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,xe.H=t===null||t.memoizedState===null?bp:Zf,bo=!1,T=u(p,C),bo=!1,Qo&&(T=U1(i,u,p,C)),z1(t),T}function z1(t){xe.H=Bl;var i=xr!==null&&xr.next!==null;if(hs=0,Qr=xr=Dn=null,$u=!1,Ol=0,Xo=null,i)throw Error(o(300));t===null||Xr||(t=t.dependencies,t!==null&&Su(t)&&(Xr=!0))}function U1(t,i,u,p){Dn=t;var C=0;do{if(Qo&&(Xo=null),Ol=0,Qo=!1,25<=C)throw Error(o(301));if(C+=1,Qr=xr=null,t.updateQueue!=null){var T=t.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}xe.H=vp,T=i(u,p)}while(Qo);return T}function OC(){var t=xe.H,i=t.useState()[0];return i=typeof i.then=="function"?Dl(i):i,t=t.useState()[0],(xr!==null?xr.memoizedState:null)!==t&&(Dn.flags|=1024),i}function zf(){var t=Lu!==0;return Lu=0,t}function Uf(t,i,u){i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~u}function Pf(t){if($u){for(t=t.memoizedState;t!==null;){var i=t.queue;i!==null&&(i.pending=null),t=t.next}$u=!1}hs=0,Qr=xr=Dn=null,Qo=!1,Ol=Lu=0,Xo=null}function Oi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qr===null?Dn.memoizedState=Qr=t:Qr=Qr.next=t,Qr}function Yr(){if(xr===null){var t=Dn.alternate;t=t!==null?t.memoizedState:null}else t=xr.next;var i=Qr===null?Dn.memoizedState:Qr.next;if(i!==null)Qr=i,xr=t;else{if(t===null)throw Dn.alternate===null?Error(o(467)):Error(o(310));xr=t,t={memoizedState:xr.memoizedState,baseState:xr.baseState,baseQueue:xr.baseQueue,queue:xr.queue,next:null},Qr===null?Dn.memoizedState=Qr=t:Qr=Qr.next=t}return Qr}function zu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dl(t){var i=Ol;return Ol+=1,Xo===null&&(Xo=[]),t=R1(Xo,t,i),i=Dn,(Qr===null?i.memoizedState:Qr.next)===null&&(i=i.alternate,xe.H=i===null||i.memoizedState===null?bp:Zf),t}function Uu(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Dl(t);if(t.$$typeof===te)return wi(t)}throw Error(o(438,String(t)))}function Ff(t){var i=null,u=Dn.updateQueue;if(u!==null&&(i=u.memoCache),i==null){var p=Dn.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(i={data:p.data.map(function(C){return C.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),u===null&&(u=zu(),Dn.updateQueue=u),u.memoCache=i,u=i.data[i.index],u===void 0)for(u=i.data[i.index]=Array(t),p=0;p<t;p++)u[p]=Qe;return i.index++,u}function ps(t,i){return typeof i=="function"?i(t):i}function Pu(t){var i=Yr();return Gf(i,xr,t)}function Gf(t,i,u){var p=t.queue;if(p===null)throw Error(o(311));p.lastRenderedReducer=u;var C=t.baseQueue,T=p.pending;if(T!==null){if(C!==null){var U=C.next;C.next=T.next,T.next=U}i.baseQueue=C=T,p.pending=null}if(T=t.baseState,C===null)t.memoizedState=T;else{i=C.next;var J=U=null,me=null,$e=i,Ze=!1;do{var it=$e.lane&-536870913;if(it!==$e.lane?(Hn&it)===it:(hs&it)===it){var ze=$e.revertLane;if(ze===0)me!==null&&(me=me.next={lane:0,revertLane:0,gesture:null,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),it===jo&&(Ze=!0);else if((hs&ze)===ze){$e=$e.next,ze===jo&&(Ze=!0);continue}else it={lane:0,revertLane:$e.revertLane,gesture:null,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},me===null?(J=me=it,U=T):me=me.next=it,Dn.lanes|=ze,Hs|=ze;it=$e.action,bo&&u(T,it),T=$e.hasEagerState?$e.eagerState:u(T,it)}else ze={lane:it,revertLane:$e.revertLane,gesture:$e.gesture,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},me===null?(J=me=ze,U=T):me=me.next=ze,Dn.lanes|=it,Hs|=it;$e=$e.next}while($e!==null&&$e!==i);if(me===null?U=T:me.next=J,!g(T,t.memoizedState)&&(Xr=!0,Ze&&(u=Ho,u!==null)))throw u;t.memoizedState=T,t.baseState=U,t.baseQueue=me,p.lastRenderedState=T}return C===null&&(p.lanes=0),[t.memoizedState,p.dispatch]}function Vf(t){var i=Yr(),u=i.queue;if(u===null)throw Error(o(311));u.lastRenderedReducer=t;var p=u.dispatch,C=u.pending,T=i.memoizedState;if(C!==null){u.pending=null;var U=C=C.next;do T=t(T,U.action),U=U.next;while(U!==C);g(T,i.memoizedState)||(Xr=!0),i.memoizedState=T,i.baseQueue===null&&(i.baseState=T),u.lastRenderedState=T}return[T,p]}function P1(t,i,u){var p=Dn,C=Yr(),T=Xn;if(T){if(u===void 0)throw Error(o(407));u=u()}else u=i();var U=!g((xr||C).memoizedState,u);if(U&&(C.memoizedState=u,Xr=!0),C=C.queue,Hf(V1.bind(null,p,C,t),[t]),C.getSnapshot!==i||U||Qr!==null&&Qr.memoizedState.tag&1){if(p.flags|=2048,Zo(9,{destroy:void 0},G1.bind(null,p,C,u,i),null),_r===null)throw Error(o(349));T||(hs&127)!==0||F1(p,i,u)}return u}function F1(t,i,u){t.flags|=16384,t={getSnapshot:i,value:u},i=Dn.updateQueue,i===null?(i=zu(),Dn.updateQueue=i,i.stores=[t]):(u=i.stores,u===null?i.stores=[t]:u.push(t))}function G1(t,i,u,p){i.value=u,i.getSnapshot=p,q1(i)&&j1(t)}function V1(t,i,u){return u(function(){q1(i)&&j1(t)})}function q1(t){var i=t.getSnapshot;t=t.value;try{var u=i();return!g(t,u)}catch{return!0}}function j1(t){var i=Lr(t,2);i!==null&&qi(i,t,2)}function qf(t){var i=Oi();if(typeof t=="function"){var u=t;if(t=u(),bo){xn(!0);try{u()}finally{xn(!1)}}}return i.memoizedState=i.baseState=t,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:t},i}function H1(t,i,u,p){return t.baseState=u,Gf(t,xr,typeof p=="function"?p:ps)}function DC(t,i,u,p,C){if(Vu(t))throw Error(o(485));if(t=i.action,t!==null){var T={payload:C,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){T.listeners.push(U)}};xe.T!==null?u(!0):T.isTransition=!1,p(T),u=i.pending,u===null?(T.next=i.pending=T,Y1(i,T)):(T.next=u.next,i.pending=u.next=T)}}function Y1(t,i){var u=i.action,p=i.payload,C=t.state;if(i.isTransition){var T=xe.T,U={};xe.T=U;try{var J=u(C,p),me=xe.S;me!==null&&me(U,J),W1(t,i,J)}catch($e){jf(t,i,$e)}finally{T!==null&&U.types!==null&&(T.types=U.types),xe.T=T}}else try{T=u(C,p),W1(t,i,T)}catch($e){jf(t,i,$e)}}function W1(t,i,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){K1(t,i,p)},function(p){return jf(t,i,p)}):K1(t,i,u)}function K1(t,i,u){i.status="fulfilled",i.value=u,Q1(i),t.state=u,i=t.pending,i!==null&&(u=i.next,u===i?t.pending=null:(u=u.next,i.next=u,Y1(t,u)))}function jf(t,i,u){var p=t.pending;if(t.pending=null,p!==null){p=p.next;do i.status="rejected",i.reason=u,Q1(i),i=i.next;while(i!==p)}t.action=null}function Q1(t){t=t.listeners;for(var i=0;i<t.length;i++)(0,t[i])()}function X1(t,i){return i}function Z1(t,i){if(Xn){var u=_r.formState;if(u!==null){e:{var p=Dn;if(Xn){if(Ir){t:{for(var C=Ir,T=wa;C.nodeType!==8;){if(!T){C=null;break t}if(C=va(C.nextSibling),C===null){C=null;break t}}T=C.data,C=T==="F!"||T==="F"?C:null}if(C){Ir=va(C.nextSibling),p=C.data==="F!";break e}}Ls(p)}p=!1}p&&(i=u[0])}}return u=Oi(),u.memoizedState=u.baseState=i,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:X1,lastRenderedState:i},u.queue=p,u=xp.bind(null,Dn,p),p.dispatch=u,p=qf(!1),T=Xf.bind(null,Dn,!1,p.queue),p=Oi(),C={state:i,dispatch:null,action:t,pending:null},p.queue=C,u=DC.bind(null,Dn,C,T,u),C.dispatch=u,p.memoizedState=t,[i,u,!1]}function J1(t){var i=Yr();return ep(i,xr,t)}function ep(t,i,u){if(i=Gf(t,i,X1)[0],t=Pu(ps)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var p=Dl(i)}catch(U){throw U===Yo?Ou:U}else p=i;i=Yr();var C=i.queue,T=C.dispatch;return u!==i.memoizedState&&(Dn.flags|=2048,Zo(9,{destroy:void 0},MC.bind(null,C,u),null)),[p,T,t]}function MC(t,i){t.action=i}function tp(t){var i=Yr(),u=xr;if(u!==null)return ep(i,u,t);Yr(),i=i.memoizedState,u=Yr();var p=u.queue.dispatch;return u.memoizedState=t,[i,p,!1]}function Zo(t,i,u,p){return t={tag:t,create:u,deps:p,inst:i,next:null},i=Dn.updateQueue,i===null&&(i=zu(),Dn.updateQueue=i),u=i.lastEffect,u===null?i.lastEffect=t.next=t:(p=u.next,u.next=t,t.next=p,i.lastEffect=t),t}function np(){return Yr().memoizedState}function Fu(t,i,u,p){var C=Oi();Dn.flags|=t,C.memoizedState=Zo(1|i,{destroy:void 0},u,p===void 0?null:p)}function Gu(t,i,u,p){var C=Yr();p=p===void 0?null:p;var T=C.memoizedState.inst;xr!==null&&p!==null&&$f(p,xr.memoizedState.deps)?C.memoizedState=Zo(i,T,u,p):(Dn.flags|=t,C.memoizedState=Zo(1|i,T,u,p))}function rp(t,i){Fu(8390656,8,t,i)}function Hf(t,i){Gu(2048,8,t,i)}function BC(t){Dn.flags|=4;var i=Dn.updateQueue;if(i===null)i=zu(),Dn.updateQueue=i,i.events=[t];else{var u=i.events;u===null?i.events=[t]:u.push(t)}}function ip(t){var i=Yr().memoizedState;return BC({ref:i,nextImpl:t}),function(){if((lr&2)!==0)throw Error(o(440));return i.impl.apply(void 0,arguments)}}function ap(t,i){return Gu(4,2,t,i)}function sp(t,i){return Gu(4,4,t,i)}function op(t,i){if(typeof i=="function"){t=t();var u=i(t);return function(){typeof u=="function"?u():i(null)}}if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function lp(t,i,u){u=u!=null?u.concat([t]):null,Gu(4,4,op.bind(null,i,t),u)}function Yf(){}function up(t,i){var u=Yr();i=i===void 0?null:i;var p=u.memoizedState;return i!==null&&$f(i,p[1])?p[0]:(u.memoizedState=[t,i],t)}function cp(t,i){var u=Yr();i=i===void 0?null:i;var p=u.memoizedState;if(i!==null&&$f(i,p[1]))return p[0];if(p=t(),bo){xn(!0);try{t()}finally{xn(!1)}}return u.memoizedState=[p,i],p}function Wf(t,i,u){return u===void 0||(hs&1073741824)!==0&&(Hn&261930)===0?t.memoizedState=i:(t.memoizedState=u,t=fg(),Dn.lanes|=t,Hs|=t,u)}function fp(t,i,u,p){return g(u,i)?u:Ko.current!==null?(t=Wf(t,u,p),g(t,i)||(Xr=!0),t):(hs&42)===0||(hs&1073741824)!==0&&(Hn&261930)===0?(Xr=!0,t.memoizedState=u):(t=fg(),Dn.lanes|=t,Hs|=t,i)}function dp(t,i,u,p,C){var T=_e.p;_e.p=T!==0&&8>T?T:8;var U=xe.T,J={};xe.T=J,Xf(t,!1,i,u);try{var me=C(),$e=xe.S;if($e!==null&&$e(J,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var Ze=IC(me,p);Ml(t,i,Ze,ia(t))}else Ml(t,i,p,ia(t))}catch(it){Ml(t,i,{then:function(){},status:"rejected",reason:it},ia())}finally{_e.p=T,U!==null&&J.types!==null&&(U.types=J.types),xe.T=U}}function NC(){}function Kf(t,i,u,p){if(t.tag!==5)throw Error(o(476));var C=hp(t).queue;dp(t,C,i,Ge,u===null?NC:function(){return pp(t),u(p)})}function hp(t){var i=t.memoizedState;if(i!==null)return i;i={memoizedState:Ge,baseState:Ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:Ge},next:null};var u={};return i.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:u},next:null},t.memoizedState=i,t=t.alternate,t!==null&&(t.memoizedState=i),i}function pp(t){var i=hp(t);i.next===null&&(i=t.alternate.memoizedState),Ml(t,i.next.queue,{},ia())}function Qf(){return wi(Kl)}function gp(){return Yr().memoizedState}function mp(){return Yr().memoizedState}function kC(t){for(var i=t.return;i!==null;){switch(i.tag){case 24:case 3:var u=ia();t=Ps(u);var p=Fs(i,t,u);p!==null&&(qi(p,i,u),Sl(p,i,u)),i={cache:Ef()},t.payload=i;return}i=i.return}}function $C(t,i,u){var p=ia();u={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Vu(t)?yp(i,u):(u=Ji(t,i,u,p),u!==null&&(qi(u,t,p),wp(u,i,p)))}function xp(t,i,u){var p=ia();Ml(t,i,u,p)}function Ml(t,i,u,p){var C={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Vu(t))yp(i,C);else{var T=t.alternate;if(t.lanes===0&&(T===null||T.lanes===0)&&(T=i.lastRenderedReducer,T!==null))try{var U=i.lastRenderedState,J=T(U,u);if(C.hasEagerState=!0,C.eagerState=J,g(J,U))return Qn(t,i,C,0),_r===null&&jn(),!1}catch{}if(u=Ji(t,i,C,p),u!==null)return qi(u,t,p),wp(u,i,p),!0}return!1}function Xf(t,i,u,p){if(p={lane:2,revertLane:Rd(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Vu(t)){if(i)throw Error(o(479))}else i=Ji(t,u,p,2),i!==null&&qi(i,t,2)}function Vu(t){var i=t.alternate;return t===Dn||i!==null&&i===Dn}function yp(t,i){Qo=$u=!0;var u=t.pending;u===null?i.next=i:(i.next=u.next,u.next=i),t.pending=i}function wp(t,i,u){if((u&4194048)!==0){var p=i.lanes;p&=t.pendingLanes,u|=p,i.lanes=u,Pr(t,u)}}var Bl={readContext:wi,use:Uu,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useLayoutEffect:Fr,useInsertionEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useSyncExternalStore:Fr,useId:Fr,useHostTransitionStatus:Fr,useFormState:Fr,useActionState:Fr,useOptimistic:Fr,useMemoCache:Fr,useCacheRefresh:Fr};Bl.useEffectEvent=Fr;var bp={readContext:wi,use:Uu,useCallback:function(t,i){return Oi().memoizedState=[t,i===void 0?null:i],t},useContext:wi,useEffect:rp,useImperativeHandle:function(t,i,u){u=u!=null?u.concat([t]):null,Fu(4194308,4,op.bind(null,i,t),u)},useLayoutEffect:function(t,i){return Fu(4194308,4,t,i)},useInsertionEffect:function(t,i){Fu(4,2,t,i)},useMemo:function(t,i){var u=Oi();i=i===void 0?null:i;var p=t();if(bo){xn(!0);try{t()}finally{xn(!1)}}return u.memoizedState=[p,i],p},useReducer:function(t,i,u){var p=Oi();if(u!==void 0){var C=u(i);if(bo){xn(!0);try{u(i)}finally{xn(!1)}}}else C=i;return p.memoizedState=p.baseState=C,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:C},p.queue=t,t=t.dispatch=$C.bind(null,Dn,t),[p.memoizedState,t]},useRef:function(t){var i=Oi();return t={current:t},i.memoizedState=t},useState:function(t){t=qf(t);var i=t.queue,u=xp.bind(null,Dn,i);return i.dispatch=u,[t.memoizedState,u]},useDebugValue:Yf,useDeferredValue:function(t,i){var u=Oi();return Wf(u,t,i)},useTransition:function(){var t=qf(!1);return t=dp.bind(null,Dn,t.queue,!0,!1),Oi().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,i,u){var p=Dn,C=Oi();if(Xn){if(u===void 0)throw Error(o(407));u=u()}else{if(u=i(),_r===null)throw Error(o(349));(Hn&127)!==0||F1(p,i,u)}C.memoizedState=u;var T={value:u,getSnapshot:i};return C.queue=T,rp(V1.bind(null,p,T,t),[t]),p.flags|=2048,Zo(9,{destroy:void 0},G1.bind(null,p,T,u,i),null),u},useId:function(){var t=Oi(),i=_r.identifierPrefix;if(Xn){var u=es,p=Ja;u=(p&~(1<<32-Xt(p)-1)).toString(32)+u,i="_"+i+"R_"+u,u=Lu++,0<u&&(i+="H"+u.toString(32)),i+="_"}else u=RC++,i="_"+i+"r_"+u.toString(32)+"_";return t.memoizedState=i},useHostTransitionStatus:Qf,useFormState:Z1,useActionState:Z1,useOptimistic:function(t){var i=Oi();i.memoizedState=i.baseState=t;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=u,i=Xf.bind(null,Dn,!0,u),u.dispatch=i,[t,i]},useMemoCache:Ff,useCacheRefresh:function(){return Oi().memoizedState=kC.bind(null,Dn)},useEffectEvent:function(t){var i=Oi(),u={impl:t};return i.memoizedState=u,function(){if((lr&2)!==0)throw Error(o(440));return u.impl.apply(void 0,arguments)}}},Zf={readContext:wi,use:Uu,useCallback:up,useContext:wi,useEffect:Hf,useImperativeHandle:lp,useInsertionEffect:ap,useLayoutEffect:sp,useMemo:cp,useReducer:Pu,useRef:np,useState:function(){return Pu(ps)},useDebugValue:Yf,useDeferredValue:function(t,i){var u=Yr();return fp(u,xr.memoizedState,t,i)},useTransition:function(){var t=Pu(ps)[0],i=Yr().memoizedState;return[typeof t=="boolean"?t:Dl(t),i]},useSyncExternalStore:P1,useId:gp,useHostTransitionStatus:Qf,useFormState:J1,useActionState:J1,useOptimistic:function(t,i){var u=Yr();return H1(u,xr,t,i)},useMemoCache:Ff,useCacheRefresh:mp};Zf.useEffectEvent=ip;var vp={readContext:wi,use:Uu,useCallback:up,useContext:wi,useEffect:Hf,useImperativeHandle:lp,useInsertionEffect:ap,useLayoutEffect:sp,useMemo:cp,useReducer:Vf,useRef:np,useState:function(){return Vf(ps)},useDebugValue:Yf,useDeferredValue:function(t,i){var u=Yr();return xr===null?Wf(u,t,i):fp(u,xr.memoizedState,t,i)},useTransition:function(){var t=Vf(ps)[0],i=Yr().memoizedState;return[typeof t=="boolean"?t:Dl(t),i]},useSyncExternalStore:P1,useId:gp,useHostTransitionStatus:Qf,useFormState:tp,useActionState:tp,useOptimistic:function(t,i){var u=Yr();return xr!==null?H1(u,xr,t,i):(u.baseState=t,[t,u.queue.dispatch])},useMemoCache:Ff,useCacheRefresh:mp};vp.useEffectEvent=ip;function Jf(t,i,u,p){i=t.memoizedState,u=u(p,i),u=u==null?i:R({},i,u),t.memoizedState=u,t.lanes===0&&(t.updateQueue.baseState=u)}var ed={enqueueSetState:function(t,i,u){t=t._reactInternals;var p=ia(),C=Ps(p);C.payload=i,u!=null&&(C.callback=u),i=Fs(t,C,p),i!==null&&(qi(i,t,p),Sl(i,t,p))},enqueueReplaceState:function(t,i,u){t=t._reactInternals;var p=ia(),C=Ps(p);C.tag=1,C.payload=i,u!=null&&(C.callback=u),i=Fs(t,C,p),i!==null&&(qi(i,t,p),Sl(i,t,p))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var u=ia(),p=Ps(u);p.tag=2,i!=null&&(p.callback=i),i=Fs(t,p,u),i!==null&&(qi(i,t,u),Sl(i,t,u))}};function _p(t,i,u,p,C,T,U){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(p,T,U):i.prototype&&i.prototype.isPureReactComponent?!w(u,p)||!w(C,T):!0}function Cp(t,i,u,p){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,p),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,p),i.state!==t&&ed.enqueueReplaceState(i,i.state,null)}function vo(t,i){var u=i;if("ref"in i){u={};for(var p in i)p!=="ref"&&(u[p]=i[p])}if(t=t.defaultProps){u===i&&(u=R({},u));for(var C in t)u[C]===void 0&&(u[C]=t[C])}return u}function Ap(t){cn(t)}function Ep(t){console.error(t)}function Tp(t){cn(t)}function qu(t,i){try{var u=t.onUncaughtError;u(i.value,{componentStack:i.stack})}catch(p){setTimeout(function(){throw p})}}function Sp(t,i,u){try{var p=t.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function td(t,i,u){return u=Ps(u),u.tag=3,u.payload={element:null},u.callback=function(){qu(t,i)},u}function Ip(t){return t=Ps(t),t.tag=3,t}function Rp(t,i,u,p){var C=u.type.getDerivedStateFromError;if(typeof C=="function"){var T=p.value;t.payload=function(){return C(T)},t.callback=function(){Sp(i,u,p)}}var U=u.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(t.callback=function(){Sp(i,u,p),typeof C!="function"&&(Ys===null?Ys=new Set([this]):Ys.add(this));var J=p.stack;this.componentDidCatch(p.value,{componentStack:J!==null?J:""})})}function LC(t,i,u,p,C){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(i=u.alternate,i!==null&&qo(i,u,C,!0),u=ea.current,u!==null){switch(u.tag){case 31:case 13:return ba===null?nc():u.alternate===null&&Gr===0&&(Gr=3),u.flags&=-257,u.flags|=65536,u.lanes=C,p===Du?u.flags|=16384:(i=u.updateQueue,i===null?u.updateQueue=new Set([p]):i.add(p),Td(t,p,C)),!1;case 22:return u.flags|=65536,p===Du?u.flags|=16384:(i=u.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=i):(u=i.retryQueue,u===null?i.retryQueue=new Set([p]):u.add(p)),Td(t,p,C)),!1}throw Error(o(435,u.tag))}return Td(t,p,C),nc(),!1}if(Xn)return i=ea.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=C,p!==bf&&(t=Error(o(422),{cause:p}),_l(ma(t,u)))):(p!==bf&&(i=Error(o(423),{cause:p}),_l(ma(i,u))),t=t.current.alternate,t.flags|=65536,C&=-C,t.lanes|=C,p=ma(p,u),C=td(t.stateNode,p,C),Df(t,C),Gr!==4&&(Gr=2)),!1;var T=Error(o(520),{cause:p});if(T=ma(T,u),Fl===null?Fl=[T]:Fl.push(T),Gr!==4&&(Gr=2),i===null)return!0;p=ma(p,u),u=i;do{switch(u.tag){case 3:return u.flags|=65536,t=C&-C,u.lanes|=t,t=td(u.stateNode,p,t),Df(u,t),!1;case 1:if(i=u.type,T=u.stateNode,(u.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ys===null||!Ys.has(T))))return u.flags|=65536,C&=-C,u.lanes|=C,C=Ip(C),Rp(C,t,u,p),Df(u,C),!1}u=u.return}while(u!==null);return!1}var nd=Error(o(461)),Xr=!1;function bi(t,i,u,p){i.child=t===null?B1(i,null,u,p):wo(i,t.child,u,p)}function Op(t,i,u,p,C){u=u.render;var T=i.ref;if("ref"in p){var U={};for(var J in p)J!=="ref"&&(U[J]=p[J])}else U=p;return go(i),p=Lf(t,i,u,U,T,C),J=zf(),t!==null&&!Xr?(Uf(t,i,C),gs(t,i,C)):(Xn&&J&&yf(i),i.flags|=1,bi(t,i,p,C),i.child)}function Dp(t,i,u,p,C){if(t===null){var T=u.type;return typeof T=="function"&&!Po(T)&&T.defaultProps===void 0&&u.compare===null?(i.tag=15,i.type=T,Mp(t,i,T,p,C)):(t=co(u.type,null,p,i,i.mode,C),t.ref=i.ref,t.return=i,i.child=t)}if(T=t.child,!cd(t,C)){var U=T.memoizedProps;if(u=u.compare,u=u!==null?u:w,u(U,p)&&t.ref===i.ref)return gs(t,i,C)}return i.flags|=1,t=Ui(T,p),t.ref=i.ref,t.return=i,i.child=t}function Mp(t,i,u,p,C){if(t!==null){var T=t.memoizedProps;if(w(T,p)&&t.ref===i.ref)if(Xr=!1,i.pendingProps=p=T,cd(t,C))(t.flags&131072)!==0&&(Xr=!0);else return i.lanes=t.lanes,gs(t,i,C)}return rd(t,i,u,p,C)}function Bp(t,i,u,p){var C=p.children,T=t!==null?t.memoizedState:null;if(t===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((i.flags&128)!==0){if(T=T!==null?T.baseLanes|u:u,t!==null){for(p=i.child=t.child,C=0;p!==null;)C=C|p.lanes|p.childLanes,p=p.sibling;p=C&~T}else p=0,i.child=null;return Np(t,i,T,u,p)}if((u&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},t!==null&&Ru(i,T!==null?T.cachePool:null),T!==null?$1(i,T):Bf(),L1(i);else return p=i.lanes=536870912,Np(t,i,T!==null?T.baseLanes|u:u,u,p)}else T!==null?(Ru(i,T.cachePool),$1(i,T),Vs(),i.memoizedState=null):(t!==null&&Ru(i,null),Bf(),Vs());return bi(t,i,C,u),i.child}function Nl(t,i){return t!==null&&t.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Np(t,i,u,p,C){var T=Sf();return T=T===null?null:{parent:Kr._currentValue,pool:T},i.memoizedState={baseLanes:u,cachePool:T},t!==null&&Ru(i,null),Bf(),L1(i),t!==null&&qo(t,i,p,!0),i.childLanes=C,null}function ju(t,i){return i=Yu({mode:i.mode,children:i.children},t.mode),i.ref=t.ref,t.child=i,i.return=t,i}function kp(t,i,u){return wo(i,t.child,null,u),t=ju(i,i.pendingProps),t.flags|=2,ta(i),i.memoizedState=null,t}function zC(t,i,u){var p=i.pendingProps,C=(i.flags&128)!==0;if(i.flags&=-129,t===null){if(Xn){if(p.mode==="hidden")return t=ju(i,p),i.lanes=536870912,Nl(null,t);if(kf(i),(t=Ir)?(t=Yg(t,wa),t=t!==null&&t.data==="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:ks!==null?{id:Ja,overflow:es}:null,retryLane:536870912,hydrationErrors:null},u=y1(t),u.return=i,i.child=u,yi=i,Ir=null)):t=null,t===null)throw Ls(i);return i.lanes=536870912,null}return ju(i,p)}var T=t.memoizedState;if(T!==null){var U=T.dehydrated;if(kf(i),C)if(i.flags&256)i.flags&=-257,i=kp(t,i,u);else if(i.memoizedState!==null)i.child=t.child,i.flags|=128,i=null;else throw Error(o(558));else if(Xr||qo(t,i,u,!1),C=(u&t.childLanes)!==0,Xr||C){if(p=_r,p!==null&&(U=P(p,u),U!==0&&U!==T.retryLane))throw T.retryLane=U,Lr(t,U),qi(p,t,U),nd;nc(),i=kp(t,i,u)}else t=T.treeContext,Ir=va(U.nextSibling),yi=i,Xn=!0,$s=null,wa=!1,t!==null&&v1(i,t),i=ju(i,p),i.flags|=4096;return i}return t=Ui(t.child,{mode:p.mode,children:p.children}),t.ref=i.ref,i.child=t,t.return=i,t}function Hu(t,i){var u=i.ref;if(u===null)t!==null&&t.ref!==null&&(i.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(o(284));(t===null||t.ref!==u)&&(i.flags|=4194816)}}function rd(t,i,u,p,C){return go(i),u=Lf(t,i,u,p,void 0,C),p=zf(),t!==null&&!Xr?(Uf(t,i,C),gs(t,i,C)):(Xn&&p&&yf(i),i.flags|=1,bi(t,i,u,C),i.child)}function $p(t,i,u,p,C,T){return go(i),i.updateQueue=null,u=U1(i,p,u,C),z1(t),p=zf(),t!==null&&!Xr?(Uf(t,i,T),gs(t,i,T)):(Xn&&p&&yf(i),i.flags|=1,bi(t,i,u,T),i.child)}function Lp(t,i,u,p,C){if(go(i),i.stateNode===null){var T=Ns,U=u.contextType;typeof U=="object"&&U!==null&&(T=wi(U)),T=new u(p,T),i.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=ed,i.stateNode=T,T._reactInternals=i,T=i.stateNode,T.props=p,T.state=i.memoizedState,T.refs={},Rf(i),U=u.contextType,T.context=typeof U=="object"&&U!==null?wi(U):Ns,T.state=i.memoizedState,U=u.getDerivedStateFromProps,typeof U=="function"&&(Jf(i,u,U,p),T.state=i.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(U=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),U!==T.state&&ed.enqueueReplaceState(T,T.state,null),Rl(i,p,T,C),Il(),T.state=i.memoizedState),typeof T.componentDidMount=="function"&&(i.flags|=4194308),p=!0}else if(t===null){T=i.stateNode;var J=i.memoizedProps,me=vo(u,J);T.props=me;var $e=T.context,Ze=u.contextType;U=Ns,typeof Ze=="object"&&Ze!==null&&(U=wi(Ze));var it=u.getDerivedStateFromProps;Ze=typeof it=="function"||typeof T.getSnapshotBeforeUpdate=="function",J=i.pendingProps!==J,Ze||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(J||$e!==U)&&Cp(i,T,p,U),Us=!1;var ze=i.memoizedState;T.state=ze,Rl(i,p,T,C),Il(),$e=i.memoizedState,J||ze!==$e||Us?(typeof it=="function"&&(Jf(i,u,it,p),$e=i.memoizedState),(me=Us||_p(i,u,me,p,ze,$e,U))?(Ze||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(i.flags|=4194308)):(typeof T.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=p,i.memoizedState=$e),T.props=p,T.state=$e,T.context=U,p=me):(typeof T.componentDidMount=="function"&&(i.flags|=4194308),p=!1)}else{T=i.stateNode,Of(t,i),U=i.memoizedProps,Ze=vo(u,U),T.props=Ze,it=i.pendingProps,ze=T.context,$e=u.contextType,me=Ns,typeof $e=="object"&&$e!==null&&(me=wi($e)),J=u.getDerivedStateFromProps,($e=typeof J=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(U!==it||ze!==me)&&Cp(i,T,p,me),Us=!1,ze=i.memoizedState,T.state=ze,Rl(i,p,T,C),Il();var Ye=i.memoizedState;U!==it||ze!==Ye||Us||t!==null&&t.dependencies!==null&&Su(t.dependencies)?(typeof J=="function"&&(Jf(i,u,J,p),Ye=i.memoizedState),(Ze=Us||_p(i,u,Ze,p,ze,Ye,me)||t!==null&&t.dependencies!==null&&Su(t.dependencies))?($e||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(p,Ye,me),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(p,Ye,me)),typeof T.componentDidUpdate=="function"&&(i.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof T.componentDidUpdate!="function"||U===t.memoizedProps&&ze===t.memoizedState||(i.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||U===t.memoizedProps&&ze===t.memoizedState||(i.flags|=1024),i.memoizedProps=p,i.memoizedState=Ye),T.props=p,T.state=Ye,T.context=me,p=Ze):(typeof T.componentDidUpdate!="function"||U===t.memoizedProps&&ze===t.memoizedState||(i.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||U===t.memoizedProps&&ze===t.memoizedState||(i.flags|=1024),p=!1)}return T=p,Hu(t,i),p=(i.flags&128)!==0,T||p?(T=i.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:T.render(),i.flags|=1,t!==null&&p?(i.child=wo(i,t.child,null,C),i.child=wo(i,null,u,C)):bi(t,i,u,C),i.memoizedState=T.state,t=i.child):t=gs(t,i,C),t}function zp(t,i,u,p){return ho(),i.flags|=256,bi(t,i,u,p),i.child}var id={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ad(t){return{baseLanes:t,cachePool:S1()}}function sd(t,i,u){return t=t!==null?t.childLanes&~u:0,i&&(t|=ra),t}function Up(t,i,u){var p=i.pendingProps,C=!1,T=(i.flags&128)!==0,U;if((U=T)||(U=t!==null&&t.memoizedState===null?!1:(Hr.current&2)!==0),U&&(C=!0,i.flags&=-129),U=(i.flags&32)!==0,i.flags&=-33,t===null){if(Xn){if(C?Gs(i):Vs(),(t=Ir)?(t=Yg(t,wa),t=t!==null&&t.data!=="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:ks!==null?{id:Ja,overflow:es}:null,retryLane:536870912,hydrationErrors:null},u=y1(t),u.return=i,i.child=u,yi=i,Ir=null)):t=null,t===null)throw Ls(i);return Gd(t)?i.lanes=32:i.lanes=536870912,null}var J=p.children;return p=p.fallback,C?(Vs(),C=i.mode,J=Yu({mode:"hidden",children:J},C),p=fo(p,C,u,null),J.return=i,p.return=i,J.sibling=p,i.child=J,p=i.child,p.memoizedState=ad(u),p.childLanes=sd(t,U,u),i.memoizedState=id,Nl(null,p)):(Gs(i),od(i,J))}var me=t.memoizedState;if(me!==null&&(J=me.dehydrated,J!==null)){if(T)i.flags&256?(Gs(i),i.flags&=-257,i=ld(t,i,u)):i.memoizedState!==null?(Vs(),i.child=t.child,i.flags|=128,i=null):(Vs(),J=p.fallback,C=i.mode,p=Yu({mode:"visible",children:p.children},C),J=fo(J,C,u,null),J.flags|=2,p.return=i,J.return=i,p.sibling=J,i.child=p,wo(i,t.child,null,u),p=i.child,p.memoizedState=ad(u),p.childLanes=sd(t,U,u),i.memoizedState=id,i=Nl(null,p));else if(Gs(i),Gd(J)){if(U=J.nextSibling&&J.nextSibling.dataset,U)var $e=U.dgst;U=$e,p=Error(o(419)),p.stack="",p.digest=U,_l({value:p,source:null,stack:null}),i=ld(t,i,u)}else if(Xr||qo(t,i,u,!1),U=(u&t.childLanes)!==0,Xr||U){if(U=_r,U!==null&&(p=P(U,u),p!==0&&p!==me.retryLane))throw me.retryLane=p,Lr(t,p),qi(U,t,p),nd;Fd(J)||nc(),i=ld(t,i,u)}else Fd(J)?(i.flags|=192,i.child=t.child,i=null):(t=me.treeContext,Ir=va(J.nextSibling),yi=i,Xn=!0,$s=null,wa=!1,t!==null&&v1(i,t),i=od(i,p.children),i.flags|=4096);return i}return C?(Vs(),J=p.fallback,C=i.mode,me=t.child,$e=me.sibling,p=Ui(me,{mode:"hidden",children:p.children}),p.subtreeFlags=me.subtreeFlags&65011712,$e!==null?J=Ui($e,J):(J=fo(J,C,u,null),J.flags|=2),J.return=i,p.return=i,p.sibling=J,i.child=p,Nl(null,p),p=i.child,J=t.child.memoizedState,J===null?J=ad(u):(C=J.cachePool,C!==null?(me=Kr._currentValue,C=C.parent!==me?{parent:me,pool:me}:C):C=S1(),J={baseLanes:J.baseLanes|u,cachePool:C}),p.memoizedState=J,p.childLanes=sd(t,U,u),i.memoizedState=id,Nl(t.child,p)):(Gs(i),u=t.child,t=u.sibling,u=Ui(u,{mode:"visible",children:p.children}),u.return=i,u.sibling=null,t!==null&&(U=i.deletions,U===null?(i.deletions=[t],i.flags|=16):U.push(t)),i.child=u,i.memoizedState=null,u)}function od(t,i){return i=Yu({mode:"visible",children:i},t.mode),i.return=t,t.child=i}function Yu(t,i){return t=Ci(22,t,null,i),t.lanes=0,t}function ld(t,i,u){return wo(i,t.child,null,u),t=od(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function Pp(t,i,u){t.lanes|=i;var p=t.alternate;p!==null&&(p.lanes|=i),Cf(t.return,i,u)}function ud(t,i,u,p,C,T){var U=t.memoizedState;U===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:C,treeForkCount:T}:(U.isBackwards=i,U.rendering=null,U.renderingStartTime=0,U.last=p,U.tail=u,U.tailMode=C,U.treeForkCount=T)}function Fp(t,i,u){var p=i.pendingProps,C=p.revealOrder,T=p.tail;p=p.children;var U=Hr.current,J=(U&2)!==0;if(J?(U=U&1|2,i.flags|=128):U&=1,De(Hr,U),bi(t,i,p,u),p=Xn?vl:0,!J&&t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Pp(t,u,i);else if(t.tag===19)Pp(t,u,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(C){case"forwards":for(u=i.child,C=null;u!==null;)t=u.alternate,t!==null&&ku(t)===null&&(C=u),u=u.sibling;u=C,u===null?(C=i.child,i.child=null):(C=u.sibling,u.sibling=null),ud(i,!1,C,u,T,p);break;case"backwards":case"unstable_legacy-backwards":for(u=null,C=i.child,i.child=null;C!==null;){if(t=C.alternate,t!==null&&ku(t)===null){i.child=C;break}t=C.sibling,C.sibling=u,u=C,C=t}ud(i,!0,u,null,T,p);break;case"together":ud(i,!1,null,null,void 0,p);break;default:i.memoizedState=null}return i.child}function gs(t,i,u){if(t!==null&&(i.dependencies=t.dependencies),Hs|=i.lanes,(u&i.childLanes)===0)if(t!==null){if(qo(t,i,u,!1),(u&i.childLanes)===0)return null}else return null;if(t!==null&&i.child!==t.child)throw Error(o(153));if(i.child!==null){for(t=i.child,u=Ui(t,t.pendingProps),i.child=u,u.return=i;t.sibling!==null;)t=t.sibling,u=u.sibling=Ui(t,t.pendingProps),u.return=i;u.sibling=null}return i.child}function cd(t,i){return(t.lanes&i)!==0?!0:(t=t.dependencies,!!(t!==null&&Su(t)))}function UC(t,i,u){switch(i.tag){case 3:At(i,i.stateNode.containerInfo),zs(i,Kr,t.memoizedState.cache),ho();break;case 27:case 5:Rt(i);break;case 4:At(i,i.stateNode.containerInfo);break;case 10:zs(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,kf(i),null;break;case 13:var p=i.memoizedState;if(p!==null)return p.dehydrated!==null?(Gs(i),i.flags|=128,null):(u&i.child.childLanes)!==0?Up(t,i,u):(Gs(i),t=gs(t,i,u),t!==null?t.sibling:null);Gs(i);break;case 19:var C=(t.flags&128)!==0;if(p=(u&i.childLanes)!==0,p||(qo(t,i,u,!1),p=(u&i.childLanes)!==0),C){if(p)return Fp(t,i,u);i.flags|=128}if(C=i.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),De(Hr,Hr.current),p)break;return null;case 22:return i.lanes=0,Bp(t,i,u,i.pendingProps);case 24:zs(i,Kr,t.memoizedState.cache)}return gs(t,i,u)}function Gp(t,i,u){if(t!==null)if(t.memoizedProps!==i.pendingProps)Xr=!0;else{if(!cd(t,u)&&(i.flags&128)===0)return Xr=!1,UC(t,i,u);Xr=(t.flags&131072)!==0}else Xr=!1,Xn&&(i.flags&1048576)!==0&&b1(i,vl,i.index);switch(i.lanes=0,i.tag){case 16:e:{var p=i.pendingProps;if(t=xo(i.elementType),i.type=t,typeof t=="function")Po(t)?(p=vo(t,p),i.tag=1,i=Lp(null,i,t,p,u)):(i.tag=0,i=rd(null,i,t,p,u));else{if(t!=null){var C=t.$$typeof;if(C===Q){i.tag=11,i=Op(null,i,t,p,u);break e}else if(C===ee){i.tag=14,i=Dp(null,i,t,p,u);break e}}throw i=et(t)||t,Error(o(306,i,""))}}return i;case 0:return rd(t,i,i.type,i.pendingProps,u);case 1:return p=i.type,C=vo(p,i.pendingProps),Lp(t,i,p,C,u);case 3:e:{if(At(i,i.stateNode.containerInfo),t===null)throw Error(o(387));p=i.pendingProps;var T=i.memoizedState;C=T.element,Of(t,i),Rl(i,p,null,u);var U=i.memoizedState;if(p=U.cache,zs(i,Kr,p),p!==T.cache&&Af(i,[Kr],u,!0),Il(),p=U.element,T.isDehydrated)if(T={element:p,isDehydrated:!1,cache:U.cache},i.updateQueue.baseState=T,i.memoizedState=T,i.flags&256){i=zp(t,i,p,u);break e}else if(p!==C){C=ma(Error(o(424)),i),_l(C),i=zp(t,i,p,u);break e}else for(t=i.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,Ir=va(t.firstChild),yi=i,Xn=!0,$s=null,wa=!0,u=B1(i,null,p,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(ho(),p===C){i=gs(t,i,u);break e}bi(t,i,p,u)}i=i.child}return i;case 26:return Hu(t,i),t===null?(u=Jg(i.type,null,i.pendingProps,null))?i.memoizedState=u:Xn||(u=i.type,t=i.pendingProps,p=uc(Me.current).createElement(u),p[Ae]=i,p[Fe]=t,vi(p,u,t),vt(p),i.stateNode=p):i.memoizedState=Jg(i.type,t.memoizedProps,i.pendingProps,t.memoizedState),null;case 27:return Rt(i),t===null&&Xn&&(p=i.stateNode=Qg(i.type,i.pendingProps,Me.current),yi=i,wa=!0,C=Ir,Xs(i.type)?(Vd=C,Ir=va(p.firstChild)):Ir=C),bi(t,i,i.pendingProps.children,u),Hu(t,i),t===null&&(i.flags|=4194304),i.child;case 5:return t===null&&Xn&&((C=p=Ir)&&(p=gA(p,i.type,i.pendingProps,wa),p!==null?(i.stateNode=p,yi=i,Ir=va(p.firstChild),wa=!1,C=!0):C=!1),C||Ls(i)),Rt(i),C=i.type,T=i.pendingProps,U=t!==null?t.memoizedProps:null,p=T.children,zd(C,T)?p=null:U!==null&&zd(C,U)&&(i.flags|=32),i.memoizedState!==null&&(C=Lf(t,i,OC,null,null,u),Kl._currentValue=C),Hu(t,i),bi(t,i,p,u),i.child;case 6:return t===null&&Xn&&((t=u=Ir)&&(u=mA(u,i.pendingProps,wa),u!==null?(i.stateNode=u,yi=i,Ir=null,t=!0):t=!1),t||Ls(i)),null;case 13:return Up(t,i,u);case 4:return At(i,i.stateNode.containerInfo),p=i.pendingProps,t===null?i.child=wo(i,null,p,u):bi(t,i,p,u),i.child;case 11:return Op(t,i,i.type,i.pendingProps,u);case 7:return bi(t,i,i.pendingProps,u),i.child;case 8:return bi(t,i,i.pendingProps.children,u),i.child;case 12:return bi(t,i,i.pendingProps.children,u),i.child;case 10:return p=i.pendingProps,zs(i,i.type,p.value),bi(t,i,p.children,u),i.child;case 9:return C=i.type._context,p=i.pendingProps.children,go(i),C=wi(C),p=p(C),i.flags|=1,bi(t,i,p,u),i.child;case 14:return Dp(t,i,i.type,i.pendingProps,u);case 15:return Mp(t,i,i.type,i.pendingProps,u);case 19:return Fp(t,i,u);case 31:return zC(t,i,u);case 22:return Bp(t,i,u,i.pendingProps);case 24:return go(i),p=wi(Kr),t===null?(C=Sf(),C===null&&(C=_r,T=Ef(),C.pooledCache=T,T.refCount++,T!==null&&(C.pooledCacheLanes|=u),C=T),i.memoizedState={parent:p,cache:C},Rf(i),zs(i,Kr,C)):((t.lanes&u)!==0&&(Of(t,i),Rl(i,null,null,u),Il()),C=t.memoizedState,T=i.memoizedState,C.parent!==p?(C={parent:p,cache:p},i.memoizedState=C,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=C),zs(i,Kr,p)):(p=T.cache,zs(i,Kr,p),p!==C.cache&&Af(i,[Kr],u,!0))),bi(t,i,i.pendingProps.children,u),i.child;case 29:throw i.pendingProps}throw Error(o(156,i.tag))}function ms(t){t.flags|=4}function fd(t,i,u,p,C){if((i=(t.mode&32)!==0)&&(i=!1),i){if(t.flags|=16777216,(C&335544128)===C)if(t.stateNode.complete)t.flags|=8192;else if(gg())t.flags|=8192;else throw yo=Du,If}else t.flags&=-16777217}function Vp(t,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!im(i))if(gg())t.flags|=8192;else throw yo=Du,If}function Wu(t,i){i!==null&&(t.flags|=4),t.flags&16384&&(i=t.tag!==22?dr():536870912,t.lanes|=i,nl|=i)}function kl(t,i){if(!Xn)switch(t.tailMode){case"hidden":i=t.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?t.tail=null:u.sibling=null;break;case"collapsed":u=t.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:p.sibling=null}}function Rr(t){var i=t.alternate!==null&&t.alternate.child===t.child,u=0,p=0;if(i)for(var C=t.child;C!==null;)u|=C.lanes|C.childLanes,p|=C.subtreeFlags&65011712,p|=C.flags&65011712,C.return=t,C=C.sibling;else for(C=t.child;C!==null;)u|=C.lanes|C.childLanes,p|=C.subtreeFlags,p|=C.flags,C.return=t,C=C.sibling;return t.subtreeFlags|=p,t.childLanes=u,i}function PC(t,i,u){var p=i.pendingProps;switch(wf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rr(i),null;case 1:return Rr(i),null;case 3:return u=i.stateNode,p=null,t!==null&&(p=t.memoizedState.cache),i.memoizedState.cache!==p&&(i.flags|=2048),ds(Kr),It(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(t===null||t.child===null)&&(Vo(i)?ms(i):t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,vf())),Rr(i),null;case 26:var C=i.type,T=i.memoizedState;return t===null?(ms(i),T!==null?(Rr(i),Vp(i,T)):(Rr(i),fd(i,C,null,p,u))):T?T!==t.memoizedState?(ms(i),Rr(i),Vp(i,T)):(Rr(i),i.flags&=-16777217):(t=t.memoizedProps,t!==p&&ms(i),Rr(i),fd(i,C,t,p,u)),null;case 27:if(ht(i),u=Me.current,C=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==p&&ms(i);else{if(!p){if(i.stateNode===null)throw Error(o(166));return Rr(i),null}t=Le.current,Vo(i)?_1(i):(t=Qg(C,p,u),i.stateNode=t,ms(i))}return Rr(i),null;case 5:if(ht(i),C=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==p&&ms(i);else{if(!p){if(i.stateNode===null)throw Error(o(166));return Rr(i),null}if(T=Le.current,Vo(i))_1(i);else{var U=uc(Me.current);switch(T){case 1:T=U.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:T=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":T=U.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":T=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":T=U.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof p.is=="string"?U.createElement("select",{is:p.is}):U.createElement("select"),p.multiple?T.multiple=!0:p.size&&(T.size=p.size);break;default:T=typeof p.is=="string"?U.createElement(C,{is:p.is}):U.createElement(C)}}T[Ae]=i,T[Fe]=p;e:for(U=i.child;U!==null;){if(U.tag===5||U.tag===6)T.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===i)break e;for(;U.sibling===null;){if(U.return===null||U.return===i)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}i.stateNode=T;e:switch(vi(T,C,p),C){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&ms(i)}}return Rr(i),fd(i,i.type,t===null?null:t.memoizedProps,i.pendingProps,u),null;case 6:if(t&&i.stateNode!=null)t.memoizedProps!==p&&ms(i);else{if(typeof p!="string"&&i.stateNode===null)throw Error(o(166));if(t=Me.current,Vo(i)){if(t=i.stateNode,u=i.memoizedProps,p=null,C=yi,C!==null)switch(C.tag){case 27:case 5:p=C.memoizedProps}t[Ae]=i,t=!!(t.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||Ug(t.nodeValue,u)),t||Ls(i,!0)}else t=uc(t).createTextNode(p),t[Ae]=i,i.stateNode=t}return Rr(i),null;case 31:if(u=i.memoizedState,t===null||t.memoizedState!==null){if(p=Vo(i),u!==null){if(t===null){if(!p)throw Error(o(318));if(t=i.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(557));t[Ae]=i}else ho(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Rr(i),t=!1}else u=vf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=u),t=!0;if(!t)return i.flags&256?(ta(i),i):(ta(i),null);if((i.flags&128)!==0)throw Error(o(558))}return Rr(i),null;case 13:if(p=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(C=Vo(i),p!==null&&p.dehydrated!==null){if(t===null){if(!C)throw Error(o(318));if(C=i.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(o(317));C[Ae]=i}else ho(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Rr(i),C=!1}else C=vf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=C),C=!0;if(!C)return i.flags&256?(ta(i),i):(ta(i),null)}return ta(i),(i.flags&128)!==0?(i.lanes=u,i):(u=p!==null,t=t!==null&&t.memoizedState!==null,u&&(p=i.child,C=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(C=p.alternate.memoizedState.cachePool.pool),T=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(T=p.memoizedState.cachePool.pool),T!==C&&(p.flags|=2048)),u!==t&&u&&(i.child.flags|=8192),Wu(i,i.updateQueue),Rr(i),null);case 4:return It(),t===null&&Bd(i.stateNode.containerInfo),Rr(i),null;case 10:return ds(i.type),Rr(i),null;case 19:if(fe(Hr),p=i.memoizedState,p===null)return Rr(i),null;if(C=(i.flags&128)!==0,T=p.rendering,T===null)if(C)kl(p,!1);else{if(Gr!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(T=ku(t),T!==null){for(i.flags|=128,kl(p,!1),t=T.updateQueue,i.updateQueue=t,Wu(i,t),i.subtreeFlags=0,t=u,u=i.child;u!==null;)uo(u,t),u=u.sibling;return De(Hr,Hr.current&1|2),Xn&&cs(i,p.treeForkCount),i.child}t=t.sibling}p.tail!==null&&kn()>Ju&&(i.flags|=128,C=!0,kl(p,!1),i.lanes=4194304)}else{if(!C)if(t=ku(T),t!==null){if(i.flags|=128,C=!0,t=t.updateQueue,i.updateQueue=t,Wu(i,t),kl(p,!0),p.tail===null&&p.tailMode==="hidden"&&!T.alternate&&!Xn)return Rr(i),null}else 2*kn()-p.renderingStartTime>Ju&&u!==536870912&&(i.flags|=128,C=!0,kl(p,!1),i.lanes=4194304);p.isBackwards?(T.sibling=i.child,i.child=T):(t=p.last,t!==null?t.sibling=T:i.child=T,p.last=T)}return p.tail!==null?(t=p.tail,p.rendering=t,p.tail=t.sibling,p.renderingStartTime=kn(),t.sibling=null,u=Hr.current,De(Hr,C?u&1|2:u&1),Xn&&cs(i,p.treeForkCount),t):(Rr(i),null);case 22:case 23:return ta(i),Nf(),p=i.memoizedState!==null,t!==null?t.memoizedState!==null!==p&&(i.flags|=8192):p&&(i.flags|=8192),p?(u&536870912)!==0&&(i.flags&128)===0&&(Rr(i),i.subtreeFlags&6&&(i.flags|=8192)):Rr(i),u=i.updateQueue,u!==null&&Wu(i,u.retryQueue),u=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(u=t.memoizedState.cachePool.pool),p=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),p!==u&&(i.flags|=2048),t!==null&&fe(mo),null;case 24:return u=null,t!==null&&(u=t.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),ds(Kr),Rr(i),null;case 25:return null;case 30:return null}throw Error(o(156,i.tag))}function FC(t,i){switch(wf(i),i.tag){case 1:return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return ds(Kr),It(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 26:case 27:case 5:return ht(i),null;case 31:if(i.memoizedState!==null){if(ta(i),i.alternate===null)throw Error(o(340));ho()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 13:if(ta(i),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(o(340));ho()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return fe(Hr),null;case 4:return It(),null;case 10:return ds(i.type),null;case 22:case 23:return ta(i),Nf(),t!==null&&fe(mo),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 24:return ds(Kr),null;case 25:return null;default:return null}}function qp(t,i){switch(wf(i),i.tag){case 3:ds(Kr),It();break;case 26:case 27:case 5:ht(i);break;case 4:It();break;case 31:i.memoizedState!==null&&ta(i);break;case 13:ta(i);break;case 19:fe(Hr);break;case 10:ds(i.type);break;case 22:case 23:ta(i),Nf(),t!==null&&fe(mo);break;case 24:ds(Kr)}}function $l(t,i){try{var u=i.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var C=p.next;u=C;do{if((u.tag&t)===t){p=void 0;var T=u.create,U=u.inst;p=T(),U.destroy=p}u=u.next}while(u!==C)}}catch(J){gr(i,i.return,J)}}function qs(t,i,u){try{var p=i.updateQueue,C=p!==null?p.lastEffect:null;if(C!==null){var T=C.next;p=T;do{if((p.tag&t)===t){var U=p.inst,J=U.destroy;if(J!==void 0){U.destroy=void 0,C=i;var me=u,$e=J;try{$e()}catch(Ze){gr(C,me,Ze)}}}p=p.next}while(p!==T)}}catch(Ze){gr(i,i.return,Ze)}}function jp(t){var i=t.updateQueue;if(i!==null){var u=t.stateNode;try{k1(i,u)}catch(p){gr(t,t.return,p)}}}function Hp(t,i,u){u.props=vo(t.type,t.memoizedProps),u.state=t.memoizedState;try{u.componentWillUnmount()}catch(p){gr(t,i,p)}}function Ll(t,i){try{var u=t.ref;if(u!==null){switch(t.tag){case 26:case 27:case 5:var p=t.stateNode;break;case 30:p=t.stateNode;break;default:p=t.stateNode}typeof u=="function"?t.refCleanup=u(p):u.current=p}}catch(C){gr(t,i,C)}}function ts(t,i){var u=t.ref,p=t.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(C){gr(t,i,C)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(C){gr(t,i,C)}else u.current=null}function Yp(t){var i=t.type,u=t.memoizedProps,p=t.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(C){gr(t,t.return,C)}}function dd(t,i,u){try{var p=t.stateNode;uA(p,t.type,u,i),p[Fe]=i}catch(C){gr(t,t.return,C)}}function Wp(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Xs(t.type)||t.tag===4}function hd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Wp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Xs(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pd(t,i,u){var p=t.tag;if(p===5||p===6)t=t.stateNode,i?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(t,i):(i=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,i.appendChild(t),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=jr));else if(p!==4&&(p===27&&Xs(t.type)&&(u=t.stateNode,i=null),t=t.child,t!==null))for(pd(t,i,u),t=t.sibling;t!==null;)pd(t,i,u),t=t.sibling}function Ku(t,i,u){var p=t.tag;if(p===5||p===6)t=t.stateNode,i?u.insertBefore(t,i):u.appendChild(t);else if(p!==4&&(p===27&&Xs(t.type)&&(u=t.stateNode),t=t.child,t!==null))for(Ku(t,i,u),t=t.sibling;t!==null;)Ku(t,i,u),t=t.sibling}function Kp(t){var i=t.stateNode,u=t.memoizedProps;try{for(var p=t.type,C=i.attributes;C.length;)i.removeAttributeNode(C[0]);vi(i,p,u),i[Ae]=t,i[Fe]=u}catch(T){gr(t,t.return,T)}}var xs=!1,Zr=!1,gd=!1,Qp=typeof WeakSet=="function"?WeakSet:Set,ci=null;function GC(t,i){if(t=t.containerInfo,$d=mc,t=V(t),Y(t)){if("selectionStart"in t)var u={start:t.selectionStart,end:t.selectionEnd};else e:{u=(u=t.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var C=p.anchorOffset,T=p.focusNode;p=p.focusOffset;try{u.nodeType,T.nodeType}catch{u=null;break e}var U=0,J=-1,me=-1,$e=0,Ze=0,it=t,ze=null;t:for(;;){for(var Ye;it!==u||C!==0&&it.nodeType!==3||(J=U+C),it!==T||p!==0&&it.nodeType!==3||(me=U+p),it.nodeType===3&&(U+=it.nodeValue.length),(Ye=it.firstChild)!==null;)ze=it,it=Ye;for(;;){if(it===t)break t;if(ze===u&&++$e===C&&(J=U),ze===T&&++Ze===p&&(me=U),(Ye=it.nextSibling)!==null)break;it=ze,ze=it.parentNode}it=Ye}u=J===-1||me===-1?null:{start:J,end:me}}else u=null}u=u||{start:0,end:0}}else u=null;for(Ld={focusedElem:t,selectionRange:u},mc=!1,ci=i;ci!==null;)if(i=ci,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,ci=t;else for(;ci!==null;){switch(i=ci,T=i.alternate,t=i.flags,i.tag){case 0:if((t&4)!==0&&(t=i.updateQueue,t=t!==null?t.events:null,t!==null))for(u=0;u<t.length;u++)C=t[u],C.ref.impl=C.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&T!==null){t=void 0,u=i,C=T.memoizedProps,T=T.memoizedState,p=u.stateNode;try{var Ht=vo(u.type,C);t=p.getSnapshotBeforeUpdate(Ht,T),p.__reactInternalSnapshotBeforeUpdate=t}catch(wn){gr(u,u.return,wn)}}break;case 3:if((t&1024)!==0){if(t=i.stateNode.containerInfo,u=t.nodeType,u===9)Pd(t);else if(u===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Pd(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(o(163))}if(t=i.sibling,t!==null){t.return=i.return,ci=t;break}ci=i.return}}function Xp(t,i,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:ws(t,u),p&4&&$l(5,u);break;case 1:if(ws(t,u),p&4)if(t=u.stateNode,i===null)try{t.componentDidMount()}catch(U){gr(u,u.return,U)}else{var C=vo(u.type,i.memoizedProps);i=i.memoizedState;try{t.componentDidUpdate(C,i,t.__reactInternalSnapshotBeforeUpdate)}catch(U){gr(u,u.return,U)}}p&64&&jp(u),p&512&&Ll(u,u.return);break;case 3:if(ws(t,u),p&64&&(t=u.updateQueue,t!==null)){if(i=null,u.child!==null)switch(u.child.tag){case 27:case 5:i=u.child.stateNode;break;case 1:i=u.child.stateNode}try{k1(t,i)}catch(U){gr(u,u.return,U)}}break;case 27:i===null&&p&4&&Kp(u);case 26:case 5:ws(t,u),i===null&&p&4&&Yp(u),p&512&&Ll(u,u.return);break;case 12:ws(t,u);break;case 31:ws(t,u),p&4&&eg(t,u);break;case 13:ws(t,u),p&4&&tg(t,u),p&64&&(t=u.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(u=XC.bind(null,u),xA(t,u))));break;case 22:if(p=u.memoizedState!==null||xs,!p){i=i!==null&&i.memoizedState!==null||Zr,C=xs;var T=Zr;xs=p,(Zr=i)&&!T?bs(t,u,(u.subtreeFlags&8772)!==0):ws(t,u),xs=C,Zr=T}break;case 30:break;default:ws(t,u)}}function Zp(t){var i=t.alternate;i!==null&&(t.alternate=null,Zp(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&jt(i)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var kr=null,Pi=!1;function ys(t,i,u){for(u=u.child;u!==null;)Jp(t,i,u),u=u.sibling}function Jp(t,i,u){if(tt&&typeof tt.onCommitFiberUnmount=="function")try{tt.onCommitFiberUnmount(an,u)}catch{}switch(u.tag){case 26:Zr||ts(u,i),ys(t,i,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Zr||ts(u,i);var p=kr,C=Pi;Xs(u.type)&&(kr=u.stateNode,Pi=!1),ys(t,i,u),Hl(u.stateNode),kr=p,Pi=C;break;case 5:Zr||ts(u,i);case 6:if(p=kr,C=Pi,kr=null,ys(t,i,u),kr=p,Pi=C,kr!==null)if(Pi)try{(kr.nodeType===9?kr.body:kr.nodeName==="HTML"?kr.ownerDocument.body:kr).removeChild(u.stateNode)}catch(T){gr(u,i,T)}else try{kr.removeChild(u.stateNode)}catch(T){gr(u,i,T)}break;case 18:kr!==null&&(Pi?(t=kr,jg(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,u.stateNode),cl(t)):jg(kr,u.stateNode));break;case 4:p=kr,C=Pi,kr=u.stateNode.containerInfo,Pi=!0,ys(t,i,u),kr=p,Pi=C;break;case 0:case 11:case 14:case 15:qs(2,u,i),Zr||qs(4,u,i),ys(t,i,u);break;case 1:Zr||(ts(u,i),p=u.stateNode,typeof p.componentWillUnmount=="function"&&Hp(u,i,p)),ys(t,i,u);break;case 21:ys(t,i,u);break;case 22:Zr=(p=Zr)||u.memoizedState!==null,ys(t,i,u),Zr=p;break;default:ys(t,i,u)}}function eg(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{cl(t)}catch(u){gr(i,i.return,u)}}}function tg(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{cl(t)}catch(u){gr(i,i.return,u)}}function VC(t){switch(t.tag){case 31:case 13:case 19:var i=t.stateNode;return i===null&&(i=t.stateNode=new Qp),i;case 22:return t=t.stateNode,i=t._retryCache,i===null&&(i=t._retryCache=new Qp),i;default:throw Error(o(435,t.tag))}}function Qu(t,i){var u=VC(t);i.forEach(function(p){if(!u.has(p)){u.add(p);var C=ZC.bind(null,t,p);p.then(C,C)}})}function Fi(t,i){var u=i.deletions;if(u!==null)for(var p=0;p<u.length;p++){var C=u[p],T=t,U=i,J=U;e:for(;J!==null;){switch(J.tag){case 27:if(Xs(J.type)){kr=J.stateNode,Pi=!1;break e}break;case 5:kr=J.stateNode,Pi=!1;break e;case 3:case 4:kr=J.stateNode.containerInfo,Pi=!0;break e}J=J.return}if(kr===null)throw Error(o(160));Jp(T,U,C),kr=null,Pi=!1,T=C.alternate,T!==null&&(T.return=null),C.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)ng(i,t),i=i.sibling}var Ba=null;function ng(t,i){var u=t.alternate,p=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Fi(i,t),Gi(t),p&4&&(qs(3,t,t.return),$l(3,t),qs(5,t,t.return));break;case 1:Fi(i,t),Gi(t),p&512&&(Zr||u===null||ts(u,u.return)),p&64&&xs&&(t=t.updateQueue,t!==null&&(p=t.callbacks,p!==null&&(u=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var C=Ba;if(Fi(i,t),Gi(t),p&512&&(Zr||u===null||ts(u,u.return)),p&4){var T=u!==null?u.memoizedState:null;if(p=t.memoizedState,u===null)if(p===null)if(t.stateNode===null){e:{p=t.type,u=t.memoizedProps,C=C.ownerDocument||C;t:switch(p){case"title":T=C.getElementsByTagName("title")[0],(!T||T[Gt]||T[Ae]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=C.createElement(p),C.head.insertBefore(T,C.querySelector("head > title"))),vi(T,p,u),T[Ae]=t,vt(T),p=T;break e;case"link":var U=nm("link","href",C).get(p+(u.href||""));if(U){for(var J=0;J<U.length;J++)if(T=U[J],T.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&T.getAttribute("rel")===(u.rel==null?null:u.rel)&&T.getAttribute("title")===(u.title==null?null:u.title)&&T.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){U.splice(J,1);break t}}T=C.createElement(p),vi(T,p,u),C.head.appendChild(T);break;case"meta":if(U=nm("meta","content",C).get(p+(u.content||""))){for(J=0;J<U.length;J++)if(T=U[J],T.getAttribute("content")===(u.content==null?null:""+u.content)&&T.getAttribute("name")===(u.name==null?null:u.name)&&T.getAttribute("property")===(u.property==null?null:u.property)&&T.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&T.getAttribute("charset")===(u.charSet==null?null:u.charSet)){U.splice(J,1);break t}}T=C.createElement(p),vi(T,p,u),C.head.appendChild(T);break;default:throw Error(o(468,p))}T[Ae]=t,vt(T),p=T}t.stateNode=p}else rm(C,t.type,t.stateNode);else t.stateNode=tm(C,p,t.memoizedProps);else T!==p?(T===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):T.count--,p===null?rm(C,t.type,t.stateNode):tm(C,p,t.memoizedProps)):p===null&&t.stateNode!==null&&dd(t,t.memoizedProps,u.memoizedProps)}break;case 27:Fi(i,t),Gi(t),p&512&&(Zr||u===null||ts(u,u.return)),u!==null&&p&4&&dd(t,t.memoizedProps,u.memoizedProps);break;case 5:if(Fi(i,t),Gi(t),p&512&&(Zr||u===null||ts(u,u.return)),t.flags&32){C=t.stateNode;try{Vn(C,"")}catch(Ht){gr(t,t.return,Ht)}}p&4&&t.stateNode!=null&&(C=t.memoizedProps,dd(t,C,u!==null?u.memoizedProps:C)),p&1024&&(gd=!0);break;case 6:if(Fi(i,t),Gi(t),p&4){if(t.stateNode===null)throw Error(o(162));p=t.memoizedProps,u=t.stateNode;try{u.nodeValue=p}catch(Ht){gr(t,t.return,Ht)}}break;case 3:if(dc=null,C=Ba,Ba=cc(i.containerInfo),Fi(i,t),Ba=C,Gi(t),p&4&&u!==null&&u.memoizedState.isDehydrated)try{cl(i.containerInfo)}catch(Ht){gr(t,t.return,Ht)}gd&&(gd=!1,rg(t));break;case 4:p=Ba,Ba=cc(t.stateNode.containerInfo),Fi(i,t),Gi(t),Ba=p;break;case 12:Fi(i,t),Gi(t);break;case 31:Fi(i,t),Gi(t),p&4&&(p=t.updateQueue,p!==null&&(t.updateQueue=null,Qu(t,p)));break;case 13:Fi(i,t),Gi(t),t.child.flags&8192&&t.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Zu=kn()),p&4&&(p=t.updateQueue,p!==null&&(t.updateQueue=null,Qu(t,p)));break;case 22:C=t.memoizedState!==null;var me=u!==null&&u.memoizedState!==null,$e=xs,Ze=Zr;if(xs=$e||C,Zr=Ze||me,Fi(i,t),Zr=Ze,xs=$e,Gi(t),p&8192)e:for(i=t.stateNode,i._visibility=C?i._visibility&-2:i._visibility|1,C&&(u===null||me||xs||Zr||_o(t)),u=null,i=t;;){if(i.tag===5||i.tag===26){if(u===null){me=u=i;try{if(T=me.stateNode,C)U=T.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{J=me.stateNode;var it=me.memoizedProps.style,ze=it!=null&&it.hasOwnProperty("display")?it.display:null;J.style.display=ze==null||typeof ze=="boolean"?"":(""+ze).trim()}}catch(Ht){gr(me,me.return,Ht)}}}else if(i.tag===6){if(u===null){me=i;try{me.stateNode.nodeValue=C?"":me.memoizedProps}catch(Ht){gr(me,me.return,Ht)}}}else if(i.tag===18){if(u===null){me=i;try{var Ye=me.stateNode;C?Hg(Ye,!0):Hg(me.stateNode,!1)}catch(Ht){gr(me,me.return,Ht)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===t)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;i.sibling===null;){if(i.return===null||i.return===t)break e;u===i&&(u=null),i=i.return}u===i&&(u=null),i.sibling.return=i.return,i=i.sibling}p&4&&(p=t.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,Qu(t,u))));break;case 19:Fi(i,t),Gi(t),p&4&&(p=t.updateQueue,p!==null&&(t.updateQueue=null,Qu(t,p)));break;case 30:break;case 21:break;default:Fi(i,t),Gi(t)}}function Gi(t){var i=t.flags;if(i&2){try{for(var u,p=t.return;p!==null;){if(Wp(p)){u=p;break}p=p.return}if(u==null)throw Error(o(160));switch(u.tag){case 27:var C=u.stateNode,T=hd(t);Ku(t,T,C);break;case 5:var U=u.stateNode;u.flags&32&&(Vn(U,""),u.flags&=-33);var J=hd(t);Ku(t,J,U);break;case 3:case 4:var me=u.stateNode.containerInfo,$e=hd(t);pd(t,$e,me);break;default:throw Error(o(161))}}catch(Ze){gr(t,t.return,Ze)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function rg(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var i=t;rg(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),t=t.sibling}}function ws(t,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Xp(t,i.alternate,i),i=i.sibling}function _o(t){for(t=t.child;t!==null;){var i=t;switch(i.tag){case 0:case 11:case 14:case 15:qs(4,i,i.return),_o(i);break;case 1:ts(i,i.return);var u=i.stateNode;typeof u.componentWillUnmount=="function"&&Hp(i,i.return,u),_o(i);break;case 27:Hl(i.stateNode);case 26:case 5:ts(i,i.return),_o(i);break;case 22:i.memoizedState===null&&_o(i);break;case 30:_o(i);break;default:_o(i)}t=t.sibling}}function bs(t,i,u){for(u=u&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var p=i.alternate,C=t,T=i,U=T.flags;switch(T.tag){case 0:case 11:case 15:bs(C,T,u),$l(4,T);break;case 1:if(bs(C,T,u),p=T,C=p.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch($e){gr(p,p.return,$e)}if(p=T,C=p.updateQueue,C!==null){var J=p.stateNode;try{var me=C.shared.hiddenCallbacks;if(me!==null)for(C.shared.hiddenCallbacks=null,C=0;C<me.length;C++)N1(me[C],J)}catch($e){gr(p,p.return,$e)}}u&&U&64&&jp(T),Ll(T,T.return);break;case 27:Kp(T);case 26:case 5:bs(C,T,u),u&&p===null&&U&4&&Yp(T),Ll(T,T.return);break;case 12:bs(C,T,u);break;case 31:bs(C,T,u),u&&U&4&&eg(C,T);break;case 13:bs(C,T,u),u&&U&4&&tg(C,T);break;case 22:T.memoizedState===null&&bs(C,T,u),Ll(T,T.return);break;case 30:break;default:bs(C,T,u)}i=i.sibling}}function md(t,i){var u=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(u=t.memoizedState.cachePool.pool),t=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(t=i.memoizedState.cachePool.pool),t!==u&&(t!=null&&t.refCount++,u!=null&&Cl(u))}function xd(t,i){t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&Cl(t))}function Na(t,i,u,p){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)ig(t,i,u,p),i=i.sibling}function ig(t,i,u,p){var C=i.flags;switch(i.tag){case 0:case 11:case 15:Na(t,i,u,p),C&2048&&$l(9,i);break;case 1:Na(t,i,u,p);break;case 3:Na(t,i,u,p),C&2048&&(t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&Cl(t)));break;case 12:if(C&2048){Na(t,i,u,p),t=i.stateNode;try{var T=i.memoizedProps,U=T.id,J=T.onPostCommit;typeof J=="function"&&J(U,i.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(me){gr(i,i.return,me)}}else Na(t,i,u,p);break;case 31:Na(t,i,u,p);break;case 13:Na(t,i,u,p);break;case 23:break;case 22:T=i.stateNode,U=i.alternate,i.memoizedState!==null?T._visibility&2?Na(t,i,u,p):zl(t,i):T._visibility&2?Na(t,i,u,p):(T._visibility|=2,Jo(t,i,u,p,(i.subtreeFlags&10256)!==0||!1)),C&2048&&md(U,i);break;case 24:Na(t,i,u,p),C&2048&&xd(i.alternate,i);break;default:Na(t,i,u,p)}}function Jo(t,i,u,p,C){for(C=C&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var T=t,U=i,J=u,me=p,$e=U.flags;switch(U.tag){case 0:case 11:case 15:Jo(T,U,J,me,C),$l(8,U);break;case 23:break;case 22:var Ze=U.stateNode;U.memoizedState!==null?Ze._visibility&2?Jo(T,U,J,me,C):zl(T,U):(Ze._visibility|=2,Jo(T,U,J,me,C)),C&&$e&2048&&md(U.alternate,U);break;case 24:Jo(T,U,J,me,C),C&&$e&2048&&xd(U.alternate,U);break;default:Jo(T,U,J,me,C)}i=i.sibling}}function zl(t,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var u=t,p=i,C=p.flags;switch(p.tag){case 22:zl(u,p),C&2048&&md(p.alternate,p);break;case 24:zl(u,p),C&2048&&xd(p.alternate,p);break;default:zl(u,p)}i=i.sibling}}var Ul=8192;function el(t,i,u){if(t.subtreeFlags&Ul)for(t=t.child;t!==null;)ag(t,i,u),t=t.sibling}function ag(t,i,u){switch(t.tag){case 26:el(t,i,u),t.flags&Ul&&t.memoizedState!==null&&RA(u,Ba,t.memoizedState,t.memoizedProps);break;case 5:el(t,i,u);break;case 3:case 4:var p=Ba;Ba=cc(t.stateNode.containerInfo),el(t,i,u),Ba=p;break;case 22:t.memoizedState===null&&(p=t.alternate,p!==null&&p.memoizedState!==null?(p=Ul,Ul=16777216,el(t,i,u),Ul=p):el(t,i,u));break;default:el(t,i,u)}}function sg(t){var i=t.alternate;if(i!==null&&(t=i.child,t!==null)){i.child=null;do i=t.sibling,t.sibling=null,t=i;while(t!==null)}}function Pl(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var p=i[u];ci=p,lg(p,t)}sg(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)og(t),t=t.sibling}function og(t){switch(t.tag){case 0:case 11:case 15:Pl(t),t.flags&2048&&qs(9,t,t.return);break;case 3:Pl(t);break;case 12:Pl(t);break;case 22:var i=t.stateNode;t.memoizedState!==null&&i._visibility&2&&(t.return===null||t.return.tag!==13)?(i._visibility&=-3,Xu(t)):Pl(t);break;default:Pl(t)}}function Xu(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var p=i[u];ci=p,lg(p,t)}sg(t)}for(t=t.child;t!==null;){switch(i=t,i.tag){case 0:case 11:case 15:qs(8,i,i.return),Xu(i);break;case 22:u=i.stateNode,u._visibility&2&&(u._visibility&=-3,Xu(i));break;default:Xu(i)}t=t.sibling}}function lg(t,i){for(;ci!==null;){var u=ci;switch(u.tag){case 0:case 11:case 15:qs(8,u,i);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Cl(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,ci=p;else e:for(u=t;ci!==null;){p=ci;var C=p.sibling,T=p.return;if(Zp(p),p===u){ci=null;break e}if(C!==null){C.return=T,ci=C;break e}ci=T}}}var qC={getCacheForType:function(t){var i=wi(Kr),u=i.data.get(t);return u===void 0&&(u=t(),i.data.set(t,u)),u},cacheSignal:function(){return wi(Kr).controller.signal}},jC=typeof WeakMap=="function"?WeakMap:Map,lr=0,_r=null,Un=null,Hn=0,pr=0,na=null,js=!1,tl=!1,yd=!1,vs=0,Gr=0,Hs=0,Co=0,wd=0,ra=0,nl=0,Fl=null,Vi=null,bd=!1,Zu=0,ug=0,Ju=1/0,ec=null,Ys=null,ri=0,Ws=null,rl=null,_s=0,vd=0,_d=null,cg=null,Gl=0,Cd=null;function ia(){return(lr&2)!==0&&Hn!==0?Hn&-Hn:xe.T!==null?Rd():M()}function fg(){if(ra===0)if((Hn&536870912)===0||Xn){var t=on;on<<=1,(on&3932160)===0&&(on=262144),ra=t}else ra=536870912;return t=ea.current,t!==null&&(t.flags|=32),ra}function qi(t,i,u){(t===_r&&(pr===2||pr===9)||t.cancelPendingCommit!==null)&&(il(t,0),Ks(t,Hn,ra,!1)),ei(t,u),((lr&2)===0||t!==_r)&&(t===_r&&((lr&2)===0&&(Co|=u),Gr===4&&Ks(t,Hn,ra,!1)),ns(t))}function dg(t,i,u){if((lr&6)!==0)throw Error(o(327));var p=!u&&(i&127)===0&&(i&t.expiredLanes)===0||fr(t,i),C=p?WC(t,i):Ed(t,i,!0),T=p;do{if(C===0){tl&&!p&&Ks(t,i,0,!1);break}else{if(u=t.current.alternate,T&&!HC(u)){C=Ed(t,i,!1),T=!1;continue}if(C===2){if(T=i,t.errorRecoveryDisabledLanes&T)var U=0;else U=t.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){i=U;e:{var J=t;C=Fl;var me=J.current.memoizedState.isDehydrated;if(me&&(il(J,U).flags|=256),U=Ed(J,U,!1),U!==2){if(yd&&!me){J.errorRecoveryDisabledLanes|=T,Co|=T,C=4;break e}T=Vi,Vi=C,T!==null&&(Vi===null?Vi=T:Vi.push.apply(Vi,T))}C=U}if(T=!1,C!==2)continue}}if(C===1){il(t,0),Ks(t,i,0,!0);break}e:{switch(p=t,T=C,T){case 0:case 1:throw Error(o(345));case 4:if((i&4194048)!==i)break;case 6:Ks(p,i,ra,!js);break e;case 2:Vi=null;break;case 3:case 5:break;default:throw Error(o(329))}if((i&62914560)===i&&(C=Zu+300-kn(),10<C)){if(Ks(p,i,ra,!js),sr(p,0,!0)!==0)break e;_s=i,p.timeoutHandle=Vg(hg.bind(null,p,u,Vi,ec,bd,i,ra,Co,nl,js,T,"Throttled",-0,0),C);break e}hg(p,u,Vi,ec,bd,i,ra,Co,nl,js,T,null,-0,0)}}break}while(!0);ns(t)}function hg(t,i,u,p,C,T,U,J,me,$e,Ze,it,ze,Ye){if(t.timeoutHandle=-1,it=i.subtreeFlags,it&8192||(it&16785408)===16785408){it={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:jr},ag(i,T,it);var Ht=(T&62914560)===T?Zu-kn():(T&4194048)===T?ug-kn():0;if(Ht=OA(it,Ht),Ht!==null){_s=T,t.cancelPendingCommit=Ht(vg.bind(null,t,i,T,u,p,C,U,J,me,Ze,it,null,ze,Ye)),Ks(t,T,U,!$e);return}}vg(t,i,T,u,p,C,U,J,me)}function HC(t){for(var i=t;;){var u=i.tag;if((u===0||u===11||u===15)&&i.flags&16384&&(u=i.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var C=u[p],T=C.getSnapshot;C=C.value;try{if(!g(T(),C))return!1}catch{return!1}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ks(t,i,u,p){i&=~wd,i&=~Co,t.suspendedLanes|=i,t.pingedLanes&=~i,p&&(t.warmLanes|=i),p=t.expirationTimes;for(var C=i;0<C;){var T=31-Xt(C),U=1<<T;p[T]=-1,C&=~U}u!==0&&Dr(t,u,i)}function tc(){return(lr&6)===0?(Vl(0),!1):!0}function Ad(){if(Un!==null){if(pr===0)var t=Un.return;else t=Un,fs=po=null,Pf(t),Wo=null,El=0,t=Un;for(;t!==null;)qp(t.alternate,t),t=t.return;Un=null}}function il(t,i){var u=t.timeoutHandle;u!==-1&&(t.timeoutHandle=-1,dA(u)),u=t.cancelPendingCommit,u!==null&&(t.cancelPendingCommit=null,u()),_s=0,Ad(),_r=t,Un=u=Ui(t.current,null),Hn=i,pr=0,na=null,js=!1,tl=fr(t,i),yd=!1,nl=ra=wd=Co=Hs=Gr=0,Vi=Fl=null,bd=!1,(i&8)!==0&&(i|=i&32);var p=t.entangledLanes;if(p!==0)for(t=t.entanglements,p&=i;0<p;){var C=31-Xt(p),T=1<<C;i|=t[C],p&=~T}return vs=i,jn(),u}function pg(t,i){Dn=null,xe.H=Bl,i===Yo||i===Ou?(i=O1(),pr=3):i===If?(i=O1(),pr=4):pr=i===nd?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,na=i,Un===null&&(Gr=1,qu(t,ma(i,t.current)))}function gg(){var t=ea.current;return t===null?!0:(Hn&4194048)===Hn?ba===null:(Hn&62914560)===Hn||(Hn&536870912)!==0?t===ba:!1}function mg(){var t=xe.H;return xe.H=Bl,t===null?Bl:t}function xg(){var t=xe.A;return xe.A=qC,t}function nc(){Gr=4,js||(Hn&4194048)!==Hn&&ea.current!==null||(tl=!0),(Hs&134217727)===0&&(Co&134217727)===0||_r===null||Ks(_r,Hn,ra,!1)}function Ed(t,i,u){var p=lr;lr|=2;var C=mg(),T=xg();(_r!==t||Hn!==i)&&(ec=null,il(t,i)),i=!1;var U=Gr;e:do try{if(pr!==0&&Un!==null){var J=Un,me=na;switch(pr){case 8:Ad(),U=6;break e;case 3:case 2:case 9:case 6:ea.current===null&&(i=!0);var $e=pr;if(pr=0,na=null,al(t,J,me,$e),u&&tl){U=0;break e}break;default:$e=pr,pr=0,na=null,al(t,J,me,$e)}}YC(),U=Gr;break}catch(Ze){pg(t,Ze)}while(!0);return i&&t.shellSuspendCounter++,fs=po=null,lr=p,xe.H=C,xe.A=T,Un===null&&(_r=null,Hn=0,jn()),U}function YC(){for(;Un!==null;)yg(Un)}function WC(t,i){var u=lr;lr|=2;var p=mg(),C=xg();_r!==t||Hn!==i?(ec=null,Ju=kn()+500,il(t,i)):tl=fr(t,i);e:do try{if(pr!==0&&Un!==null){i=Un;var T=na;t:switch(pr){case 1:pr=0,na=null,al(t,i,T,1);break;case 2:case 9:if(I1(T)){pr=0,na=null,wg(i);break}i=function(){pr!==2&&pr!==9||_r!==t||(pr=7),ns(t)},T.then(i,i);break e;case 3:pr=7;break e;case 4:pr=5;break e;case 7:I1(T)?(pr=0,na=null,wg(i)):(pr=0,na=null,al(t,i,T,7));break;case 5:var U=null;switch(Un.tag){case 26:U=Un.memoizedState;case 5:case 27:var J=Un;if(U?im(U):J.stateNode.complete){pr=0,na=null;var me=J.sibling;if(me!==null)Un=me;else{var $e=J.return;$e!==null?(Un=$e,rc($e)):Un=null}break t}}pr=0,na=null,al(t,i,T,5);break;case 6:pr=0,na=null,al(t,i,T,6);break;case 8:Ad(),Gr=6;break e;default:throw Error(o(462))}}KC();break}catch(Ze){pg(t,Ze)}while(!0);return fs=po=null,xe.H=p,xe.A=C,lr=u,Un!==null?0:(_r=null,Hn=0,jn(),Gr)}function KC(){for(;Un!==null&&!Er();)yg(Un)}function yg(t){var i=Gp(t.alternate,t,vs);t.memoizedProps=t.pendingProps,i===null?rc(t):Un=i}function wg(t){var i=t,u=i.alternate;switch(i.tag){case 15:case 0:i=$p(u,i,i.pendingProps,i.type,void 0,Hn);break;case 11:i=$p(u,i,i.pendingProps,i.type.render,i.ref,Hn);break;case 5:Pf(i);default:qp(u,i),i=Un=uo(i,vs),i=Gp(u,i,vs)}t.memoizedProps=t.pendingProps,i===null?rc(t):Un=i}function al(t,i,u,p){fs=po=null,Pf(i),Wo=null,El=0;var C=i.return;try{if(LC(t,C,i,u,Hn)){Gr=1,qu(t,ma(u,t.current)),Un=null;return}}catch(T){if(C!==null)throw Un=C,T;Gr=1,qu(t,ma(u,t.current)),Un=null;return}i.flags&32768?(Xn||p===1?t=!0:tl||(Hn&536870912)!==0?t=!1:(js=t=!0,(p===2||p===9||p===3||p===6)&&(p=ea.current,p!==null&&p.tag===13&&(p.flags|=16384))),bg(i,t)):rc(i)}function rc(t){var i=t;do{if((i.flags&32768)!==0){bg(i,js);return}t=i.return;var u=PC(i.alternate,i,vs);if(u!==null){Un=u;return}if(i=i.sibling,i!==null){Un=i;return}Un=i=t}while(i!==null);Gr===0&&(Gr=5)}function bg(t,i){do{var u=FC(t.alternate,t);if(u!==null){u.flags&=32767,Un=u;return}if(u=t.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!i&&(t=t.sibling,t!==null)){Un=t;return}Un=t=u}while(t!==null);Gr=6,Un=null}function vg(t,i,u,p,C,T,U,J,me){t.cancelPendingCommit=null;do ic();while(ri!==0);if((lr&6)!==0)throw Error(o(327));if(i!==null){if(i===t.current)throw Error(o(177));if(T=i.lanes|i.childLanes,T|=Jn,ti(t,u,T,U,J,me),t===_r&&(Un=_r=null,Hn=0),rl=i,Ws=t,_s=u,vd=T,_d=C,cg=p,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,JC(vr,function(){return Tg(),null})):(t.callbackNode=null,t.callbackPriority=0),p=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||p){p=xe.T,xe.T=null,C=_e.p,_e.p=2,U=lr,lr|=4;try{GC(t,i,u)}finally{lr=U,_e.p=C,xe.T=p}}ri=1,_g(),Cg(),Ag()}}function _g(){if(ri===1){ri=0;var t=Ws,i=rl,u=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||u){u=xe.T,xe.T=null;var p=_e.p;_e.p=2;var C=lr;lr|=4;try{ng(i,t);var T=Ld,U=V(t.containerInfo),J=T.focusedElem,me=T.selectionRange;if(U!==J&&J&&J.ownerDocument&&L(J.ownerDocument.documentElement,J)){if(me!==null&&Y(J)){var $e=me.start,Ze=me.end;if(Ze===void 0&&(Ze=$e),"selectionStart"in J)J.selectionStart=$e,J.selectionEnd=Math.min(Ze,J.value.length);else{var it=J.ownerDocument||document,ze=it&&it.defaultView||window;if(ze.getSelection){var Ye=ze.getSelection(),Ht=J.textContent.length,wn=Math.min(me.start,Ht),wr=me.end===void 0?wn:Math.min(me.end,Ht);!Ye.extend&&wn>wr&&(U=wr,wr=wn,wn=U);var Re=O(J,wn),Ce=O(J,wr);if(Re&&Ce&&(Ye.rangeCount!==1||Ye.anchorNode!==Re.node||Ye.anchorOffset!==Re.offset||Ye.focusNode!==Ce.node||Ye.focusOffset!==Ce.offset)){var Ne=it.createRange();Ne.setStart(Re.node,Re.offset),Ye.removeAllRanges(),wn>wr?(Ye.addRange(Ne),Ye.extend(Ce.node,Ce.offset)):(Ne.setEnd(Ce.node,Ce.offset),Ye.addRange(Ne))}}}}for(it=[],Ye=J;Ye=Ye.parentNode;)Ye.nodeType===1&&it.push({element:Ye,left:Ye.scrollLeft,top:Ye.scrollTop});for(typeof J.focus=="function"&&J.focus(),J=0;J<it.length;J++){var nt=it[J];nt.element.scrollLeft=nt.left,nt.element.scrollTop=nt.top}}mc=!!$d,Ld=$d=null}finally{lr=C,_e.p=p,xe.T=u}}t.current=i,ri=2}}function Cg(){if(ri===2){ri=0;var t=Ws,i=rl,u=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||u){u=xe.T,xe.T=null;var p=_e.p;_e.p=2;var C=lr;lr|=4;try{Xp(t,i.alternate,i)}finally{lr=C,_e.p=p,xe.T=u}}ri=3}}function Ag(){if(ri===4||ri===3){ri=0,Bn();var t=Ws,i=rl,u=_s,p=cg;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?ri=5:(ri=0,rl=Ws=null,Eg(t,t.pendingLanes));var C=t.pendingLanes;if(C===0&&(Ys=null),K(u),i=i.stateNode,tt&&typeof tt.onCommitFiberRoot=="function")try{tt.onCommitFiberRoot(an,i,void 0,(i.current.flags&128)===128)}catch{}if(p!==null){i=xe.T,C=_e.p,_e.p=2,xe.T=null;try{for(var T=t.onRecoverableError,U=0;U<p.length;U++){var J=p[U];T(J.value,{componentStack:J.stack})}}finally{xe.T=i,_e.p=C}}(_s&3)!==0&&ic(),ns(t),C=t.pendingLanes,(u&261930)!==0&&(C&42)!==0?t===Cd?Gl++:(Gl=0,Cd=t):Gl=0,Vl(0)}}function Eg(t,i){(t.pooledCacheLanes&=i)===0&&(i=t.pooledCache,i!=null&&(t.pooledCache=null,Cl(i)))}function ic(){return _g(),Cg(),Ag(),Tg()}function Tg(){if(ri!==5)return!1;var t=Ws,i=vd;vd=0;var u=K(_s),p=xe.T,C=_e.p;try{_e.p=32>u?32:u,xe.T=null,u=_d,_d=null;var T=Ws,U=_s;if(ri=0,rl=Ws=null,_s=0,(lr&6)!==0)throw Error(o(331));var J=lr;if(lr|=4,og(T.current),ig(T,T.current,U,u),lr=J,Vl(0,!1),tt&&typeof tt.onPostCommitFiberRoot=="function")try{tt.onPostCommitFiberRoot(an,T)}catch{}return!0}finally{_e.p=C,xe.T=p,Eg(t,i)}}function Sg(t,i,u){i=ma(u,i),i=td(t.stateNode,i,2),t=Fs(t,i,2),t!==null&&(ei(t,2),ns(t))}function gr(t,i,u){if(t.tag===3)Sg(t,t,u);else for(;i!==null;){if(i.tag===3){Sg(i,t,u);break}else if(i.tag===1){var p=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ys===null||!Ys.has(p))){t=ma(u,t),u=Ip(2),p=Fs(i,u,2),p!==null&&(Rp(u,p,i,t),ei(p,2),ns(p));break}}i=i.return}}function Td(t,i,u){var p=t.pingCache;if(p===null){p=t.pingCache=new jC;var C=new Set;p.set(i,C)}else C=p.get(i),C===void 0&&(C=new Set,p.set(i,C));C.has(u)||(yd=!0,C.add(u),t=QC.bind(null,t,i,u),i.then(t,t))}function QC(t,i,u){var p=t.pingCache;p!==null&&p.delete(i),t.pingedLanes|=t.suspendedLanes&u,t.warmLanes&=~u,_r===t&&(Hn&u)===u&&(Gr===4||Gr===3&&(Hn&62914560)===Hn&&300>kn()-Zu?(lr&2)===0&&il(t,0):wd|=u,nl===Hn&&(nl=0)),ns(t)}function Ig(t,i){i===0&&(i=dr()),t=Lr(t,i),t!==null&&(ei(t,i),ns(t))}function XC(t){var i=t.memoizedState,u=0;i!==null&&(u=i.retryLane),Ig(t,u)}function ZC(t,i){var u=0;switch(t.tag){case 31:case 13:var p=t.stateNode,C=t.memoizedState;C!==null&&(u=C.retryLane);break;case 19:p=t.stateNode;break;case 22:p=t.stateNode._retryCache;break;default:throw Error(o(314))}p!==null&&p.delete(i),Ig(t,u)}function JC(t,i){return nr(t,i)}var ac=null,sl=null,Sd=!1,sc=!1,Id=!1,Qs=0;function ns(t){t!==sl&&t.next===null&&(sl===null?ac=sl=t:sl=sl.next=t),sc=!0,Sd||(Sd=!0,tA())}function Vl(t,i){if(!Id&&sc){Id=!0;do for(var u=!1,p=ac;p!==null;){if(t!==0){var C=p.pendingLanes;if(C===0)var T=0;else{var U=p.suspendedLanes,J=p.pingedLanes;T=(1<<31-Xt(42|t)+1)-1,T&=C&~(U&~J),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(u=!0,Mg(p,T))}else T=Hn,T=sr(p,p===_r?T:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(T&3)===0||fr(p,T)||(u=!0,Mg(p,T));p=p.next}while(u);Id=!1}}function eA(){Rg()}function Rg(){sc=Sd=!1;var t=0;Qs!==0&&fA()&&(t=Qs);for(var i=kn(),u=null,p=ac;p!==null;){var C=p.next,T=Og(p,i);T===0?(p.next=null,u===null?ac=C:u.next=C,C===null&&(sl=u)):(u=p,(t!==0||(T&3)!==0)&&(sc=!0)),p=C}ri!==0&&ri!==5||Vl(t),Qs!==0&&(Qs=0)}function Og(t,i){for(var u=t.suspendedLanes,p=t.pingedLanes,C=t.expirationTimes,T=t.pendingLanes&-62914561;0<T;){var U=31-Xt(T),J=1<<U,me=C[U];me===-1?((J&u)===0||(J&p)!==0)&&(C[U]=hi(J,i)):me<=i&&(t.expiredLanes|=J),T&=~J}if(i=_r,u=Hn,u=sr(t,t===i?u:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),p=t.callbackNode,u===0||t===i&&(pr===2||pr===9)||t.cancelPendingCommit!==null)return p!==null&&p!==null&&wt(p),t.callbackNode=null,t.callbackPriority=0;if((u&3)===0||fr(t,u)){if(i=u&-u,i===t.callbackPriority)return i;switch(p!==null&&wt(p),K(u)){case 2:case 8:u=Or;break;case 32:u=vr;break;case 268435456:u=Nt;break;default:u=vr}return p=Dg.bind(null,t),u=nr(u,p),t.callbackPriority=i,t.callbackNode=u,i}return p!==null&&p!==null&&wt(p),t.callbackPriority=2,t.callbackNode=null,2}function Dg(t,i){if(ri!==0&&ri!==5)return t.callbackNode=null,t.callbackPriority=0,null;var u=t.callbackNode;if(ic()&&t.callbackNode!==u)return null;var p=Hn;return p=sr(t,t===_r?p:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),p===0?null:(dg(t,p,i),Og(t,kn()),t.callbackNode!=null&&t.callbackNode===u?Dg.bind(null,t):null)}function Mg(t,i){if(ic())return null;dg(t,i,!0)}function tA(){hA(function(){(lr&6)!==0?nr(hr,eA):Rg()})}function Rd(){if(Qs===0){var t=jo;t===0&&(t=In,In<<=1,(In&261888)===0&&(In=256)),Qs=t}return Qs}function Bg(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:ua(""+t)}function Ng(t,i){var u=i.ownerDocument.createElement("input");return u.name=i.name,u.value=i.value,t.id&&u.setAttribute("form",t.id),i.parentNode.insertBefore(u,i),t=new FormData(t),u.parentNode.removeChild(u),t}function nA(t,i,u,p,C){if(i==="submit"&&u&&u.stateNode===C){var T=Bg((C[Fe]||null).action),U=p.submitter;U&&(i=(i=U[Fe]||null)?Bg(i.formAction):U.getAttribute("formAction"),i!==null&&(T=i,U=null));var J=new Tr("action","action",null,p,C);t.push({event:J,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Qs!==0){var me=U?Ng(C,U):new FormData(C);Kf(u,{pending:!0,data:me,method:C.method,action:T},null,me)}}else typeof T=="function"&&(J.preventDefault(),me=U?Ng(C,U):new FormData(C),Kf(u,{pending:!0,data:me,method:C.method,action:T},T,me))},currentTarget:C}]})}}for(var Od=0;Od<lt.length;Od++){var Dd=lt[Od],rA=Dd.toLowerCase(),iA=Dd[0].toUpperCase()+Dd.slice(1);yt(rA,"on"+iA)}yt(D,"onAnimationEnd"),yt($,"onAnimationIteration"),yt(q,"onAnimationStart"),yt("dblclick","onDoubleClick"),yt("focusin","onFocus"),yt("focusout","onBlur"),yt(Z,"onTransitionRun"),yt(se,"onTransitionStart"),yt(de,"onTransitionCancel"),yt(Te,"onTransitionEnd"),_t("onMouseEnter",["mouseout","mouseover"]),_t("onMouseLeave",["mouseout","mouseover"]),_t("onPointerEnter",["pointerout","pointerover"]),_t("onPointerLeave",["pointerout","pointerover"]),ct("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ct("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ct("onBeforeInput",["compositionend","keypress","textInput","paste"]),ct("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ct("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ct("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ql));function kg(t,i){i=(i&4)!==0;for(var u=0;u<t.length;u++){var p=t[u],C=p.event;p=p.listeners;e:{var T=void 0;if(i)for(var U=p.length-1;0<=U;U--){var J=p[U],me=J.instance,$e=J.currentTarget;if(J=J.listener,me!==T&&C.isPropagationStopped())break e;T=J,C.currentTarget=$e;try{T(C)}catch(Ze){cn(Ze)}C.currentTarget=null,T=me}else for(U=0;U<p.length;U++){if(J=p[U],me=J.instance,$e=J.currentTarget,J=J.listener,me!==T&&C.isPropagationStopped())break e;T=J,C.currentTarget=$e;try{T(C)}catch(Ze){cn(Ze)}C.currentTarget=null,T=me}}}}function Pn(t,i){var u=i[Tt];u===void 0&&(u=i[Tt]=new Set);var p=t+"__bubble";u.has(p)||($g(i,t,2,!1),u.add(p))}function Md(t,i,u){var p=0;i&&(p|=4),$g(u,t,p,i)}var oc="_reactListening"+Math.random().toString(36).slice(2);function Bd(t){if(!t[oc]){t[oc]=!0,Se.forEach(function(u){u!=="selectionchange"&&(aA.has(u)||Md(u,!1,t),Md(u,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[oc]||(i[oc]=!0,Md("selectionchange",!1,i))}}function $g(t,i,u,p){switch(fm(i)){case 2:var C=BA;break;case 8:C=NA;break;default:C=Wd}u=C.bind(null,i,u,t),C=void 0,!Ea||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(C=!0),p?C!==void 0?t.addEventListener(i,u,{capture:!0,passive:C}):t.addEventListener(i,u,!0):C!==void 0?t.addEventListener(i,u,{passive:C}):t.addEventListener(i,u,!1)}function Nd(t,i,u,p,C){var T=p;if((i&1)===0&&(i&2)===0&&p!==null)e:for(;;){if(p===null)return;var U=p.tag;if(U===3||U===4){var J=p.stateNode.containerInfo;if(J===C)break;if(U===4)for(U=p.return;U!==null;){var me=U.tag;if((me===3||me===4)&&U.stateNode.containerInfo===C)return;U=U.return}for(;J!==null;){if(U=kt(J),U===null)return;if(me=U.tag,me===5||me===6||me===26||me===27){p=T=U;continue e}J=J.parentNode}}p=p.return}as(function(){var $e=T,Ze=oi(u),it=[];e:{var ze=je.get(t);if(ze!==void 0){var Ye=Tr,Ht=t;switch(t){case"keypress":if(Mi(u)===0)break e;case"keydown":case"keyup":Ye=Wa;break;case"focusin":Ht="focus",Ye=os;break;case"focusout":Ht="blur",Ye=os;break;case"beforeblur":case"afterblur":Ye=os;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=Kn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=Ha;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=Ms;break;case D:case $:case q:Ye=Cn;break;case Te:Ye=Ii;break;case"scroll":case"scrollend":Ye=Is;break;case"wheel":Ye=Rn;break;case"copy":case"cut":case"paste":Ye=Ia;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=qn;break;case"toggle":case"beforetoggle":Ye=Ka}var wn=(i&4)!==0,wr=!wn&&(t==="scroll"||t==="scrollend"),Re=wn?ze!==null?ze+"Capture":null:ze;wn=[];for(var Ce=$e,Ne;Ce!==null;){var nt=Ce;if(Ne=nt.stateNode,nt=nt.tag,nt!==5&&nt!==26&&nt!==27||Ne===null||Re===null||(nt=pn(Ce,Re),nt!=null&&wn.push(jl(Ce,nt,Ne))),wr)break;Ce=Ce.return}0<wn.length&&(ze=new Ye(ze,Ht,null,u,Ze),it.push({event:ze,listeners:wn}))}}if((i&7)===0){e:{if(ze=t==="mouseover"||t==="pointerover",Ye=t==="mouseout"||t==="pointerout",ze&&u!==si&&(Ht=u.relatedTarget||u.fromElement)&&(kt(Ht)||Ht[ut]))break e;if((Ye||ze)&&(ze=Ze.window===Ze?Ze:(ze=Ze.ownerDocument)?ze.defaultView||ze.parentWindow:window,Ye?(Ht=u.relatedTarget||u.toElement,Ye=$e,Ht=Ht?kt(Ht):null,Ht!==null&&(wr=h(Ht),wn=Ht.tag,Ht!==wr||wn!==5&&wn!==27&&wn!==6)&&(Ht=null)):(Ye=null,Ht=$e),Ye!==Ht)){if(wn=Kn,nt="onMouseLeave",Re="onMouseEnter",Ce="mouse",(t==="pointerout"||t==="pointerover")&&(wn=qn,nt="onPointerLeave",Re="onPointerEnter",Ce="pointer"),wr=Ye==null?ze:Zt(Ye),Ne=Ht==null?ze:Zt(Ht),ze=new wn(nt,Ce+"leave",Ye,u,Ze),ze.target=wr,ze.relatedTarget=Ne,nt=null,kt(Ze)===$e&&(wn=new wn(Re,Ce+"enter",Ht,u,Ze),wn.target=Ne,wn.relatedTarget=wr,nt=wn),wr=nt,Ye&&Ht)t:{for(wn=sA,Re=Ye,Ce=Ht,Ne=0,nt=Re;nt;nt=wn(nt))Ne++;nt=0;for(var ln=Ce;ln;ln=wn(ln))nt++;for(;0<Ne-nt;)Re=wn(Re),Ne--;for(;0<nt-Ne;)Ce=wn(Ce),nt--;for(;Ne--;){if(Re===Ce||Ce!==null&&Re===Ce.alternate){wn=Re;break t}Re=wn(Re),Ce=wn(Ce)}wn=null}else wn=null;Ye!==null&&Lg(it,ze,Ye,wn,!1),Ht!==null&&wr!==null&&Lg(it,wr,Ht,wn,!0)}}e:{if(ze=$e?Zt($e):window,Ye=ze.nodeName&&ze.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&ze.type==="file")var ir=xi;else if(Xa(ze))if(Za)ir=f;else{ir=s;var Jt=n}else Ye=ze.nodeName,!Ye||Ye.toLowerCase()!=="input"||ze.type!=="checkbox"&&ze.type!=="radio"?$e&&yn($e.elementType)&&(ir=xi):ir=l;if(ir&&(ir=ir(t,$e))){ui(it,ir,u,Ze);break e}Jt&&Jt(t,ze,$e),t==="focusout"&&$e&&ze.type==="number"&&$e.memoizedProps.value!=null&&re(ze,"number",ze.value)}switch(Jt=$e?Zt($e):window,t){case"focusin":(Xa(Jt)||Jt.contentEditable==="true")&&(ge=Jt,we=$e,Oe=null);break;case"focusout":Oe=we=ge=null;break;case"mousedown":Ue=!0;break;case"contextmenu":case"mouseup":case"dragend":Ue=!1,pt(it,u,Ze);break;case"selectionchange":if(ae)break;case"keydown":case"keyup":pt(it,u,Ze)}var Mn;if(ha)e:{switch(t){case"compositionstart":var Yn="onCompositionStart";break e;case"compositionend":Yn="onCompositionEnd";break e;case"compositionupdate":Yn="onCompositionUpdate";break e}Yn=void 0}else Xi?Ra(t,u)&&(Yn="onCompositionEnd"):t==="keydown"&&u.keyCode===229&&(Yn="onCompositionStart");Yn&&(Qa&&u.locale!=="ko"&&(Xi||Yn!=="onCompositionStart"?Yn==="onCompositionEnd"&&Xi&&(Mn=Si()):(li=Ze,Ti="value"in li?li.value:li.textContent,Xi=!0)),Jt=lc($e,Yn),0<Jt.length&&(Yn=new Ya(Yn,t,null,u,Ze),it.push({event:Yn,listeners:Jt}),Mn?Yn.data=Mn:(Mn=$i(u),Mn!==null&&(Yn.data=Mn)))),(Mn=Ki?Ri(t,u):Oa(t,u))&&(Yn=lc($e,"onBeforeInput"),0<Yn.length&&(Jt=new Ya("onBeforeInput","beforeinput",null,u,Ze),it.push({event:Jt,listeners:Yn}),Jt.data=Mn)),nA(it,t,$e,u,Ze)}kg(it,i)})}function jl(t,i,u){return{instance:t,listener:i,currentTarget:u}}function lc(t,i){for(var u=i+"Capture",p=[];t!==null;){var C=t,T=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||T===null||(C=pn(t,u),C!=null&&p.unshift(jl(t,C,T)),C=pn(t,i),C!=null&&p.push(jl(t,C,T))),t.tag===3)return p;t=t.return}return[]}function sA(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Lg(t,i,u,p,C){for(var T=i._reactName,U=[];u!==null&&u!==p;){var J=u,me=J.alternate,$e=J.stateNode;if(J=J.tag,me!==null&&me===p)break;J!==5&&J!==26&&J!==27||$e===null||(me=$e,C?($e=pn(u,T),$e!=null&&U.unshift(jl(u,$e,me))):C||($e=pn(u,T),$e!=null&&U.push(jl(u,$e,me)))),u=u.return}U.length!==0&&t.push({event:i,listeners:U})}var oA=/\r\n?/g,lA=/\u0000|\uFFFD/g;function zg(t){return(typeof t=="string"?t:""+t).replace(oA,`
`).replace(lA,"")}function Ug(t,i){return i=zg(i),zg(t)===i}function yr(t,i,u,p,C,T){switch(u){case"children":typeof p=="string"?i==="body"||i==="textarea"&&p===""||Vn(t,p):(typeof p=="number"||typeof p=="bigint")&&i!=="body"&&Vn(t,""+p);break;case"className":Xe(t,"class",p);break;case"tabIndex":Xe(t,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Xe(t,u,p);break;case"style":Et(t,p,T);break;case"data":if(i!=="object"){Xe(t,"data",p);break}case"src":case"href":if(p===""&&(i!=="a"||u!=="href")){t.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){t.removeAttribute(u);break}p=ua(""+p),t.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){t.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(u==="formAction"?(i!=="input"&&yr(t,i,"name",C.name,C,null),yr(t,i,"formEncType",C.formEncType,C,null),yr(t,i,"formMethod",C.formMethod,C,null),yr(t,i,"formTarget",C.formTarget,C,null)):(yr(t,i,"encType",C.encType,C,null),yr(t,i,"method",C.method,C,null),yr(t,i,"target",C.target,C,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){t.removeAttribute(u);break}p=ua(""+p),t.setAttribute(u,p);break;case"onClick":p!=null&&(t.onclick=jr);break;case"onScroll":p!=null&&Pn("scroll",t);break;case"onScrollEnd":p!=null&&Pn("scrollend",t);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(u=p.__html,u!=null){if(C.children!=null)throw Error(o(60));t.innerHTML=u}}break;case"multiple":t.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":t.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){t.removeAttribute("xlink:href");break}u=ua(""+p),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?t.setAttribute(u,""+p):t.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?t.setAttribute(u,""):t.removeAttribute(u);break;case"capture":case"download":p===!0?t.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?t.setAttribute(u,p):t.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?t.setAttribute(u,p):t.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?t.removeAttribute(u):t.setAttribute(u,p);break;case"popover":Pn("beforetoggle",t),Pn("toggle",t),rt(t,"popover",p);break;case"xlinkActuate":He(t,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":He(t,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":He(t,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":He(t,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":He(t,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":He(t,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":He(t,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":He(t,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":He(t,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":rt(t,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Cr.get(u)||u,rt(t,u,p))}}function kd(t,i,u,p,C,T){switch(u){case"style":Et(t,p,T);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(u=p.__html,u!=null){if(C.children!=null)throw Error(o(60));t.innerHTML=u}}break;case"children":typeof p=="string"?Vn(t,p):(typeof p=="number"||typeof p=="bigint")&&Vn(t,""+p);break;case"onScroll":p!=null&&Pn("scroll",t);break;case"onScrollEnd":p!=null&&Pn("scrollend",t);break;case"onClick":p!=null&&(t.onclick=jr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vt.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(C=u.endsWith("Capture"),i=u.slice(2,C?u.length-7:void 0),T=t[Fe]||null,T=T!=null?T[u]:null,typeof T=="function"&&t.removeEventListener(i,T,C),typeof p=="function")){typeof T!="function"&&T!==null&&(u in t?t[u]=null:t.hasAttribute(u)&&t.removeAttribute(u)),t.addEventListener(i,p,C);break e}u in t?t[u]=p:p===!0?t.setAttribute(u,""):rt(t,u,p)}}}function vi(t,i,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pn("error",t),Pn("load",t);var p=!1,C=!1,T;for(T in u)if(u.hasOwnProperty(T)){var U=u[T];if(U!=null)switch(T){case"src":p=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:yr(t,i,T,U,u,null)}}C&&yr(t,i,"srcSet",u.srcSet,u,null),p&&yr(t,i,"src",u.src,u,null);return;case"input":Pn("invalid",t);var J=T=U=C=null,me=null,$e=null;for(p in u)if(u.hasOwnProperty(p)){var Ze=u[p];if(Ze!=null)switch(p){case"name":C=Ze;break;case"type":U=Ze;break;case"checked":me=Ze;break;case"defaultChecked":$e=Ze;break;case"value":T=Ze;break;case"defaultValue":J=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(o(137,i));break;default:yr(t,i,p,Ze,u,null)}}be(t,T,J,me,$e,U,C,!1);return;case"select":Pn("invalid",t),p=U=T=null;for(C in u)if(u.hasOwnProperty(C)&&(J=u[C],J!=null))switch(C){case"value":T=J;break;case"defaultValue":U=J;break;case"multiple":p=J;default:yr(t,i,C,J,u,null)}i=T,u=U,t.multiple=!!p,i!=null?ot(t,!!p,i,!1):u!=null&&ot(t,!!p,u,!0);return;case"textarea":Pn("invalid",t),T=C=p=null;for(U in u)if(u.hasOwnProperty(U)&&(J=u[U],J!=null))switch(U){case"value":p=J;break;case"defaultValue":C=J;break;case"children":T=J;break;case"dangerouslySetInnerHTML":if(J!=null)throw Error(o(91));break;default:yr(t,i,U,J,u,null)}tn(t,p,C,T);return;case"option":for(me in u)u.hasOwnProperty(me)&&(p=u[me],p!=null)&&(me==="selected"?t.selected=p&&typeof p!="function"&&typeof p!="symbol":yr(t,i,me,p,u,null));return;case"dialog":Pn("beforetoggle",t),Pn("toggle",t),Pn("cancel",t),Pn("close",t);break;case"iframe":case"object":Pn("load",t);break;case"video":case"audio":for(p=0;p<ql.length;p++)Pn(ql[p],t);break;case"image":Pn("error",t),Pn("load",t);break;case"details":Pn("toggle",t);break;case"embed":case"source":case"link":Pn("error",t),Pn("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($e in u)if(u.hasOwnProperty($e)&&(p=u[$e],p!=null))switch($e){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:yr(t,i,$e,p,u,null)}return;default:if(yn(i)){for(Ze in u)u.hasOwnProperty(Ze)&&(p=u[Ze],p!==void 0&&kd(t,i,Ze,p,u,void 0));return}}for(J in u)u.hasOwnProperty(J)&&(p=u[J],p!=null&&yr(t,i,J,p,u,null))}function uA(t,i,u,p){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,T=null,U=null,J=null,me=null,$e=null,Ze=null;for(Ye in u){var it=u[Ye];if(u.hasOwnProperty(Ye)&&it!=null)switch(Ye){case"checked":break;case"value":break;case"defaultValue":me=it;default:p.hasOwnProperty(Ye)||yr(t,i,Ye,null,p,it)}}for(var ze in p){var Ye=p[ze];if(it=u[ze],p.hasOwnProperty(ze)&&(Ye!=null||it!=null))switch(ze){case"type":T=Ye;break;case"name":C=Ye;break;case"checked":$e=Ye;break;case"defaultChecked":Ze=Ye;break;case"value":U=Ye;break;case"defaultValue":J=Ye;break;case"children":case"dangerouslySetInnerHTML":if(Ye!=null)throw Error(o(137,i));break;default:Ye!==it&&yr(t,i,ze,Ye,p,it)}}nn(t,U,J,me,$e,Ze,T,C);return;case"select":Ye=U=J=ze=null;for(T in u)if(me=u[T],u.hasOwnProperty(T)&&me!=null)switch(T){case"value":break;case"multiple":Ye=me;default:p.hasOwnProperty(T)||yr(t,i,T,null,p,me)}for(C in p)if(T=p[C],me=u[C],p.hasOwnProperty(C)&&(T!=null||me!=null))switch(C){case"value":ze=T;break;case"defaultValue":J=T;break;case"multiple":U=T;default:T!==me&&yr(t,i,C,T,p,me)}i=J,u=U,p=Ye,ze!=null?ot(t,!!u,ze,!1):!!p!=!!u&&(i!=null?ot(t,!!u,i,!0):ot(t,!!u,u?[]:"",!1));return;case"textarea":Ye=ze=null;for(J in u)if(C=u[J],u.hasOwnProperty(J)&&C!=null&&!p.hasOwnProperty(J))switch(J){case"value":break;case"children":break;default:yr(t,i,J,null,p,C)}for(U in p)if(C=p[U],T=u[U],p.hasOwnProperty(U)&&(C!=null||T!=null))switch(U){case"value":ze=C;break;case"defaultValue":Ye=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(o(91));break;default:C!==T&&yr(t,i,U,C,p,T)}bn(t,ze,Ye);return;case"option":for(var Ht in u)ze=u[Ht],u.hasOwnProperty(Ht)&&ze!=null&&!p.hasOwnProperty(Ht)&&(Ht==="selected"?t.selected=!1:yr(t,i,Ht,null,p,ze));for(me in p)ze=p[me],Ye=u[me],p.hasOwnProperty(me)&&ze!==Ye&&(ze!=null||Ye!=null)&&(me==="selected"?t.selected=ze&&typeof ze!="function"&&typeof ze!="symbol":yr(t,i,me,ze,p,Ye));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wn in u)ze=u[wn],u.hasOwnProperty(wn)&&ze!=null&&!p.hasOwnProperty(wn)&&yr(t,i,wn,null,p,ze);for($e in p)if(ze=p[$e],Ye=u[$e],p.hasOwnProperty($e)&&ze!==Ye&&(ze!=null||Ye!=null))switch($e){case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(o(137,i));break;default:yr(t,i,$e,ze,p,Ye)}return;default:if(yn(i)){for(var wr in u)ze=u[wr],u.hasOwnProperty(wr)&&ze!==void 0&&!p.hasOwnProperty(wr)&&kd(t,i,wr,void 0,p,ze);for(Ze in p)ze=p[Ze],Ye=u[Ze],!p.hasOwnProperty(Ze)||ze===Ye||ze===void 0&&Ye===void 0||kd(t,i,Ze,ze,p,Ye);return}}for(var Re in u)ze=u[Re],u.hasOwnProperty(Re)&&ze!=null&&!p.hasOwnProperty(Re)&&yr(t,i,Re,null,p,ze);for(it in p)ze=p[it],Ye=u[it],!p.hasOwnProperty(it)||ze===Ye||ze==null&&Ye==null||yr(t,i,it,ze,p,Ye)}function Pg(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function cA(){if(typeof performance.getEntriesByType=="function"){for(var t=0,i=0,u=performance.getEntriesByType("resource"),p=0;p<u.length;p++){var C=u[p],T=C.transferSize,U=C.initiatorType,J=C.duration;if(T&&J&&Pg(U)){for(U=0,J=C.responseEnd,p+=1;p<u.length;p++){var me=u[p],$e=me.startTime;if($e>J)break;var Ze=me.transferSize,it=me.initiatorType;Ze&&Pg(it)&&(me=me.responseEnd,U+=Ze*(me<J?1:(J-$e)/(me-$e)))}if(--p,i+=8*(T+U)/(C.duration/1e3),t++,10<t)break}}if(0<t)return i/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var $d=null,Ld=null;function uc(t){return t.nodeType===9?t:t.ownerDocument}function Fg(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gg(t,i){if(t===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&i==="foreignObject"?0:t}function zd(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ud=null;function fA(){var t=window.event;return t&&t.type==="popstate"?t===Ud?!1:(Ud=t,!0):(Ud=null,!1)}var Vg=typeof setTimeout=="function"?setTimeout:void 0,dA=typeof clearTimeout=="function"?clearTimeout:void 0,qg=typeof Promise=="function"?Promise:void 0,hA=typeof queueMicrotask=="function"?queueMicrotask:typeof qg<"u"?function(t){return qg.resolve(null).then(t).catch(pA)}:Vg;function pA(t){setTimeout(function(){throw t})}function Xs(t){return t==="head"}function jg(t,i){var u=i,p=0;do{var C=u.nextSibling;if(t.removeChild(u),C&&C.nodeType===8)if(u=C.data,u==="/$"||u==="/&"){if(p===0){t.removeChild(C),cl(i);return}p--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")p++;else if(u==="html")Hl(t.ownerDocument.documentElement);else if(u==="head"){u=t.ownerDocument.head,Hl(u);for(var T=u.firstChild;T;){var U=T.nextSibling,J=T.nodeName;T[Gt]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&T.rel.toLowerCase()==="stylesheet"||u.removeChild(T),T=U}}else u==="body"&&Hl(t.ownerDocument.body);u=C}while(u);cl(i)}function Hg(t,i){var u=t;t=0;do{var p=u.nextSibling;if(u.nodeType===1?i?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(i?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(t===0)break;t--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||t++;u=p}while(u)}function Pd(t){var i=t.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var u=i;switch(i=i.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Pd(u),jt(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}t.removeChild(u)}}function gA(t,i,u,p){for(;t.nodeType===1;){var C=u;if(t.nodeName.toLowerCase()!==i.toLowerCase()){if(!p&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(p){if(!t[Gt])switch(i){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(T=t.getAttribute("rel"),T==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(T!==C.rel||t.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||t.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||t.getAttribute("title")!==(C.title==null?null:C.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(T=t.getAttribute("src"),(T!==(C.src==null?null:C.src)||t.getAttribute("type")!==(C.type==null?null:C.type)||t.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&T&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(i==="input"&&t.type==="hidden"){var T=C.name==null?null:""+C.name;if(C.type==="hidden"&&t.getAttribute("name")===T)return t}else return t;if(t=va(t.nextSibling),t===null)break}return null}function mA(t,i,u){if(i==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!u||(t=va(t.nextSibling),t===null))return null;return t}function Yg(t,i){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=va(t.nextSibling),t===null))return null;return t}function Fd(t){return t.data==="$?"||t.data==="$~"}function Gd(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function xA(t,i){var u=t.ownerDocument;if(t.data==="$~")t._reactRetry=i;else if(t.data!=="$?"||u.readyState!=="loading")i();else{var p=function(){i(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),t._reactRetry=p}}function va(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return t}var Vd=null;function Wg(t){t=t.nextSibling;for(var i=0;t;){if(t.nodeType===8){var u=t.data;if(u==="/$"||u==="/&"){if(i===0)return va(t.nextSibling);i--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||i++}t=t.nextSibling}return null}function Kg(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var u=t.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(i===0)return t;i--}else u!=="/$"&&u!=="/&"||i++}t=t.previousSibling}return null}function Qg(t,i,u){switch(i=uc(u),t){case"html":if(t=i.documentElement,!t)throw Error(o(452));return t;case"head":if(t=i.head,!t)throw Error(o(453));return t;case"body":if(t=i.body,!t)throw Error(o(454));return t;default:throw Error(o(451))}}function Hl(t){for(var i=t.attributes;i.length;)t.removeAttributeNode(i[0]);jt(t)}var _a=new Map,Xg=new Set;function cc(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Cs=_e.d;_e.d={f:yA,r:wA,D:bA,C:vA,L:_A,m:CA,X:EA,S:AA,M:TA};function yA(){var t=Cs.f(),i=tc();return t||i}function wA(t){var i=bt(t);i!==null&&i.tag===5&&i.type==="form"?pp(i):Cs.r(t)}var ol=typeof document>"u"?null:document;function Zg(t,i,u){var p=ol;if(p&&typeof i=="string"&&i){var C=Dt(i);C='link[rel="'+t+'"][href="'+C+'"]',typeof u=="string"&&(C+='[crossorigin="'+u+'"]'),Xg.has(C)||(Xg.add(C),t={rel:t,crossOrigin:u,href:i},p.querySelector(C)===null&&(i=p.createElement("link"),vi(i,"link",t),vt(i),p.head.appendChild(i)))}}function bA(t){Cs.D(t),Zg("dns-prefetch",t,null)}function vA(t,i){Cs.C(t,i),Zg("preconnect",t,i)}function _A(t,i,u){Cs.L(t,i,u);var p=ol;if(p&&t&&i){var C='link[rel="preload"][as="'+Dt(i)+'"]';i==="image"&&u&&u.imageSrcSet?(C+='[imagesrcset="'+Dt(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(C+='[imagesizes="'+Dt(u.imageSizes)+'"]')):C+='[href="'+Dt(t)+'"]';var T=C;switch(i){case"style":T=ll(t);break;case"script":T=ul(t)}_a.has(T)||(t=R({rel:"preload",href:i==="image"&&u&&u.imageSrcSet?void 0:t,as:i},u),_a.set(T,t),p.querySelector(C)!==null||i==="style"&&p.querySelector(Yl(T))||i==="script"&&p.querySelector(Wl(T))||(i=p.createElement("link"),vi(i,"link",t),vt(i),p.head.appendChild(i)))}}function CA(t,i){Cs.m(t,i);var u=ol;if(u&&t){var p=i&&typeof i.as=="string"?i.as:"script",C='link[rel="modulepreload"][as="'+Dt(p)+'"][href="'+Dt(t)+'"]',T=C;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=ul(t)}if(!_a.has(T)&&(t=R({rel:"modulepreload",href:t},i),_a.set(T,t),u.querySelector(C)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Wl(T)))return}p=u.createElement("link"),vi(p,"link",t),vt(p),u.head.appendChild(p)}}}function AA(t,i,u){Cs.S(t,i,u);var p=ol;if(p&&t){var C=St(p).hoistableStyles,T=ll(t);i=i||"default";var U=C.get(T);if(!U){var J={loading:0,preload:null};if(U=p.querySelector(Yl(T)))J.loading=5;else{t=R({rel:"stylesheet",href:t,"data-precedence":i},u),(u=_a.get(T))&&qd(t,u);var me=U=p.createElement("link");vt(me),vi(me,"link",t),me._p=new Promise(function($e,Ze){me.onload=$e,me.onerror=Ze}),me.addEventListener("load",function(){J.loading|=1}),me.addEventListener("error",function(){J.loading|=2}),J.loading|=4,fc(U,i,p)}U={type:"stylesheet",instance:U,count:1,state:J},C.set(T,U)}}}function EA(t,i){Cs.X(t,i);var u=ol;if(u&&t){var p=St(u).hoistableScripts,C=ul(t),T=p.get(C);T||(T=u.querySelector(Wl(C)),T||(t=R({src:t,async:!0},i),(i=_a.get(C))&&jd(t,i),T=u.createElement("script"),vt(T),vi(T,"link",t),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(C,T))}}function TA(t,i){Cs.M(t,i);var u=ol;if(u&&t){var p=St(u).hoistableScripts,C=ul(t),T=p.get(C);T||(T=u.querySelector(Wl(C)),T||(t=R({src:t,async:!0,type:"module"},i),(i=_a.get(C))&&jd(t,i),T=u.createElement("script"),vt(T),vi(T,"link",t),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(C,T))}}function Jg(t,i,u,p){var C=(C=Me.current)?cc(C):null;if(!C)throw Error(o(446));switch(t){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(i=ll(u.href),u=St(C).hoistableStyles,p=u.get(i),p||(p={type:"style",instance:null,count:0,state:null},u.set(i,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){t=ll(u.href);var T=St(C).hoistableStyles,U=T.get(t);if(U||(C=C.ownerDocument||C,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(t,U),(T=C.querySelector(Yl(t)))&&!T._p&&(U.instance=T,U.state.loading=5),_a.has(t)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},_a.set(t,u),T||SA(C,t,u,U.state))),i&&p===null)throw Error(o(528,""));return U}if(i&&p!==null)throw Error(o(529,""));return null;case"script":return i=u.async,u=u.src,typeof u=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=ul(u),u=St(C).hoistableScripts,p=u.get(i),p||(p={type:"script",instance:null,count:0,state:null},u.set(i,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,t))}}function ll(t){return'href="'+Dt(t)+'"'}function Yl(t){return'link[rel="stylesheet"]['+t+"]"}function em(t){return R({},t,{"data-precedence":t.precedence,precedence:null})}function SA(t,i,u,p){t.querySelector('link[rel="preload"][as="style"]['+i+"]")?p.loading=1:(i=t.createElement("link"),p.preload=i,i.addEventListener("load",function(){return p.loading|=1}),i.addEventListener("error",function(){return p.loading|=2}),vi(i,"link",u),vt(i),t.head.appendChild(i))}function ul(t){return'[src="'+Dt(t)+'"]'}function Wl(t){return"script[async]"+t}function tm(t,i,u){if(i.count++,i.instance===null)switch(i.type){case"style":var p=t.querySelector('style[data-href~="'+Dt(u.href)+'"]');if(p)return i.instance=p,vt(p),p;var C=R({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(t.ownerDocument||t).createElement("style"),vt(p),vi(p,"style",C),fc(p,u.precedence,t),i.instance=p;case"stylesheet":C=ll(u.href);var T=t.querySelector(Yl(C));if(T)return i.state.loading|=4,i.instance=T,vt(T),T;p=em(u),(C=_a.get(C))&&qd(p,C),T=(t.ownerDocument||t).createElement("link"),vt(T);var U=T;return U._p=new Promise(function(J,me){U.onload=J,U.onerror=me}),vi(T,"link",p),i.state.loading|=4,fc(T,u.precedence,t),i.instance=T;case"script":return T=ul(u.src),(C=t.querySelector(Wl(T)))?(i.instance=C,vt(C),C):(p=u,(C=_a.get(T))&&(p=R({},u),jd(p,C)),t=t.ownerDocument||t,C=t.createElement("script"),vt(C),vi(C,"link",p),t.head.appendChild(C),i.instance=C);case"void":return null;default:throw Error(o(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(p=i.instance,i.state.loading|=4,fc(p,u.precedence,t));return i.instance}function fc(t,i,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=p.length?p[p.length-1]:null,T=C,U=0;U<p.length;U++){var J=p[U];if(J.dataset.precedence===i)T=J;else if(T!==C)break}T?T.parentNode.insertBefore(t,T.nextSibling):(i=u.nodeType===9?u.head:u,i.insertBefore(t,i.firstChild))}function qd(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.title==null&&(t.title=i.title)}function jd(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.integrity==null&&(t.integrity=i.integrity)}var dc=null;function nm(t,i,u){if(dc===null){var p=new Map,C=dc=new Map;C.set(u,p)}else C=dc,p=C.get(u),p||(p=new Map,C.set(u,p));if(p.has(t))return p;for(p.set(t,null),u=u.getElementsByTagName(t),C=0;C<u.length;C++){var T=u[C];if(!(T[Gt]||T[Ae]||t==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var U=T.getAttribute(i)||"";U=t+U;var J=p.get(U);J?J.push(T):p.set(U,[T])}}return p}function rm(t,i,u){t=t.ownerDocument||t,t.head.insertBefore(u,i==="title"?t.querySelector("head > title"):null)}function IA(t,i,u){if(u===1||i.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(t=i.disabled,typeof i.precedence=="string"&&t==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function im(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function RA(t,i,u,p){if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var C=ll(p.href),T=i.querySelector(Yl(C));if(T){i=T._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(t.count++,t=hc.bind(t),i.then(t,t)),u.state.loading|=4,u.instance=T,vt(T);return}T=i.ownerDocument||i,p=em(p),(C=_a.get(C))&&qd(p,C),T=T.createElement("link"),vt(T);var U=T;U._p=new Promise(function(J,me){U.onload=J,U.onerror=me}),vi(T,"link",p),u.instance=T}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(u,i),(i=u.state.preload)&&(u.state.loading&3)===0&&(t.count++,u=hc.bind(t),i.addEventListener("load",u),i.addEventListener("error",u))}}var Hd=0;function OA(t,i){return t.stylesheets&&t.count===0&&gc(t,t.stylesheets),0<t.count||0<t.imgCount?function(u){var p=setTimeout(function(){if(t.stylesheets&&gc(t,t.stylesheets),t.unsuspend){var T=t.unsuspend;t.unsuspend=null,T()}},6e4+i);0<t.imgBytes&&Hd===0&&(Hd=62500*cA());var C=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&gc(t,t.stylesheets),t.unsuspend)){var T=t.unsuspend;t.unsuspend=null,T()}},(t.imgBytes>Hd?50:800)+i);return t.unsuspend=u,function(){t.unsuspend=null,clearTimeout(p),clearTimeout(C)}}:null}function hc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gc(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var pc=null;function gc(t,i){t.stylesheets=null,t.unsuspend!==null&&(t.count++,pc=new Map,i.forEach(DA,t),pc=null,hc.call(t))}function DA(t,i){if(!(i.state.loading&4)){var u=pc.get(t);if(u)var p=u.get(null);else{u=new Map,pc.set(t,u);for(var C=t.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<C.length;T++){var U=C[T];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(u.set(U.dataset.precedence,U),p=U)}p&&u.set(null,p)}C=i.instance,U=C.getAttribute("data-precedence"),T=u.get(U)||p,T===p&&u.set(null,C),u.set(U,C),this.count++,p=hc.bind(this),C.addEventListener("load",p),C.addEventListener("error",p),T?T.parentNode.insertBefore(C,T.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(C,t.firstChild)),i.state.loading|=4}}var Kl={$$typeof:te,Provider:null,Consumer:null,_currentValue:Ge,_currentValue2:Ge,_threadCount:0};function MA(t,i,u,p,C,T,U,J,me){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qr(0),this.hiddenUpdates=qr(null),this.identifierPrefix=p,this.onUncaughtError=C,this.onCaughtError=T,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function am(t,i,u,p,C,T,U,J,me,$e,Ze,it){return t=new MA(t,i,u,U,me,$e,Ze,it,J),i=1,T===!0&&(i|=24),T=Ci(3,null,null,i),t.current=T,T.stateNode=t,i=Ef(),i.refCount++,t.pooledCache=i,i.refCount++,T.memoizedState={element:p,isDehydrated:u,cache:i},Rf(T),t}function sm(t){return t?(t=Ns,t):Ns}function om(t,i,u,p,C,T){C=sm(C),p.context===null?p.context=C:p.pendingContext=C,p=Ps(i),p.payload={element:u},T=T===void 0?null:T,T!==null&&(p.callback=T),u=Fs(t,p,i),u!==null&&(qi(u,t,i),Sl(u,t,i))}function lm(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var u=t.retryLane;t.retryLane=u!==0&&u<i?u:i}}function Yd(t,i){lm(t,i),(t=t.alternate)&&lm(t,i)}function um(t){if(t.tag===13||t.tag===31){var i=Lr(t,67108864);i!==null&&qi(i,t,67108864),Yd(t,67108864)}}function cm(t){if(t.tag===13||t.tag===31){var i=ia();i=W(i);var u=Lr(t,i);u!==null&&qi(u,t,i),Yd(t,i)}}var mc=!0;function BA(t,i,u,p){var C=xe.T;xe.T=null;var T=_e.p;try{_e.p=2,Wd(t,i,u,p)}finally{_e.p=T,xe.T=C}}function NA(t,i,u,p){var C=xe.T;xe.T=null;var T=_e.p;try{_e.p=8,Wd(t,i,u,p)}finally{_e.p=T,xe.T=C}}function Wd(t,i,u,p){if(mc){var C=Kd(p);if(C===null)Nd(t,i,p,xc,u),dm(t,p);else if($A(C,t,i,u,p))p.stopPropagation();else if(dm(t,p),i&4&&-1<kA.indexOf(t)){for(;C!==null;){var T=bt(C);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var U=Gn(T.pendingLanes);if(U!==0){var J=T;for(J.pendingLanes|=2,J.entangledLanes|=2;U;){var me=1<<31-Xt(U);J.entanglements[1]|=me,U&=~me}ns(T),(lr&6)===0&&(Ju=kn()+500,Vl(0))}}break;case 31:case 13:J=Lr(T,2),J!==null&&qi(J,T,2),tc(),Yd(T,2)}if(T=Kd(p),T===null&&Nd(t,i,p,xc,u),T===C)break;C=T}C!==null&&p.stopPropagation()}else Nd(t,i,p,null,u)}}function Kd(t){return t=oi(t),Qd(t)}var xc=null;function Qd(t){if(xc=null,t=kt(t),t!==null){var i=h(t);if(i===null)t=null;else{var u=i.tag;if(u===13){if(t=m(i),t!==null)return t;t=null}else if(u===31){if(t=x(i),t!==null)return t;t=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null)}}return xc=t,null}function fm(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ai()){case hr:return 2;case Or:return 8;case vr:case cr:return 32;case Nt:return 268435456;default:return 32}default:return 32}}var Xd=!1,Zs=null,Js=null,eo=null,Ql=new Map,Xl=new Map,to=[],kA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dm(t,i){switch(t){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":Ql.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xl.delete(i.pointerId)}}function Zl(t,i,u,p,C,T){return t===null||t.nativeEvent!==T?(t={blockedOn:i,domEventName:u,eventSystemFlags:p,nativeEvent:T,targetContainers:[C]},i!==null&&(i=bt(i),i!==null&&um(i)),t):(t.eventSystemFlags|=p,i=t.targetContainers,C!==null&&i.indexOf(C)===-1&&i.push(C),t)}function $A(t,i,u,p,C){switch(i){case"focusin":return Zs=Zl(Zs,t,i,u,p,C),!0;case"dragenter":return Js=Zl(Js,t,i,u,p,C),!0;case"mouseover":return eo=Zl(eo,t,i,u,p,C),!0;case"pointerover":var T=C.pointerId;return Ql.set(T,Zl(Ql.get(T)||null,t,i,u,p,C)),!0;case"gotpointercapture":return T=C.pointerId,Xl.set(T,Zl(Xl.get(T)||null,t,i,u,p,C)),!0}return!1}function hm(t){var i=kt(t.target);if(i!==null){var u=h(i);if(u!==null){if(i=u.tag,i===13){if(i=m(u),i!==null){t.blockedOn=i,H(t.priority,function(){cm(u)});return}}else if(i===31){if(i=x(u),i!==null){t.blockedOn=i,H(t.priority,function(){cm(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){t.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yc(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var u=Kd(t.nativeEvent);if(u===null){u=t.nativeEvent;var p=new u.constructor(u.type,u);si=p,u.target.dispatchEvent(p),si=null}else return i=bt(u),i!==null&&um(i),t.blockedOn=u,!1;i.shift()}return!0}function pm(t,i,u){yc(t)&&u.delete(i)}function LA(){Xd=!1,Zs!==null&&yc(Zs)&&(Zs=null),Js!==null&&yc(Js)&&(Js=null),eo!==null&&yc(eo)&&(eo=null),Ql.forEach(pm),Xl.forEach(pm)}function wc(t,i){t.blockedOn===i&&(t.blockedOn=null,Xd||(Xd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,LA)))}var bc=null;function gm(t){bc!==t&&(bc=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){bc===t&&(bc=null);for(var i=0;i<t.length;i+=3){var u=t[i],p=t[i+1],C=t[i+2];if(typeof p!="function"){if(Qd(p||u)===null)continue;break}var T=bt(u);T!==null&&(t.splice(i,3),i-=3,Kf(T,{pending:!0,data:C,method:u.method,action:p},p,C))}}))}function cl(t){function i(me){return wc(me,t)}Zs!==null&&wc(Zs,t),Js!==null&&wc(Js,t),eo!==null&&wc(eo,t),Ql.forEach(i),Xl.forEach(i);for(var u=0;u<to.length;u++){var p=to[u];p.blockedOn===t&&(p.blockedOn=null)}for(;0<to.length&&(u=to[0],u.blockedOn===null);)hm(u),u.blockedOn===null&&to.shift();if(u=(t.ownerDocument||t).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var C=u[p],T=u[p+1],U=C[Fe]||null;if(typeof T=="function")U||gm(u);else if(U){var J=null;if(T&&T.hasAttribute("formAction")){if(C=T,U=T[Fe]||null)J=U.formAction;else if(Qd(C)!==null)continue}else J=U.action;typeof J=="function"?u[p+1]=J:(u.splice(p,3),p-=3),gm(u)}}}function mm(){function t(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(U){return C=U})},focusReset:"manual",scroll:"manual"})}function i(){C!==null&&(C(),C=null),p||setTimeout(u,20)}function u(){if(!p&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,C=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(u,100),function(){p=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),C!==null&&(C(),C=null)}}}function Zd(t){this._internalRoot=t}vc.prototype.render=Zd.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(o(409));var u=i.current,p=ia();om(u,p,t,i,null,null)},vc.prototype.unmount=Zd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;om(t.current,2,null,t,null,null),tc(),i[ut]=null}};function vc(t){this._internalRoot=t}vc.prototype.unstable_scheduleHydration=function(t){if(t){var i=M();t={blockedOn:null,target:t,priority:i};for(var u=0;u<to.length&&i!==0&&i<to[u].priority;u++);to.splice(u,0,t),u===0&&hm(t)}};var xm=r.version;if(xm!=="19.2.3")throw Error(o(527,xm,"19.2.3"));_e.findDOMNode=function(t){var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(o(188)):(t=Object.keys(t).join(","),Error(o(268,t)));return t=y(i),t=t!==null?S(t):null,t=t===null?null:t.stateNode,t};var zA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:xe,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_c.isDisabled&&_c.supportsFiber)try{an=_c.inject(zA),tt=_c}catch{}}return eu.createRoot=function(t,i){if(!c(t))throw Error(o(299));var u=!1,p="",C=Ap,T=Ep,U=Tp;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onUncaughtError!==void 0&&(C=i.onUncaughtError),i.onCaughtError!==void 0&&(T=i.onCaughtError),i.onRecoverableError!==void 0&&(U=i.onRecoverableError)),i=am(t,1,!1,null,null,u,p,null,C,T,U,mm),t[ut]=i.current,Bd(t),new Zd(i)},eu.hydrateRoot=function(t,i,u){if(!c(t))throw Error(o(299));var p=!1,C="",T=Ap,U=Ep,J=Tp,me=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(C=u.identifierPrefix),u.onUncaughtError!==void 0&&(T=u.onUncaughtError),u.onCaughtError!==void 0&&(U=u.onCaughtError),u.onRecoverableError!==void 0&&(J=u.onRecoverableError),u.formState!==void 0&&(me=u.formState)),i=am(t,1,!0,i,u??null,p,C,me,T,U,J,mm),i.context=sm(null),u=i.current,p=ia(),p=W(p),C=Ps(p),C.callback=null,Fs(u,C,p),u=p,i.current.lanes=u,ei(i,u),ns(i),t[ut]=i.current,Bd(t),new vc(i)},eu.version="19.2.3",eu}var Sm;function QA(){if(Sm)return t0.exports;Sm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),t0.exports=KA(),t0.exports}var XA=QA(),zc={exports:{}},ZA=zc.exports,Im;function JA(){return Im||(Im=1,(function(e,r){(function(o,c){e.exports=c(ff())})(ZA,function(a){return(function(o){var c={};function h(m){if(c[m])return c[m].exports;var x=c[m]={i:m,l:!1,exports:{}};return o[m].call(x.exports,x,x.exports,h),x.l=!0,x.exports}return h.m=o,h.c=c,h.d=function(m,x,_){h.o(m,x)||Object.defineProperty(m,x,{enumerable:!0,get:_})},h.r=function(m){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})},h.t=function(m,x){if(x&1&&(m=h(m)),x&8||x&4&&typeof m=="object"&&m&&m.__esModule)return m;var _=Object.create(null);if(h.r(_),Object.defineProperty(_,"default",{enumerable:!0,value:m}),x&2&&typeof m!="string")for(var y in m)h.d(_,y,(function(S){return m[S]}).bind(null,y));return _},h.n=function(m){var x=m&&m.__esModule?function(){return m.default}:function(){return m};return h.d(x,"a",x),x},h.o=function(m,x){return Object.prototype.hasOwnProperty.call(m,x)},h.p="",h(h.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(o,c,h){h.r(c);var m=h("react"),x=(function(){var B=function(N,k){return B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,X){z.__proto__=X}||function(z,X){for(var j in X)X.hasOwnProperty(j)&&(z[j]=X[j])},B(N,k)};return function(N,k){B(N,k);function z(){this.constructor=N}N.prototype=k===null?Object.create(k):(z.prototype=k.prototype,new z)}})(),_=function(){return _=Object.assign||function(B){for(var N,k=1,z=arguments.length;k<z;k++){N=arguments[k];for(var X in N)Object.prototype.hasOwnProperty.call(N,X)&&(B[X]=N[X])}return B},_.apply(this,arguments)},y=function(B,N){var k={};for(var z in B)Object.prototype.hasOwnProperty.call(B,z)&&N.indexOf(z)<0&&(k[z]=B[z]);if(B!=null&&typeof Object.getOwnPropertySymbols=="function")for(var X=0,z=Object.getOwnPropertySymbols(B);X<z.length;X++)N.indexOf(z[X])<0&&Object.prototype.propertyIsEnumerable.call(B,z[X])&&(k[z[X]]=B[z[X]]);return k};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(N){var k=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return k?new Promise(function(z,X){k.call(navigator,N,z,X)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function S(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var R=(function(B){x(N,B);function N(k){var z=B.call(this,k)||this;return z.canvas=null,z.ctx=null,z.requestUserMediaId=0,z.unmounted=!1,z.state={hasUserMedia:!1},z}return N.prototype.componentDidMount=function(){var k=this,z=k.state,X=k.props;if(this.unmounted=!1,!S()){X.onUserMediaError("getUserMedia not supported");return}z.hasUserMedia||this.requestUserMedia(),X.children&&typeof X.children!="function"&&console.warn("children must be a function")},N.prototype.componentDidUpdate=function(k){var z=this.props;if(!S()){z.onUserMediaError("getUserMedia not supported");return}var X=JSON.stringify(k.audioConstraints)!==JSON.stringify(z.audioConstraints),j=JSON.stringify(k.videoConstraints)!==JSON.stringify(z.videoConstraints),F=k.minScreenshotWidth!==z.minScreenshotWidth,te=k.minScreenshotHeight!==z.minScreenshotHeight;(j||F||te)&&(this.canvas=null,this.ctx=null),(X||j)&&(this.stopAndCleanup(),this.requestUserMedia())},N.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},N.stopMediaStream=function(k){k&&(k.getVideoTracks&&k.getAudioTracks?(k.getVideoTracks().map(function(z){k.removeTrack(z),z.stop()}),k.getAudioTracks().map(function(z){k.removeTrack(z),z.stop()})):k.stop())},N.prototype.stopAndCleanup=function(){var k=this.state;k.hasUserMedia&&(N.stopMediaStream(this.stream),k.src&&window.URL.revokeObjectURL(k.src))},N.prototype.getScreenshot=function(k){var z=this,X=z.state,j=z.props;if(!X.hasUserMedia)return null;var F=this.getCanvas(k);return F&&F.toDataURL(j.screenshotFormat,j.screenshotQuality)},N.prototype.getCanvas=function(k){var z=this,X=z.state,j=z.props;if(!this.video||!X.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var F=this.video.videoWidth,te=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var Q=F/te;F=j.minScreenshotWidth||this.video.clientWidth,te=F/Q,j.minScreenshotHeight&&te<j.minScreenshotHeight&&(te=j.minScreenshotHeight,F=te*Q)}this.canvas=document.createElement("canvas"),this.canvas.width=k?.width||F,this.canvas.height=k?.height||te,this.ctx=this.canvas.getContext("2d")}var oe=this,ue=oe.ctx,ee=oe.canvas;return ue&&ee&&(ee.width=k?.width||ee.width,ee.height=k?.height||ee.height,j.mirrored&&(ue.translate(ee.width,0),ue.scale(-1,1)),ue.imageSmoothingEnabled=j.imageSmoothing,ue.drawImage(this.video,0,0,k?.width||ee.width,k?.height||ee.height),j.mirrored&&(ue.scale(-1,1),ue.translate(-ee.width,0))),ee},N.prototype.requestUserMedia=function(){var k=this,z=this.props,X=function(te,Q){var oe={video:typeof Q<"u"?Q:!0};z.audio&&(oe.audio=typeof te<"u"?te:!0),k.requestUserMediaId++;var ue=k.requestUserMediaId;navigator.mediaDevices.getUserMedia(oe).then(function(ee){k.unmounted||ue!==k.requestUserMediaId?N.stopMediaStream(ee):k.handleUserMedia(null,ee)}).catch(function(ee){k.handleUserMedia(ee)})};if("mediaDevices"in navigator)X(z.audioConstraints,z.videoConstraints);else{var j=function(te){return{optional:[{sourceId:te}]}},F=function(te){var Q=te.deviceId;return typeof Q=="string"?Q:Array.isArray(Q)&&Q.length>0?Q[0]:typeof Q=="object"&&Q.ideal?Q.ideal:null};MediaStreamTrack.getSources(function(te){var Q=null,oe=null;te.forEach(function(ce){ce.kind==="audio"?Q=ce.id:ce.kind==="video"&&(oe=ce.id)});var ue=F(z.audioConstraints);ue&&(Q=ue);var ee=F(z.videoConstraints);ee&&(oe=ee),X(j(Q),j(oe))})}},N.prototype.handleUserMedia=function(k,z){var X=this.props;if(k||!z){this.setState({hasUserMedia:!1}),X.onUserMediaError(k);return}this.stream=z;try{this.video&&(this.video.srcObject=z),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(z)})}X.onUserMedia(z)},N.prototype.render=function(){var k=this,z=this,X=z.state,j=z.props,F=j.audio;j.forceScreenshotSourceSize;var te=j.disablePictureInPicture;j.onUserMedia,j.onUserMediaError,j.screenshotFormat,j.screenshotQuality,j.minScreenshotWidth,j.minScreenshotHeight,j.audioConstraints,j.videoConstraints,j.imageSmoothing;var Q=j.mirrored,oe=j.style,ue=oe===void 0?{}:oe,ee=j.children,ce=y(j,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),le=Q?_(_({},ue),{transform:(ue.transform||"")+" scaleX(-1)"}):ue,Qe={getScreenshot:this.getScreenshot.bind(this)};return m.createElement(m.Fragment,null,m.createElement("video",_({autoPlay:!0,disablePictureInPicture:te,src:X.src,muted:!F,playsInline:!0,ref:function(Je){k.video=Je},style:le},ce)),ee&&ee(Qe))},N.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},N})(m.Component);c.default=R}),react:(function(o,c){o.exports=a})}).default})})(zc)),zc.exports}var eE=JA();const tE=zh(eE);var Pw=e=>{throw TypeError(e)},Fw=(e,r,a)=>r.has(e)||Pw("Cannot "+a),nE=(e,r,a)=>(Fw(e,r,"read from private field"),a?a.call(e):r.get(e)),rE=(e,r,a)=>r.has(e)?Pw("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,a),iE=(e,r,a,o)=>(Fw(e,r,"write to private field"),r.set(e,a),a);const df=[["Aztec","M"],["Codabar","L"],["Code39","L"],["Code93","L"],["Code128","L"],["DataBar","L"],["DataBarExpanded","L"],["DataMatrix","M"],["EAN-8","L"],["EAN-13","L"],["ITF","L"],["MaxiCode","M"],["PDF417","M"],["QRCode","M"],["UPC-A","L"],["UPC-E","L"],["MicroQRCode","M"],["rMQRCode","M"],["DXFilmEdge","L"],["DataBarLimited","L"]],hf=df.map(([e])=>e),aE=hf.filter((e,r)=>df[r][1]==="L"),sE=hf.filter((e,r)=>df[r][1]==="M");function oh(e){switch(e){case"Linear-Codes":return aE.reduce((r,a)=>r|oh(a),0);case"Matrix-Codes":return sE.reduce((r,a)=>r|oh(a),0);case"Any":return(1<<df.length)-1;case"None":return 0;default:return 1<<hf.indexOf(e)}}function oE(e){if(e===0)return"None";const r=31-Math.clz32(e);return hf[r]}function lE(e){return e.reduce((r,a)=>r|oh(a),0)}const uE=["LocalAverage","GlobalHistogram","FixedThreshold","BoolCast"];function cE(e){return uE.indexOf(e)}const Rm=["Unknown","ASCII","ISO8859_1","ISO8859_2","ISO8859_3","ISO8859_4","ISO8859_5","ISO8859_6","ISO8859_7","ISO8859_8","ISO8859_9","ISO8859_10","ISO8859_11","ISO8859_13","ISO8859_14","ISO8859_15","ISO8859_16","Cp437","Cp1250","Cp1251","Cp1252","Cp1256","Shift_JIS","Big5","GB2312","GB18030","EUC_JP","EUC_KR","UTF16BE","UTF16BE","UTF8","UTF16LE","UTF32BE","UTF32LE","BINARY"];function fE(e){return e==="UnicodeBig"?Rm.indexOf("UTF16BE"):Rm.indexOf(e)}const dE=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function hE(e){return dE[e]}const pE=["Ignore","Read","Require"];function gE(e){return pE.indexOf(e)}const mE=["Plain","ECI","HRI","Hex","Escaped"];function xE(e){return mE.indexOf(e)}const Wc={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,tryDenoise:!1,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!0,returnErrors:!1,eanAddOnSymbol:"Ignore",textMode:"HRI",characterSet:"Unknown"};function Om(e){return{...e,formats:lE(e.formats),binarizer:cE(e.binarizer),eanAddOnSymbol:gE(e.eanAddOnSymbol),textMode:xE(e.textMode),characterSet:fE(e.characterSet)}}function yE(e){return{...e,format:oE(e.format),contentType:hE(e.contentType),eccLevel:e.ecLevel}}const wE={locateFile:(e,r)=>{const a=e.match(/_(.+?)\.wasm$/);return a?`https://fastly.jsdelivr.net/npm/zxing-wasm@2.2.4/dist/${a[1]}/${e}`:r+e}},a0=new WeakMap;function bE(e,r){return Object.is(e,r)||Object.keys(e).length===Object.keys(r).length&&Object.keys(e).every(a=>Object.hasOwn(r,a)&&e[a]===r[a])}function Gw(e,{overrides:r,equalityFn:a=bE,fireImmediately:o=!1}={}){var c;const[h,m]=(c=a0.get(e))!=null?c:[wE],x=r??h;let _;if(o){if(m&&(_=a(h,x)))return m;const y=e({...x});return a0.set(e,[x,y]),y}(_??a(h,x))||a0.set(e,[x])}async function vE(e,r,a=Wc){const o={...Wc,...a},c=await Gw(e,{fireImmediately:!0});let h,m;if("width"in r&&"height"in r&&"data"in r){const{data:_,data:{byteLength:y},width:S,height:R}=r;m=c._malloc(y),c.HEAPU8.set(_,m),h=c.readBarcodesFromPixmap(m,S,R,Om(o))}else{let _,y;if("buffer"in r)[_,y]=[r.byteLength,r];else if("byteLength"in r)[_,y]=[r.byteLength,new Uint8Array(r)];else if("size"in r)[_,y]=[r.size,new Uint8Array(await r.arrayBuffer())];else throw new TypeError("Invalid input type");m=c._malloc(_),c.HEAPU8.set(y,m),h=c.readBarcodesFromImage(m,_,Om(o))}c._free(m);const x=[];for(let _=0;_<h.size();++_)x.push(yE(h.get(_)));return x}({...Wc,formats:[...Wc.formats]});async function Vw(e={}){var r,a,o,c=e,h=!!globalThis.window,m=typeof Bun<"u",x=!!globalThis.WorkerGlobalScope;!((a=globalThis.process)===null||a===void 0||(a=a.versions)===null||a===void 0)&&a.node&&((o=globalThis.process)===null||o===void 0?void 0:o.type)!="renderer";var _="./this.program",y,S="";function R(b){return c.locateFile?c.locateFile(b,S):S+b}var B,N;if(h||x||m){try{S=new URL(".",y).href}catch{}x&&(N=b=>{var A=new XMLHttpRequest;return A.open("GET",b,!1),A.responseType="arraybuffer",A.send(null),new Uint8Array(A.response)}),B=async b=>{var A=await fetch(b,{credentials:"same-origin"});if(A.ok)return A.arrayBuffer();throw new Error(A.status+" : "+A.url)}}var k=console.log.bind(console),z=console.error.bind(console),X,j=!1,F,te,Q,oe,ue,ee,ce,le,Qe,Je,ke=!1;function at(){var b=Qi.buffer;Q=new Int8Array(b),ue=new Int16Array(b),c.HEAPU8=oe=new Uint8Array(b),ee=new Uint16Array(b),ce=new Int32Array(b),le=new Uint32Array(b),Qe=new Float32Array(b),Je=new Float64Array(b)}function et(){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)Rt(c.preRun.shift());Me(It)}function ve(){ke=!0,I.xa()}function xe(){if(c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;)At(c.postRun.shift());Me(Bt)}function _e(b){var A,D;(A=c.onAbort)===null||A===void 0||A.call(c,b),b="Aborted("+b+")",z(b),j=!0,b+=". Build with -sASSERTIONS for more info.";var $=new WebAssembly.RuntimeError(b);throw(D=te)===null||D===void 0||D($),$}var Ge;function qe(){return R("zxing_reader.wasm")}function ft(b){if(b==Ge&&X)return new Uint8Array(X);if(N)return N(b);throw"both async and sync fetching of the wasm failed"}async function ne(b){if(!X)try{var A=await B(b);return new Uint8Array(A)}catch{}return ft(b)}async function fe(b,A){try{var D=await ne(b),$=await WebAssembly.instantiate(D,A);return $}catch(q){z(`failed to asynchronously prepare wasm: ${q}`),_e(q)}}async function De(b,A,D){if(!b&&WebAssembly.instantiateStreaming)try{var $=fetch(A,{credentials:"same-origin"}),q=await WebAssembly.instantiateStreaming($,D);return q}catch(Z){z(`wasm streaming compile failed: ${Z}`),z("falling back to ArrayBuffer instantiation")}return fe(A,D)}function Le(){var b={a:Xi};return b}async function pe(){function b(Z,se){return I=Z.exports,$i(I),at(),I}function A(Z){return b(Z.instance)}var D=Le();if(c.instantiateWasm)return new Promise((Z,se)=>{c.instantiateWasm(D,(de,Te)=>{Z(b(de))})});Ge!=null||(Ge=qe());var $=await De(X,Ge,D),q=A($);return q}var Me=b=>{for(;b.length>0;)b.shift()(c)},Bt=[],At=b=>Bt.push(b),It=[],Rt=b=>It.push(b),ht=b=>Ka(b),mt=()=>ls(),qt=[],Sn=0,Zn=b=>{var A=new mn(b);return A.get_caught()||(A.set_caught(!0),Sn--),A.set_rethrown(!1),qt.push(A),_i(b),Wi(b)},_n=0,zn=()=>{Rn(0,0);var b=qt.pop();ha(b.excPtr),_n=0};class mn{constructor(A){this.excPtr=A,this.ptr=A-24}set_type(A){le[this.ptr+4>>2]=A}get_type(){return le[this.ptr+4>>2]}set_destructor(A){le[this.ptr+8>>2]=A}get_destructor(){return le[this.ptr+8>>2]}set_caught(A){A=A?1:0,Q[this.ptr+12]=A}get_caught(){return Q[this.ptr+12]!=0}set_rethrown(A){A=A?1:0,Q[this.ptr+13]=A}get_rethrown(){return Q[this.ptr+13]!=0}init(A,D){this.set_adjusted_ptr(0),this.set_type(A),this.set_destructor(D)}set_adjusted_ptr(A){le[this.ptr+16>>2]=A}get_adjusted_ptr(){return le[this.ptr+16>>2]}}var Qt=b=>mi(b),nr=b=>{var A=_n;if(!A)return Qt(0),0;var D=new mn(A);D.set_adjusted_ptr(A);var $=D.get_type();if(!$)return Qt(0),A;for(var q of b){if(q===0||q===$)break;var Z=D.ptr+16;if(Ki(q,$,Z))return Qt(q),A}return Qt($),A},wt=()=>nr([]),Er=b=>nr([b]),Bn=(b,A)=>nr([b,A]),kn=()=>{var b=qt.pop();b||_e("no exception to throw");var A=b.excPtr;throw b.get_rethrown()||(qt.push(b),b.set_rethrown(!0),b.set_caught(!1),Sn++),_n=A,_n},ai=(b,A,D)=>{var $=new mn(b);throw $.init(A,D),_n=b,Sn++,_n},hr=()=>Sn,Or=b=>{throw _n||(_n=b),_n},vr=()=>_e(""),cr={},Nt=b=>{for(;b.length;){var A=b.pop(),D=b.pop();D(A)}};function Wt(b){return this.fromWireType(le[b>>2])}var Lt={},an={},tt={},xn=class extends Error{constructor(b){super(b),this.name="InternalError"}},Xt=b=>{throw new xn(b)},En=(b,A,D)=>{b.forEach(de=>tt[de]=A);function $(de){var Te=D(de);Te.length!==b.length&&Xt("Mismatched type converter count");for(var je=0;je<b.length;++je)sr(b[je],Te[je])}var q=new Array(A.length),Z=[],se=0;{const de=A;for(let Te=0;Te<de.length;++Te){const je=de[Te];an.hasOwnProperty(je)?q[Te]=an[je]:(Z.push(je),Lt.hasOwnProperty(je)||(Lt[je]=[]),Lt[je].push(()=>{q[Te]=an[je],++se,se===Z.length&&$(q)}))}}Z.length===0&&$(q)},Nn=b=>{var A=cr[b];delete cr[b];var D=A.rawConstructor,$=A.rawDestructor,q=A.fields,Z=q.map(se=>se.getterReturnType).concat(q.map(se=>se.setterArgumentType));En([b],Z,se=>{var de={};{const Te=q;for(let je=0;je<Te.length;++je){const lt=Te[je],yt=se[je],cn=lt.getter,gn=lt.getterContext,Ln=se[je+q.length],Jn=lt.setter,jn=lt.setterContext;de[lt.fieldName]={read:Qn=>yt.fromWireType(cn(gn,Qn)),write:(Qn,Ji)=>{var Lr=[];Jn(jn,Qn,Ln.toWireType(Lr,Ji)),Nt(Lr)},optional:yt.optional}}}return[{name:A.name,fromWireType:Te=>{var je={};for(var lt in de)je[lt]=de[lt].read(Te);return $(Te),je},toWireType:(Te,je)=>{for(var lt in de)if(!(lt in je)&&!de[lt].optional)throw new TypeError(`Missing field: "${lt}"`);var yt=D();for(lt in de)de[lt].write(yt,je[lt]);return Te!==null&&Te.push($,yt),yt},readValueFromPointer:Wt,destructorFunction:$}]})},Jr=(b,A,D,$,q)=>{},In=b=>{for(var A="";;){var D=oe[b++];if(!D)return A;A+=String.fromCharCode(D)}},on=class extends Error{constructor(b){super(b),this.name="BindingError"}},Ft=b=>{throw new on(b)};function Gn(b,A){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var $=A.name;if(b||Ft(`type "${$}" must have a positive integer typeid pointer`),an.hasOwnProperty(b)){if(D.ignoreDuplicateRegistrations)return;Ft(`Cannot register type '${$}' twice`)}if(an[b]=A,delete tt[b],Lt.hasOwnProperty(b)){var q=Lt[b];delete Lt[b],q.forEach(Z=>Z())}}function sr(b,A){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Gn(b,A,D)}var fr=(b,A,D,$)=>{A=In(A),sr(b,{name:A,fromWireType:function(q){return!!q},toWireType:function(q,Z){return Z?D:$},readValueFromPointer:function(q){return this.fromWireType(oe[q])},destructorFunction:null})},hi=b=>({count:b.count,deleteScheduled:b.deleteScheduled,preservePointerOnDelete:b.preservePointerOnDelete,ptr:b.ptr,ptrType:b.ptrType,smartPtr:b.smartPtr,smartPtrType:b.smartPtrType}),dr=b=>{function A(D){return D.$$.ptrType.registeredClass.name}Ft(A(b)+" instance already deleted")},qr=!1,ei=b=>{},ti=b=>{b.smartPtr?b.smartPtrType.rawDestructor(b.smartPtr):b.ptrType.registeredClass.rawDestructor(b.ptr)},Dr=b=>{b.count.value-=1;var A=b.count.value===0;A&&ti(b)},Pr=b=>globalThis.FinalizationRegistry?(qr=new FinalizationRegistry(A=>{Dr(A.$$)}),Pr=A=>{var D=A.$$,$=!!D.smartPtr;if($){var q={$$:D};qr.register(A,q,A)}return A},ei=A=>qr.unregister(A),Pr(b)):(Pr=A=>A,b),P=()=>{let b=W.prototype;Object.assign(b,{isAliasOf(D){if(!(this instanceof W)||!(D instanceof W))return!1;var $=this.$$.ptrType.registeredClass,q=this.$$.ptr;D.$$=D.$$;for(var Z=D.$$.ptrType.registeredClass,se=D.$$.ptr;$.baseClass;)q=$.upcast(q),$=$.baseClass;for(;Z.baseClass;)se=Z.upcast(se),Z=Z.baseClass;return $===Z&&q===se},clone(){if(this.$$.ptr||dr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var D=Pr(Object.create(Object.getPrototypeOf(this),{$$:{value:hi(this.$$)}}));return D.$$.count.value+=1,D.$$.deleteScheduled=!1,D},delete(){this.$$.ptr||dr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ft("Object already scheduled for deletion"),ei(this),Dr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||dr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ft("Object already scheduled for deletion"),this.$$.deleteScheduled=!0,this}});const A=Symbol.dispose;A&&(b[A]=b.delete)};function W(){}var K=(b,A)=>Object.defineProperty(A,"name",{value:b}),M={},H=(b,A,D)=>{if(b[A].overloadTable===void 0){var $=b[A];b[A]=function(){for(var q=arguments.length,Z=new Array(q),se=0;se<q;se++)Z[se]=arguments[se];return b[A].overloadTable.hasOwnProperty(Z.length)||Ft(`Function '${D}' called with an invalid number of arguments (${Z.length}) - expects one of (${b[A].overloadTable})!`),b[A].overloadTable[Z.length].apply(this,Z)},b[A].overloadTable=[],b[A].overloadTable[$.argCount]=$}},Ee=(b,A,D)=>{c.hasOwnProperty(b)?((D===void 0||c[b].overloadTable!==void 0&&c[b].overloadTable[D]!==void 0)&&Ft(`Cannot register public name '${b}' twice`),H(c,b,b),c[b].overloadTable.hasOwnProperty(D)&&Ft(`Cannot register multiple overloads of a function with the same number of arguments (${D})!`),c[b].overloadTable[D]=A):(c[b]=A,c[b].argCount=D)},Ae=48,Fe=57,ut=b=>{b=b.replace(/[^a-zA-Z0-9_]/g,"$");var A=b.charCodeAt(0);return A>=Ae&&A<=Fe?`_${b}`:b};function Tt(b,A,D,$,q,Z,se,de){this.name=b,this.constructor=A,this.instancePrototype=D,this.rawDestructor=$,this.baseClass=q,this.getActualType=Z,this.upcast=se,this.downcast=de,this.pureVirtualFunctions=[]}var xt=(b,A,D)=>{for(;A!==D;)A.upcast||Ft(`Expected null or instance of ${D.name}, got an instance of ${A.name}`),b=A.upcast(b),A=A.baseClass;return b},dn=b=>{if(b===null)return"null";var A=typeof b;return A==="object"||A==="array"||A==="function"?b.toString():""+b};function Mt(b,A){if(A===null)return this.isReference&&Ft(`null is not a valid ${this.name}`),0;A.$$||Ft(`Cannot pass "${dn(A)}" as a ${this.name}`),A.$$.ptr||Ft(`Cannot pass deleted object as a pointer of type ${this.name}`);var D=A.$$.ptrType.registeredClass,$=xt(A.$$.ptr,D,this.registeredClass);return $}function Gt(b,A){var D;if(A===null)return this.isReference&&Ft(`null is not a valid ${this.name}`),this.isSmartPointer?(D=this.rawConstructor(),b!==null&&b.push(this.rawDestructor,D),D):0;(!A||!A.$$)&&Ft(`Cannot pass "${dn(A)}" as a ${this.name}`),A.$$.ptr||Ft(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&A.$$.ptrType.isConst&&Ft(`Cannot convert argument of type ${A.$$.smartPtrType?A.$$.smartPtrType.name:A.$$.ptrType.name} to parameter type ${this.name}`);var $=A.$$.ptrType.registeredClass;if(D=xt(A.$$.ptr,$,this.registeredClass),this.isSmartPointer)switch(A.$$.smartPtr===void 0&&Ft("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:A.$$.smartPtrType===this?D=A.$$.smartPtr:Ft(`Cannot convert argument of type ${A.$$.smartPtrType?A.$$.smartPtrType.name:A.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:D=A.$$.smartPtr;break;case 2:if(A.$$.smartPtrType===this)D=A.$$.smartPtr;else{var q=A.clone();D=this.rawShare(D,tn.toHandle(()=>q.delete())),b!==null&&b.push(this.rawDestructor,D)}break;default:Ft("Unsupporting sharing policy")}return D}function jt(b,A){if(A===null)return this.isReference&&Ft(`null is not a valid ${this.name}`),0;A.$$||Ft(`Cannot pass "${dn(A)}" as a ${this.name}`),A.$$.ptr||Ft(`Cannot pass deleted object as a pointer of type ${this.name}`),A.$$.ptrType.isConst&&Ft(`Cannot convert argument of type ${A.$$.ptrType.name} to parameter type ${this.name}`);var D=A.$$.ptrType.registeredClass,$=xt(A.$$.ptr,D,this.registeredClass);return $}var kt=(b,A,D)=>{if(A===D)return b;if(D.baseClass===void 0)return null;var $=kt(b,A,D.baseClass);return $===null?null:D.downcast($)},bt={},Zt=(b,A)=>{for(A===void 0&&Ft("ptr should not be undefined");b.baseClass;)A=b.upcast(A),b=b.baseClass;return A},St=(b,A)=>(A=Zt(b,A),bt[A]),vt=(b,A)=>{(!A.ptrType||!A.ptr)&&Xt("makeClassHandle requires ptr and ptrType");var D=!!A.smartPtrType,$=!!A.smartPtr;return D!==$&&Xt("Both smartPtrType and smartPtr must be specified"),A.count={value:1},Pr(Object.create(b,{$$:{value:A,writable:!0}}))};function Se(b){var A=this.getPointee(b);if(!A)return this.destructor(b),null;var D=St(this.registeredClass,A);if(D!==void 0){if(D.$$.count.value===0)return D.$$.ptr=A,D.$$.smartPtr=b,D.clone();var $=D.clone();return this.destructor(b),$}function q(){return this.isSmartPointer?vt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:A,smartPtrType:this,smartPtr:b}):vt(this.registeredClass.instancePrototype,{ptrType:this,ptr:b})}var Z=this.registeredClass.getActualType(A),se=M[Z];if(!se)return q.call(this);var de;this.isConst?de=se.constPointerType:de=se.pointerType;var Te=kt(A,this.registeredClass,de.registeredClass);return Te===null?q.call(this):this.isSmartPointer?vt(de.registeredClass.instancePrototype,{ptrType:de,ptr:Te,smartPtrType:this,smartPtr:b}):vt(de.registeredClass.instancePrototype,{ptrType:de,ptr:Te})}var Vt=()=>{Object.assign(ct.prototype,{getPointee(b){return this.rawGetPointee&&(b=this.rawGetPointee(b)),b},destructor(b){var A;(A=this.rawDestructor)===null||A===void 0||A.call(this,b)},readValueFromPointer:Wt,fromWireType:Se})};function ct(b,A,D,$,q,Z,se,de,Te,je,lt){this.name=b,this.registeredClass=A,this.isReference=D,this.isConst=$,this.isSmartPointer=q,this.pointeeType=Z,this.sharingPolicy=se,this.rawGetPointee=de,this.rawConstructor=Te,this.rawShare=je,this.rawDestructor=lt,!q&&A.baseClass===void 0?$?(this.toWireType=Mt,this.destructorFunction=null):(this.toWireType=jt,this.destructorFunction=null):this.toWireType=Gt}var _t=(b,A,D)=>{c.hasOwnProperty(b)||Xt("Replacing nonexistent public symbol"),c[b].overloadTable!==void 0&&D!==void 0?c[b].overloadTable[D]=A:(c[b]=A,c[b].argCount=D)},Ot={},st=(b,A,D)=>{b=b.replace(/p/g,"i");var $=Ot[b];return $(A,...D)},Ie=[],ye=b=>{var A=Ie[b];return A||(Ie[b]=A=Ra.get(b)),A},rt=function(b,A){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(b.includes("j"))return st(b,A,D);var $=ye(A),q=$(...D);return q},Xe=function(b,A){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function(){for(var $=arguments.length,q=new Array($),Z=0;Z<$;Z++)q[Z]=arguments[Z];return rt(b,A,q,D)}},He=function(b,A){b=In(b);function D(){if(b.includes("j"))return Xe(b,A);var q=ye(A);return q}var $=D();return typeof $!="function"&&Ft(`unknown function pointer with signature ${b}: ${A}`),$};class We extends Error{}var zt=b=>{var A=Ms(b),D=In(A);return $n(A),D},hn=(b,A)=>{var D=[],$={};function q(Z){if(!$[Z]&&!an[Z]){if(tt[Z]){tt[Z].forEach(q);return}D.push(Z),$[Z]=!0}}throw A.forEach(q),new We(`${b}: `+D.map(zt).join([", "]))},$t=(b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn)=>{lt=In(lt),Z=He(q,Z),de&&(de=He(se,de)),je&&(je=He(Te,je)),cn=He(yt,cn);var gn=ut(lt);Ee(gn,function(){hn(`Cannot construct ${lt} due to unbound types`,[$])}),En([b,A,D],$?[$]:[],Ln=>{Ln=Ln[0];var Jn,jn;$?(Jn=Ln.registeredClass,jn=Jn.instancePrototype):jn=W.prototype;var Qn=K(lt,function(){if(Object.getPrototypeOf(this)!==Ji)throw new on(`Use 'new' to construct ${lt}`);if(Lr.constructor_body===void 0)throw new on(`${lt} has no accessible constructor`);for(var Po=arguments.length,Ui=new Array(Po),uo=0;uo<Po;uo++)Ui[uo]=arguments[uo];var co=Lr.constructor_body[Ui.length];if(co===void 0)throw new on(`Tried to invoke ctor of ${lt} with invalid number of parameters (${Ui.length}) - expected (${Object.keys(Lr.constructor_body).toString()}) parameters instead!`);return co.apply(this,Ui)}),Ji=Object.create(jn,{constructor:{value:Qn}});Qn.prototype=Ji;var Lr=new Tt(lt,Qn,Ji,cn,Jn,Z,de,je);if(Lr.baseClass){var ga,us;(us=(ga=Lr.baseClass).__derivedClasses)!==null&&us!==void 0||(ga.__derivedClasses=[]),Lr.baseClass.__derivedClasses.push(Lr)}var Ns=new ct(lt,Lr,!0,!1,!1),Eu=new ct(lt+"*",Lr,!1,!1,!1),Ci=new ct(lt+" const*",Lr,!1,!0,!1);return M[b]={pointerType:Eu,constPointerType:Ci},_t(gn,Qn),[Ns,Eu,Ci]})},en=(b,A)=>{for(var D=[],$=0;$<b;$++)D.push(le[A+$*4>>2]);return D};function he(b){for(var A=1;A<b.length;++A)if(b[A]!==null&&b[A].destructorFunction===void 0)return!0;return!1}function un(b,A,D,$,q,Z){var se=A.length;se<2&&Ft("argTypes array size mismatch! Must at least get return value and 'this' types!");var de=A[1]!==null&&D!==null,Te=he(A),je=!A[0].isVoid,lt=se-2,yt=new Array(lt),cn=[],gn=[],Ln=function(){gn.length=0;var Jn;cn.length=de?2:1,cn[0]=q,de&&(Jn=A[1].toWireType(gn,this),cn[1]=Jn);for(var jn=0;jn<lt;++jn)yt[jn]=A[jn+2].toWireType(gn,jn<0||arguments.length<=jn?void 0:arguments[jn]),cn.push(yt[jn]);var Qn=$(...cn);function Ji(Lr){if(Te)Nt(gn);else for(var ga=de?1:2;ga<A.length;ga++){var us=ga===1?Jn:yt[ga-2];A[ga].destructorFunction!==null&&A[ga].destructorFunction(us)}if(je)return A[0].fromWireType(Lr)}return Ji(Qn)};return K(b,Ln)}var Dt=(b,A,D,$,q,Z)=>{var se=en(A,D);q=He($,q),En([],[b],de=>{de=de[0];var Te=`constructor ${de.name}`;if(de.registeredClass.constructor_body===void 0&&(de.registeredClass.constructor_body=[]),de.registeredClass.constructor_body[A-1]!==void 0)throw new on(`Cannot register multiple constructors with identical number of parameters (${A-1}) for class '${de.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return de.registeredClass.constructor_body[A-1]=()=>{hn(`Cannot construct ${de.name} due to unbound types`,se)},En([],se,je=>(je.splice(1,0,null),de.registeredClass.constructor_body[A-1]=un(Te,je,null,q,Z),[])),[]})},nn=b=>{b=b.trim();const A=b.indexOf("(");return A===-1?b:b.slice(0,A)},be=(b,A,D,$,q,Z,se,de,Te,je)=>{var lt=en(D,$);A=In(A),A=nn(A),Z=He(q,Z),En([],[b],yt=>{yt=yt[0];var cn=`${yt.name}.${A}`;A.startsWith("@@")&&(A=Symbol[A.substring(2)]),de&&yt.registeredClass.pureVirtualFunctions.push(A);function gn(){hn(`Cannot call ${cn} due to unbound types`,lt)}var Ln=yt.registeredClass.instancePrototype,Jn=Ln[A];return Jn===void 0||Jn.overloadTable===void 0&&Jn.className!==yt.name&&Jn.argCount===D-2?(gn.argCount=D-2,gn.className=yt.name,Ln[A]=gn):(H(Ln,A,cn),Ln[A].overloadTable[D-2]=gn),En([],lt,jn=>{var Qn=un(cn,jn,yt,Z,se);return Ln[A].overloadTable===void 0?(Qn.argCount=D-2,Ln[A]=Qn):Ln[A].overloadTable[D-2]=Qn,[]}),[]})},re=[],ot=[0,1,,1,null,1,!0,1,!1,1],bn=b=>{b>9&&--ot[b+1]===0&&(ot[b]=void 0,re.push(b))},tn={toValue:b=>(b||Ft(`Cannot use deleted val. handle = ${b}`),ot[b]),toHandle:b=>{switch(b){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const A=re.pop()||ot.length;return ot[A]=b,ot[A+1]=1,A}}}},Vn={name:"emscripten::val",fromWireType:b=>{var A=tn.toValue(b);return bn(b),A},toWireType:(b,A)=>tn.toHandle(A),readValueFromPointer:Wt,destructorFunction:null},rr=b=>sr(b,Vn),On=(b,A)=>{switch(A){case 4:return function(D){return this.fromWireType(Qe[D>>2])};case 8:return function(D){return this.fromWireType(Je[D>>3])};default:throw new TypeError(`invalid float width (${A}): ${b}`)}},Et=(b,A,D)=>{A=In(A),sr(b,{name:A,fromWireType:$=>$,toWireType:($,q)=>q,readValueFromPointer:On(A,D),destructorFunction:null})},yn=(b,A,D,$,q,Z,se,de)=>{var Te=en(A,D);b=In(b),b=nn(b),q=He($,q),Ee(b,function(){hn(`Cannot call ${b} due to unbound types`,Te)},A-1),En([],Te,je=>{var lt=[je[0],null].concat(je.slice(1));return _t(b,un(b,lt,null,q,Z),A-1),[]})},Cr=(b,A,D)=>{switch(A){case 1:return D?$=>Q[$]:$=>oe[$];case 2:return D?$=>ue[$>>1]:$=>ee[$>>1];case 4:return D?$=>ce[$>>2]:$=>le[$>>2];default:throw new TypeError(`invalid integer width (${A}): ${b}`)}},Mr=(b,A,D,$,q)=>{A=In(A);const Z=$===0;let se=Te=>Te;if(Z){var de=32-8*D;se=Te=>Te<<de>>>de,q=se(q)}sr(b,{name:A,fromWireType:se,toWireType:(Te,je)=>je,readValueFromPointer:Cr(A,D,$!==0),destructorFunction:null})},ua=(b,A,D)=>{var $=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],q=$[A];function Z(se){var de=le[se>>2],Te=le[se+4>>2];return new q(Q.buffer,Te,de)}D=In(D),sr(b,{name:D,fromWireType:Z,readValueFromPointer:Z},{ignoreDuplicateRegistrations:!0})},jr=Object.assign({optional:!0},Vn),si=(b,A)=>{sr(b,jr)},oi=(b,A,D,$)=>{if(!($>0))return 0;for(var q=D,Z=D+$-1,se=0;se<b.length;++se){var de=b.codePointAt(se);if(de<=127){if(D>=Z)break;A[D++]=de}else if(de<=2047){if(D+1>=Z)break;A[D++]=192|de>>6,A[D++]=128|de&63}else if(de<=65535){if(D+2>=Z)break;A[D++]=224|de>>12,A[D++]=128|de>>6&63,A[D++]=128|de&63}else{if(D+3>=Z)break;A[D++]=240|de>>18,A[D++]=128|de>>12&63,A[D++]=128|de>>6&63,A[D++]=128|de&63,se++}}return A[D]=0,D-q},Wn=(b,A,D)=>oi(b,oe,A,D),Wr=b=>{for(var A=0,D=0;D<b.length;++D){var $=b.charCodeAt(D);$<=127?A++:$<=2047?A+=2:$>=55296&&$<=57343?(A+=4,++D):A+=3}return A},pi=globalThis.TextDecoder&&new TextDecoder,rn=(b,A,D,$)=>{var q=A+D;if($)return q;for(;b[A]&&!(A>=q);)++A;return A},as=function(b){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=arguments.length>2?arguments[2]:void 0,$=arguments.length>3?arguments[3]:void 0;var q=rn(b,A,D,$);if(q-A>16&&b.buffer&&pi)return pi.decode(b.subarray(A,q));for(var Z="";A<q;){var se=b[A++];if(!(se&128)){Z+=String.fromCharCode(se);continue}var de=b[A++]&63;if((se&224)==192){Z+=String.fromCharCode((se&31)<<6|de);continue}var Te=b[A++]&63;if((se&240)==224?se=(se&15)<<12|de<<6|Te:se=(se&7)<<18|de<<12|Te<<6|b[A++]&63,se<65536)Z+=String.fromCharCode(se);else{var je=se-65536;Z+=String.fromCharCode(55296|je>>10,56320|je&1023)}}return Z},pn=(b,A,D)=>b?as(oe,b,A,D):"",or=(b,A)=>{A=In(A),sr(b,{name:A,fromWireType(D){var $=le[D>>2],q=D+4,Z;return Z=pn(q,$,!0),$n(D),Z},toWireType(D,$){$ instanceof ArrayBuffer&&($=new Uint8Array($));var q,Z=typeof $=="string";Z||ArrayBuffer.isView($)&&$.BYTES_PER_ELEMENT==1||Ft("Cannot pass non-string to std::string"),Z?q=Wr($):q=$.length;var se=Ii(4+q+1),de=se+4;return le[se>>2]=q,Z?Wn($,de,q+1):oe.set($,de),D!==null&&D.push($n,se),se},readValueFromPointer:Wt,destructorFunction(D){$n(D)}})},Ea=globalThis.TextDecoder?new TextDecoder("utf-16le"):void 0,ji=(b,A,D)=>{var $=b>>1,q=rn(ee,$,A/2,D);if(q-$>16&&Ea)return Ea.decode(ee.subarray($,q));for(var Z="",se=$;se<q;++se){var de=ee[se];Z+=String.fromCharCode(de)}return Z},li=(b,A,D)=>{if(D!=null||(D=2147483647),D<2)return 0;D-=2;for(var $=A,q=D<b.length*2?D/2:b.length,Z=0;Z<q;++Z){var se=b.charCodeAt(Z);ue[A>>1]=se,A+=2}return ue[A>>1]=0,A-$},Ti=b=>b.length*2,Va=(b,A,D)=>{for(var $="",q=b>>2,Z=0;!(Z>=A/4);Z++){var se=le[q+Z];if(!se&&!D)break;$+=String.fromCodePoint(se)}return $},Si=(b,A,D)=>{if(D!=null||(D=2147483647),D<4)return 0;for(var $=A,q=$+D-4,Z=0;Z<b.length;++Z){var se=b.codePointAt(Z);if(se>65535&&Z++,ce[A>>2]=se,A+=4,A+4>q)break}return ce[A>>2]=0,A-$},Mi=b=>{for(var A=0,D=0;D<b.length;++D){var $=b.codePointAt(D);$>65535&&D++,A+=4}return A},Bi=(b,A,D)=>{D=In(D);var $,q,Z;A===2?($=ji,q=li,Z=Ti):($=Va,q=Si,Z=Mi),sr(b,{name:D,fromWireType:se=>{var de=le[se>>2],Te=$(se+4,de*A,!0);return $n(se),Te},toWireType:(se,de)=>{typeof de!="string"&&Ft(`Cannot pass non-string to C++ string type ${D}`);var Te=Z(de),je=Ii(4+Te+A);return le[je>>2]=Te/A,q(de,je+4,Te+A),se!==null&&se.push($n,je),je},readValueFromPointer:Wt,destructorFunction(se){$n(se)}})},qa=(b,A,D,$,q,Z)=>{cr[b]={name:In(A),rawConstructor:He(D,$),rawDestructor:He(q,Z),fields:[]}},Br=(b,A,D,$,q,Z,se,de,Te,je)=>{cr[b].fields.push({fieldName:In(A),getterReturnType:D,getter:He($,q),getterContext:Z,setterArgumentType:se,setter:He(de,Te),setterContext:je})},gi=(b,A)=>{A=In(A),sr(b,{isVoid:!0,name:A,fromWireType:()=>{},toWireType:(D,$)=>{}})},Tr=[],ca=b=>{var A=Tr.length;return Tr.push(b),A},Is=(b,A)=>{var D=an[b];return D===void 0&&Ft(`${A} has unknown type ${zt(b)}`),D},ja=(b,A)=>{for(var D=new Array(b),$=0;$<b;++$)D[$]=Is(le[A+$*4>>2],`parameter ${$}`);return D},ss=(b,A,D)=>{var $=[],q=b($,D);return $.length&&(le[A>>2]=tn.toHandle($)),q},Ta={},Sa=b=>{var A=Ta[b];return A===void 0?In(b):A},Kn=(b,A,D)=>{var $=8,[q,...Z]=ja(b,A),se=q.toWireType.bind(q),de=Z.map(yt=>yt.readValueFromPointer.bind(yt));b--;var Te=new Array(b),je=(yt,cn,gn,Ln)=>{for(var Jn=0,jn=0;jn<b;++jn)Te[jn]=de[jn](Ln+Jn),Jn+=$;var Qn;switch(D){case 0:Qn=tn.toValue(yt).apply(null,Te);break;case 2:Qn=Reflect.construct(tn.toValue(yt),Te);break;case 3:Qn=Te[0];break;case 1:Qn=tn.toValue(yt)[Sa(cn)](...Te);break}return ss(se,gn,Qn)},lt=`methodCaller<(${Z.map(yt=>yt.name)}) => ${q.name}>`;return ca(K(lt,je))},Rs=b=>b?(b=Sa(b),tn.toHandle(globalThis[b])):tn.toHandle(globalThis),Ha=b=>{b>9&&(ot[b+1]+=1)},Ni=(b,A,D,$,q)=>Tr[b](A,D,$,q),os=b=>{var A=tn.toValue(b);Nt(A),bn(b)},Pe=(b,A,D,$)=>{var q=new Date().getFullYear(),Z=new Date(q,0,1),se=new Date(q,6,1),de=Z.getTimezoneOffset(),Te=se.getTimezoneOffset(),je=Math.max(de,Te);le[b>>2]=je*60,ce[A>>2]=+(de!=Te);var lt=gn=>{var Ln=gn>=0?"-":"+",Jn=Math.abs(gn),jn=String(Math.floor(Jn/60)).padStart(2,"0"),Qn=String(Jn%60).padStart(2,"0");return`UTC${Ln}${jn}${Qn}`},yt=lt(de),cn=lt(Te);Te<de?(Wn(yt,D,17),Wn(cn,$,17)):(Wn(yt,$,17),Wn(cn,D,17))},Cn=()=>2147483648,Nr=(b,A)=>Math.ceil(b/A)*A,Ia=b=>{var A=Qi.buffer.byteLength,D=(b-A+65535)/65536|0;try{return Qi.grow(D),at(),1}catch{}},Os=b=>{var A=oe.length;b>>>=0;var D=Cn();if(b>D)return!1;for(var $=1;$<=4;$*=2){var q=A*(1+.2/$);q=Math.min(q,b+100663296);var Z=Math.min(D,Nr(Math.max(b,q),65536)),se=Ia(Z);if(se)return!0}return!1},Ya={},Ds=()=>_||"./this.program",fa=()=>{if(!fa.strings){var b=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",A={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:b,_:Ds()};for(var D in Ya)Ya[D]===void 0?delete A[D]:A[D]=Ya[D];var $=[];for(var D in A)$.push(`${D}=${A[D]}`);fa.strings=$}return fa.strings},Hi=(b,A)=>{var D=0,$=0;for(var q of fa()){var Z=A+D;le[b+$>>2]=Z,D+=Wn(q,Z,1/0)+1,$+=4}return 0},Sr=(b,A)=>{var D=fa();le[b>>2]=D.length;var $=0;for(var q of D)$+=Wr(q)+1;return le[A>>2]=$,0},da=b=>52;function mr(b,A,D,$,q){return 70}var Wa=[null,[],[]],Yi=(b,A)=>{var D=Wa[b];A===0||A===10?((b===1?k:z)(as(D)),D.length=0):D.push(A)},qn=(b,A,D,$)=>{for(var q=0,Z=0;Z<D;Z++){var se=le[A>>2],de=le[A+4>>2];A+=8;for(var Te=0;Te<de;Te++)Yi(b,oe[se+Te]);q+=de}return le[$>>2]=q,0},sn=b=>b;if(P(),Vt(),c.noExitRuntime&&c.noExitRuntime,c.print&&(k=c.print),c.printErr&&(z=c.printErr),c.wasmBinary&&(X=c.wasmBinary),c.arguments&&c.arguments,c.thisProgram&&(_=c.thisProgram),c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.shift()();var Ms,$n,Ii,Wi,Rn,mi,Ka,ls,ha,_i,Ki,Qa,ki,Qi,Ra;function $i(b){Ms=b.ya,$n=c._free=b.za,Ii=c._malloc=b.Ba,Wi=b.Ca,Rn=b.Da,mi=b.Ea,Ka=b.Fa,ls=b.Ga,ha=b.Ha,_i=b.Ia,Ki=b.Ja,Ot.viijii=b.Ka,Qa=Ot.iiijj=b.La,Ot.jiji=b.Ma,ki=Ot.jiiii=b.Na,Ot.iiiiij=b.Oa,Ot.iiiiijj=b.Pa,Ot.iiiiiijj=b.Qa,Qi=b.wa,Ra=b.Aa}var Xi={s:Zn,w:zn,a:wt,j:Er,m:Bn,Q:kn,p:ai,U:hr,d:Or,ca:vr,ta:Nn,ba:Jr,oa:fr,ra:$t,qa:Dt,H:be,ma:rr,X:Et,Y:yn,x:Mr,t:ua,sa:si,na:or,R:Bi,I:qa,ua:Br,pa:gi,N:Kn,va:bn,D:Rs,S:Ha,M:Ni,ia:os,da:Pe,ga:Os,ea:Hi,fa:Sr,ha:da,$:mr,V:qn,K:w,C:L,Z:Li,T:Oe,r:l,b:ui,E:g,ka:Y,c:Bs,ja:ae,h:Da,i:Za,q:pa,P:d,v:n,F:s,L:f,z:V,J:Ue,aa:pt,_:dt,f:zi,l:Ri,e:Xa,g:ni,O:we,k:Oa,la:E,o:G,B:Ma,u:O,W:Be,A:ge,n:xi,G:Zi,y:sn};function Ri(b,A){var D=mt();try{ye(b)(A)}catch($){if(ht(D),$!==$+0)throw $;Rn(1,0)}}function Oa(b,A,D,$,q){var Z=mt();try{ye(b)(A,D,$,q)}catch(se){if(ht(Z),se!==se+0)throw se;Rn(1,0)}}function ni(b,A,D,$){var q=mt();try{ye(b)(A,D,$)}catch(Z){if(ht(q),Z!==Z+0)throw Z;Rn(1,0)}}function Xa(b,A,D){var $=mt();try{ye(b)(A,D)}catch(q){if(ht($),q!==q+0)throw q;Rn(1,0)}}function ui(b,A){var D=mt();try{return ye(b)(A)}catch($){if(ht(D),$!==$+0)throw $;Rn(1,0)}}function Da(b,A,D,$){var q=mt();try{return ye(b)(A,D,$)}catch(Z){if(ht(q),Z!==Z+0)throw Z;Rn(1,0)}}function Li(b,A,D,$,q,Z){var se=mt();try{return ye(b)(A,D,$,q,Z)}catch(de){if(ht(se),de!==de+0)throw de;Rn(1,0)}}function Bs(b,A,D){var $=mt();try{return ye(b)(A,D)}catch(q){if(ht($),q!==q+0)throw q;Rn(1,0)}}function zi(b){var A=mt();try{ye(b)()}catch(D){if(ht(A),D!==D+0)throw D;Rn(1,0)}}function xi(b,A,D,$,q,Z,se,de,Te,je,lt){var yt=mt();try{ye(b)(A,D,$,q,Z,se,de,Te,je,lt)}catch(cn){if(ht(yt),cn!==cn+0)throw cn;Rn(1,0)}}function Za(b,A,D,$,q){var Z=mt();try{return ye(b)(A,D,$,q)}catch(se){if(ht(Z),se!==se+0)throw se;Rn(1,0)}}function Ma(b,A,D,$,q,Z,se){var de=mt();try{ye(b)(A,D,$,q,Z,se)}catch(Te){if(ht(de),Te!==Te+0)throw Te;Rn(1,0)}}function Zi(b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn){var jn=mt();try{ye(b)(A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn)}catch(Qn){if(ht(jn),Qn!==Qn+0)throw Qn;Rn(1,0)}}function Be(b,A,D,$,q,Z,se,de,Te){var je=mt();try{ye(b)(A,D,$,q,Z,se,de,Te)}catch(lt){if(ht(je),lt!==lt+0)throw lt;Rn(1,0)}}function pa(b,A,D,$,q,Z){var se=mt();try{return ye(b)(A,D,$,q,Z)}catch(de){if(ht(se),de!==de+0)throw de;Rn(1,0)}}function G(b,A,D,$,q,Z){var se=mt();try{ye(b)(A,D,$,q,Z)}catch(de){if(ht(se),de!==de+0)throw de;Rn(1,0)}}function n(b,A,D,$,q,Z,se){var de=mt();try{return ye(b)(A,D,$,q,Z,se)}catch(Te){if(ht(de),Te!==Te+0)throw Te;Rn(1,0)}}function s(b,A,D,$,q,Z,se,de){var Te=mt();try{return ye(b)(A,D,$,q,Z,se,de)}catch(je){if(ht(Te),je!==je+0)throw je;Rn(1,0)}}function l(b){var A=mt();try{return ye(b)()}catch(D){if(ht(A),D!==D+0)throw D;Rn(1,0)}}function f(b,A,D,$,q,Z,se,de,Te){var je=mt();try{return ye(b)(A,D,$,q,Z,se,de,Te)}catch(lt){if(ht(je),lt!==lt+0)throw lt;Rn(1,0)}}function d(b,A,D,$,q,Z,se){var de=mt();try{return ye(b)(A,D,$,q,Z,se)}catch(Te){if(ht(de),Te!==Te+0)throw Te;Rn(1,0)}}function g(b,A,D,$){var q=mt();try{return ye(b)(A,D,$)}catch(Z){if(ht(q),Z!==Z+0)throw Z;Rn(1,0)}}function w(b,A,D,$){var q=mt();try{return ye(b)(A,D,$)}catch(Z){if(ht(q),Z!==Z+0)throw Z;Rn(1,0)}}function E(b,A,D,$,q,Z,se,de){var Te=mt();try{ye(b)(A,D,$,q,Z,se,de)}catch(je){if(ht(Te),je!==je+0)throw je;Rn(1,0)}}function O(b,A,D,$,q,Z,se,de){var Te=mt();try{ye(b)(A,D,$,q,Z,se,de)}catch(je){if(ht(Te),je!==je+0)throw je;Rn(1,0)}}function L(b,A,D,$,q,Z){var se=mt();try{return ye(b)(A,D,$,q,Z)}catch(de){if(ht(se),de!==de+0)throw de;Rn(1,0)}}function V(b,A,D,$,q,Z,se,de,Te,je){var lt=mt();try{return ye(b)(A,D,$,q,Z,se,de,Te,je)}catch(yt){if(ht(lt),yt!==yt+0)throw yt;Rn(1,0)}}function Y(b,A,D){var $=mt();try{return ye(b)(A,D)}catch(q){if(ht($),q!==q+0)throw q;Rn(1,0)}}function ae(b,A,D,$,q){var Z=mt();try{return ye(b)(A,D,$,q)}catch(se){if(ht(Z),se!==se+0)throw se;Rn(1,0)}}function ge(b,A,D,$,q,Z,se,de,Te,je){var lt=mt();try{ye(b)(A,D,$,q,Z,se,de,Te,je)}catch(yt){if(ht(lt),yt!==yt+0)throw yt;Rn(1,0)}}function we(b,A,D,$,q,Z,se){var de=mt();try{ye(b)(A,D,$,q,Z,se)}catch(Te){if(ht(de),Te!==Te+0)throw Te;Rn(1,0)}}function Oe(b,A,D,$){var q=mt();try{return ye(b)(A,D,$)}catch(Z){if(ht(q),Z!==Z+0)throw Z;Rn(1,0)}}function Ue(b,A,D,$,q,Z,se,de,Te,je,lt,yt){var cn=mt();try{return ye(b)(A,D,$,q,Z,se,de,Te,je,lt,yt)}catch(gn){if(ht(cn),gn!==gn+0)throw gn;Rn(1,0)}}function pt(b,A,D,$,q,Z,se){var de=mt();try{return Qa(b,A,D,$,q,Z,se)}catch(Te){if(ht(de),Te!==Te+0)throw Te;Rn(1,0)}}function dt(b,A,D,$,q){var Z=mt();try{return ki(b,A,D,$,q)}catch(se){if(ht(Z),se!==se+0)throw se;Rn(1,0)}}function v(){et();function b(){var A,D;c.calledRun=!0,!j&&(ve(),(A=F)===null||A===void 0||A(c),(D=c.onRuntimeInitialized)===null||D===void 0||D.call(c),xe())}c.setStatus?(c.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>c.setStatus(""),1),b()},1)):b()}var I;return I=await pe(),v(),ke?r=c:r=new Promise((b,A)=>{F=b,te=A}),r}function _E(e){return Gw(Vw,e)}async function CE(e,r){return vE(Vw,e,r)}const qw=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["databar_limited","DataBarLimited"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"],["any","Any"]],AE=[...qw,["unknown"]].map(e=>e[0]),lh=new Map(qw);function EE(e){for(const[r,a]of lh)if(e===a)return r;return"unknown"}function TE(e){if(jw(e))return{width:e.naturalWidth,height:e.naturalHeight};if(Hw(e))return{width:e.width.baseVal.value,height:e.height.baseVal.value};if(Yw(e))return{width:e.videoWidth,height:e.videoHeight};if(Kw(e))return{width:e.width,height:e.height};if(Xw(e))return{width:e.displayWidth,height:e.displayHeight};if(Ww(e))return{width:e.width,height:e.height};if(Qw(e))return{width:e.width,height:e.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function jw(e){var r,a;try{return e instanceof((a=(r=e?.ownerDocument)==null?void 0:r.defaultView)==null?void 0:a.HTMLImageElement)}catch{return!1}}function Hw(e){var r,a;try{return e instanceof((a=(r=e?.ownerDocument)==null?void 0:r.defaultView)==null?void 0:a.SVGImageElement)}catch{return!1}}function Yw(e){var r,a;try{return e instanceof((a=(r=e?.ownerDocument)==null?void 0:r.defaultView)==null?void 0:a.HTMLVideoElement)}catch{return!1}}function Ww(e){var r,a;try{return e instanceof((a=(r=e?.ownerDocument)==null?void 0:r.defaultView)==null?void 0:a.HTMLCanvasElement)}catch{return!1}}function Kw(e){try{return e instanceof ImageBitmap||Object.prototype.toString.call(e)==="[object ImageBitmap]"}catch{return!1}}function Qw(e){try{return e instanceof OffscreenCanvas||Object.prototype.toString.call(e)==="[object OffscreenCanvas]"}catch{return!1}}function Xw(e){try{return e instanceof VideoFrame||Object.prototype.toString.call(e)==="[object VideoFrame]"}catch{return!1}}function SE(e){try{return e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"}catch{return!1}}function IE(e){try{return e instanceof ImageData||Object.prototype.toString.call(e)==="[object ImageData]"}catch{return!1}}function RE(e,r){try{const a=new OffscreenCanvas(e,r);if(a.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return a;throw void 0}catch{const a=document.createElement("canvas");return a.width=e,a.height=r,a}}async function Zw(e){if(jw(e)&&!await BE(e))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(Hw(e)&&!await NE(e))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(Xw(e)&&kE(e))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(Yw(e)&&(e.readyState===0||e.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(Kw(e)&&LE(e))throw new DOMException("The image source is detached.","InvalidStateError");const{width:r,height:a}=TE(e);if(r===0||a===0)return null;const o=RE(r,a).getContext("2d");o.drawImage(e,0,0);try{return o.getImageData(0,0,r,a)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function OE(e){let r;try{r=await createImageBitmap(e)}catch{try{if(globalThis.Image){r=new Image;let a="";try{a=URL.createObjectURL(e),r.src=a,await r.decode()}finally{URL.revokeObjectURL(a)}}else return e}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}}return await Zw(r)}function DE(e){const{width:r,height:a}=e;if(r===0||a===0)return null;const o=e.getContext("2d");try{return o.getImageData(0,0,r,a)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function ME(e){if(SE(e))return await OE(e);if(IE(e)){if($E(e))throw new DOMException("The image data has been detached.","InvalidStateError");return e}return Ww(e)||Qw(e)?DE(e):await Zw(e)}async function BE(e){try{return await e.decode(),!0}catch{return!1}}async function NE(e){var r;try{return await((r=e.decode)==null?void 0:r.call(e)),!0}catch{return!1}}function kE(e){return e.format===null}function $E(e){return e.data.buffer.byteLength===0}function LE(e){return e.width===0&&e.height===0}function Dm(e,r){return zE(e)?new DOMException(`${r}: ${e.message}`,e.name):UE(e)?new e.constructor(`${r}: ${e.message}`):new Error(`${r}: ${e}`)}function zE(e){return e instanceof DOMException||Object.prototype.toString.call(e)==="[object DOMException]"}function UE(e){return e instanceof Error||Object.prototype.toString.call(e)==="[object Error]"}var Uc;let uh=class{constructor(r={}){rE(this,Uc);var a;try{const o=(a=r?.formats)==null?void 0:a.filter(c=>c!=="unknown");if(o?.length===0)throw new TypeError("Hint option provided, but is empty.");for(const c of o??[])if(!lh.has(c))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${c}' is not a valid enum value of type BarcodeFormat.`);iE(this,Uc,o??[]),_E({fireImmediately:!0}).catch(()=>{})}catch(o){throw Dm(o,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return AE.filter(r=>r!=="unknown")}async detect(r){try{const a=await ME(r);if(a===null)return[];let o;const c={tryCode39ExtendedMode:!1,textMode:"Plain",formats:nE(this,Uc).map(h=>lh.get(h))};try{o=await CE(a,c)}catch(h){throw console.error(h),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return o.map(h=>{const{topLeft:{x:m,y:x},topRight:{x:_,y},bottomLeft:{x:S,y:R},bottomRight:{x:B,y:N}}=h.position,k=Math.min(m,_,S,B),z=Math.min(x,y,R,N),X=Math.max(m,_,S,B),j=Math.max(x,y,R,N);return{boundingBox:new DOMRectReadOnly(k,z,X-k,j-z),rawValue:h.text,format:EE(h.format),cornerPoints:[{x:m,y:x},{x:_,y},{x:B,y:N},{x:S,y:R}]}})}catch(a){throw Dm(a,"Failed to execute 'detect' on 'BarcodeDetector'")}}};Uc=new WeakMap;globalThis.BarcodeDetector!=null||(globalThis.BarcodeDetector=uh);let Jw=!0,eb=!0;function pu(e,r,a){const o=e.match(r);return o&&o.length>=a&&parseFloat(o[a],10)}function Lo(e,r,a){if(!e.RTCPeerConnection)return;const o=e.RTCPeerConnection.prototype,c=o.addEventListener;o.addEventListener=function(m,x){if(m!==r)return c.apply(this,arguments);const _=y=>{const S=a(y);S&&(x.handleEvent?x.handleEvent(S):x(S))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(x,_),c.apply(this,[m,_])};const h=o.removeEventListener;o.removeEventListener=function(m,x){if(m!==r||!this._eventMap||!this._eventMap[r])return h.apply(this,arguments);if(!this._eventMap[r].has(x))return h.apply(this,arguments);const _=this._eventMap[r].get(x);return this._eventMap[r].delete(x),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,h.apply(this,[m,_])},Object.defineProperty(o,"on"+r,{get(){return this["_on"+r]},set(m){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),m&&this.addEventListener(r,this["_on"+r]=m)},enumerable:!0,configurable:!0})}function PE(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(Jw=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function FE(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(eb=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function tb(){if(typeof window=="object"){if(Jw)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Uh(e,r){eb&&console.warn(e+" is deprecated, please use "+r+" instead.")}function GE(e){const r={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return r.browser="Not a browser.",r;const{navigator:a}=e;if(a.userAgentData&&a.userAgentData.brands){const o=a.userAgentData.brands.find(c=>c.brand==="Chromium");if(o)return{browser:"chrome",version:parseInt(o.version,10)}}if(a.mozGetUserMedia)r.browser="firefox",r.version=parseInt(pu(a.userAgent,/Firefox\/(\d+)\./,1));else if(a.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)r.browser="chrome",r.version=parseInt(pu(a.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(e.RTCPeerConnection&&a.userAgent.match(/AppleWebKit\/(\d+)\./))r.browser="safari",r.version=parseInt(pu(a.userAgent,/AppleWebKit\/(\d+)\./,1)),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,r._safariVersion=pu(a.userAgent,/Version\/(\d+(\.?\d+))/,1);else return r.browser="Not a supported browser.",r;return r}function Mm(e){return Object.prototype.toString.call(e)==="[object Object]"}function nb(e){return Mm(e)?Object.keys(e).reduce(function(r,a){const o=Mm(e[a]),c=o?nb(e[a]):e[a],h=o&&!Object.keys(c).length;return c===void 0||h?r:Object.assign(r,{[a]:c})},{}):e}function ch(e,r,a){!r||a.has(r.id)||(a.set(r.id,r),Object.keys(r).forEach(o=>{o.endsWith("Id")?ch(e,e.get(r[o]),a):o.endsWith("Ids")&&r[o].forEach(c=>{ch(e,e.get(c),a)})}))}function Bm(e,r,a){const o=a?"outbound-rtp":"inbound-rtp",c=new Map;if(r===null)return c;const h=[];return e.forEach(m=>{m.type==="track"&&m.trackIdentifier===r.id&&h.push(m)}),h.forEach(m=>{e.forEach(x=>{x.type===o&&x.trackId===m.id&&ch(e,x,c)})}),c}const Nm=tb;function rb(e,r){const a=e&&e.navigator;if(!a.mediaDevices)return;const o=function(x){if(typeof x!="object"||x.mandatory||x.optional)return x;const _={};return Object.keys(x).forEach(y=>{if(y==="require"||y==="advanced"||y==="mediaSource")return;const S=typeof x[y]=="object"?x[y]:{ideal:x[y]};S.exact!==void 0&&typeof S.exact=="number"&&(S.min=S.max=S.exact);const R=function(B,N){return B?B+N.charAt(0).toUpperCase()+N.slice(1):N==="deviceId"?"sourceId":N};if(S.ideal!==void 0){_.optional=_.optional||[];let B={};typeof S.ideal=="number"?(B[R("min",y)]=S.ideal,_.optional.push(B),B={},B[R("max",y)]=S.ideal,_.optional.push(B)):(B[R("",y)]=S.ideal,_.optional.push(B))}S.exact!==void 0&&typeof S.exact!="number"?(_.mandatory=_.mandatory||{},_.mandatory[R("",y)]=S.exact):["min","max"].forEach(B=>{S[B]!==void 0&&(_.mandatory=_.mandatory||{},_.mandatory[R(B,y)]=S[B])})}),x.advanced&&(_.optional=(_.optional||[]).concat(x.advanced)),_},c=function(x,_){if(r.version>=61)return _(x);if(x=JSON.parse(JSON.stringify(x)),x&&typeof x.audio=="object"){const y=function(S,R,B){R in S&&!(B in S)&&(S[B]=S[R],delete S[R])};x=JSON.parse(JSON.stringify(x)),y(x.audio,"autoGainControl","googAutoGainControl"),y(x.audio,"noiseSuppression","googNoiseSuppression"),x.audio=o(x.audio)}if(x&&typeof x.video=="object"){let y=x.video.facingMode;y=y&&(typeof y=="object"?y:{ideal:y});const S=r.version<66;if(y&&(y.exact==="user"||y.exact==="environment"||y.ideal==="user"||y.ideal==="environment")&&!(a.mediaDevices.getSupportedConstraints&&a.mediaDevices.getSupportedConstraints().facingMode&&!S)){delete x.video.facingMode;let R;if(y.exact==="environment"||y.ideal==="environment"?R=["back","rear"]:(y.exact==="user"||y.ideal==="user")&&(R=["front"]),R)return a.mediaDevices.enumerateDevices().then(B=>{B=B.filter(k=>k.kind==="videoinput");let N=B.find(k=>R.some(z=>k.label.toLowerCase().includes(z)));return!N&&B.length&&R.includes("back")&&(N=B[B.length-1]),N&&(x.video.deviceId=y.exact?{exact:N.deviceId}:{ideal:N.deviceId}),x.video=o(x.video),Nm("chrome: "+JSON.stringify(x)),_(x)})}x.video=o(x.video)}return Nm("chrome: "+JSON.stringify(x)),_(x)},h=function(x){return r.version>=64?x:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[x.name]||x.name,message:x.message,constraint:x.constraint||x.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},m=function(x,_,y){c(x,S=>{a.webkitGetUserMedia(S,_,R=>{y&&y(h(R))})})};if(a.getUserMedia=m.bind(a),a.mediaDevices.getUserMedia){const x=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(_){return c(_,y=>x(y).then(S=>{if(y.audio&&!S.getAudioTracks().length||y.video&&!S.getVideoTracks().length)throw S.getTracks().forEach(R=>{R.stop()}),new DOMException("","NotFoundError");return S},S=>Promise.reject(h(S))))}}}function ib(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function ab(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(a){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=o=>{o.stream.addEventListener("addtrack",c=>{let h;e.RTCPeerConnection.prototype.getReceivers?h=this.getReceivers().find(x=>x.track&&x.track.id===c.track.id):h={track:c.track};const m=new Event("track");m.track=c.track,m.receiver=h,m.transceiver={receiver:h},m.streams=[o.stream],this.dispatchEvent(m)}),o.stream.getTracks().forEach(c=>{let h;e.RTCPeerConnection.prototype.getReceivers?h=this.getReceivers().find(x=>x.track&&x.track.id===c.id):h={track:c};const m=new Event("track");m.track=c,m.receiver=h,m.transceiver={receiver:h},m.streams=[o.stream],this.dispatchEvent(m)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else Lo(e,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function sb(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const r=function(c,h){return{track:h,get dtmf(){return this._dtmf===void 0&&(h.kind==="audio"?this._dtmf=c.createDTMFSender(h):this._dtmf=null),this._dtmf},_pc:c}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const c=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(x,_){let y=c.apply(this,arguments);return y||(y=r(this,x),this._senders.push(y)),y};const h=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(x){h.apply(this,arguments);const _=this._senders.indexOf(x);_!==-1&&this._senders.splice(_,1)}}const a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(h){this._senders=this._senders||[],a.apply(this,[h]),h.getTracks().forEach(m=>{this._senders.push(r(this,m))})};const o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(h){this._senders=this._senders||[],o.apply(this,[h]),h.getTracks().forEach(m=>{const x=this._senders.find(_=>_.track===m);x&&this._senders.splice(this._senders.indexOf(x),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const o=r.apply(this,[]);return o.forEach(c=>c._pc=this),o},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ob(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const a=e.RTCPeerConnection.prototype.getSenders;a&&(e.RTCPeerConnection.prototype.getSenders=function(){const h=a.apply(this,[]);return h.forEach(m=>m._pc=this),h});const o=e.RTCPeerConnection.prototype.addTrack;o&&(e.RTCPeerConnection.prototype.addTrack=function(){const h=o.apply(this,arguments);return h._pc=this,h}),e.RTCRtpSender.prototype.getStats=function(){const h=this;return this._pc.getStats().then(m=>Bm(m,h.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const a=e.RTCPeerConnection.prototype.getReceivers;a&&(e.RTCPeerConnection.prototype.getReceivers=function(){const c=a.apply(this,[]);return c.forEach(h=>h._pc=this),c}),Lo(e,"track",o=>(o.receiver._pc=o.srcElement,o)),e.RTCRtpReceiver.prototype.getStats=function(){const c=this;return this._pc.getStats().then(h=>Bm(h,c.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const o=arguments[0];let c,h,m;return this.getSenders().forEach(x=>{x.track===o&&(c?m=!0:c=x)}),this.getReceivers().forEach(x=>(x.track===o&&(h?m=!0:h=x),x.track===o)),m||c&&h?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():h?h.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function lb(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(m=>this._shimmedLocalStreams[m][0])};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(m,x){if(!x)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const _=r.apply(this,arguments);return this._shimmedLocalStreams[x.id]?this._shimmedLocalStreams[x.id].indexOf(_)===-1&&this._shimmedLocalStreams[x.id].push(_):this._shimmedLocalStreams[x.id]=[x,_],_};const a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(m){this._shimmedLocalStreams=this._shimmedLocalStreams||{},m.getTracks().forEach(y=>{if(this.getSenders().find(R=>R.track===y))throw new DOMException("Track already exists.","InvalidAccessError")});const x=this.getSenders();a.apply(this,arguments);const _=this.getSenders().filter(y=>x.indexOf(y)===-1);this._shimmedLocalStreams[m.id]=[m].concat(_)};const o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(m){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[m.id],o.apply(this,arguments)};const c=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(m){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},m&&Object.keys(this._shimmedLocalStreams).forEach(x=>{const _=this._shimmedLocalStreams[x].indexOf(m);_!==-1&&this._shimmedLocalStreams[x].splice(_,1),this._shimmedLocalStreams[x].length===1&&delete this._shimmedLocalStreams[x]}),c.apply(this,arguments)}}function ub(e,r){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&r.version>=65)return lb(e);const a=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const S=a.apply(this);return this._reverseStreams=this._reverseStreams||{},S.map(R=>this._reverseStreams[R.id])};const o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(S){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},S.getTracks().forEach(R=>{if(this.getSenders().find(N=>N.track===R))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[S.id]){const R=new e.MediaStream(S.getTracks());this._streams[S.id]=R,this._reverseStreams[R.id]=S,S=R}o.apply(this,[S])};const c=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(S){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[S.id]||S]),delete this._reverseStreams[this._streams[S.id]?this._streams[S.id].id:S.id],delete this._streams[S.id]},e.RTCPeerConnection.prototype.addTrack=function(S,R){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const B=[].slice.call(arguments,1);if(B.length!==1||!B[0].getTracks().find(z=>z===S))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(z=>z.track===S))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const k=this._streams[R.id];if(k)k.addTrack(S),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const z=new e.MediaStream([S]);this._streams[R.id]=z,this._reverseStreams[z.id]=R,this.addStream(z)}return this.getSenders().find(z=>z.track===S)};function h(y,S){let R=S.sdp;return Object.keys(y._reverseStreams||[]).forEach(B=>{const N=y._reverseStreams[B],k=y._streams[N.id];R=R.replace(new RegExp(k.id,"g"),N.id)}),new RTCSessionDescription({type:S.type,sdp:R})}function m(y,S){let R=S.sdp;return Object.keys(y._reverseStreams||[]).forEach(B=>{const N=y._reverseStreams[B],k=y._streams[N.id];R=R.replace(new RegExp(N.id,"g"),k.id)}),new RTCSessionDescription({type:S.type,sdp:R})}["createOffer","createAnswer"].forEach(function(y){const S=e.RTCPeerConnection.prototype[y],R={[y](){const B=arguments;return arguments.length&&typeof arguments[0]=="function"?S.apply(this,[k=>{const z=h(this,k);B[0].apply(null,[z])},k=>{B[1]&&B[1].apply(null,k)},arguments[2]]):S.apply(this,arguments).then(k=>h(this,k))}};e.RTCPeerConnection.prototype[y]=R[y]});const x=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?x.apply(this,arguments):(arguments[0]=m(this,arguments[0]),x.apply(this,arguments))};const _=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const y=_.get.apply(this);return y.type===""?y:h(this,y)}}),e.RTCPeerConnection.prototype.removeTrack=function(S){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!S._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(S._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let B;Object.keys(this._streams).forEach(N=>{this._streams[N].getTracks().find(z=>S.track===z)&&(B=this._streams[N])}),B&&(B.getTracks().length===1?this.removeStream(this._reverseStreams[B.id]):B.removeTrack(S.track),this.dispatchEvent(new Event("negotiationneeded")))}}function fh(e,r){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const o=e.RTCPeerConnection.prototype[a],c={[a](){return arguments[0]=new(a==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};e.RTCPeerConnection.prototype[a]=c[a]})}function cb(e,r){Lo(e,"negotiationneeded",a=>{const o=a.target;if(!((r.version<72||o.getConfiguration&&o.getConfiguration().sdpSemantics==="plan-b")&&o.signalingState!=="stable"))return a})}const km=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:cb,shimAddTrackRemoveTrack:ub,shimAddTrackRemoveTrackWithNative:lb,shimGetSendersWithDtmf:sb,shimGetUserMedia:rb,shimMediaStream:ib,shimOnTrack:ab,shimPeerConnection:fh,shimSenderReceiverGetStats:ob},Symbol.toStringTag,{value:"Module"}));function fb(e,r){const a=e&&e.navigator,o=e&&e.MediaStreamTrack;if(a.getUserMedia=function(c,h,m){Uh("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),a.mediaDevices.getUserMedia(c).then(h,m)},!(r.version>55&&"autoGainControl"in a.mediaDevices.getSupportedConstraints())){const c=function(m,x,_){x in m&&!(_ in m)&&(m[_]=m[x],delete m[x])},h=a.mediaDevices.getUserMedia.bind(a.mediaDevices);if(a.mediaDevices.getUserMedia=function(m){return typeof m=="object"&&typeof m.audio=="object"&&(m=JSON.parse(JSON.stringify(m)),c(m.audio,"autoGainControl","mozAutoGainControl"),c(m.audio,"noiseSuppression","mozNoiseSuppression")),h(m)},o&&o.prototype.getSettings){const m=o.prototype.getSettings;o.prototype.getSettings=function(){const x=m.apply(this,arguments);return c(x,"mozAutoGainControl","autoGainControl"),c(x,"mozNoiseSuppression","noiseSuppression"),x}}if(o&&o.prototype.applyConstraints){const m=o.prototype.applyConstraints;o.prototype.applyConstraints=function(x){return this.kind==="audio"&&typeof x=="object"&&(x=JSON.parse(JSON.stringify(x)),c(x,"autoGainControl","mozAutoGainControl"),c(x,"noiseSuppression","mozNoiseSuppression")),m.apply(this,[x])}}}}function VE(e,r){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(o){if(!(o&&o.video)){const c=new DOMException("getDisplayMedia without video constraints is undefined");return c.name="NotFoundError",c.code=8,Promise.reject(c)}return o.video===!0?o.video={mediaSource:r}:o.video.mediaSource=r,e.navigator.mediaDevices.getUserMedia(o)})}function db(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function dh(e,r){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const h=e.RTCPeerConnection.prototype[c],m={[c](){return arguments[0]=new(c==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),h.apply(this,arguments)}};e.RTCPeerConnection.prototype[c]=m[c]});const a={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[h,m,x]=arguments;return o.apply(this,[h||null]).then(_=>{if(r.version<53&&!m)try{_.forEach(y=>{y.type=a[y.type]||y.type})}catch(y){if(y.name!=="TypeError")throw y;_.forEach((S,R)=>{_.set(R,Object.assign({},S,{type:a[S.type]||S.type}))})}return _}).then(m,x)}}function hb(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const c=r.apply(this,[]);return c.forEach(h=>h._pc=this),c});const a=e.RTCPeerConnection.prototype.addTrack;a&&(e.RTCPeerConnection.prototype.addTrack=function(){const c=a.apply(this,arguments);return c._pc=this,c}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function pb(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const o=r.apply(this,[]);return o.forEach(c=>c._pc=this),o}),Lo(e,"track",a=>(a.receiver._pc=a.srcElement,a)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function gb(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(a){Uh("removeStream","removeTrack"),this.getSenders().forEach(o=>{o.track&&a.getTracks().includes(o.track)&&this.removeTrack(o)})})}function mb(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function xb(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.addTransceiver;r&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let o=arguments[1]&&arguments[1].sendEncodings;o===void 0&&(o=[]),o=[...o];const c=o.length>0;c&&o.forEach(m=>{if("rid"in m&&!/^[a-z0-9]{0,16}$/i.test(m.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in m&&!(parseFloat(m.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in m&&!(parseFloat(m.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const h=r.apply(this,arguments);if(c){const{sender:m}=h,x=m.getParameters();(!("encodings"in x)||x.encodings.length===1&&Object.keys(x.encodings[0]).length===0)&&(x.encodings=o,m.sendEncodings=o,this.setParametersPromises.push(m.setParameters(x).then(()=>{delete m.sendEncodings}).catch(()=>{delete m.sendEncodings})))}return h})}function yb(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const r=e.RTCRtpSender.prototype.getParameters;r&&(e.RTCRtpSender.prototype.getParameters=function(){const o=r.apply(this,arguments);return"encodings"in o||(o.encodings=[].concat(this.sendEncodings||[{}])),o})}function wb(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function bb(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}const $m=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:xb,shimCreateAnswer:bb,shimCreateOffer:wb,shimGetDisplayMedia:VE,shimGetParameters:yb,shimGetUserMedia:fb,shimOnTrack:db,shimPeerConnection:dh,shimRTCDataChannel:mb,shimReceiverGetStats:pb,shimRemoveStream:gb,shimSenderGetStats:hb},Symbol.toStringTag,{value:"Module"}));function vb(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(o){this._localStreams||(this._localStreams=[]),this._localStreams.includes(o)||this._localStreams.push(o),o.getAudioTracks().forEach(c=>r.call(this,c,o)),o.getVideoTracks().forEach(c=>r.call(this,c,o))},e.RTCPeerConnection.prototype.addTrack=function(o,...c){return c&&c.forEach(h=>{this._localStreams?this._localStreams.includes(h)||this._localStreams.push(h):this._localStreams=[h]}),r.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);const o=this._localStreams.indexOf(a);if(o===-1)return;this._localStreams.splice(o,1);const c=a.getTracks();this.getSenders().forEach(h=>{c.includes(h.track)&&this.removeTrack(h)})})}}function _b(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(a){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=a),this.addEventListener("track",this._onaddstreampoly=o=>{o.streams.forEach(c=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(c))return;this._remoteStreams.push(c);const h=new Event("addstream");h.stream=c,this.dispatchEvent(h)})})}});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const o=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(h=>{if(o._remoteStreams||(o._remoteStreams=[]),o._remoteStreams.indexOf(h)>=0)return;o._remoteStreams.push(h);const m=new Event("addstream");m.stream=h,o.dispatchEvent(m)})}),r.apply(o,arguments)}}}function Cb(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,a=r.createOffer,o=r.createAnswer,c=r.setLocalDescription,h=r.setRemoteDescription,m=r.addIceCandidate;r.createOffer=function(y,S){const R=arguments.length>=2?arguments[2]:arguments[0],B=a.apply(this,[R]);return S?(B.then(y,S),Promise.resolve()):B},r.createAnswer=function(y,S){const R=arguments.length>=2?arguments[2]:arguments[0],B=o.apply(this,[R]);return S?(B.then(y,S),Promise.resolve()):B};let x=function(_,y,S){const R=c.apply(this,[_]);return S?(R.then(y,S),Promise.resolve()):R};r.setLocalDescription=x,x=function(_,y,S){const R=h.apply(this,[_]);return S?(R.then(y,S),Promise.resolve()):R},r.setRemoteDescription=x,x=function(_,y,S){const R=m.apply(this,[_]);return S?(R.then(y,S),Promise.resolve()):R},r.addIceCandidate=x}function Ab(e){const r=e&&e.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const a=r.mediaDevices,o=a.getUserMedia.bind(a);r.mediaDevices.getUserMedia=c=>o(Eb(c))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=(function(o,c,h){r.mediaDevices.getUserMedia(o).then(c,h)}).bind(r))}function Eb(e){return e&&e.video!==void 0?Object.assign({},e,{video:nb(e.video)}):e}function Tb(e){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection;e.RTCPeerConnection=function(o,c){if(o&&o.iceServers){const h=[];for(let m=0;m<o.iceServers.length;m++){let x=o.iceServers[m];x.urls===void 0&&x.url?(Uh("RTCIceServer.url","RTCIceServer.urls"),x=JSON.parse(JSON.stringify(x)),x.urls=x.url,delete x.url,h.push(x)):h.push(o.iceServers[m])}o.iceServers=h}return new r(o,c)},e.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return r.generateCertificate}})}function Sb(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ib(e){const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(o){if(o){typeof o.offerToReceiveAudio<"u"&&(o.offerToReceiveAudio=!!o.offerToReceiveAudio);const c=this.getTransceivers().find(m=>m.receiver.track.kind==="audio");o.offerToReceiveAudio===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):o.offerToReceiveAudio===!0&&!c&&this.addTransceiver("audio",{direction:"recvonly"}),typeof o.offerToReceiveVideo<"u"&&(o.offerToReceiveVideo=!!o.offerToReceiveVideo);const h=this.getTransceivers().find(m=>m.receiver.track.kind==="video");o.offerToReceiveVideo===!1&&h?h.direction==="sendrecv"?h.setDirection?h.setDirection("sendonly"):h.direction="sendonly":h.direction==="recvonly"&&(h.setDirection?h.setDirection("inactive"):h.direction="inactive"):o.offerToReceiveVideo===!0&&!h&&this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function Rb(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const Lm=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Rb,shimCallbacksAPI:Cb,shimConstraints:Eb,shimCreateOfferLegacy:Ib,shimGetUserMedia:Ab,shimLocalStreamsAPI:vb,shimRTCIceServerUrls:Tb,shimRemoteStreamsAPI:_b,shimTrackEventTransceiver:Sb},Symbol.toStringTag,{value:"Module"}));var s0={exports:{}},zm;function qE(){return zm||(zm=1,(function(e){const r={};r.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},r.localCName=r.generateIdentifier(),r.splitLines=function(a){return a.trim().split(`
`).map(o=>o.trim())},r.splitSections=function(a){return a.split(`
m=`).map((c,h)=>(h>0?"m="+c:c).trim()+`\r
`)},r.getDescription=function(a){const o=r.splitSections(a);return o&&o[0]},r.getMediaSections=function(a){const o=r.splitSections(a);return o.shift(),o},r.matchPrefix=function(a,o){return r.splitLines(a).filter(c=>c.indexOf(o)===0)},r.parseCandidate=function(a){let o;a.indexOf("a=candidate:")===0?o=a.substring(12).split(" "):o=a.substring(10).split(" ");const c={foundation:o[0],component:{1:"rtp",2:"rtcp"}[o[1]]||o[1],protocol:o[2].toLowerCase(),priority:parseInt(o[3],10),ip:o[4],address:o[4],port:parseInt(o[5],10),type:o[7]};for(let h=8;h<o.length;h+=2)switch(o[h]){case"raddr":c.relatedAddress=o[h+1];break;case"rport":c.relatedPort=parseInt(o[h+1],10);break;case"tcptype":c.tcpType=o[h+1];break;case"ufrag":c.ufrag=o[h+1],c.usernameFragment=o[h+1];break;default:c[o[h]]===void 0&&(c[o[h]]=o[h+1]);break}return c},r.writeCandidate=function(a){const o=[];o.push(a.foundation);const c=a.component;c==="rtp"?o.push(1):c==="rtcp"?o.push(2):o.push(c),o.push(a.protocol.toUpperCase()),o.push(a.priority),o.push(a.address||a.ip),o.push(a.port);const h=a.type;return o.push("typ"),o.push(h),h!=="host"&&a.relatedAddress&&a.relatedPort&&(o.push("raddr"),o.push(a.relatedAddress),o.push("rport"),o.push(a.relatedPort)),a.tcpType&&a.protocol.toLowerCase()==="tcp"&&(o.push("tcptype"),o.push(a.tcpType)),(a.usernameFragment||a.ufrag)&&(o.push("ufrag"),o.push(a.usernameFragment||a.ufrag)),"candidate:"+o.join(" ")},r.parseIceOptions=function(a){return a.substring(14).split(" ")},r.parseRtpMap=function(a){let o=a.substring(9).split(" ");const c={payloadType:parseInt(o.shift(),10)};return o=o[0].split("/"),c.name=o[0],c.clockRate=parseInt(o[1],10),c.channels=o.length===3?parseInt(o[2],10):1,c.numChannels=c.channels,c},r.writeRtpMap=function(a){let o=a.payloadType;a.preferredPayloadType!==void 0&&(o=a.preferredPayloadType);const c=a.channels||a.numChannels||1;return"a=rtpmap:"+o+" "+a.name+"/"+a.clockRate+(c!==1?"/"+c:"")+`\r
`},r.parseExtmap=function(a){const o=a.substring(9).split(" ");return{id:parseInt(o[0],10),direction:o[0].indexOf("/")>0?o[0].split("/")[1]:"sendrecv",uri:o[1],attributes:o.slice(2).join(" ")}},r.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&a.direction!=="sendrecv"?"/"+a.direction:"")+" "+a.uri+(a.attributes?" "+a.attributes:"")+`\r
`},r.parseFmtp=function(a){const o={};let c;const h=a.substring(a.indexOf(" ")+1).split(";");for(let m=0;m<h.length;m++)c=h[m].trim().split("="),o[c[0].trim()]=c[1];return o},r.writeFmtp=function(a){let o="",c=a.payloadType;if(a.preferredPayloadType!==void 0&&(c=a.preferredPayloadType),a.parameters&&Object.keys(a.parameters).length){const h=[];Object.keys(a.parameters).forEach(m=>{a.parameters[m]!==void 0?h.push(m+"="+a.parameters[m]):h.push(m)}),o+="a=fmtp:"+c+" "+h.join(";")+`\r
`}return o},r.parseRtcpFb=function(a){const o=a.substring(a.indexOf(" ")+1).split(" ");return{type:o.shift(),parameter:o.join(" ")}},r.writeRtcpFb=function(a){let o="",c=a.payloadType;return a.preferredPayloadType!==void 0&&(c=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(h=>{o+="a=rtcp-fb:"+c+" "+h.type+(h.parameter&&h.parameter.length?" "+h.parameter:"")+`\r
`}),o},r.parseSsrcMedia=function(a){const o=a.indexOf(" "),c={ssrc:parseInt(a.substring(7,o),10)},h=a.indexOf(":",o);return h>-1?(c.attribute=a.substring(o+1,h),c.value=a.substring(h+1)):c.attribute=a.substring(o+1),c},r.parseSsrcGroup=function(a){const o=a.substring(13).split(" ");return{semantics:o.shift(),ssrcs:o.map(c=>parseInt(c,10))}},r.getMid=function(a){const o=r.matchPrefix(a,"a=mid:")[0];if(o)return o.substring(6)},r.parseFingerprint=function(a){const o=a.substring(14).split(" ");return{algorithm:o[0].toLowerCase(),value:o[1].toUpperCase()}},r.getDtlsParameters=function(a,o){return{role:"auto",fingerprints:r.matchPrefix(a+o,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(a,o){let c="a=setup:"+o+`\r
`;return a.fingerprints.forEach(h=>{c+="a=fingerprint:"+h.algorithm+" "+h.value+`\r
`}),c},r.parseCryptoLine=function(a){const o=a.substring(9).split(" ");return{tag:parseInt(o[0],10),cryptoSuite:o[1],keyParams:o[2],sessionParams:o.slice(3)}},r.writeCryptoLine=function(a){return"a=crypto:"+a.tag+" "+a.cryptoSuite+" "+(typeof a.keyParams=="object"?r.writeCryptoKeyParams(a.keyParams):a.keyParams)+(a.sessionParams?" "+a.sessionParams.join(" "):"")+`\r
`},r.parseCryptoKeyParams=function(a){if(a.indexOf("inline:")!==0)return null;const o=a.substring(7).split("|");return{keyMethod:"inline",keySalt:o[0],lifeTime:o[1],mkiValue:o[2]?o[2].split(":")[0]:void 0,mkiLength:o[2]?o[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(a){return a.keyMethod+":"+a.keySalt+(a.lifeTime?"|"+a.lifeTime:"")+(a.mkiValue&&a.mkiLength?"|"+a.mkiValue+":"+a.mkiLength:"")},r.getCryptoParameters=function(a,o){return r.matchPrefix(a+o,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(a,o){const c=r.matchPrefix(a+o,"a=ice-ufrag:")[0],h=r.matchPrefix(a+o,"a=ice-pwd:")[0];return c&&h?{usernameFragment:c.substring(12),password:h.substring(10)}:null},r.writeIceParameters=function(a){let o="a=ice-ufrag:"+a.usernameFragment+`\r
a=ice-pwd:`+a.password+`\r
`;return a.iceLite&&(o+=`a=ice-lite\r
`),o},r.parseRtpParameters=function(a){const o={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},h=r.splitLines(a)[0].split(" ");o.profile=h[2];for(let x=3;x<h.length;x++){const _=h[x],y=r.matchPrefix(a,"a=rtpmap:"+_+" ")[0];if(y){const S=r.parseRtpMap(y),R=r.matchPrefix(a,"a=fmtp:"+_+" ");switch(S.parameters=R.length?r.parseFmtp(R[0]):{},S.rtcpFeedback=r.matchPrefix(a,"a=rtcp-fb:"+_+" ").map(r.parseRtcpFb),o.codecs.push(S),S.name.toUpperCase()){case"RED":case"ULPFEC":o.fecMechanisms.push(S.name.toUpperCase());break}}}r.matchPrefix(a,"a=extmap:").forEach(x=>{o.headerExtensions.push(r.parseExtmap(x))});const m=r.matchPrefix(a,"a=rtcp-fb:* ").map(r.parseRtcpFb);return o.codecs.forEach(x=>{m.forEach(_=>{x.rtcpFeedback.find(S=>S.type===_.type&&S.parameter===_.parameter)||x.rtcpFeedback.push(_)})}),o},r.writeRtpDescription=function(a,o){let c="";c+="m="+a+" ",c+=o.codecs.length>0?"9":"0",c+=" "+(o.profile||"UDP/TLS/RTP/SAVPF")+" ",c+=o.codecs.map(m=>m.preferredPayloadType!==void 0?m.preferredPayloadType:m.payloadType).join(" ")+`\r
`,c+=`c=IN IP4 0.0.0.0\r
`,c+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,o.codecs.forEach(m=>{c+=r.writeRtpMap(m),c+=r.writeFmtp(m),c+=r.writeRtcpFb(m)});let h=0;return o.codecs.forEach(m=>{m.maxptime>h&&(h=m.maxptime)}),h>0&&(c+="a=maxptime:"+h+`\r
`),o.headerExtensions&&o.headerExtensions.forEach(m=>{c+=r.writeExtmap(m)}),c},r.parseRtpEncodingParameters=function(a){const o=[],c=r.parseRtpParameters(a),h=c.fecMechanisms.indexOf("RED")!==-1,m=c.fecMechanisms.indexOf("ULPFEC")!==-1,x=r.matchPrefix(a,"a=ssrc:").map(B=>r.parseSsrcMedia(B)).filter(B=>B.attribute==="cname"),_=x.length>0&&x[0].ssrc;let y;const S=r.matchPrefix(a,"a=ssrc-group:FID").map(B=>B.substring(17).split(" ").map(k=>parseInt(k,10)));S.length>0&&S[0].length>1&&S[0][0]===_&&(y=S[0][1]),c.codecs.forEach(B=>{if(B.name.toUpperCase()==="RTX"&&B.parameters.apt){let N={ssrc:_,codecPayloadType:parseInt(B.parameters.apt,10)};_&&y&&(N.rtx={ssrc:y}),o.push(N),h&&(N=JSON.parse(JSON.stringify(N)),N.fec={ssrc:_,mechanism:m?"red+ulpfec":"red"},o.push(N))}}),o.length===0&&_&&o.push({ssrc:_});let R=r.matchPrefix(a,"b=");return R.length&&(R[0].indexOf("b=TIAS:")===0?R=parseInt(R[0].substring(7),10):R[0].indexOf("b=AS:")===0?R=parseInt(R[0].substring(5),10)*1e3*.95-2e3*8:R=void 0,o.forEach(B=>{B.maxBitrate=R})),o},r.parseRtcpParameters=function(a){const o={},c=r.matchPrefix(a,"a=ssrc:").map(x=>r.parseSsrcMedia(x)).filter(x=>x.attribute==="cname")[0];c&&(o.cname=c.value,o.ssrc=c.ssrc);const h=r.matchPrefix(a,"a=rtcp-rsize");o.reducedSize=h.length>0,o.compound=h.length===0;const m=r.matchPrefix(a,"a=rtcp-mux");return o.mux=m.length>0,o},r.writeRtcpParameters=function(a){let o="";return a.reducedSize&&(o+=`a=rtcp-rsize\r
`),a.mux&&(o+=`a=rtcp-mux\r
`),a.ssrc!==void 0&&a.cname&&(o+="a=ssrc:"+a.ssrc+" cname:"+a.cname+`\r
`),o},r.parseMsid=function(a){let o;const c=r.matchPrefix(a,"a=msid:");if(c.length===1)return o=c[0].substring(7).split(" "),{stream:o[0],track:o[1]};const h=r.matchPrefix(a,"a=ssrc:").map(m=>r.parseSsrcMedia(m)).filter(m=>m.attribute==="msid");if(h.length>0)return o=h[0].value.split(" "),{stream:o[0],track:o[1]}},r.parseSctpDescription=function(a){const o=r.parseMLine(a),c=r.matchPrefix(a,"a=max-message-size:");let h;c.length>0&&(h=parseInt(c[0].substring(19),10)),isNaN(h)&&(h=65536);const m=r.matchPrefix(a,"a=sctp-port:");if(m.length>0)return{port:parseInt(m[0].substring(12),10),protocol:o.fmt,maxMessageSize:h};const x=r.matchPrefix(a,"a=sctpmap:");if(x.length>0){const _=x[0].substring(10).split(" ");return{port:parseInt(_[0],10),protocol:_[1],maxMessageSize:h}}},r.writeSctpDescription=function(a,o){let c=[];return a.protocol!=="DTLS/SCTP"?c=["m="+a.kind+" 9 "+a.protocol+" "+o.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+o.port+`\r
`]:c=["m="+a.kind+" 9 "+a.protocol+" "+o.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+o.port+" "+o.protocol+` 65535\r
`],o.maxMessageSize!==void 0&&c.push("a=max-message-size:"+o.maxMessageSize+`\r
`),c.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,22)},r.writeSessionBoilerplate=function(a,o,c){let h;const m=o!==void 0?o:2;return a?h=a:h=r.generateSessionId(),`v=0\r
o=`+(c||"thisisadapterortc")+" "+h+" "+m+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},r.getDirection=function(a,o){const c=r.splitLines(a);for(let h=0;h<c.length;h++)switch(c[h]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[h].substring(2)}return o?r.getDirection(o):"sendrecv"},r.getKind=function(a){return r.splitLines(a)[0].split(" ")[0].substring(2)},r.isRejected=function(a){return a.split(" ",2)[1]==="0"},r.parseMLine=function(a){const c=r.splitLines(a)[0].substring(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},r.parseOLine=function(a){const c=r.matchPrefix(a,"o=")[0].substring(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},r.isValidSDP=function(a){if(typeof a!="string"||a.length===0)return!1;const o=r.splitLines(a);for(let c=0;c<o.length;c++)if(o[c].length<2||o[c].charAt(1)!=="=")return!1;return!0},e.exports=r})(s0)),s0.exports}var Ob=qE();const gl=zh(Ob),jE=PA({__proto__:null,default:gl},[Ob]);function Pc(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const r=e.RTCIceCandidate;e.RTCIceCandidate=function(o){if(typeof o=="object"&&o.candidate&&o.candidate.indexOf("a=")===0&&(o=JSON.parse(JSON.stringify(o)),o.candidate=o.candidate.substring(2)),o.candidate&&o.candidate.length){const c=new r(o),h=gl.parseCandidate(o.candidate);for(const m in h)m in c||Object.defineProperty(c,m,{value:h[m]});return c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}},c}return new r(o)},e.RTCIceCandidate.prototype=r.prototype,Lo(e,"icecandidate",a=>(a.candidate&&Object.defineProperty(a,"candidate",{value:new e.RTCIceCandidate(a.candidate),writable:"false"}),a))}function hh(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Lo(e,"icecandidate",r=>{if(r.candidate){const a=gl.parseCandidate(r.candidate.candidate);a.type==="relay"&&(r.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[a.priority>>24])}return r})}function Fc(e,r){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const a=function(x){if(!x||!x.sdp)return!1;const _=gl.splitSections(x.sdp);return _.shift(),_.some(y=>{const S=gl.parseMLine(y);return S&&S.kind==="application"&&S.protocol.indexOf("SCTP")!==-1})},o=function(x){const _=x.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_===null||_.length<2)return-1;const y=parseInt(_[1],10);return y!==y?-1:y},c=function(x){let _=65536;return r.browser==="firefox"&&(r.version<57?x===-1?_=16384:_=2147483637:r.version<60?_=r.version===57?65535:65536:_=2147483637),_},h=function(x,_){let y=65536;r.browser==="firefox"&&r.version===57&&(y=65535);const S=gl.matchPrefix(x.sdp,"a=max-message-size:");return S.length>0?y=parseInt(S[0].substring(19),10):r.browser==="firefox"&&_!==-1&&(y=2147483637),y},m=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:_}=this.getConfiguration();_==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(a(arguments[0])){const _=o(arguments[0]),y=c(_),S=h(arguments[0],_);let R;y===0&&S===0?R=Number.POSITIVE_INFINITY:y===0||S===0?R=Math.max(y,S):R=Math.min(y,S);const B={};Object.defineProperty(B,"maxMessageSize",{get(){return R}}),this._sctp=B}return m.apply(this,arguments)}}function Gc(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function r(o,c){const h=o.send;o.send=function(){const x=arguments[0],_=x.length||x.size||x.byteLength;if(o.readyState==="open"&&c.sctp&&_>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return h.apply(o,arguments)}}const a=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const c=a.apply(this,arguments);return r(c,this),c},Lo(e,"datachannel",o=>(r(o.channel,o.target),o))}function ph(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(a=>{const o=r[a];r[a]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=c=>{const h=c.target;if(h._lastConnectionState!==h.connectionState){h._lastConnectionState=h.connectionState;const m=new Event("connectionstatechange",c);h.dispatchEvent(m)}return c},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),o.apply(this,arguments)}})}function gh(e,r){if(!e.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r._safariVersion>=13.1)return;const a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(c){if(c&&c.sdp&&c.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const h=c.sdp.split(`
`).filter(m=>m.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&c instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:c.type,sdp:h}):c.sdp=h}return a.apply(this,arguments)}}function Vc(e,r){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const a=e.RTCPeerConnection.prototype.addIceCandidate;!a||a.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():a.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function qc(e,r){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const a=e.RTCPeerConnection.prototype.setLocalDescription;!a||a.length===0||(e.RTCPeerConnection.prototype.setLocalDescription=function(){let c=arguments[0]||{};if(typeof c!="object"||c.type&&c.sdp)return a.apply(this,arguments);if(c={type:c.type,sdp:c.sdp},!c.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":c.type="offer";break;default:c.type="answer";break}return c.sdp||c.type!=="offer"&&c.type!=="answer"?a.apply(this,[c]):(c.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(m=>a.apply(this,[m]))})}const HE=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:gh,shimAddIceCandidateNullOrEmpty:Vc,shimConnectionState:ph,shimMaxMessageSize:Fc,shimParameterlessSetLocalDescription:qc,shimRTCIceCandidate:Pc,shimRTCIceCandidateRelayProtocol:hh,shimSendThrowTypeError:Gc},Symbol.toStringTag,{value:"Module"}));function YE({window:e}={},r={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const a=tb,o=GE(e),c={browserDetails:o,commonShim:HE,extractVersion:pu,disableLog:PE,disableWarnings:FE,sdp:jE};switch(o.browser){case"chrome":if(!km||!fh||!r.shimChrome)return a("Chrome shim is not included in this adapter release."),c;if(o.version===null)return a("Chrome shim can not determine version, not shimming."),c;a("adapter.js shimming chrome."),c.browserShim=km,Vc(e,o),qc(e),rb(e,o),ib(e),fh(e,o),ab(e),ub(e,o),sb(e),ob(e),cb(e,o),Pc(e),hh(e),ph(e),Fc(e,o),Gc(e),gh(e,o);break;case"firefox":if(!$m||!dh||!r.shimFirefox)return a("Firefox shim is not included in this adapter release."),c;a("adapter.js shimming firefox."),c.browserShim=$m,Vc(e,o),qc(e),fb(e,o),dh(e,o),db(e),gb(e),hb(e),pb(e),mb(e),xb(e),yb(e),wb(e),bb(e),Pc(e),ph(e),Fc(e,o),Gc(e);break;case"safari":if(!Lm||!r.shimSafari)return a("Safari shim is not included in this adapter release."),c;a("adapter.js shimming safari."),c.browserShim=Lm,Vc(e,o),qc(e),Tb(e),Ib(e),Cb(e),vb(e),_b(e),Sb(e),Ab(e),Rb(e),Pc(e),hh(e),Fc(e,o),Gc(e),gh(e,o);break;default:a("Unsupported browser!");break}return c}YE({window:typeof window>"u"?void 0:window});const WE={finder:!0,torch:!0,tracker:void 0,onOff:!1,zoom:!1},KE={facingMode:"environment",width:{min:640,ideal:720,max:1920},height:{min:640,ideal:720,max:1080}},QE={width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",aspectRatio:"1/1"},XE={width:"100%",height:"100%",objectFit:"cover",overflow:"hidden"};var gu=e=>e instanceof Date,Db=e=>e==null;const Mb=e=>typeof e=="object";var Um=e=>!Db(e)&&!Array.isArray(e)&&Mb(e)&&!gu(e),Pm=e=>Db(e)||!Mb(e);function Bb(e,r){if(Pm(e)||Pm(r))return e===r;if(gu(e)&&gu(r))return e.getTime()===r.getTime();const a=e,o=r,c=Object.keys(a),h=Object.keys(o);if(c.length!==h.length)return!1;for(const m of c){const x=a[m];if(!h.includes(m))return!1;if(m!=="ref"){const _=o[m];if(gu(x)&&gu(_)||Um(x)&&Um(_)||Array.isArray(x)&&Array.isArray(_)?!Bb(x,_):x!==_)return!1}}return!0}function ZE(e){const{onClick:r,disabled:a,className:o}=e,c={cursor:a?"default":"pointer",stroke:a?"grey":"yellow",strokeLineJoin:"round",strokeLineCap:"round",strokeWidth:1.5,...e.style};return ie.jsxs("svg",{onClick:a?void 0:r,className:o,style:c,width:"28px",height:"28px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ie.jsx("title",{children:"Camera Off"}),ie.jsx("path",{d:"M3 3L6.00007 6.00007M21 21L19.8455 19.8221M9.74194 4.06811C9.83646 4.04279 9.93334 4.02428 10.0319 4.01299C10.1453 4 10.2683 4 10.5141 4H13.5327C13.7786 4 13.9015 4 14.015 4.01299C14.6068 4.08078 15.1375 4.40882 15.4628 4.90782C15.5252 5.00345 15.5802 5.11345 15.6901 5.33333C15.7451 5.44329 15.7726 5.49827 15.8037 5.54609C15.9664 5.79559 16.2318 5.95961 16.5277 5.9935C16.5844 6 16.6459 6 16.7688 6H17.8234C18.9435 6 19.5036 6 19.9314 6.21799C20.3077 6.40973 20.6137 6.71569 20.8055 7.09202C21.0234 7.51984 21.0234 8.0799 21.0234 9.2V15.3496M19.8455 19.8221C19.4278 20 18.8702 20 17.8234 20H6.22344C5.10333 20 4.54328 20 4.11546 19.782C3.73913 19.5903 3.43317 19.2843 3.24142 18.908C3.02344 18.4802 3.02344 17.9201 3.02344 16.8V9.2C3.02344 8.0799 3.02344 7.51984 3.24142 7.09202C3.43317 6.71569 3.73913 6.40973 4.11546 6.21799C4.51385 6.015 5.0269 6.00103 6.00007 6.00007M19.8455 19.8221L14.5619 14.5619M14.5619 14.5619C14.0349 15.4243 13.0847 16 12 16C10.3431 16 9 14.6569 9 13C9 11.9153 9.57566 10.9651 10.4381 10.4381M14.5619 14.5619L10.4381 10.4381M10.4381 10.4381L6.00007 6.00007"})]})}function JE(e){const{onClick:r,disabled:a,className:o}=e,c={cursor:a?"default":"pointer",stroke:a?"grey":"yellow",strokeLineJoin:"round",strokeLineCap:"round",strokeWidth:1.5,...e.style};return ie.jsxs("svg",{onClick:a?void 0:r,className:o,style:c,width:"28px",height:"28px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ie.jsx("title",{children:"Camera On"}),ie.jsx("path",{d:"M12 16C13.6569 16 15 14.6569 15 13C15 11.3431 13.6569 10 12 10C10.3431 10 9 11.3431 9 13C9 14.6569 10.3431 16 12 16Z"}),ie.jsx("path",{d:"M3 16.8V9.2C3 8.0799 3 7.51984 3.21799 7.09202C3.40973 6.71569 3.71569 6.40973 4.09202 6.21799C4.51984 6 5.0799 6 6.2 6H7.25464C7.37758 6 7.43905 6 7.49576 5.9935C7.79166 5.95961 8.05705 5.79559 8.21969 5.54609C8.25086 5.49827 8.27836 5.44328 8.33333 5.33333C8.44329 5.11342 8.49827 5.00346 8.56062 4.90782C8.8859 4.40882 9.41668 4.08078 10.0085 4.01299C10.1219 4 10.2448 4 10.4907 4H13.5093C13.7552 4 13.8781 4 13.9915 4.01299C14.5833 4.08078 15.1141 4.40882 15.4394 4.90782C15.5017 5.00345 15.5567 5.11345 15.6667 5.33333C15.7216 5.44329 15.7491 5.49827 15.7803 5.54609C15.943 5.79559 16.2083 5.95961 16.5042 5.9935C16.561 6 16.6224 6 16.7454 6H17.8C18.9201 6 19.4802 6 19.908 6.21799C20.2843 6.40973 20.5903 6.71569 20.782 7.09202C21 7.51984 21 8.0799 21 9.2V16.8C21 17.9201 21 18.4802 20.782 18.908C20.5903 19.2843 20.2843 19.5903 19.908 19.782C19.4802 20 18.9201 20 17.8 20H6.2C5.0799 20 4.51984 20 4.09202 19.782C3.71569 19.5903 3.40973 19.2843 3.21799 18.908C3 18.4802 3 17.9201 3 16.8Z"})]})}function e4(e){const{scanning:r,startScanning:a,stopScanning:o}=e,[c,h]=Ct.useState(!1);function m(){h(!0),r?o():a(),setTimeout(()=>h(!1),1e3)}return ie.jsx("div",{style:{bottom:85,right:8,position:"absolute",zIndex:2,cursor:c?"default":"pointer"},children:ie.jsx(r?ZE:JE,{disabled:c,onClick:m})})}function t4(e){const{onClick:r,className:a,style:o}=e;return ie.jsxs("svg",{onClick:r,width:"30px",height:"30px",viewBox:"0 0 24 24",className:a,style:o,xmlns:"http://www.w3.org/2000/svg",children:[ie.jsx("title",{children:"Torch Off"}),ie.jsx("path",{strokeWidth:.2,stroke:"yellow",fill:"yellow",d:"M14.516 15.158l.714.714-4.595 6.14-.75-.364L12.337 13H6.978L8.22 8.861l.803.803L8.322 12h3.036l1.793 1.792-1.475 5.16zm5.984 4.05L4.793 3.5l.707-.707 3.492 3.492L10.278 2h7.972l-5.025 7h7.149l-3.71 4.957 4.543 4.543zM12.707 10l3.243 3.243L18.376 10zM9.795 7.088l2.079 2.079L16.3 3h-5.278z"})]})}function n4(e){const{onClick:r,className:a,style:o}=e;return ie.jsxs("svg",{onClick:r,width:"30px",height:"30px",viewBox:"0 0 24 24",className:a,style:o,xmlns:"http://www.w3.org/2000/svg",children:[ie.jsx("title",{children:"Torch On"}),ie.jsx("path",{strokeWidth:.2,stroke:"yellow",fill:"yellow",d:"M13.225 9l5.025-7h-7.972l-3.3 11h5.359l-2.452 8.648.75.364L20.374 9zm.438 3H8.322l2.7-9H16.3l-5.025 7h7.101l-6.7 8.953z"})]})}function r4(e){const{status:r,scanning:a,torchToggle:o}=e;function c(h){o(h)}return a&&o?ie.jsx("div",{style:{bottom:35,right:8,position:"absolute",zIndex:2,cursor:"pointer"},children:r?ie.jsx(t4,{onClick:()=>c(!1)}):ie.jsx(n4,{onClick:()=>c(!0)})}):null}function i4(e){const{onClick:r,className:a,disabled:o=!1}=e,c={cursor:o?"default":"pointer",stroke:o?"grey":"yellow",fill:o?"grey":"yellow",...e.style};return ie.jsxs("svg",{onClick:o?void 0:r,width:"30px",height:"30px",viewBox:"0 0 24 24",className:a,style:c,xmlns:"http://www.w3.org/2000/svg",children:[ie.jsx("title",{children:"Zoom In"}),ie.jsx("path",{strokeWidth:.3,d:"M16.279,17.039c-1.396,1.209 -3.216,1.941 -5.206,1.941c-4.393,0 -7.96,-3.567 -7.96,-7.96c-0,-4.393 3.567,-7.96 7.96,-7.96c4.393,0 7.96,3.567 7.96,7.96c-0,2.044 -0.772,3.909 -2.04,5.319l0.165,0.165c1.194,1.194 2.388,2.388 3.583,3.582c0.455,0.456 -0.252,1.163 -0.707,0.708l-3.755,-3.755Zm1.754,-6.019c-0,-3.841 -3.119,-6.96 -6.96,-6.96c-3.842,0 -6.96,3.119 -6.96,6.96c-0,3.841 3.118,6.96 6.96,6.96c3.841,0 6.96,-3.119 6.96,-6.96Zm-7.46,0.5l-1.5,0c-0.645,0 -0.643,-1 -0,-1l1.5,0l-0,-1.5c-0,-0.645 1,-0.643 1,0l-0,1.5l1.5,0c0.645,0 0.643,1 -0,1l-1.5,0l-0,1.5c-0,0.645 -1,0.643 -1,0l-0,-1.5Z"})]})}function a4(e){const{onClick:r,className:a,disabled:o=!1}=e,c={cursor:o?"default":"pointer",stroke:o?"grey":"yellow",fill:o?"grey":"yellow",...e.style};return ie.jsxs("svg",{onClick:o?void 0:r,width:"30px",height:"30px",viewBox:"0 0 24 24",className:a,style:c,xmlns:"http://www.w3.org/2000/svg",children:[ie.jsx("title",{children:"Zoom Out"}),ie.jsx("path",{strokeWidth:.3,d:"M16.279,17.039c-1.396,1.209 -3.216,1.941 -5.206,1.941c-4.393,0 -7.96,-3.567 -7.96,-7.96c-0,-4.393 3.567,-7.96 7.96,-7.96c4.393,0 7.96,3.567 7.96,7.96c-0,2.044 -0.772,3.909 -2.04,5.319l0.165,0.165c1.194,1.194 2.388,2.388 3.583,3.582c0.455,0.456 -0.252,1.163 -0.707,0.708l-3.755,-3.755Zm1.754,-6.019c-0,-3.841 -3.119,-6.96 -6.96,-6.96c-3.842,0 -6.96,3.119 -6.96,6.96c-0,3.841 3.118,6.96 6.96,6.96c3.841,0 6.96,-3.119 6.96,-6.96Zm-4.96,-0.5c0.645,0 0.643,1 -0,1l-4,0c-0.645,0 -0.643,-1 -0,-1l4,0Z"})]})}function s4(e){const{scanning:r,capabilities:a,onZoom:o,value:c}=e;if(!r||!o)return null;const h=(a.max-a.min)/3;return ie.jsxs(Ct.Fragment,{children:[ie.jsx("div",{style:{bottom:130,right:8,position:"absolute",zIndex:2,cursor:"pointer"},children:ie.jsx(a4,{disabled:c<=a.min,onClick:function(){o(Math.max(c-h,a.min))}})}),ie.jsx("div",{style:{bottom:180,right:8,position:"absolute",zIndex:2,cursor:"pointer"},children:ie.jsx(i4,{disabled:c>=a.max,onClick:function(){o(Math.min(c+h,a.max))}})})]})}const ro={fullContainer:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},innerContainer:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},overlay:{position:"absolute",top:0,right:0,bottom:0,left:0,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},borderBox:{position:"relative",width:"70%",aspectRatio:"1 / 1",border:"2px dashed rgba(239, 68, 68, 0.4)",borderRadius:"0.5rem"},cornerTopLeft:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",top:0,left:0,borderBottomColor:"transparent",borderRightColor:"transparent",borderTopLeftRadius:"0.5rem"},cornerTopRight:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",top:0,right:0,borderBottomColor:"transparent",borderLeftColor:"transparent",borderTopRightRadius:"0.5rem"},cornerBottomLeft:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",bottom:0,left:0,borderTopColor:"transparent",borderRightColor:"transparent",borderBottomLeftRadius:"0.5rem"},cornerBottomRight:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",bottom:0,right:0,borderTopColor:"transparent",borderLeftColor:"transparent",borderBottomRightRadius:"0.5rem"}};function o4(e){const{scanning:r,capabilities:a,onOff:o,torch:c,zoom:h,startScanning:m,stopScanning:x}=e;return ie.jsx("div",{style:ro.fullContainer,children:ie.jsxs("div",{style:ro.innerContainer,children:[ie.jsx("div",{style:ro.overlay,children:ie.jsxs("div",{style:ro.borderBox,children:[ie.jsx("div",{style:ro.cornerTopLeft}),ie.jsx("div",{style:ro.cornerTopRight}),ie.jsx("div",{style:ro.cornerBottomLeft}),ie.jsx("div",{style:ro.cornerBottomRight})]})}),o&&ie.jsx(e4,{scanning:r,startScanning:m,stopScanning:x}),c&&a.torch&&ie.jsx(r4,{scanning:r,status:c.status,torchToggle:c.toggle}),h&&a.zoom&&ie.jsx(s4,{scanning:r,capabilities:a.zoom,value:h.value,onZoom:h.onChange})]})})}function Ac(e){if(e===null)throw new Error("Canvas should always be defined when component is mounted.");const r=e.getContext("2d");if(r===null)throw new Error("Canvas 2D context should be non-null");r.clearRect(0,0,e.width,e.height)}function l4(e){const{onScan:r,constraints:a,formats:o=["any"],paused:c=!1,components:h,children:m,styles:x,classNames:_,allowMultiple:y,scanDelay:S,onError:R,sound:B}=e,N=Ct.useRef(null),k=Ct.useRef(null),z=Ct.useRef(null),X=Ct.useMemo(()=>({...KE,...a}),[a]),j=Ct.useMemo(()=>({...WE,...h}),[h]),[F,te]=Ct.useState(!1),[Q,oe]=Ct.useState(!0),[ue,ee]=Ct.useState(X),ce=(function(){const Ge=Ct.useRef(Promise.resolve({type:"stop",data:{}})),qe=Ct.useRef(null),ft=Ct.useRef(null),[ne,fe]=Ct.useState({}),[De,Le]=Ct.useState({}),pe=Ct.useCallback(async(Rt,ht)=>{if(!window.isSecureContext)throw new Error("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.");if(navigator?.mediaDevices?.getUserMedia===void 0)throw new Error("this browser has no Stream API support");const mt=await navigator.mediaDevices.getUserMedia({audio:!1,video:ht});Rt.srcObject!==void 0?Rt.srcObject=mt:Rt.mozSrcObject!==void 0?Rt.mozSrcObject=mt:window.URL.createObjectURL?Rt.src=window.URL.createObjectURL(mt):window.webkitURL?Rt.src=window.webkitURL.createObjectURL(mt):Rt.src=mt.id,await Promise.race([Rt.play(),new Promise(Sn=>setTimeout(Sn,3e3)).then(()=>{throw new Error("Loading camera stream timed out after 3 seconds.")})]),await new Promise(Sn=>setTimeout(Sn,500));const[qt]=mt.getVideoTracks();return Le(qt.getSettings()),fe(qt?.getCapabilities?.()??{}),qe.current=mt,ft.current=qt,{type:"start",data:{videoEl:Rt,stream:mt,constraints:ht}}},[]),Me=Ct.useCallback(async(Rt,ht)=>{Rt.src="",Rt.srcObject=null,Rt.load();for(const mt of ht.getTracks())ht.removeTrack(mt),mt.stop();return qe.current=null,ft.current=null,Le({}),{type:"stop",data:{}}},[]),Bt=Ct.useCallback(async(Rt,{constraints:ht,restart:mt=!1})=>{let qt=null;Ge.current=Ge.current.then(Zn=>{if(Zn.type==="start"){const{data:{videoEl:_n,stream:zn,constraints:mn}}=Zn;return mt||Rt!==_n||ht!==mn?Me(_n,zn).then(()=>pe(Rt,ht)):Zn}return pe(Rt,ht)}).catch(Zn=>(qt=Zn,{type:"stop",data:{}}));const Sn=await Ge.current;if(qt)throw qt;if(Sn.type==="stop")throw new Error("Something went wrong with the camera task queue (start task).")},[pe,Me]),At=Ct.useCallback(async()=>{if(Ge.current=Ge.current.then(Rt=>{if(Rt.type==="stop")return Rt;const{data:{videoEl:ht,stream:mt}}=Rt;return Me(ht,mt)}),(await Ge.current).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")},[Me]),It=Ct.useCallback(async Rt=>{const ht=ft.current;if(!ht)throw new Error("No active video track found.");{Rt.advanced?.[0].zoom&&ht.getCapabilities().torch&&await ht.applyConstraints({advanced:[{torch:!1}]}),await ht.applyConstraints(Rt);const mt=ht.getCapabilities(),qt=ht.getSettings();fe(mt),Le(qt)}},[]);return Ct.useEffect(()=>()=>{(async()=>await At())()},[At]),{capabilities:ne,settings:De,startCamera:Bt,stopCamera:At,updateConstraints:It}})(),le=Ct.useRef(ce),Qe=Ct.useRef(R),Je=Ct.useRef(j.tracker);Ct.useEffect(()=>{le.current=ce},[ce]),Ct.useEffect(()=>{Qe.current=R},[R]),Ct.useEffect(()=>{Je.current=j.tracker},[j.tracker]);const ke=Ct.useCallback(Ge=>{(function(qe,ft,ne,fe){const De=ne;if(De==null)throw new Error("onFound handler should only be called when component is mounted. Thus tracking canvas is always defined.");const Le=ft;if(Le==null)throw new Error("onFound handler should only be called when component is mounted. Thus video element is always defined.");if(qe.length===0||fe===void 0)Ac(De);else{const pe=Le.offsetWidth,Me=Le.offsetHeight,Bt=Le.videoWidth,At=Le.videoHeight,It=Math.max(pe/Bt,Me/At),Rt=Bt*It,ht=At*It,mt=Rt/Bt,qt=ht/At,Sn=(pe-Rt)/2,Zn=(Me-ht)/2,_n=({x:nr,y:wt})=>({x:Math.floor(nr*mt),y:Math.floor(wt*qt)}),zn=({x:nr,y:wt})=>({x:Math.floor(nr+Sn),y:Math.floor(wt+Zn)}),mn=qe.map(nr=>{const{boundingBox:wt,cornerPoints:Er}=nr,{x:Bn,y:kn}=zn(_n({x:wt.x,y:wt.y})),{x:ai,y:hr}=_n({x:wt.width,y:wt.height});return{...nr,cornerPoints:Er.map(Or=>zn(_n(Or))),boundingBox:DOMRectReadOnly.fromRect({x:Bn,y:kn,width:ai,height:hr})}});De.width=Le.offsetWidth,De.height=Le.offsetHeight;const Qt=De.getContext("2d");if(Qt===null)throw new Error("onFound handler should only be called when component is mounted. Thus tracking canvas 2D context is always defined.");fe(mn,Qt)}})(Ge,N.current,z.current,Je.current)},[]),{startScanning:at,stopScanning:et}=(function(Ge){const{videoElementRef:qe,onScan:ft,onFound:ne,retryDelay:fe=100,scanDelay:De=0,formats:Le=[],allowMultiple:pe=!1,sound:Me=!0}=Ge,Bt=Ct.useRef(new uh({formats:Le})),At=Ct.useRef(null),It=Ct.useRef(null);Ct.useEffect(()=>{Bt.current=new uh({formats:Le})},[Le]),Ct.useEffect(()=>{typeof window<"u"&&Me&&(At.current=new Audio(typeof Me=="string"?Me:"data:audio/mp3;base64,//PkZAAhghE0AKToAJra/n0FQygAAAGIkYJgmCYXBMAAGCTJz3zhCEM//z//1hz//8MMMMN08ssV6e5DDWIQreAgCvFKy8bXgIKMkUDDBgzJwIBtkRMQAocxIFdxghQGKDoEziAzQxOBOdH92i/iGi+zDCAEIX46a73HrSybZw1x3JZjXp7dSNy/P68rjcbt7p7fakMP5LVMyzCaj1pjvejYYAIDgDGzECjEAk1Jl3559HIon8hzlfPVTCvGJZzfcKSxXfyMWM88//9VKSxXdtnb9vomOuuRyiWVYbf+X8zp6fKGHIdycuWMMMMMMKSnp+6wsYc/9f/7z7rPPWHN556p6fP8MMMP///PPP/7+GHK9PT6p7f/unldP2np7YeHjweiYA4GLNAgAiI7u57n5//oc5/yfk6znOcPhwOBwggHCMpA4HA4KEyHOc5znO+hPIc5//+fqJh8XQPh90JU5xQinOf//87/zvP+ggAYuhCKHxdA+Hxd0EA4KKHA4ciB3kOXfXB/gmf8p/B96lAMKAgAADU+BujARHgwdisgHMfAUHAiceBg4ASBgZBiBIBH4ZaHOJsLhf8R+HYEciIgYSwj/+Bi7EqBh+AcBn5P6Bh4TuBmrAMBiZH7gaLEWgew//PkZFMlyek60MpYAShzqqZhm6gCUWeEUWAewEWYGN4X4GDEPwGE8S4GDoOIGAYKgIQOkz//gGARAUB+CwGxTwMAACAEgyAwdAlAxKhzAxXiZ///AxcEwAwJjDAziCAAwQgdAwRgdAsJQDAmAcGzYDwAhZIAKAcIQB4GT9TQMJ9/4Gi1Fv/AcAYUqKBAwGgNAwVBAAwGhwAwdBlAxFg1AwlgzAwNBuAkJQDBgEEDEqGECgChFgBgL//CIswYYH//+HKCpk4K0C9AaKKCAOBeMcR4X9C44BwABCgGAsGYCgTwHAcAwXAiAwSAQV///CJP9lwMBQAwAAAWGo5lVLCcaeneVhJAVGai3//ioaUEf//gaTAYGCj8BnEwfrIqDcsIQb/vmhU/8fAs0G8YGGwKST8Igj4GCATipksVzY8p//90FWJwh45AkX//4fCF9wMEgkL3uQc+gbGJ8t4MBAMBP/hEXf9FRuWBcAfIFjYzQdoLCBwh7IWVlxaX/w8oMCP/+EQT5poGB1Ir90DhiV6af/jFYBpT2BgoQyyt2M0ToBdEaZyzt8nTo3xdNDCTSd//o6F06CjooxRr4jVF/0bOKD6OMUNDRxiMUVFR0FFQPhGXRjDpr4MAEA4wIQUhYOIw//PkZE4nrg08sOx4ACQ0CopD2aAAlwTTBxQeMcwd8w8gZTAgABXwGABOkzpI0wAQAExnWfP4x8ZjKunWdZ1o1Qe6lFGKCNULORQCELAAPnRUf/GIx/0FHGfo3SdZ0qP2cukXKLlRtBKFgAQwCkwJgFRYBEEATmDsLSY2QiQYCEnEra+UZo6F1aKMRr6GhoaP/+j//ov+i+hjLqBgMkYoqChoo1GqCjoY06TpRqjjLOYzRRmMuizmgdKhdF8kjTAAAPMCwGswzglgwAJfzqxmioKH/////////////+ijLOAwFmN0f/////////Q///8ZjP/9DGYyFwIDBeB3MA4AlBWidKM5spykAUAQOCakK+udGqN8VDYjTRuN//0bVX//6Kio4xQFv//nf//kKOoAEIB6SY6hcxenp85///4/DEPf/84Xvl4vF4dwtxfEJgCYQHMSgKCROp4+fn////L4tQf0unz89OecLxeL0ul09y6enzp4dIhKAQFA5hKfLu1nU7/Wr71rRKJUBQSUVt////l08GUPVWgAAYAeNKsxbQNAAhQx3/oKGMM6dZ1Yy6sajMbfKio7lNcv0sScZ47lNcw32ekVFMP9fp/f+mklI6at6u/dBMQuW6y+C5BcgwAA//PkZEomGg1HYGe0riWsCqbEwiY0BJFJMxrCcxGgQ2VK8xxCF1wsABgQBBgQBAYAFCkYCgALkK4fJ00E5ctJN1Uxy5au3XoGcM4dSN0EYZwzhW0WCh1PZwzhnFFQxtnbO2d0Kt6CdXbruggkTEX5Rs4TEQUVsdVXaCcuWXIBQUGmwmgoAGcJiM4dSioHQdBnEY+hjcbov//jcb/43G43G/jCRibfxugdBnDqULO2duvQumztncbo4xGKKNxugooxGIxQULoOgFgUMTA/jbrxiMDmETL+eLhcPThzOeeOZfL5fIcBYuXD/OHv8t//LJFxjxQYHHKDGFkZMtlmKM0RgQfbVtxFIHbQBDRuzRguEI1c9XZ/rWmrZfVU3Oc/9utNNygRQkCoHlAYstNN6DJ1IINpoINppv+WG/+g2mmnUmmmpBAoJIJhnwB5xkymn606Df/t000xhU03UXC5Ol8uFyXy+Xy/l8v5w4cLk4XAvwAYUvl/QL5fTdlKZkEEEEGumaKaX00zIOemf6CH///ywI3LKpiQ2Ef4xYWMSDyI0XwzikpL0ajVHZ3j9DGIjeuXcNfjn96/S/TUz/X/vX////5K/r+v7Jn+LlAoGZOIQIwMKBQM/yppKYURmhGZkR2b//PkZE0mHg1HEG8wyiD7mlwAyDU8nJHi5htakZmZGNiRcpkJhBmUmZYQcM1VDEEBggNDV/ASEZRYKFZIhkXKLlKmk7IVTKmZNJ5KhiqVUqpX+k7+qlVKyV/ZIqZDFDWTJlFyi5TJpKhiXKBQyZzIS5JhBoayV/AQWVpGWkcYTV5O/rIVSv8/0nkr+v6/vyR/X9f1/ZN8kf5/n99/n+f5/lTKmf9/mRP8yFUqpWSv4yJUqpX9kj/MmZNJ5K/z/P9J5P/v6yFUz/CEoywgUMqZkz/FssECIsVq0aPRrRRatFFFykQZJ2Ukl///5KjmksOaA7ALROJLDnEsLbq3GTMVrwb/0dGzmM0DlfBlHQOmrdR0MYi92TX6b/cmDHLclyUVYO/4O8sFTKFTKFf8yhUyhUyhXzKlDKlCsr/+ZUoVlSsr/+ZQqZUoZUoceMfcoZUoZUoVlfOPGcmDHKcpynKg9yXJcr3JclyXJclyYO+DXJclyfgxFZVb3KcqD/g2MxzsY72L9LubPR0dCyf5K5NNd+Tv9GXRdV0XJclyfcl/n+k8kf6SX/iVynvXf///4Mg/1OkxguYzmM5jMcLHMxwwGhgNCwXMLAcwMXTLi1MD7w7tmTdBvMmE0xQFzCwHMDAd//PkZGMpigkmAGOUvCfTgcgAuC+ITswMFzC4oMLhYMByn0xvU+p9Tr0xUxf/0xv///1PBYDhgNTFTFTGTGTGTGTGTGTGTGC4GTFMDAcLAdMVMVMULAcMBpgYDhcDGFwsYXFBikLGFwMGA4MBxgcDKfTEMUoAx2BisD+mKp5Tv1OkxkxkxkxkxkxkxkxlO0xVPJi/6nv////U7CwHTFTFTGTGTGTGU+p71PpjJipihYDpipi/6n1Ov//C4GC4GTGTGTGTFU8WBSZdLhWB//yKlotyLZFiLf8tyyRUipFSKkVGRBZQMiWC3yx//wxUGKsSvDFQGHUAL3QMsHDFIYpCYy2Bmagy6BjLgy6Bh3od58DCLAizBgRb+EQiyEQiwGBFuDAi3/////20QqSBJf/qcumv/////wMZdGXAYMu1gYy6MuBEZdBgy4BjLgy6BjLgy6BjLgy6BjLQy6DBlz2cJDLgRGXAMZdGXAYMuhMZcCIy6sJGaoGMuppwNRl3WBjLgy63wiEWAwIt/+EQi0IhFsDCLAi0GBFkGBFgMJCqaqYAgAYIhBBvwf7kwcqRq7V3IctacvlN6NxqgooxRRuNRiijEZjMGRuMvz9FGozQ+1X2qe1T1S//+VhaWAtKwtML//PkZEIkbgcaAHc1xCJrjeAAtfuUAtLAWf///mWePH95ZFgsyssvM88+jzO6K+z7OM48sH+WDiweZx5YOK+zxWLGJWsa6xadAv02fTZLSpsFpvLSga0tMgWgUgWmwgUmyWl8tMgWWmLSoFJsoFlpSwsmyBg4HhEdgwHAYPBwGDgeBg8HwMHg4DB4PBgOAwcOwMHLwDn5lAwcDgiDgYDwMHA/4MB3//+EQeDAdwiDwYLPhEWQYLODBYERZBgt8Ii34GLBaB5pfAZ0FvEAQ/UfwxULlx+IXx+8f5CELH8fxKhAIDFoHBEDRc3////gwHgaRXgMHYMB2EU/gwZ/gYbw3gY3QbgYNgbgYiAbgwN3/+EQbBEG4MBuDAbAwG4RBtAwbg2////+B9B6F//////////hEdD//////////8DRahEQGCInMNg3LBElgNjDciCwG/lgNiwGxWG///mG4bf/+WA3Kw3KyIMNw2Kw3MNg3MNg3MNiIMiQ2OK0xMiA3KyJLAEZgRARmBEDEYFwBBgEgEeomowol5YAJKwCDAIAJ8sAE+gGBgCJYAQUZ/13LubMu5dyiYOAhKwEFGf9AOoz/g4CFAIol/lgAjysAgsAElYBP////lgJksBM//lgRUxF//PkZGApggsIAHt2wiNLoggAqCz8RFSwIqYioipkjEjHCCSN/+WJg5iYOYmPK5krmTmZk5mZ8sTJYmf8yJiNiIisi/ywRmRkZkZGZGRmRERkREZERGRERkREZERGxEf///hETIMEyBiZEyBiZEzwiJgDEwU4DV2gQGFOBgmP8GAiAwRAiBgIgYCIGAi/4MBHAwRgjAwRgjwMEQIgMcgY8DBGCMDBGCMDEyJn///+BiYQIBlObj4eYLIwsjAOBGFkYBoEQ84eULIw88LIA88PKHnw8sPKFkeHlANAiAaFUDAiMYPIHmDzBZBhZB///8GBOA1sH/Awni7AwnhPCITwYE/CKzBgt8Ig8GA4Ig6EQdww4Yb+F1sIgtwYCwGAsAwWAsBgLAYCwDBYCwDBaHUDF+VEDKgC2BgtBaDAWgYLQW////gYLAWQMFgLAMFoLcGAt////4RMABmBSj4NgwMOGHBsHhdcLrwbB4XXC6+F14YcLrww4Ng8MOGHBsHww4Ng8AUC4AoMQMC4fgw3wutV4QIsAgFYIBWCCVgHeVgHeWABCwAIVgH+YBwB5aRAstKgV6Ba1oMg9avtUVN/qdLWciD/cqD3Jg6DFPuTB/////lYAn//mC8C+YLwL5gvgvGC//PkZFEpLgMKYXt2xB5LogAArbdc+C8VgvlYL/mC8C+YLwL5YBfMNgNkwXixDWoHPMc4VUxVA2TBeDZPYXzXl815fK14sLxYXvK1//NeXzXl815fMtdDLSw3UsMtLCstMtLDLSwsFhWWlgt//8sFhW6f/////+WF7zXl8sL5ry+Vrxry+WF/wMLwX4MC+EQv/AwvBfAxsjYAyqpKA0lpLAwvBfBgXv///4RA2DANAYGgNgYGgNgYGwN+EQvf/BgXwYF//8DC+F4Dd6NgGBf4AgFwbB0MMF1wuuDYMBsGwusDYOBsHA2Dvg2DQuuDYOhdcMMF14YYDGYDEGwfhhgbB0MN///4RBaEQWgZByoYRWYMFvwiDsGwaF1gbB34GDwdC64XW/w1aKxDVgatir4YcLrQbBwNg7////////////+ESfgZPyff/////////4MFmBvvMAERZ8CC5adNj02E2S0qbCBSBZaYtN///oFlpU2QMXIFAYuQK9AtAo7IxLTpsIFJs/5aZRxQawaxGfIg9CsrI+PUqkWdOHp7ODsOl6cOHZ4dsulfLI9/8BAAgMBACsBLACVgBjoAWAE5OTM6WDAR0zodMdHCsJLASWAjzCQgsBJhASWAjysI8wkJMICU//PkZFkeqgcaYDd1th6DogAAqCuIxQwtDA5MdMULgyY6YqnXqdep5TpMdMVRNRL/UT9AN6jCiSjKAZRNRhAMomgFQDfCIJwYCQiCAiCMGAkGAgDBJUA3eVAMEgj////8SrDFIYqh5g8kPMHkDzB5OFkYeYPJ+HlDzB5+AYVQDibCyIPLLEZIsjIliWS0WywWyyWuWCyWJaLZbLJYDHgLAItFvy3///4eYPKBlQTh5QYEODBb//hhoNg7/C62DYPFUKwKsVgNWBq8VkVcVkVUVYrH//hGff/8Iz8GT7//////wiX4ML3gwvgwvf4ML3gZeqoHVGyBl4vgZfL2F1oNg4Lrg2DcLrg2DQw0Lrhh8Lr4YcMNBsGhdcGBcMOGGAFGAGMQsF1guuGG4XXV/4uQXOLmF1kL/8lCXkuSk4O8/FzHzuP0hIucf/CIFAMCgFPgYFAKAwCgGBQCgGHYO4GBVM4GgQI4RCMEQKQOtQjUI1CNcI14MqDKwDIAGQDzh5wsjDyw8uHmDzYeUPN+DEYRRhFEIowYgDQgIhWDApgwKAwKQYFAYFQMKkYDOxHAzsRgMKBUGBX/h5v+Hm4ecPNh5A8wBwjhZHhZAHlDzBZAFkAeQPKHnCyILIAsih5QsgDz//PkZLQgIgsMAFp1xCGLogAAA2rkB5w8oeYLIQ8kPMHkCyGHnAMKoGmAgFkUPMHmDYAtfHPHNkr/JYl8c8lCWHPHMkqSo5onMAkBDnfJX//8IgDBgBhEdAaxSQMHUGAEIgAV4risCcipBOMVRVBO////hEvAxsAwvf////8MPDDww4XWC64XXDDww4YcMPC6wYb/wYGgiGwMplMDYhTCIaCIaBga/////8GA+EQdgYPB4MB4GDwdhEH8Ig8Ig8GA6EQcEQf8DBxlBjoAweDuFwgCQXiL//iLiKCKCL4XCiKRFwEgoRT4iqpMQU1FMy4xMDCqqqqqqqr////xuDd8fv/DVwrArEIg6EQdhEHAYPBwMB+ERYBi0WAwWAZ0FoGLYOB+JfgZ0FoGdBaDBYbn+WHm9xW7/Nzzc83PLDzc8reWlA7S0oHamx//6BflpU2C0qbBaf/8yk/ysn+VkMhTKQrKVk8yE8rIVkKyYsAn/5WC+YICmCApWCGTkxtKMcVWlgFMEBTBAX////0C0C0C/////////LTFpvTZLTlpv/0Ci0xaYtOgWmymyWkAxcWmTZTYTY8tMmygUWmLTIFpsFpv9NnywLmLCx2RgWmQKTZ98UjnzZ1/++D4M6/////3//PkZOgjIg8IAFcbxCaTogAAoCuIzfJ8vfJ8Wcs5fBnD5//++L5f////////6nCKv//+o0o0FUYwqDNGCwgUMKC0VVGkVv//4Yf8LrxVCriqDVoasDVuKsNWw1bisBqwVkVkVX//gy/4YYMMGGhhgwwNg4LrhdcLrAYWGAA0zBsH4Ng3C6/////4MAoGBQIDAKBgUCAwCgYEAsDAoEAwKBAYBYMAoGBQIBgUCYGBQIBgUCwiBAYBYMAoRAgRAoGBBMBooCAYFAkIgTEUxFv/EWxFxFhFoi0LhQuFiLCL/EWqTEFNRTMuMTAwqqqq//////8TWJriV/hERAwRgYiEYGIhGBmIRgYiEYMEQMEcDMSiA1GYwMR+UDMTkA7KIgMRGIGGM0SIrRGjRlhEV4jxov8rR/5YRFhEdQSViCsR5iRJWIKxPlgQYgSViSsR5WJMQJLC78IiKERF4REeERGEREERHwMRGOBmIRhERhERAwRAYiEQGIhGBmIRAajkgG5TEEREDBHwYIwYI4REXCIV/4MCmDArgwKAYUO/gYVCkGBUGBTgYUCsGBUIhUDCoUCIVBgVBgVBgUhEKQMKhUDCoUBgVAwoFAYFcGBQDI6oA5+qQiFAMjBUGBXCyEPIFkOH//PkZPMj6gr6AFdVwifkBdwAoC2Ilh5/8PPh5Qsih5IeUA0TAZrE8PP////wMRiIIqID8piAxEIwMxCMDEQjCIj//BiIDRo8Iogii/4MKwYVhEoESkDEiIGJEgYlfBgmDBIMEAYgSBiBIREAwSERH/8I7wPfuCO4I7v/8GBvAw3Bv/////gwN34RBuBg2BuBg2BuBg2BuEQbhEG+EQbAwG4MBtwiDaDAbhEGwMBuDAbAwG4GDYG8DBsDcDBuNwDRWDcIg2AwbA34RBv///CINvCINgMRIN/////wiG4DDeG+TEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq/zB4OLAP8rBxWDisHlYOKxb5WLTFgsMWiw18LDOnjPxZoxadDOgsLAtLAbKymVhsrDZWG/LAb8w2GywGysNlgNFgNGFwuBQuWnTZLToFFpisLJsFp0Cy0voFAQLFZkMCAQwIBCsC/5WBCwBCwBCwBCsCeVgUwIBCwBDEwEMCAQrAhgUClgCFgTlgCGJgJ5gQTGJwKWAKYFApgQTGBQL5kY0HMjQYnAhWJvKwIWAIVgQrApYAhWBPBgECIEBgE/8IgXhECQiBAMCkcDEwEwMCAQGAQIhoIhsGBsIhvgwN//PkZN4irgr2AAOVqiUThegAnCtMgwNwiG/8IhuDA1hENhENgYbKYHb2IBhoNhENAwN////8IhsDKZS////8IhuBhspgc0KQRDWEQ3///CNf4GAIMDAwgAwAAwhAwAwYAIgwiHBgAMAYGAAGHv///CIBqBqESDEIgRYGoGHBiDEIgGoGgMAYgxgwgxCIETwYFYMCoMCuDApBgU8DCoU//gY3G//wYFOBhUKBEKQYFfBgV8IhSEQoBkYK8IhT/wMKhXBgUCIU4RCoRCvgYVCsDCp3A1SqAYFAiFP////gY3G1TEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVgwCAwCBEC///////8IgUIgWEQIBgUCAwTQMCAQDAoEhECAYFIwGaRMBotWAasdwH/KqBmhFgaKI4GRgKVpjCBTCBPMJHNMFMIFKwnlgJ5hUxhUwGWlpAMuMuWLTFpvQKQLQKLTIFJsoFIFFZb/8woQwoT///MIF8rC+WAphAphAppgpYClgsmwBC6bHoFFpUCi0wGXFguWCwFLgUsgX6BZaVNj0Ci03//+EQKEQKEQLCIFAxMBcDAgFAwIBQYBODAKBgUCAYEAuDAKBgUCAYFAgRAngwCgwCwiBIRAmE//PkZN4iogj2AFdVxiUrhewAhOkwQIBgQ0gbOI4GRhOBiYCgYEAv////CIFAyMBQYBf///CIF8IgUDAgFBgEAwIRwMCCcDEwFAwIBf///CIEQGMDGEXCKBpCIDCEQDCAsYInDFQMMAuYSoTQMVfBlf//+DKfBgAiGDAQMIMIgCIQYADAEGAgwP////8ItgNu2/8DAAAiABgHhECBgQGEQARA8GAeEQIMABECEQIMAwYBBgCDAARA4GAAgYACDAARAwiAgwDhED4RABEBCIGBgDoH2dgZwCBgAP//BhX/+DCiTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqF1ww////////hdeGGDDBhwjeF102E2fTYAowMLjE0zTDfyyMYjEDJTwMLSwFi0/gQLoFIFpsegWmyBQsWlQL9ApNgtIWn8tMgX6BaBX+WmQL9Nn02f9NktIgUgWmwWl9Avy06bCBSbJaUtImyWkQKLTIFgYWoFFpAKFwMLzZgwAwvLTIFlpU2fQLQK///4Yf4YaF1sLrg2DAuuDYNDDQw4NgwLrhh4XXC64Ng3C60MNwbB4XWC64YcMODYPCJYDlMQBlwRLg2DOF1v/////PkZM0eKgz0AE+UuCnLFfAAk3Fsg2DAYX/ww//4YaGGDDhdbDDACFwMuXA2DADlygusDYOBsGhhv//wNU/CKQusF1oXX+F1wuuGGC6wXWDDBdbC6wXXhHv//4AHIFgC0BZAA4Ba4FkADwFsC3AtQAOcC0BYAtgAcAA9+BYAsgW4FvgWOABwC1oq+it4RT0VVG0VFGkVywo1/RWU4U59TlFb1GvRX////QK9Nj/9AtNn02fTY9NhNlAr/QK//TYTZLSJsIFemx///oF/5aZNj02U2C0yBaBfoFAS6bKBfoFVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQiA8GAO/4RAf//////wYA4GAO+EQHAwB4GDoB4GA4HQRB0BhlDIBpEAcBgPDIBgPAeDAHIFAYuLTpspsJsFpi0haRApAtAstIYKClgF/ysF/ysE/ysF//LAJ6plTlYC1ZUypmqtWVK1VqyplSFgBaqqcwAAVIqcrEBAAKmMBERCQhwD5iICIQEyABMAABBVGXF4gIA4DLAAWAEQgLVSsBaq1ZUv+YKClgELAJ////5YBP//LAL5WC+Vgn+WAX/LT+gW//PkZMIhLgrsAFt1yiD7FiB6A9qwmwViybCbCbCBSBabCBSBabPpsegWmwWn9ApApApNgCGBmEwWlLSpsf////hEHgYOB3////4GDkiBxMHhEdgYOB4GDwcBg4HW23gooFYHd/+BnAz8O8Vv//FaBm4rBWh38es2zbAtD1m2PVBqBrBqBrAF7AF3/5el84MkuHTgyy+dL0dRnEajMIyOn8RsZ5HGG/kbIpHIkYUiD0y2WctlZaWSwrKx6FZbxnL54ul04eLhw9Ol84dl86cOHT3Ipb5Z8qKpVx6/j0EkLctVTEFNRTMuMTAwgWQLQAHgLf/////4Fn+EQESEcIgInCIRW9TkrCzH0YIjjWtI+YeCD0woLCBQwsKRWUaRVCBZFZRtRtFRTlTlThRtAr0C0C//02E2fTZQK/0Ck2f9TlFRTlTlFT/9TlFVFRFb/9ThThynIQbWkAREue5S11rKdlkDEVABh61ExYPU+tOD4MQgcn4iwigivxFRFoXDcRQLhoiwioXCeAkFBcNiL8RURQBIKEVEWiLBcKIqIpEXC4QReIoIpCIKAQMxFAFAsIuIr/4YYLr//ww4XWBgwC64XX/hhgw3hhwuv8MNhhguvhdcAUYgaYTAAoWDDg2DQbBg//PkZPYe6gzuADd1uDKsBhBAe89cYYdGjtDT2hDmlD2leaOv9oX0OX/0NNLplNf8ewakNWGrTfTRpphNJtfaeh7T1/tStdtTpqN532lpX/1/kmQ5eaf2hoaV9paGleJAvd0rer2pWu1ar2vk56vVrV5Hj1Nop+/lfv5Zpkem5kX/2vtata2rq783nbvtbW6VjW6a2rq13+rO6VysV58K7tbp0ru6Vrtqa1a67tr6sau1ulYrnfa2v927Vrt21NSuN5X927/D4diAQANh4gEIfxB+IQG/D/4gDw/iGIRD+HRATEFNRTMuMTAwqqqqqqqqqqqqqqqqqiIEK/ititFX///8VcVuK38VsVhXBOQTpq/qm8QCAcBmIxgdfFZCHECpxFBFAuFEUC4cLhsRTEVEUDVoDQD+KrFYirFX+KwKoVgVUVUVeKwGrhWRWBViqFYDV4rMViKyGroauBg/A0YThVgNAEVQqw1fisis4quKxxWYrAatxWIqoqg1dFYxVxWIrAavAaAArIrAqoqhWYrIqvxWMVYrARCADhcKoVYavDVgqhV4qorIrHFWKuKxFViscVUVYasAaAfFY/4YcMNhdfwuuGGC64YfDDA2DwusANygbBwAxhAECwNg8MOF1hD4//PkZOkc4g7yBjd1sDNkDhgqYwtcYoUyiQ0NCkxQ0NCQkSIbGKIyRGEo5mUaNEhGKEHMmaGhI0UokORvMmZmZSZSiMZQkRnKKZkzRoSNCQpQ0NEZoaNFJkhh3KOUJEhIcoSJCQkIzlDlEjMDMyMpQ0JCQzNCRGaNCRISEZoZihoaIwlEHKNGiMzFEjRmSIwlHMyZmcyiGyMxRyhIkIxRSZokSEYGBkiRojAPESNGjQxvKHMmMoSKTJCQkIwlFKLDYWGhoZhYWAAUGBsAwsMDYUAcK4XDPhQVwwLAH/DfgHC6TEFNRaqqBgjwYI//wYI/8GCL///+DBFhERgwRcIiPAzGYgMRKIDcskBgjAxEIwYI4GiRwNEjhFH4MRwYjA0aOEUf8Io/BiLgxGEUYRRQij/BiKDEYMR+DBGBiMRQiIgYIwiIwYIgiIgMRGIDUSjhEReEREBiIRAwR/wYI/8IiP4MEcGCIIiOERH8GCIIiMIiIIiODBHBgjBgjwiIoREcIiOEREDBFCKiAxHJcIiMGCMGCLwYI8IiPhERgwRAwRAYjEUIiIGCP/AxGIgiIsGCL//4REYMEXhERBERhExhExAzyAZiEWDBGERGeKsVsVRVFcVwTnFcVxVgnYqipFUV//PkZPkcfgzeAFaVxDgUBgAgatvIYrgnYqgnQJyK4riqK4rwTsVor4rQAjABAgnQritFSKoqQTsE5C1haxfF7F4XQtULSFqC1i4LwWkXIWkXRdF+LwqAnME4iqCdwToVuK+HAERWAkAlgJB0OB3Doc8OYc8VCsVgIB3DuHAERUAkAkHMOBwOAIisO4dwEAEAEg6AkAl4CeHA4AkKhXioBIOiv8OB3F+LgWkXxeF8XouxcF0XBeF8XBdF8XhdAdouC8AEsXYWsXOKsVBU/FaKmK/FTxXFbFUVPiv/8VfxXitVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVAXX/8MN/wwwYf//DDBh4Yf/+DYODDfCIFAwKBQiaANFgUDAgFAwIBcADwFuBY/At8C1wLfgAdAtwLGBawLcC3AsgWeBYwLX4XW8LrBhgiFgMlhYLrhh4XWhdb8MOGGhdcMP4YaF1gw8LrwuvhhoYYLrYXWDDBdcGwfC60MN/ww8GwZ4XXC64GZQsF1wbBnDD4XXg2DcLrBdaDYPhhgusF1uGGC64YfhhoNg0LrQwwYcMNC62F1/g2DYXW4XXC6+GH8DTIW4YeB/wR/wjwR+DP/y06bJaRAtAtAtAs//PkZNwY2grqBFW1xDhTRegABLBstL6BRaVAstN5aYtN/psIFf5aQtIgWgUWk8tImyWkQL9Avy0qbKbKbJaf02f/0CkCy05adAsC3K7+mx5aVAv0C/TZ8tOmymwB2pspsFpPLSlpy0qbCBSBXlpk2E2E2C0paUtP6Bfpslp0CkCy0ibJaZAosWQLLTJsemwgUmz6BZaYtOgUWmLTpsJsoFJslpPLT+mwmz//6Bfpsf6BSBSbCBXoFeWk9NhNhAr0Cy0/+WnTZ8tJ/oFf6bP+myWn//8tMmz/lpf//////8sPTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVBgJwiCYMBP//gwE//////wiCAMEgkIggIqIDKpUCIIgwE8IzA4j+EYhGAZMIyDJA5gGRhGcIyDIhEQiIGAgwIRDwiAGAAwYMHBghGAZMGRCMhGYRgGRA5gIyDIwZPBk/wZIRmEY/gyOBxIMgIzCMgcTgwRBgjwYJBgngwTwYJhEQBiBGERMIrwOouAxAgGCQYIhERhEQDBGDBAREgwTCIgGCQYJgwSDBHwiI4MEAwSBiRHCIkGCYGJEQiI/Bgn4REYREeBiBIH6XhERhETwogoy04mpZibFmJuWYmx8n//PkZN4ZrgrkAFZUyDcjofgAA9qc0HafZ8HwNrjaG3xtjaDtJwTo+D55Ow7fxNRNSyLPlqJsAr/lmA/FmWYm5acTQVgTkVQTnBOQTgVxVBOBVFWK4J3FUE7gBABOwToVQTsVhUFcVRXBOhUBORWiuKkVYrCqK+KoqgnQrAnEV+K8E7FQE5xWBOQToVQTsVRW8V4qRUFYVgTsVhXioKgrCqKwqAnYqCtBOhUioK+CcisK8VRUFSKnirFQVBVFcE6FcVoJwKoqCrFXFUE7gnAqiuCcQTsE7xU8VP8VYrgnYrCuTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqn3/l/J/8vHL5f/BhwCETgGpIDOATgEIOFoDcHzgEIDgC+pG7eve1S/6tat7rXupDXSStWoIpGS4TSMQNIySMwpIyAaRkkZ8GJGdBtbwYkZ63tCKRkoIpGWDEjLCKRmEkjOvsEUjJOsIpGa6bOrgxIzsEkjIGJGYUkZVKCKRmqoDkgEjMJJGSYMSMAikZJ3qhp0dq9ru3X1I36FujPbXuxwKbr//waABfg0AC6DUDUDXBqBoAmQawJiGrhqDUGoN//PkZL8USgKcAAblrroTgfQAbhtQAag1QawaYNIAuQa12Lv9si7F2NnXa2Vsi7i/DZl2tlL9l+vL8tlUTUTUTUYQDIBlGUAyifqJKJqJ+p5Mf/U7TETEU7CxkxVO1PKdqeU8u4vq2ddnrsbM2Zs/tl9s67V2NlbIu5sgaA1Q14ExAmAaA0BrDVDXhpgTPDQGuBMA0gTKGgCYgTHDQGrDUGgNcNQaw1hoAmcNIaRIAtALVEgC1gteI8FpBaBIAtcRwkAWgFpBaILVBaIkAWgRwjhIiPEeDXwa/4NUGr+DRwaKBgX/8IhP//wiF8GBMGBP/wYEhEKEQmEQuDAoGFTAwLgwLhG/4MvCM8GSDJCNwZQOXg2DwbB8MPDDhhuGGBsHhh8Lrf4MCQYFCIUGJgiE8GBQMIFhELDDhdaGHhdYGwaGGDDhhuDYMBsHg2D8MMGHBsH8GwYDYMhEKEQgMCeDAsIhAiFBgQIhAYFhEKDAkGBMIhYGEC4GFCBELgYUKDAuEQsGBQMKEwiEBgUGBcIhQYFwYFAwgWDAoRC8GBAYE4RCgwKEQvhEJgYUIBhQkIhAiECIUGBIMC4RCgwJCIUGBAiFgaYLwiEA5cGXCNhGBGwZAw4Ng0MPBkqNqcoqorlh//PkZP8cygrkAFI0wjo7lfAAjhq4SnPor//psoFemygWmwWm/0C0Ci05adApNn/TZQLU5RU9FRFVFdTn1OFG1Gywv/UbUa9Ff0VoFgCwBbAtQLUCzAtgAchHAN8ImAbgBvwDd4RwjQDeAN8I0ImEQEQAbwRgiQjBHhHAN0A3vgG6Ab/CIhEgG5AN6EQESAbmEYI4RABvYRoRABuYRgDehEQiAiIRABvcA3QiQDfwjwDfCICPCJCJCJ4RwiYRwjBEwDehEYRgDfCNCOEQEQEcI+BagAd4FrAscCxAswLfwLAFgC1wLNVMQU1FMy4xMDBVVVVVVVVVBlBkwO3wZAZMIz//////+DJwO0IwI0DsA7cGUI34Rn4RgMuEZgywZQjAZP/hGAcmDKEYDIB28GQGQGXhGgcgRoMgRoHYBywZAZYMmBygyQYFCIUDChQYE4MCgaYJ/gwKEQsGBAiEBgXAwgQLrhdcGwcGHBsGA2Dgw4YYGwZC6/hdYMMF14YcLrYYcMPDDhdYGweF1oYb4MCwYEwYEgwJBgTCIQGBIRC/BgQDCBcIhAMKFhEKDAsGBQYFAwgTgwKDAoMCQiEgwIBhAnCIUGBQiFwiEBicIhAiFhEIgIoBooGieDPA+4GeDPCP//PkZOobXgrkAEY0jjazieQgBKKIBGgyBGhGhGgyAdoMmEaDIB2gyhGwZYMsI0GSDIEaDKB2QOWEaDKB2hGgygcoHYBygdkDtgygcngyAyhG4MgMgRgRmDJCNBkA7QjAZIRoRoMuByhGgyAyAyhGwZYHKByAcgMgRoHIEbCNCNA7fCNA7AZAO0GSEYEaDLA7cDthGgyAyAyQjAOwGUIyDKEYEaEYEYEaEbA5AZQZAZAZIMgRkGXBlBkCMgyAyQZYMngcmEb8GUGQIyDIBywZAZOEZhGBGwO2EbwjcI3hGYMqTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqquDqz8GMDQIvBj///+DGDEGAMAifBj8IuEThFCIEQGPCLwiQYBFCKESDCETBhhGAZGEZ4MjgcSEY4GoRQigxCIEQGPCKBiBrgxwiBEwMIRAY4MQNMIkImDEGIRYMIRYRAYhFBjwYwNQYgwBgBh4GAMQiwYgxA0gahFBgBjgYBFhFhFCKEWBgEWEUGEIgMQYQMYRAMQigxhFBh4GkIgRIRYRAY4RIMQYgYhFA18IoMQYQihFhEgwhFCIDEGIRQieBiEUIoRQYhEwYDAFwGrBog0waAaQawacGsGiDQp9MZMVT3piJjJjK//PkZOYZBgjoaUJQ0DprofQgbhq0dep71PqeU69TpMdMVT6n1OlPKdJjpiKdFZkxlPKdJiJj+mKp/0xFPBoAmYaw0BpwJhDSBMQ1BqAmIEzDSGgNXDRDRhp+GsNMNAEyAmYagJkBMA1BpDXAmECZhoDXhqAmYawJjgTICZBrDSGsNAExDVDQGqGgNHDWBMIaQ0BrAmcCYgTHAmIEzDWGgNYaOBMw0BqDSBMYaA04aA1hqwJhw0ATKGqBM8NYEz4aQJkGoNMNIag1+GsCY+BMQJlDVw0cCYfDXw1ho4aQ0gTCTEFNRTMuMTAwqqoD37wjuhHf/////hGf////hHf/gycEZwRn4MnYMncIzsGTwOdOA507A507hGeEZ8GTuDJ4Rn4HPn4Mn4RnhGcDJwM3YM3gzdBm6DNwR3QjvA927Bm//Bm7Bm/Bm8GbgZvBm4GboR3gzeEd+DN8GbvBm6EZ+Bzp4Mn4HOnBGfA588IzsDnTgZPCM8Iz+EZ/CM4DnTgOdPBk8Iz4RJwGTidBi7AycTgiT4RJ8GE6ESdhEngZPJwGTieDCcESfwYToMJ3AycTwiTsDJ5OhEnwibwYb+ETdwibwibvCJuwYb/4RN/Btf/jYGyNv8bHLUtSzE0/LQBW//PkZPQcHgjQAFKVrjfDmgAge1eMLITcshNy1LX8si0LUTQtCyLQTUteWQmvLItSz4mgmnTJops0umEymDSPsnR9HwfB8k7Pvn0fAvwtcLXF/F+L4vQtQWuFoC0BaReF7AeBfwtcXBdF4XheFwXAtAui9C1haRdi6LwvirgnUE6FcVBVisKgrCvioK+KoqiqAhh3AQFXhwVYrFYCWHMOioVAI4dFWHPDgCAdDgdDmHcBIBEO+HRWAiKsBMO4dFQCAdATw6HBWHBWAgHBUHMOf/gICsOCoV4qw7+KxWHA6KhVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVC11Fz1+NP+/Xkqpr9OfuhQ6lZNWf+XsZc/si+KNoOj/Ntai9j7IISgZAklTqQhjToNTeQoreRdaSDODWvYAVFaWWkQmVuZPP8bRUzq896vc+XS6mm5gnnW7JLnV4z9N5XnW4k86x+uyHyxnWkmdborzraff2SvOtvljOtjd/5XRW8MivOsry/K3gUzrFPS1eFTOttTsul1+lLGdbV3c53h51mdbK7xPOr1SpnWlM63kedZnV4XPK86onnW7myrnWTmRTOqascoabXd/L+yuzS95dv1efjhl92ntYyTuIb6wuWRZFmWRa//PkZOcb/gqMACDf1LTLofggA9qc/gKRZiblqWYm3E24moSQnR9BJj6JwfBaFqWZZFoWvLUshNPxNuWn6bTZHgozRTSaNAY5oGjFQVgTkE6FUVorioK8VBXBO8VRUioAhxVioK4qAnIrYrCqKsVRVBORXBORVFcVcVwTgVBUBORUisK4rCoKwrxXFYE4FYVATjFcVhX4rcVBVFQV4rxVFSKwqCpFcV+K8VhXFYV4qivFUE4FaCdivBORUBOfBOgToE6FUVYqisKgqCtxWFbFQVxXisKgqRU4qioKuKwqCvxVBkH/4Mgf4Rg4RgfgxZBizhFYEVuDFvhFbBi3CKyEVsGLf/4MgAxaDFoGsWYMWgaxYBrFngxaDFnCKwIrAYswNas+DFgRWYGtWYMWBFZgxbgaxbgxZCKwGLIRWgxZCK2EVmDFmDFgMW4GtW8IrAYtBi3Bi0GLAYsCK0IrQit4MWeEVgRW+DFsI9cDW9AYtgxZhFaBrVgMWgxaDFvCKwIrIGtWhFaBrFuEVvBi3hFZA1i0IrYMWYMWAxaEVkGLAisCKzBizCK0DWrIRg+EYIRgQjABkHwODABkDhGDwODBgyAEYIRoRvww4YcKILYKILfhRg5htjY4OQbQ2hNAH8su//PkZP8cRgjWAFAUYjwDofQAi9pcJry1E1LUsuWvE2E0LQTcB+E2LMTctQFEEcWnFYVwTkAI4rRWFYE6BOhWwToBBAQgnIrisETANwIiAb/COEQEbgG+EcA38A3wjhGCMEeEaEeKoJwK4J2KoARBVBOIJ1FWKoJ0CcCuCdRWFcV4rioK4rAnYJ2K0V8VYr8E4xWFUVBVFQE6FXBORWFSKorxVFcVwToE5wTvBOoqwToVIJziuKwJxAQgnUVBUgnAqQCaCdxWirFaKwrRWFcE7FfFeK4rgnIrAnYrCoKoqgnAqCrip4qgnCr/////8Iu8BjvP4Ry5/8Izggc4Zw4RnD/hGcP8GThBk4eDJwgycIMnDwjOD4MnBA3eu9hF3kGO8gx3vBjvAN3jvMGO8CLvAY72DHeAbvXe+DHehF3kGO8gbvHeBF3oG713gG713vgx3oMd5BjvAi7wGO9A3eu8BjvMDd470Iu9wN3jvQY7wGO9wN3jvIRd4Bu9d6Bu9d6DHeAbvHewi7yEXecGO9BjvQN3rvIG7zykGO9A3eO9CLvYMd6EXegx3gG7x3kDd470Dd472DHewY7yDHeAKomwmhZFkAof8tCy4m5aCbcTUswFYsy0/LQTX9NBqBgJgYaY//PkZPcaTdCuAFgWlkI0DfQAe9r8Jxz6CShr8++JsArgjxNBNC0LQsyyLMsgRxallyyLIsi0LUTUtS0AVwFPia8si0LMTXiacsxNizLMTYTcsi1LMsy0E2LUsuJqJvxNyy/E1LMteWgm4mpZlkJuWRZFmWnLQTfgncVATkVcVQTsVIqQToVxWFeK4rwTmATCsCcAnQJyKoriqKwrxWiqKoqwToVRWBORWBOBVFSKgq4qAnAqAnArRVgnIJ3FYVQAgCriqK4qYqivBOsVoJwKgJ3FYVBWFfBOIqCoCcivipxUFSCd4qRV4rCvFaCc/BOhW8VxWFUVhX4r1eX/+DHgaYMOEX/CJgwwYQY8GODH/wYf4RAiQiAxCKBj4GAMYRQiwYcGEGMIoMfhECIBgEXAwCJhEA1BjhF+BhCIDEGARYGoRAYgxCLwYeESEUGMDEIoGAMAiAwBiBrCJ8GMGGEWEUGIRYMAYAxCKBiBgBqDDA1wiBEBiDAIsGIMANANMIoMAYhEBh4GMGMGARfAxBj8GAMANYRAYBFAwCIBhgYhEwNQMYGIRAMAiwNYRQi4RQYwYgahEBiBqBgESEUIqa6Z6bTBpGkmUwmkwaZpJlNCkifmkaaaBymgm0wmRPxSDTTa//PkZOYYTgboZUAQIkCEFgAAe898YTZpJtMJhNilphNdMJhMGgmemDSNJNmkaX6aNJN9MJhMc0E2mzSNJMpg0umU2mDS5oJlNJtNJnpg0DSTBoml0wmzTE8TRpGgm00mkzzRNNMJg0jQTSb/NFNdNGl02KTzRTfTPTSbTKZNLphNJpNmgmUymkwaaaTKZ/TSYTBoJr/ifptMpr9MJlNptMpg0kymumEwmf+mEwmOmkymTT5ppv80eaHTCYTHTSaNBNJtN80/0yaBoJo0k2aPTPNA0OaSaTJoplMJv9MgBAB4MBUGwbwVwUBkFAYDAU4NBoMBqhAELk//h/y1/vz6/6zMnEglwqnIsVSHBzAMMIqXiLgxS8ucoLCKl7VwipeupwYpeAxS8Z22hSl4U+qE1L2goKUva1GUJqXqwkpeAxS81IQpS8smBqXql6E1LyEVLxdEJqXoSUvAmpeJhFS8rpH3CKl6EVLxPWFKXgDUvVL1LCal4kuDFL2EVLxFlPClLyEVL2FKXhdwYpeswGpeqXkGKXqLAxS8wYpeqWk8KUvATUvQYpehJS9Bil6yoUpegipeZT2x1vN5NR2X3KrRuXjFmaS0AUCyE1BHflmWZacTYsvy05ZgAIs+WQCqJoWZ//PkZOwZ+gaYBgbm6EQMAfQAe9r8ZCbiaFkWv5ZibialoArlryyDtCSnyfR8hrE7PpNmiaIxDTGKafTJalqJoJoWQm4mnLUtSzE1LUsxNyy4mpZlqJpy14mgD8WpagKvLIEcJuWnLItBNhNhNxNgH8tSyLMTflmA/iaCaFqJqWf4mxZFmCdCvFWKwqivgnQJzFfwToAIwqgnOKgqCoK4J2KwqisKwJwKwqCqKgJwK4rYqirgnIJ2K8VhVwTmKorYrioK4JwKwrRWFQE5FUE6BOwTgV4qYqiuCdAnYqAnMVBVFUVATkVBVirioKoqCviuK8VwTjxWFfivFUVxXBOcVuKvFaKoqiuCdeEW3Bjb/gxvhFvCLYGN8GNwi3CLf8DbtuEW//CM7+DG+EW+DG8DbNgi3CLfA2zYItwY3gbZuDG8GT/Bk+DJ+DJ/hGdCM+EZwMnQZP8GT8GToRngc6dBk4IzwZOBk8GTvhGdBk+DG8Dbt8DbtgY2CLbBjYGNwi2A2zYDbN4RbhFtA2zcDbNwNu3CLaEW4RbeEW2DG8DbNwY3BjYDbNgY3A2zYItwi3CLbgbdvA27YGN/CLaDG4RbgxsDG4Rb8ItsI7oR3cGb00m0wmTT6aTZoJgUpMc0kwaa//PkZNcYqeLUAAAUHjw8DgQAe88cYTXTXNBpXiQdfLVpLJoaCSJs0TQNAbRpJpDWleaGlDmlfQ9fQ7tBZoa0IeOw3Ccq44TcHgrufDVzQNA0Om0wmDTNE0EymkymumU2mU0aSY6ZE8NFMmiaaYNDptMGn+aJpdNptNps0OmU0J50wNtMGmmEz/zQTJpppNplMJlM9M8FAYCoKAAApgqDIMACwAQbBsAMGQAQaCkGg0GgyCkGeCgNABwAAUgrwA+CoAQNAeHCAOAeAyIQHBwgDg4QYDAGgMEEOEAeA0Q4DxAHh0PEMGYMBsFQYDPgoDMGQV4NBqryAZfhGfwjMDl4Rv/wjcGT/4R/CPBH//hH4H3gzv4M7A+/gzoR4GdBnAf+DPBnwj4M7BnwivA1QIpCKcIpgaqDFgaqBogMWBqgGqgxQinA0XBi8IqEUCKBFcD7/CPwj0I+DPA/8GfBnQZ8I+EeCPwZ4R6EfhGcI0GSDIDJCNCMBkgdsIwGQDkBk4HIEZgy4RoHZwZQjcDtCMgcoRgRoRgHKDJBl4RgHIDKDIEYEaEZgyYMoRsIwGQGQIwGUGUI3A5AZMI2EaDLBlwjQZQjAjAZQoqIqqN+pypx/qNIqoqqNKNKcqchwGrCAPqN//PkZOsaCgjiBUZRnkhEBfAgw9tw+iu1RUqp2qNUNalOVG1GkV/U58sLU48sLLCiwFU4hAYA+qQQgasVhVIYQNWKwmAKpvasNoHIDm4OQHIDlGwNgbH4D+JuWQm4mhZFoJsWgm4I4TcbA2xtA5ODnGyNoHJ+NgHKDl/LMBXLUtS04mvLQteAqCaCbFoWQmha8bQ2Acg2ht8bI2RsjaGyNrjYGwNvjbByja/GxFYE4ipBOIrwTiK4J2KuK8BAK4rAnAJwKkE4FYE7FUVgEIqgIRVBO4qRXFQVBVBOMVwCcE5itBOoqAnQqCpBOIrxVBOoJ0KwJxgnQrCuKsVBXioCcCqCdAnYJyKsVYqipBOgjwiAj/8InhH4RMIkIioAC4RiJCMRP////CNk//Blkv4M6F8I9C/8GWT/8I2SwjZOEbJQZZIGWShGyYMsnwj0P///CPQ/hGyQRsn8I2SCNkgOyVkoMsnhGyQMslCNkoMsl4MsnhGyXCNk4MsmEbJ/wZZP8I2SA7JWTgyyQMiKDIieEYiAcRIihGIkIxFwZEUIxEA4iREgcRYihGIoHESIkDiJEUIxFwjEQIxEwZEWDIihGIoRiKEYiHcYJRIr9kzDmO5cIaApXE/NA0TTTKZGym/0//PkZMQWjdCsAwAWCsQ8Cfwoe89cyaXTKZACgKxsmybQFQCyPQPUbRtA9x6QAoegHKmRtClpk0RSkwaCYE/GyaaZ6ZFJTaaTCbTabTBomgmk2mxS0x0waSaTI2gcgOcT0T5MiedM9M9NCfCeGgNhMJlNJoT1MdNJhMjaNPptNGkmhtpnmgmv+KQmRSE0aaY6ZTKZTRoJg0U0aBopg0emU1/xPzTTaa5o80DRTZoJs0TRNEUhMikJs0P0x0wmkwmUymkwaKb5pppNJg0OaInhpGgmeaSbTBp9N/ptNJo0DTNAbOCkGAwGABgA4NgwAAAMAPBgAQKAyDAZgoCkFINAABWAEDAUBTAABgMBTgqACDcGAAQYDAUqLUlVt///+Bj4MIRcGH/hE//hEwY/wi8GPBj8GH8IgRcIv4RYMQi+DAIsIsIn8GHCLCJCJ/BhBgBpgwwifhFhEhF/gwCIDAGIMIMAMQYBFhFBgDH4GAMQiQNAYAwwYBECIAMIAMAAiHBgAMIAiAIg4MABgABhADAhEAGAARCBhCEQhEIMABh6EQAwIMABgCEQwMAQYD4MDCIcGACIQiHwYGDAhEOEQ4MAENB8hJD7PsnXJ0fZ98+D6LItQR3PgnZHmgPYYRopk0xj//PkZMkU/gLsKkITrkL0CfzIetvgJtNdNGkmkwCPLITf8s+WpaFmApAjgFUsyz49jSTCaGMmkyaRZlkJsWpaiagKBZlmWomh8c+CdcnROj4Pk+Akh9E6DsJ0fJ8c+OTs+idk4J2Tg+j7Pr8nB9nwfAa59k7598+D74Sk+eEkFQdDmKsOhwBEVYCeAiAmAiHcBEV4CYCIWmCHF6FqC0haRcF4XYvxfF2LwvC+FqC0xcC0C/FwLSFoF0XBfi7C0xei8LwvcLQLoWoXheC0BaIWoXBdiNiMY6cZ8RkZxnjqOojAz4zx0HUdBGozjoMw6iMjpxdi+L4uC5F/xd/haIui/bZ/+DGBp4RYMQYgw8Ivgw/CJ4RfBh/hECKBgEUGODH8InhFwY4GoMcIgRIMcInCIBrBhCIESESBp+DEGARfhEA1gxBjBj4RAYQYgxgYwiYRcIgMAiAwBjCJgYAawYYRQMQMAYhFgagYhEA0AxA1A1CJBhBgEXwMQNAihFhFAxwYAwgaYMPCJA1hEBiBrwYQiwYwiBFwYhFgxgawihFCLA0gYAwCKESBoBpCJ4MIRcGOEVB9ALR8BJj7/PonB9HyEoJwfZ9E4Dt5OeTnlqJtxNAH7nwfHPonJ8E759E6PoJI//PkZOAWKgjoZUAQYka0Ffgge9VcfZOCdE7J0To+Cc8JWTo+D7J0EqPoO0+T5PsJSfJ9n0TkJUfJOeTknPPo+z6J2Ts+ycE759/k7Pg+z5J2TonBOeTkJUTg+T5DtJ0Tvk5Pjk5DXPg+idH2HYfR9E6PgnR9k5JyfZ9cnR9cNYJSfROidE6Ps+Cdn0fB8E6DtPs+CdHwfH5OAlR8nyfB98+SdE4J0ff5OidH2TknfPkJMfYSg+Cd8+D6PsnP/JwTk++fYSQO0+D5J0fZ8HwTjn2AWDgdAL8ApALQCkO8GACwMgyAVBiAVhzwY4BeDIMgFMOh0ArDgc4BeAV4cgFsOhz/wP225HGw7wCsO4M8AqHP/+DEGQ7/8OgzgFoM4Bf4MhwO4BT4cDmHcGfDnw78GcVhUFTFXFeKoqYJ3isKuKkVgTsVoqCsKwrCoKsVQTqKorYWoXhfxeF/xdi58XOL4WmLnFYVQToE4FXiuK0VwTnFQVRVFcVhU4JzFfDgdhzBnDuHfALgyDAMQZBgGQCgBUAoDAMh3BkAsDMGcGAYgxBn+HAC0ArwCwMAS5adAry0yBSBfoFBVaKqKwVUVrRXUa9FUOEqVUjV3ySPLkvkzlNlNn02E2S06pvVKWACECpW//PkZN8VDgj+zymq5krb1ewAxJvkqe1XysDVFSqlVIo2o0ispyFVoqKNIrKcqNKcKcFhSjaKiKyKhYWiv6nCnCKijajSnPorKNKcKcqcIrqNoqKNqcKNoqKNKNqNKcIqKN//orf6BSbKbKBSBXlp0CvQKTYTZ/0C/LTxFxFoigioigCLC4cRYRWItEXC4cRcI0IoFwwXCiKwjQXC8LhRFcRcRQRSFwoikRcLhxFRFguHiKRF8E7FYVhVBOgCYVRUACKKgqgE0E6ACJFYVoJ0CcgnQrAnMVwTgE6ioKoRwDdhHhG4RARgDcCMEaEYIiAbwRIRuESEcIwRwiYRwjQjBEgWoFuBa4FngWkIQQigwhEwigx/CL/4RfCKEQGP/wYiEUwYHwYGDAwYAGA4RCEQBEGB0rCNcGU4RrBlcIsGGDCESBiEWDCBhCIEWBiDAGHCKEUGEGEGMIgMAiwigxCIDADQGIRfCIEQDXgYYRfBgBoESEXwY/CJCKEQIsGIRODEGIRQYgw8IgRYMMGAGGDEDGDAIoMcDQIkGMGGBrgwCKDAIsIkDUDWDGDDA1hE4RQMQYgwBhhFBhBh4MAMYRMIoRAiAxBjhF4mhZFpxNBNy0LQTUTXhKglR9FqWpaAP5Zi//PkZNYXkgTkGEJwlkXcDfQAe9r8bCa/k5JwTriacsizBHE6CSH1w7efHLPgjuJqWnLITYTX8tRNAH/ialqJuJuWZaFkCO4m5aE7J2TonB8E559nyEnJyfB8FmJrxNxNhNS1E3LT8sxNC0E0LTlqJuWQm3E15ZiaFqWRZiaCagP5aCblkKoqCsCdioKoqwToE6FcVwAhRWBOIrCpFbgnEVRVFUVIJ2K4rAnIqioKgrcV4riuK0E4FcVQTsVxUBOoJ3FUE7itFYE7FYVRXFUVwTkVoqAnYJxBO4rReF4XYWsLWLoui4LwuC9AdsLQL0LQA9C8Lgvi6LguBahfFwXAtIvQQ4vCqKwrxX/8E5xXit4JwKzBnwj+DF+F1guvBiQYkDRIR8I/gz8Gd4R/wYsGLBi8I8DPBneDPBnwZ/8I8DP8I8B/0Gd+DPA+8I/+Ef+DOgzvwj4R/hHoM+Ee4M4D74M+Ef/A/7gfcDPBn4R7BnfCPgz4M7Bngf8DPwjwR6B/3CPwj0Gfgz+EfBnhH8GfwioRQGIBqgRUDVAYoGiBFcIoBqoMWEUA1UDRYRUIqEUA1WBooGiAaqBogRUGJwigM8I/gz+DOCPwj/Bnwj3BnBHgZ4M4I+DOhHhNCz5aiaCb//PkZM0YugrgAAASBEUEBfQAe9rclmWompZ8shNyzLMsy1LMBUAfhNxNicBJCcE5J0JpyyLMTcBVLXloCO5aCagKACiAqflqWYmvE3E3BHlmArFnxNRNC1LUBS5aFoWhZFmWR8k5CTnxz4PonZ8E5Pg+j4LUshNQH4TYtSzLMshNBNhNSyAViyE0FQE4FYVoJ0CcRUgnYqisKoJxFWAhiuKgrCtFUE7FQE5iqKgqRVFWKorwTsVxVFYE7FTFTBOxVgnAqRXBOPisK4BOK0VoriuK0E5BOxUivFcE5FYE5FQVBXFQE6FQVBVFYVxWioCcCoLovi4LoWiL0LSL+LouBaIvBahdi6LoWgEMFoC1hacXxdC14uipiqKn8VPFbiqKsVb//Bm/+EXgx4RdhFb///hE1/8GLP//CKwIrQjoGa/wPewZqEdYM1wZqDNAetgzWEd8GagzYM2DN4M1wjoI7Bm+DNhHcD3rA9awZuEdwZvCOwjsGaA964M1A978I7hHQR0DNge98I6hHYR1wZrBmwPWgPWwZsI7wjqB63COvgzQR3BmwZsGaget8D3rCOgZoGa4R1gzYM0EdwZsI6CO+DN4R1wZsD3oGaBmwjqEdAzXCO/4R0DNAzYR0WgI8TQT//PkZL4XFgTcAE6Tekf8EfQAe9t8YTXiagKwCsJuWXLMTUtC1LMTT8TYTUJP+fAdomomoD8JuWoCgWoI7iaFkJqJqfZ8hrk4CSE5Pk+Cdk5PgnBOT7JwTg+uWZaiaCbcsgFAsy0LPlmJsWYmom5ZFmWpaibiaAjy15ZFkWQm5Zll+JsJqJvy1E0CThJz65OQlJ8H2TknZOT759k6J3z4PgTQTcsy0LITflmWfLUsiyLITYTcTT8syzLQsi0LMEcWZa8tSyE1LTibibFqWYI/8shNCyE1LQsy1LUTUBTLLloWXLUsiyLUtBN+JqJvy1E05Z8TcsxNeWn/LTnxydHwfZ9n1ydk4PsnHJyfR9E4JwTgnB8k4588nB9cnR8c+D7PjxV4q4r8VsVgTgE4/itFShX/xV4rirxVFWKoq4qfxX8E6xVxUBOYrCtwTvwTj/xV8E5/irBOsVuKwqRXFTFQVorCrFf/xWioKwrCtioCcxUFUVAToE4FUVxWFQVhUBO4rgnUVIJyKkVgToE4ipFUVoq4qisKsE64qCoCdxUFUVxXFUE78VxWFQV4qiuKgqiuK4CCK2KoqirBOATsE4FWK4qxVFUVhVFYE4gnIriuCcQTiK4rCoCdCtirBORUiqK2//PkZLAWsgzuADQNNkZj/fjIe9r8K/FXFUVwSE5aiaAKgmhaFpxNQkp8n3z5PsJOGsffLQsyyE1LItS1E1Af+CPLMTUTfibFmJoWQmxanzydHwTsnASknBaCalqWom5ZcsxNyc8nASsnHDt59BrhJgkpOicBKg7D7JyfZ8E5Pk+Cd8EeWXE0LQsiyLQtSyLIsi0LUTYsy0E3LITQshNiyLUsiy4I78shNy0LMVcE6ipgnArRVgncE4wTsVIrCqCcCtBOYrwTgE7iuKwqCoKwrcE7BOQTqKgqiqFpBEC1gPYD3F0X4WoLTF0Xxei6FqC0BaAtQWgXxdwtWFqC0haBW/FQVRUBOBUFcE6ioCcAnEVRX4rYrxWFUVBViuLsXgtAuC6FoBDBaYvi7F8XxexdF8XhcFyI//gx//CJBhgxhEwY/+EXwYgx8ImDH8GPhE8GPhEwigwhFwNQNQNfhE+DGDAGHCIBrhEhEBh4RQMAY/gYBFBhhEAxCIDCEUDEDHBiEUIoRQY+DCBp4McGEIgGgMcGIGMGIGIGgRQYgxCKBiBjBgDGESDADWBgEUDEIuDADWBpBiEUDEDDgYgwBgDEDQDUGIGgRAYQYAxCKBhCKEThEBgBiEUGIRQMQiQiwNAY//PkZKwWNgjoZUAQREakFfQAe9t8YMfwi4GBaFoJsWpaFlyyBHctCzE25ZiaFoAocsy1E24Sk+idk6LMTYTYTQsyyLUtCyLQTUswFYJMGuTg+CdHwErPotAFAsuJtxNCz4m4mvBHiafloWZZ8YppBqzTNI0jTNBMpg0jTTZZFqWfE3Af/xNf+WomhZ8suWZZCb8tC1LQtS14m/LQtBNhNOfR8hKCc8nHJ2EqCUE5CSHxydk6Pg+D7Ps+Sdk6LUTQTcTcTctSz4mwmha8TXlmJvyy5ZiaFl+WpZFoWZa8TQshNCz4mhalmJsWfLQsuWRactBNRNC1E1LLlly0E2PgJWfR8h2H2fJOSdnx+fXPs+T5PgNbnzz6Po+T7JwTk+z4PonROglJ84qCvxXxUirFX4q4qeCd1f8InCI/4R/CP//4RMI/CMEYI4RAR8I8IjCJ4REI/gG8ESEfCOERCP4R/+EaERCPCNCNCI4BvQjYRMHINobIOfjZBzDZG3xtja42gcw2PwcvG2Nng5+NgbY2wcn42htDYGwNrjYGwNsbX42vxscbI2gc3Bzg5Qcg2uNvjaGwNgbI2+Dl4OUbI2Qc42RsjbBy//g5eAboR4RwjQDeCP+EcI8IwBuwjwjBEBEA//PkZKoZMgrqADXt9EV8FfQAe9scG+EThEBGCMESESEbhEQjwjwjwjBHCIwiQDcCNCI/hHE0/LQBSLITf/lqWoSvk7LT8BWLMtRNAk58E7Po+CyLQTcsyyLUsi0Afi1LUTUTUtBNS05aFkWpZHzwkoSgnB9HwfQSsTYsizLQtRNRNgFf/8NcJWEmAWCdn0To+T4CUHyGtxNiyLT/lmJqJqJqWgmpZFqJsWgmwmwmwmv5ZiaibiactBNv/yyLTiaFkWZagKgCmJqWQmgmom3E0LTibAKfE0LLiuKgrYqipBO4JzFUE5BORXBOhVioKwqRWBOYJyKkE6BOIrYqCqCcxVxVFUV8E4FSCdcVgAgCuKkLTBDC6CHi+LwuRfha4uC+FpF8XQtAWgB2wtAWoXBchaBfwtQWnFSCdxVxXFUVhUFYV4rgnOK3wTiKir//1eDCsf//7/+wOYd///ei/f6lmiqGXpyOlCSRm+yP3UtDhFIzqBhwCFHAGFHABYGcAnAAMOAAYcAAw4BYKOAIROANgicAQYcABE4AAzgE4B+1wmcAwYcAK+sDOADgFLCJwAlWBnABwABnABwDWraETgEDOADgDBiRkgoJpGaP+64RSMoRSMGBiRkkwMSMlq7AxIy4//PkZJUYEgieBFw3fkL8FgAied8AROAAicA8DOATgAGHAAROAFwM4BOAGBhwADDgAGHANQUcAgicAYROAfgw4AIkbPNNNpo0TSNBNJgUs0l7lomEwmRSOaRp80zQFK4nvTInnTEGgwGwAwYmOmkyaInppJpMJg0k1+KUaaaTCb42U0mBsGiaSaNNNpo0OaKZNE0jTTSY5oGmaZpJrphM9MGkmDQTCZBzpg0OKR+mBtdMJobfTSbTfG2KSaBpGgaZomiaBomn02mOmkwmjSNPpjmmaKZNA0zSNFNCeClJkT40DTTCY5oJk0kyaJpdMppMdMdN80TR6ZTXTfNJNmimumem+aKZTKaTaaTRops0kwaZppk0+aSa6ZTKYTfTfTPTHTKa5omgmEyaJo9NmkaRp/pnmmaf6aNNMplMplMdMpv8TxMJlNplNJn9MdM1OM6hWa/EjiRiRiO/xIcSP+GgCZQ1+GvDRDV//4aP///4I8EwTwTBLwS/4AHgnBHBHgiwR4JgAgS4IwAYPA8ADg+AAAAFwfB4L4WADC2AGAGFwsFwuD2FgAcAPC+F/B8L4X/B7B4L4WwuD+AGDwXACAAC2D2AEFgfCwAAAAXB8LhcLeDwXCwPYPA+ACACD+AH4XwA//PkZJMVIgb2ejVLxkBMEgTIe898vwv4X/ACB/C4WwtgBg/gA4PA9gBeFhLRTXTRomkmP0yJ6J+mPy0NA0OvibNDQmfzTNNMjaFKNATxMiemiaRoGkmE2mkwmTRTHNBMGiaCZTSZTZomh0PaV9fX2hoX14kzSmOaCY5pJr80U0aPTfNFMps0jSNJMmiaSaTKb6aTKYNLphMpg0eaJoGkJ8aBoppMppMJg00xzTTabNFNJpNJpNpnpg0DT6bTRoppoJMWrSh/690NQ5paV5D2le/LND2hoQxDF/rzR1/r/aWhfaWleQxfXmheaevNDS0tLQ0ryGoch/X15D+vLy+0oc0ry/19DUOXuvIc0oav9oXkNX1/r3X18QCGHQGQHB8PiAPAaHgPDsBgcH+Hqv//+DJ0GNuEW4MbQY2wZO4Rn///4R34R3Qjv//8Gbv//8GbgZuwZvCO4GbsD37+Ed3A586DJ4Rn8DnToRn8GTsGT8GToRn4HOngyf4HOnBGeDJ0IzgjOCM8DnTwjOgydwOdP4RnYMncDbtwY2A27cItgNs3CLeDGwMbwY3CLaEWwRbQi3A27eDG0GN4G2bBFvA2zcItgY3A27YGN4G2bAxtA58/gc6eDJwHOnAyfCM7A588//PkZLMYngTSAFAUhEYcDfggw9V8DnzwOdOBk8IzuEZ4MnAyfgychsy7F3oE13Nl9sy7myrsL6qqOU5anCqkHqNDI3KVUTEU8GNU7U6gxyHKchyVV/Xa2Zspfds3rubK2VsjZmztk9djZi/TZV2NnXYu0vsm0yaBoDZNEbA2k0aKZNjmwbH/Nvm2bRtGyBVArD1G0bQPUevg9h6/+PRzZNkCrzZNgesegesermyPQPXzbHpNvm0PQPUPSbJs82TaHqAtj082h6DaNn8eo2DbHrHpNjj1m1zYHqNo2jYNnmwbPNgek2ja5sj0D1m0bJs80xtJlMdMCeps0U0meaaa6b5p/mmmU3zRTfNFN/pgHPzQNPmkaaaTXTKbTRoJk0zS6b/NBNdNJlNGj02aH6Z4IgAEEYJ4I+CMEQJcEUEXBOpHDX/w1Q0Q1Q1cNWGvw0Q0/hp/AmIaA0cCYhow0w1/w0hoDRhpw1w1BrgTLDXw1BrhrDQGgNQEzAmOGuGiGgNfgTHDQGoCZw1w0BrDWBMIEzDVDTDUGgNfAFwGjBrg1A1YNcGsAXAaQaABcBqg1g1QagaINYaoEyw1Bow1YaA1hoDSBMw1gTICYQJkGrDQGoNGGmGsNcNQawJkGuBM4aIa//PkZKAYngTsATQNQkKMFgDifh7AYagJkGsCZ+GkNWGiGsNAaYaOGgCYgTENQaw0Yaw1Q1Q0/hqw1BkAfmkaCb6ZTCY6bNBNLwmqGA5fzSTCb/lgwXOmMmMmTQ5pmkmUwmkymfzRTaZFJ6aNM002NrppMpg0kwKQmE2m0yKUaKaE95o9MJj9N9NJk0UymOaSaE/TabNNNmmmk2mU2aHTKZTCaNDjaTJoGimkyNvpk0TRTHTf6bTRopg001+mU0aXNBMjYNA0k2mjR5pfps0U100mUz0ym02mDRTHTaaTRpplMc0kz0ySA000mDSTKbNI002mzQTHTaYTf//NA0zQTBodNJk0UyKSaaZNJMprmkaP5oGmKUmEymUyaCbTHNBMJlN80DRNBMmkm/00mUwaZpprplNpvmiaJo80+aSa//TaY/6ZaH//wY4ReEX4RIMfwiAxBh/BhCJ/+ESDDwYcIn+EQIoMAiQYAw8IsGIGGETBj4MP4MQiAxhEAwAxAxBjBiEUIgMIMcDCDAGIMcGMDEGGBgEUDTwNfAx4MAiwiQYgwBgEUIgMIRAiQYhFwYAwBhA1CKDEIoGoGgMQi4MeDADGEQIkIgGMDCDAIoMAiQiAYwYYMQNQigwCJBiDEGAR//PkZJwV+gzoZUAQRkZsCfQAe9tcQYgx8GEGIMQiwMAY4MANAMcIoMSyE1E1/LMTUtCz5OD5PkJJz5Pk+uA/FqWRaib8TUTUTQtC05alqWYm4momgI8TYsxNCzE3LUtQFEsgFM+z6J0fB8nz+TsNcnB9BK+Tk+g7CdhJT6LTiaFqWYI7lqWoCvy05ZlnxNy0/LUshNBNvwR4moCj+Wv5ZlkJqWpalkCOE1E1LQsiyLITUBULLlqWZZlmJsWhZcsi1/4CiWpalkJqJuWvLXlkJsJpyy4mwm5ZlmJuWXLUTQteWgmgmwCsJoWfE3LMsiyLP8TTlkJuAolqJryzE1LTibCbloJuWhZFoWYmxZ8TcXIvxeC0i+FrF0B2i4L8LSL4uBaIDyCHF8XRfF6FqgiwtIuYWoXIrYqAncVvxVip8VIqCvUxPqtFbFf/4q/8V/8V/iririr8VATjxXipxWgnYq+KwqfFTFQVoq+KsVBW8VhUisKuK0VRXivFYE4FTBOhVFcVRV4riuCdCuCdCtwTiCcCqCcgnYqxWFcVIJwKsVxWisK8VxVgnArYqRWFeK0V4qgnQrgnYrfBOoqAnAq4J0CciqKviuK3BOoJyKsE4FUVoqisK2KwrAnArgBAFSK4//PkZJ0VagjyJgGtbkOkFfwAbh4AqRViuK4J0KgrCrFUVxVjOEeDQgjlcT4T40xtjaNI0uaI2QciGNJIl4kJZtCGIaSckIm6GL3TQ2zRTY2UwmjSNE0fxS02aY2BsJs0/+mzSE8TQpHTKZTaaG0aQpApZp/mmm+aHTfTCZGwNgUk0E0aRp/ilJlNJgT5MmkJ9zQNA0TQTH6ZG2mk0mk0mk3zQTKY/G3zQTHTabTBpGgmU0aKaTJpJpNJtMphNjYTfNE0emkymE2mEyaCbNBNfmkaJpdNJnpg0k0mDTTCbTaZTBp80k2aCbTfNE00yaCb6bTZoplMmmaKZTKaTJpmiaHTXNJNdMDbTab6Y6Z6ZNNMJhMJhN9NJrmim02m0ymU300aPTSa6Y//5pJpNdN/9NppxWxU4Jx/xWxU/xU4qcV/ipiuKwqxWFbioK/8VIqivFTwTkVgTkVor4JxFXxX8VcVxUFQE4FaCcwTvBOIqwToVuKwqCtFUVYqxXxWFeK0E7FQVYrwTnwTsV4rCqCcfFaCcRVFQE5gnAr4JyK4r4Jz4J0Koqip4rCvisKoJ3xWBOME7iuKgriuKgrAnAqgnArxXiqCcgnYJzFQVQTmAEIVYrwToAIYrwTiKkVQTkE5//PkZK4XGgzsADQNAkIcCfwAe898FXFTFYVxXxUFQVkzzS5oilg5TTTY2kyaJpJtNGgJ8aKaTQ2k2aCaNI0eaSYNJM/tKHEiQxfJG09MmgaSYTRppg0TRNNMJlMptMCfppNprmiaA2jQNLmmaRppk0jRFLNP9NJhMGmaQpZpJhNCkGkmE0J+mxSk0m0x02mjRTKbTCZ42EwaQpJpptNprmgaRpmim00J4mzSNM0kymkyKWmE0muaKYGwNjmgafTPNE0U0mUwJ7+mem01+J8mhSk2mjRTSb6aTCbNBM9MpjpjppMpk0E2mE2mE2mjSTfTaZ6YNFMcT1MpnprptNmim0wmE100aSaTRo9MGjzTTHTaaTfTSaNLpoFMAAFYNBQGwAvwAYM4NgqqkjaAN3d3d3etERNK5CZ/3Ctf8AaiAc/u7vaIn/+8XPv//+GDKv8W1/+AC8K4Yw+94xe940jgceOBwOcRaxGwH4EuNIjBfxazB8HhkwVjIAII/vDkjG/wAcJPeF5e98hNgSYLWMFvhZ73pX06aoehpmh01hMJtM9K3TKY9E10x+memvlIpZM9MUTCbShbUrtM+n5ophNZuXK+0wmemumMCemkmvc0Uwm/lJJlLe5oJZI0SyW6R0mE//PkZLcXlgrzECFvrEmMEfgAfh7k2aORpbTYUo9SBNsekGYNVKgqg6hrUXK4Q42DOwPWbILEzBSumEgkWJPU8S72G5wUuGDwguEKa1Q0UykS3Bn7FJNgg5qoEgpsGabBtGabZt7NrKCNgLYes1idmabBtm2bZsBRm0PQbF9mwPSPUBbMwzB6QojYM42ePTzbMwzR6TaNs1eBVNv81yDUJ2QYhJtD0m0PVe+x6T2M8HsbFwsh6B6D7HpugT2uZhO6HqZhmE7ISZhhkFNcghtmybBnnsD1Ho49ZtG2bZs5PVBc2EEepCaEHNjj1EJHq5smabZtmwbNEEPR+bJse9z2PY2T1SN0rdNJq6yXI06COvNJj9MGmkkGmUj7pI0TToNGlEsNEnCW10ymi5FtNFKpvps0kz0uW3aaTF00mTSzdNJu0KFYz1KjaGAhyoQCFGM//zFARgIUZ/oZpdCttay6M5drW1joSj6Ekk1b7J7R7aoQNlPrWBKLTTzOsGT5yYxLrtHTy2iUxEkES0HIBVD066VjGj31odPkkSjJtbWs6OIjKmlXHR9K5MTv5pdZolE10kk2lly74TFx5KTXeTGLrS6ExiucvJSSDUdXZm3NLn1rtYBCUEoRj77WOhCPc+g5//PkZJ8XPgzoAABMTrz8BfQyY9ONGxJULutaa1TE5LHxWEo+XecmMa3p0kqBCR6qOFaFUGpNJIIjqVi0ylBqJIkiSJIkmJj605EkSRJPetWAyVacmodBUVhGfrAZPF0AUrgRLNiqDU4VHo8h6HRObJJNdqlRBMFT0qdNE0WZhmay2tCuOY6oieWieianCnVSbzjd7SGhrLi6eUSeLcZTWqdML5PM50uOGJms9VqtYU6hrgrm4V0frUzTvYsiegR2FOkqUxSKdVCpmRCSkIAUZ4VPhqEKgFDU2VhUiIhUaIg0RAkTBYEjYBUbBMuCJgLAkCUBUinABgBE3/9EQqFRM0s0qzktk9ZFqqFC6RULE11JVDkd8Y1vVFOx9oUIpZ8Vnq5klkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"))},[Me]);const Rt=Ct.useCallback(ht=>async mt=>{if(qe.current!==null&&qe.current.readyState>1){const{lastScan:qt,contentBefore:Sn,lastScanHadContent:Zn}=ht;if(mt-qt<fe)It.current=window.requestAnimationFrame(Rt(ht));else{const _n=await Bt.current.detect(qe.current),zn=_n.some(wt=>!Sn.includes(wt.rawValue)),mn=_n.length>0;let Qt=ht.lastOnScan;(zn||pe&&mn&&mt-Qt>=De)&&(Me&&At.current&&At.current.paused&&At.current.play().catch(wt=>console.error("Error playing the sound",wt)),Qt=mt,ft(_n)),mn&&ne(_n),!mn&&Zn&&ne(_n);const nr={lastScan:mt,lastOnScan:Qt,lastScanHadContent:mn,contentBefore:zn?_n.map(wt=>wt.rawValue):Sn};It.current=window.requestAnimationFrame(Rt(nr))}}},[ft,ne,fe,pe,De,Me]);return{startScanning:Ct.useCallback(()=>{const ht=performance.now(),mt={lastScan:ht,lastOnScan:ht,contentBefore:[],lastScanHadContent:!1};It.current=window.requestAnimationFrame(Rt(mt))},[Rt]),stopScanning:Ct.useCallback(()=>{It.current!==null&&(window.cancelAnimationFrame(It.current),It.current=null)},[])}})({videoElementRef:N,onScan:r,onFound:ke,formats:o,retryDelay:j.tracker===void 0?500:10,scanDelay:S,allowMultiple:y,sound:B});Ct.useEffect(()=>(te(!0),()=>{te(!1)}),[]),Ct.useEffect(()=>{if(!Bb(X,ue)){const Ge=X;a?.deviceId&&delete Ge.facingMode,ee(Ge)}},[a,X,ue]);const ve=Ct.useMemo(()=>({constraints:ue,shouldStream:F&&!c}),[ue,F,c]),xe=Ct.useCallback(async()=>{const Ge=N.current;if(Ge==null)throw new Error("Video should be defined when component is mounted.");const qe=k.current;if(qe==null)throw new Error("Canvas should be defined when component is mounted.");const ft=qe.getContext("2d");if(ft==null)throw new Error("Canvas should be defined when component is mounted.");if(ve.shouldStream){await le.current.stopCamera(),oe(!1);try{await le.current.startCamera(Ge,ve),Ge?oe(!0):await le.current.stopCamera()}catch(ne){Qe.current?.(ne),console.error("error",ne)}}else qe.width=Ge.videoWidth,qe.height=Ge.videoHeight,ft.drawImage(Ge,0,0,Ge.videoWidth,Ge.videoHeight),await le.current.stopCamera(),oe(!1)},[ve]);Ct.useEffect(()=>{(async()=>await xe())()},[xe]);const _e=Ct.useMemo(()=>ve.shouldStream&&Q,[ve.shouldStream,Q]);return Ct.useEffect(()=>{if(_e){if(k.current===void 0)throw new Error("shouldScan effect should only be triggered when component is mounted. Thus pause frame canvas is defined");if(Ac(k.current),z.current===void 0)throw new Error("shouldScan effect should only be triggered when component is mounted. Thus tracking canvas is defined");if(Ac(z.current),N.current==null)throw new Error("shouldScan effect should only be triggered when component is mounted. Thus video element is defined");at()}return()=>{et()}},[_e,at,et]),ie.jsxs("div",{style:{...QE,...x?.container},className:_?.container,children:[ie.jsx("video",{ref:N,style:{...XE,...x?.video,visibility:c?"hidden":"visible"},className:_?.video,autoPlay:!0,muted:!0,playsInline:!0}),ie.jsx("canvas",{ref:k,style:{display:c?"block":"none",position:"absolute",width:"100%",height:"100%"}}),ie.jsx("canvas",{ref:z,style:{position:"absolute",width:"100%",height:"100%"}}),ie.jsxs("div",{style:{position:"absolute",width:"100%",height:"100%"},children:[j.finder&&ie.jsx(o4,{scanning:Q,capabilities:ce.capabilities,onOff:j.onOff,zoom:j.zoom&&ce.settings.zoom?{value:ce.settings.zoom,onChange:async Ge=>{const qe={...ue,advanced:[{zoom:Ge}]};await ce.updateConstraints(qe)}}:void 0,torch:j.torch?{status:ce.settings.torch??!1,toggle:async Ge=>{const qe={...ue,advanced:[{torch:Ge}]};await ce.updateConstraints(qe)}}:void 0,startScanning:async()=>await xe(),stopScanning:async()=>{await ce.stopCamera(),Ac(z.current),oe(!1)}}),m]})]})}var Ut;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ut||(Ut={}));var Fm=new Map([[Ut.QR_CODE,"QR_CODE"],[Ut.AZTEC,"AZTEC"],[Ut.CODABAR,"CODABAR"],[Ut.CODE_39,"CODE_39"],[Ut.CODE_93,"CODE_93"],[Ut.CODE_128,"CODE_128"],[Ut.DATA_MATRIX,"DATA_MATRIX"],[Ut.MAXICODE,"MAXICODE"],[Ut.ITF,"ITF"],[Ut.EAN_13,"EAN_13"],[Ut.EAN_8,"EAN_8"],[Ut.PDF_417,"PDF_417"],[Ut.RSS_14,"RSS_14"],[Ut.RSS_EXPANDED,"RSS_EXPANDED"],[Ut.UPC_A,"UPC_A"],[Ut.UPC_E,"UPC_E"],[Ut.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Gm;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(Gm||(Gm={}));function u4(e){return Object.values(Ut).includes(e)}var Kc;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Kc||(Kc={}));var c4=(function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[Kc.SCAN_TYPE_CAMERA,Kc.SCAN_TYPE_FILE],e})(),Nb=(function(){function e(r,a){this.format=r,this.formatName=a}return e.prototype.toString=function(){return this.formatName},e.create=function(r){if(!Fm.has(r))throw"".concat(r," not in html5QrcodeSupportedFormatsTextMap");return new e(r,Fm.get(r))},e})(),Vm=(function(){function e(){}return e.createFromText=function(r){var a={text:r};return{decodedText:r,result:a}},e.createFromQrcodeResult=function(r){return{decodedText:r.text,result:r}},e})(),mh;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(mh||(mh={}));var f4=(function(){function e(){}return e.createFrom=function(r){return{errorMessage:r,type:mh.UNKWOWN_ERROR}},e})(),d4=(function(){function e(r){this.verbose=r}return e.prototype.log=function(r){this.verbose&&console.log(r)},e.prototype.warn=function(r){this.verbose&&console.warn(r)},e.prototype.logError=function(r,a){(this.verbose||a===!0)&&console.error(r)},e.prototype.logErrors=function(r){if(r.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(r)},e})();function Es(e){return typeof e>"u"||e===null}var dl=(function(){function e(){}return e.codeParseError=function(r){return"QR code parse error, error = ".concat(r)},e.errorGettingUserMedia=function(r){return"Error getting userMedia, error = ".concat(r)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e})(),kb=(function(){function e(){}return e.isMediaStreamConstraintsValid=function(r,a){if(typeof r!="object"){var o=typeof r;return a.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(o,"."),!0),!1}for(var c=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],h=new Set(c),m=Object.keys(r),x=0,_=m;x<_.length;x++){var y=_[x];if(h.has(y))return a.logError("".concat(y," is not supported videoConstaints."),!0),!1}return!0},e})(),mu={exports:{}},h4=mu.exports,qm;function p4(){return qm||(qm=1,(function(e,r){(function(a,o){o(r)})(h4,(function(a){function o(G){return G==null}var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,n){G.__proto__=n}||function(G,n){for(var s in n)n.hasOwnProperty(s)&&(G[s]=n[s])};function h(G,n){c(G,n);function s(){this.constructor=G}G.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}function m(G,n){var s=Object.setPrototypeOf;s?s(G,n):G.__proto__=n}function x(G,n){n===void 0&&(n=G.constructor);var s=Error.captureStackTrace;s&&s(G,n)}var _=(function(G){h(n,G);function n(s){var l=this.constructor,f=G.call(this,s)||this;return Object.defineProperty(f,"name",{value:l.name,enumerable:!1}),m(f,l.prototype),x(f),f}return n})(Error);class y extends _{constructor(n=void 0){super(n),this.message=n}getKind(){return this.constructor.kind}}y.kind="Exception";class S extends y{}S.kind="ArgumentException";class R extends y{}R.kind="IllegalArgumentException";class B{constructor(n){if(this.binarizer=n,n===null)throw new R("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(n,s){return this.binarizer.getBlackRow(n,s)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(n,s,l,f){const d=this.binarizer.getLuminanceSource().crop(n,s,l,f);return new B(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const n=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new B(this.binarizer.createBinarizer(n))}rotateCounterClockwise45(){const n=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new B(this.binarizer.createBinarizer(n))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class N extends y{static getChecksumInstance(){return new N}}N.kind="ChecksumException";class k{constructor(n){this.source=n}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class z{static arraycopy(n,s,l,f,d){for(;d--;)l[f++]=n[s++]}static currentTimeMillis(){return Date.now()}}class X extends y{}X.kind="IndexOutOfBoundsException";class j extends X{constructor(n=void 0,s=void 0){super(s),this.index=n,this.message=s}}j.kind="ArrayIndexOutOfBoundsException";class F{static fill(n,s){for(let l=0,f=n.length;l<f;l++)n[l]=s}static fillWithin(n,s,l,f){F.rangeCheck(n.length,s,l);for(let d=s;d<l;d++)n[d]=f}static rangeCheck(n,s,l){if(s>l)throw new R("fromIndex("+s+") > toIndex("+l+")");if(s<0)throw new j(s);if(l>n)throw new j(l)}static asList(...n){return n}static create(n,s,l){return Array.from({length:n}).map(d=>Array.from({length:s}).fill(l))}static createInt32Array(n,s,l){return Array.from({length:n}).map(d=>Int32Array.from({length:s}).fill(l))}static equals(n,s){if(!n||!s||!n.length||!s.length||n.length!==s.length)return!1;for(let l=0,f=n.length;l<f;l++)if(n[l]!==s[l])return!1;return!0}static hashCode(n){if(n===null)return 0;let s=1;for(const l of n)s=31*s+l;return s}static fillUint8Array(n,s){for(let l=0;l!==n.length;l++)n[l]=s}static copyOf(n,s){return n.slice(0,s)}static copyOfUint8Array(n,s){if(n.length<=s){const l=new Uint8Array(s);return l.set(n),l}return n.slice(0,s)}static copyOfRange(n,s,l){const f=l-s,d=new Int32Array(f);return z.arraycopy(n,s,d,0,f),d}static binarySearch(n,s,l){l===void 0&&(l=F.numberComparator);let f=0,d=n.length-1;for(;f<=d;){const g=d+f>>1,w=l(s,n[g]);if(w>0)f=g+1;else if(w<0)d=g-1;else return g}return-f-1}static numberComparator(n,s){return n-s}}class te{static numberOfTrailingZeros(n){let s;if(n===0)return 32;let l=31;return s=n<<16,s!==0&&(l-=16,n=s),s=n<<8,s!==0&&(l-=8,n=s),s=n<<4,s!==0&&(l-=4,n=s),s=n<<2,s!==0&&(l-=2,n=s),l-(n<<1>>>31)}static numberOfLeadingZeros(n){if(n===0)return 32;let s=1;return n>>>16||(s+=16,n<<=16),n>>>24||(s+=8,n<<=8),n>>>28||(s+=4,n<<=4),n>>>30||(s+=2,n<<=2),s-=n>>>31,s}static toHexString(n){return n.toString(16)}static toBinaryString(n){return String(parseInt(String(n),2))}static bitCount(n){return n=n-(n>>>1&1431655765),n=(n&858993459)+(n>>>2&858993459),n=n+(n>>>4)&252645135,n=n+(n>>>8),n=n+(n>>>16),n&63}static truncDivision(n,s){return Math.trunc(n/s)}static parseInt(n,s=void 0){return parseInt(n,s)}}te.MIN_VALUE_32_BITS=-2147483648,te.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Q{constructor(n,s){n===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=n,s==null?this.bits=Q.makeArray(n):this.bits=s)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(n){if(n>this.bits.length*32){const s=Q.makeArray(n);z.arraycopy(this.bits,0,s,0,this.bits.length),this.bits=s}}get(n){return(this.bits[Math.floor(n/32)]&1<<(n&31))!==0}set(n){this.bits[Math.floor(n/32)]|=1<<(n&31)}flip(n){this.bits[Math.floor(n/32)]^=1<<(n&31)}getNextSet(n){const s=this.size;if(n>=s)return s;const l=this.bits;let f=Math.floor(n/32),d=l[f];d&=~((1<<(n&31))-1);const g=l.length;for(;d===0;){if(++f===g)return s;d=l[f]}const w=f*32+te.numberOfTrailingZeros(d);return w>s?s:w}getNextUnset(n){const s=this.size;if(n>=s)return s;const l=this.bits;let f=Math.floor(n/32),d=~l[f];d&=~((1<<(n&31))-1);const g=l.length;for(;d===0;){if(++f===g)return s;d=~l[f]}const w=f*32+te.numberOfTrailingZeros(d);return w>s?s:w}setBulk(n,s){this.bits[Math.floor(n/32)]=s}setRange(n,s){if(s<n||n<0||s>this.size)throw new R;if(s===n)return;s--;const l=Math.floor(n/32),f=Math.floor(s/32),d=this.bits;for(let g=l;g<=f;g++){const w=g>l?0:n&31,O=(2<<(g<f?31:s&31))-(1<<w);d[g]|=O}}clear(){const n=this.bits.length,s=this.bits;for(let l=0;l<n;l++)s[l]=0}isRange(n,s,l){if(s<n||n<0||s>this.size)throw new R;if(s===n)return!0;s--;const f=Math.floor(n/32),d=Math.floor(s/32),g=this.bits;for(let w=f;w<=d;w++){const E=w>f?0:n&31,L=(2<<(w<d?31:s&31))-(1<<E)&4294967295;if((g[w]&L)!==(l?L:0))return!1}return!0}appendBit(n){this.ensureCapacity(this.size+1),n&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(n,s){if(s<0||s>32)throw new R("Num bits must be between 0 and 32");this.ensureCapacity(this.size+s);for(let l=s;l>0;l--)this.appendBit((n>>l-1&1)===1)}appendBitArray(n){const s=n.size;this.ensureCapacity(this.size+s);for(let l=0;l<s;l++)this.appendBit(n.get(l))}xor(n){if(this.size!==n.size)throw new R("Sizes don't match");const s=this.bits;for(let l=0,f=s.length;l<f;l++)s[l]^=n.bits[l]}toBytes(n,s,l,f){for(let d=0;d<f;d++){let g=0;for(let w=0;w<8;w++)this.get(n)&&(g|=1<<7-w),n++;s[l+d]=g}}getBitArray(){return this.bits}reverse(){const n=new Int32Array(this.bits.length),s=Math.floor((this.size-1)/32),l=s+1,f=this.bits;for(let d=0;d<l;d++){let g=f[d];g=g>>1&1431655765|(g&1431655765)<<1,g=g>>2&858993459|(g&858993459)<<2,g=g>>4&252645135|(g&252645135)<<4,g=g>>8&16711935|(g&16711935)<<8,g=g>>16&65535|(g&65535)<<16,n[s-d]=g}if(this.size!==l*32){const d=l*32-this.size;let g=n[0]>>>d;for(let w=1;w<l;w++){const E=n[w];g|=E<<32-d,n[w-1]=g,g=E>>>d}n[l-1]=g}this.bits=n}static makeArray(n){return new Int32Array(Math.floor((n+31)/32))}equals(n){if(!(n instanceof Q))return!1;const s=n;return this.size===s.size&&F.equals(this.bits,s.bits)}hashCode(){return 31*this.size+F.hashCode(this.bits)}toString(){let n="";for(let s=0,l=this.size;s<l;s++)(s&7)===0&&(n+=" "),n+=this.get(s)?"X":".";return n}clone(){return new Q(this.size,this.bits.slice())}}var oe;(function(G){G[G.OTHER=0]="OTHER",G[G.PURE_BARCODE=1]="PURE_BARCODE",G[G.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",G[G.TRY_HARDER=3]="TRY_HARDER",G[G.CHARACTER_SET=4]="CHARACTER_SET",G[G.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",G[G.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",G[G.ASSUME_GS1=7]="ASSUME_GS1",G[G.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",G[G.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",G[G.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(oe||(oe={}));var ue=oe;class ee extends y{static getFormatInstance(){return new ee}}ee.kind="FormatException";var ce;(function(G){G[G.Cp437=0]="Cp437",G[G.ISO8859_1=1]="ISO8859_1",G[G.ISO8859_2=2]="ISO8859_2",G[G.ISO8859_3=3]="ISO8859_3",G[G.ISO8859_4=4]="ISO8859_4",G[G.ISO8859_5=5]="ISO8859_5",G[G.ISO8859_6=6]="ISO8859_6",G[G.ISO8859_7=7]="ISO8859_7",G[G.ISO8859_8=8]="ISO8859_8",G[G.ISO8859_9=9]="ISO8859_9",G[G.ISO8859_10=10]="ISO8859_10",G[G.ISO8859_11=11]="ISO8859_11",G[G.ISO8859_13=12]="ISO8859_13",G[G.ISO8859_14=13]="ISO8859_14",G[G.ISO8859_15=14]="ISO8859_15",G[G.ISO8859_16=15]="ISO8859_16",G[G.SJIS=16]="SJIS",G[G.Cp1250=17]="Cp1250",G[G.Cp1251=18]="Cp1251",G[G.Cp1252=19]="Cp1252",G[G.Cp1256=20]="Cp1256",G[G.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",G[G.UTF8=22]="UTF8",G[G.ASCII=23]="ASCII",G[G.Big5=24]="Big5",G[G.GB18030=25]="GB18030",G[G.EUC_KR=26]="EUC_KR"})(ce||(ce={}));class le{constructor(n,s,l,...f){this.valueIdentifier=n,this.name=l,typeof s=="number"?this.values=Int32Array.from([s]):this.values=s,this.otherEncodingNames=f,le.VALUE_IDENTIFIER_TO_ECI.set(n,this),le.NAME_TO_ECI.set(l,this);const d=this.values;for(let g=0,w=d.length;g!==w;g++){const E=d[g];le.VALUES_TO_ECI.set(E,this)}for(const g of f)le.NAME_TO_ECI.set(g,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(n){if(n<0||n>=900)throw new ee("incorect value");const s=le.VALUES_TO_ECI.get(n);if(s===void 0)throw new ee("incorect value");return s}static getCharacterSetECIByName(n){const s=le.NAME_TO_ECI.get(n);if(s===void 0)throw new ee("incorect value");return s}equals(n){if(!(n instanceof le))return!1;const s=n;return this.getName()===s.getName()}}le.VALUE_IDENTIFIER_TO_ECI=new Map,le.VALUES_TO_ECI=new Map,le.NAME_TO_ECI=new Map,le.Cp437=new le(ce.Cp437,Int32Array.from([0,2]),"Cp437"),le.ISO8859_1=new le(ce.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),le.ISO8859_2=new le(ce.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),le.ISO8859_3=new le(ce.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),le.ISO8859_4=new le(ce.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),le.ISO8859_5=new le(ce.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),le.ISO8859_6=new le(ce.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),le.ISO8859_7=new le(ce.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),le.ISO8859_8=new le(ce.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),le.ISO8859_9=new le(ce.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),le.ISO8859_10=new le(ce.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),le.ISO8859_11=new le(ce.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),le.ISO8859_13=new le(ce.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),le.ISO8859_14=new le(ce.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),le.ISO8859_15=new le(ce.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),le.ISO8859_16=new le(ce.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),le.SJIS=new le(ce.SJIS,20,"SJIS","Shift_JIS"),le.Cp1250=new le(ce.Cp1250,21,"Cp1250","windows-1250"),le.Cp1251=new le(ce.Cp1251,22,"Cp1251","windows-1251"),le.Cp1252=new le(ce.Cp1252,23,"Cp1252","windows-1252"),le.Cp1256=new le(ce.Cp1256,24,"Cp1256","windows-1256"),le.UnicodeBigUnmarked=new le(ce.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),le.UTF8=new le(ce.UTF8,26,"UTF8","UTF-8"),le.ASCII=new le(ce.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),le.Big5=new le(ce.Big5,28,"Big5"),le.GB18030=new le(ce.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),le.EUC_KR=new le(ce.EUC_KR,30,"EUC_KR","EUC-KR");class Qe extends y{}Qe.kind="UnsupportedOperationException";class Je{static decode(n,s){const l=this.encodingName(s);return this.customDecoder?this.customDecoder(n,l):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(l)?this.decodeFallback(n,l):new TextDecoder(l).decode(n)}static shouldDecodeOnFallback(n){return!Je.isBrowser()&&n==="ISO-8859-1"}static encode(n,s){const l=this.encodingName(s);return this.customEncoder?this.customEncoder(n,l):typeof TextEncoder>"u"?this.encodeFallback(n):new TextEncoder().encode(n)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(n){return typeof n=="string"?n:n.getName()}static encodingCharacterSet(n){return n instanceof le?n:le.getCharacterSetECIByName(n)}static decodeFallback(n,s){const l=this.encodingCharacterSet(s);if(Je.isDecodeFallbackSupported(l)){let f="";for(let d=0,g=n.length;d<g;d++){let w=n[d].toString(16);w.length<2&&(w="0"+w),f+="%"+w}return decodeURIComponent(f)}if(l.equals(le.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(n.buffer));throw new Qe(`Encoding ${this.encodingName(s)} not supported by fallback.`)}static isDecodeFallbackSupported(n){return n.equals(le.UTF8)||n.equals(le.ISO8859_1)||n.equals(le.ASCII)}static encodeFallback(n){const l=btoa(unescape(encodeURIComponent(n))).split(""),f=[];for(let d=0;d<l.length;d++)f.push(l[d].charCodeAt(0));return new Uint8Array(f)}}class ke{static castAsNonUtf8Char(n,s=null){const l=s?s.getName():this.ISO88591;return Je.decode(new Uint8Array([n]),l)}static guessEncoding(n,s){if(s!=null&&s.get(ue.CHARACTER_SET)!==void 0)return s.get(ue.CHARACTER_SET).toString();const l=n.length;let f=!0,d=!0,g=!0,w=0,E=0,O=0,L=0,V=0,Y=0,ae=0,ge=0,we=0,Oe=0,Ue=0;const pt=n.length>3&&n[0]===239&&n[1]===187&&n[2]===191;for(let dt=0;dt<l&&(f||d||g);dt++){const v=n[dt]&255;g&&(w>0?(v&128)===0?g=!1:w--:(v&128)!==0&&((v&64)===0?g=!1:(w++,(v&32)===0?E++:(w++,(v&16)===0?O++:(w++,(v&8)===0?L++:g=!1))))),f&&(v>127&&v<160?f=!1:v>159&&(v<192||v===215||v===247)&&Ue++),d&&(V>0?v<64||v===127||v>252?d=!1:V--:v===128||v===160||v>239?d=!1:v>160&&v<224?(Y++,ge=0,ae++,ae>we&&(we=ae)):v>127?(V++,ae=0,ge++,ge>Oe&&(Oe=ge)):(ae=0,ge=0))}return g&&w>0&&(g=!1),d&&V>0&&(d=!1),g&&(pt||E+O+L>0)?ke.UTF8:d&&(ke.ASSUME_SHIFT_JIS||we>=3||Oe>=3)?ke.SHIFT_JIS:f&&d?we===2&&Y===2||Ue*10>=l?ke.SHIFT_JIS:ke.ISO88591:f?ke.ISO88591:d?ke.SHIFT_JIS:g?ke.UTF8:ke.PLATFORM_DEFAULT_ENCODING}static format(n,...s){let l=-1;function f(g,w,E,O,L,V){if(g==="%%")return"%";if(s[++l]===void 0)return;g=O?parseInt(O.substr(1)):void 0;let Y=L?parseInt(L.substr(1)):void 0,ae;switch(V){case"s":ae=s[l];break;case"c":ae=s[l][0];break;case"f":ae=parseFloat(s[l]).toFixed(g);break;case"p":ae=parseFloat(s[l]).toPrecision(g);break;case"e":ae=parseFloat(s[l]).toExponential(g);break;case"x":ae=parseInt(s[l]).toString(Y||16);break;case"d":ae=parseFloat(parseInt(s[l],Y||10).toPrecision(g)).toFixed(0);break}ae=typeof ae=="object"?JSON.stringify(ae):(+ae).toString(Y);let ge=parseInt(E),we=E&&E[0]+""=="0"?"0":" ";for(;ae.length<ge;)ae=w!==void 0?ae+we:we+ae;return ae}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return n.replace(d,f)}static getBytes(n,s){return Je.encode(n,s)}static getCharCode(n,s=0){return n.charCodeAt(s)}static getCharAt(n){return String.fromCharCode(n)}}ke.SHIFT_JIS=le.SJIS.getName(),ke.GB2312="GB2312",ke.ISO88591=le.ISO8859_1.getName(),ke.EUC_JP="EUC_JP",ke.UTF8=le.UTF8.getName(),ke.PLATFORM_DEFAULT_ENCODING=ke.UTF8,ke.ASSUME_SHIFT_JIS=!1;class at{constructor(n=""){this.value=n}enableDecoding(n){return this.encoding=n,this}append(n){return typeof n=="string"?this.value+=n.toString():this.encoding?this.value+=ke.castAsNonUtf8Char(n,this.encoding):this.value+=String.fromCharCode(n),this}appendChars(n,s,l){for(let f=s;s<s+l;f++)this.append(n[f]);return this}length(){return this.value.length}charAt(n){return this.value.charAt(n)}deleteCharAt(n){this.value=this.value.substr(0,n)+this.value.substring(n+1)}setCharAt(n,s){this.value=this.value.substr(0,n)+s+this.value.substr(n+1)}substring(n,s){return this.value.substring(n,s)}setLengthToZero(){this.value=""}toString(){return this.value}insert(n,s){this.value=this.value.substr(0,n)+s+this.value.substr(n+s.length)}}class et{constructor(n,s,l,f){if(this.width=n,this.height=s,this.rowSize=l,this.bits=f,s==null&&(s=n),this.height=s,n<1||s<1)throw new R("Both dimensions must be greater than 0");l==null&&(l=Math.floor((n+31)/32)),this.rowSize=l,f==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(n){const s=n.length,l=n[0].length,f=new et(l,s);for(let d=0;d<s;d++){const g=n[d];for(let w=0;w<l;w++)g[w]&&f.set(w,d)}return f}static parseFromString(n,s,l){if(n===null)throw new R("stringRepresentation cannot be null");const f=new Array(n.length);let d=0,g=0,w=-1,E=0,O=0;for(;O<n.length;)if(n.charAt(O)===`
`||n.charAt(O)==="\r"){if(d>g){if(w===-1)w=d-g;else if(d-g!==w)throw new R("row lengths do not match");g=d,E++}O++}else if(n.substring(O,O+s.length)===s)O+=s.length,f[d]=!0,d++;else if(n.substring(O,O+l.length)===l)O+=l.length,f[d]=!1,d++;else throw new R("illegal character encountered: "+n.substring(O));if(d>g){if(w===-1)w=d-g;else if(d-g!==w)throw new R("row lengths do not match");E++}const L=new et(w,E);for(let V=0;V<d;V++)f[V]&&L.set(Math.floor(V%w),Math.floor(V/w));return L}get(n,s){const l=s*this.rowSize+Math.floor(n/32);return(this.bits[l]>>>(n&31)&1)!==0}set(n,s){const l=s*this.rowSize+Math.floor(n/32);this.bits[l]|=1<<(n&31)&4294967295}unset(n,s){const l=s*this.rowSize+Math.floor(n/32);this.bits[l]&=~(1<<(n&31)&4294967295)}flip(n,s){const l=s*this.rowSize+Math.floor(n/32);this.bits[l]^=1<<(n&31)&4294967295}xor(n){if(this.width!==n.getWidth()||this.height!==n.getHeight()||this.rowSize!==n.getRowSize())throw new R("input matrix dimensions do not match");const s=new Q(Math.floor(this.width/32)+1),l=this.rowSize,f=this.bits;for(let d=0,g=this.height;d<g;d++){const w=d*l,E=n.getRow(d,s).getBitArray();for(let O=0;O<l;O++)f[w+O]^=E[O]}}clear(){const n=this.bits,s=n.length;for(let l=0;l<s;l++)n[l]=0}setRegion(n,s,l,f){if(s<0||n<0)throw new R("Left and top must be nonnegative");if(f<1||l<1)throw new R("Height and width must be at least 1");const d=n+l,g=s+f;if(g>this.height||d>this.width)throw new R("The region must fit inside the matrix");const w=this.rowSize,E=this.bits;for(let O=s;O<g;O++){const L=O*w;for(let V=n;V<d;V++)E[L+Math.floor(V/32)]|=1<<(V&31)&4294967295}}getRow(n,s){s==null||s.getSize()<this.width?s=new Q(this.width):s.clear();const l=this.rowSize,f=this.bits,d=n*l;for(let g=0;g<l;g++)s.setBulk(g*32,f[d+g]);return s}setRow(n,s){z.arraycopy(s.getBitArray(),0,this.bits,n*this.rowSize,this.rowSize)}rotate180(){const n=this.getWidth(),s=this.getHeight();let l=new Q(n),f=new Q(n);for(let d=0,g=Math.floor((s+1)/2);d<g;d++)l=this.getRow(d,l),f=this.getRow(s-1-d,f),l.reverse(),f.reverse(),this.setRow(d,f),this.setRow(s-1-d,l)}getEnclosingRectangle(){const n=this.width,s=this.height,l=this.rowSize,f=this.bits;let d=n,g=s,w=-1,E=-1;for(let O=0;O<s;O++)for(let L=0;L<l;L++){const V=f[O*l+L];if(V!==0){if(O<g&&(g=O),O>E&&(E=O),L*32<d){let Y=0;for(;(V<<31-Y&4294967295)===0;)Y++;L*32+Y<d&&(d=L*32+Y)}if(L*32+31>w){let Y=31;for(;!(V>>>Y);)Y--;L*32+Y>w&&(w=L*32+Y)}}}return w<d||E<g?null:Int32Array.from([d,g,w-d+1,E-g+1])}getTopLeftOnBit(){const n=this.rowSize,s=this.bits;let l=0;for(;l<s.length&&s[l]===0;)l++;if(l===s.length)return null;const f=l/n;let d=l%n*32;const g=s[l];let w=0;for(;(g<<31-w&4294967295)===0;)w++;return d+=w,Int32Array.from([d,f])}getBottomRightOnBit(){const n=this.rowSize,s=this.bits;let l=s.length-1;for(;l>=0&&s[l]===0;)l--;if(l<0)return null;const f=Math.floor(l/n);let d=Math.floor(l%n)*32;const g=s[l];let w=31;for(;!(g>>>w);)w--;return d+=w,Int32Array.from([d,f])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(n){if(!(n instanceof et))return!1;const s=n;return this.width===s.width&&this.height===s.height&&this.rowSize===s.rowSize&&F.equals(this.bits,s.bits)}hashCode(){let n=this.width;return n=31*n+this.width,n=31*n+this.height,n=31*n+this.rowSize,n=31*n+F.hashCode(this.bits),n}toString(n="X ",s="  ",l=`
`){return this.buildToString(n,s,l)}buildToString(n,s,l){let f=new at;for(let d=0,g=this.height;d<g;d++){for(let w=0,E=this.width;w<E;w++)f.append(this.get(w,d)?n:s);f.append(l)}return f.toString()}clone(){return new et(this.width,this.height,this.rowSize,this.bits.slice())}}class ve extends y{static getNotFoundInstance(){return new ve}}ve.kind="NotFoundException";class xe extends k{constructor(n){super(n),this.luminances=xe.EMPTY,this.buckets=new Int32Array(xe.LUMINANCE_BUCKETS)}getBlackRow(n,s){const l=this.getLuminanceSource(),f=l.getWidth();s==null||s.getSize()<f?s=new Q(f):s.clear(),this.initArrays(f);const d=l.getRow(n,this.luminances),g=this.buckets;for(let E=0;E<f;E++)g[(d[E]&255)>>xe.LUMINANCE_SHIFT]++;const w=xe.estimateBlackPoint(g);if(f<3)for(let E=0;E<f;E++)(d[E]&255)<w&&s.set(E);else{let E=d[0]&255,O=d[1]&255;for(let L=1;L<f-1;L++){const V=d[L+1]&255;(O*4-E-V)/2<w&&s.set(L),E=O,O=V}}return s}getBlackMatrix(){const n=this.getLuminanceSource(),s=n.getWidth(),l=n.getHeight(),f=new et(s,l);this.initArrays(s);const d=this.buckets;for(let E=1;E<5;E++){const O=Math.floor(l*E/5),L=n.getRow(O,this.luminances),V=Math.floor(s*4/5);for(let Y=Math.floor(s/5);Y<V;Y++){const ae=L[Y]&255;d[ae>>xe.LUMINANCE_SHIFT]++}}const g=xe.estimateBlackPoint(d),w=n.getMatrix();for(let E=0;E<l;E++){const O=E*s;for(let L=0;L<s;L++)(w[O+L]&255)<g&&f.set(L,E)}return f}createBinarizer(n){return new xe(n)}initArrays(n){this.luminances.length<n&&(this.luminances=new Uint8ClampedArray(n));const s=this.buckets;for(let l=0;l<xe.LUMINANCE_BUCKETS;l++)s[l]=0}static estimateBlackPoint(n){const s=n.length;let l=0,f=0,d=0;for(let L=0;L<s;L++)n[L]>d&&(f=L,d=n[L]),n[L]>l&&(l=n[L]);let g=0,w=0;for(let L=0;L<s;L++){const V=L-f,Y=n[L]*V*V;Y>w&&(g=L,w=Y)}if(f>g){const L=f;f=g,g=L}if(g-f<=s/16)throw new ve;let E=g-1,O=-1;for(let L=g-1;L>f;L--){const V=L-f,Y=V*V*(g-L)*(l-n[L]);Y>O&&(E=L,O=Y)}return E<<xe.LUMINANCE_SHIFT}}xe.LUMINANCE_BITS=5,xe.LUMINANCE_SHIFT=8-xe.LUMINANCE_BITS,xe.LUMINANCE_BUCKETS=1<<xe.LUMINANCE_BITS,xe.EMPTY=Uint8ClampedArray.from([0]);class _e extends xe{constructor(n){super(n),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const n=this.getLuminanceSource(),s=n.getWidth(),l=n.getHeight();if(s>=_e.MINIMUM_DIMENSION&&l>=_e.MINIMUM_DIMENSION){const f=n.getMatrix();let d=s>>_e.BLOCK_SIZE_POWER;(s&_e.BLOCK_SIZE_MASK)!==0&&d++;let g=l>>_e.BLOCK_SIZE_POWER;(l&_e.BLOCK_SIZE_MASK)!==0&&g++;const w=_e.calculateBlackPoints(f,d,g,s,l),E=new et(s,l);_e.calculateThresholdForBlock(f,d,g,s,l,w,E),this.matrix=E}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(n){return new _e(n)}static calculateThresholdForBlock(n,s,l,f,d,g,w){const E=d-_e.BLOCK_SIZE,O=f-_e.BLOCK_SIZE;for(let L=0;L<l;L++){let V=L<<_e.BLOCK_SIZE_POWER;V>E&&(V=E);const Y=_e.cap(L,2,l-3);for(let ae=0;ae<s;ae++){let ge=ae<<_e.BLOCK_SIZE_POWER;ge>O&&(ge=O);const we=_e.cap(ae,2,s-3);let Oe=0;for(let pt=-2;pt<=2;pt++){const dt=g[Y+pt];Oe+=dt[we-2]+dt[we-1]+dt[we]+dt[we+1]+dt[we+2]}const Ue=Oe/25;_e.thresholdBlock(n,ge,V,Ue,f,w)}}}static cap(n,s,l){return n<s?s:n>l?l:n}static thresholdBlock(n,s,l,f,d,g){for(let w=0,E=l*d+s;w<_e.BLOCK_SIZE;w++,E+=d)for(let O=0;O<_e.BLOCK_SIZE;O++)(n[E+O]&255)<=f&&g.set(s+O,l+w)}static calculateBlackPoints(n,s,l,f,d){const g=d-_e.BLOCK_SIZE,w=f-_e.BLOCK_SIZE,E=new Array(l);for(let O=0;O<l;O++){E[O]=new Int32Array(s);let L=O<<_e.BLOCK_SIZE_POWER;L>g&&(L=g);for(let V=0;V<s;V++){let Y=V<<_e.BLOCK_SIZE_POWER;Y>w&&(Y=w);let ae=0,ge=255,we=0;for(let Ue=0,pt=L*f+Y;Ue<_e.BLOCK_SIZE;Ue++,pt+=f){for(let dt=0;dt<_e.BLOCK_SIZE;dt++){const v=n[pt+dt]&255;ae+=v,v<ge&&(ge=v),v>we&&(we=v)}if(we-ge>_e.MIN_DYNAMIC_RANGE)for(Ue++,pt+=f;Ue<_e.BLOCK_SIZE;Ue++,pt+=f)for(let dt=0;dt<_e.BLOCK_SIZE;dt++)ae+=n[pt+dt]&255}let Oe=ae>>_e.BLOCK_SIZE_POWER*2;if(we-ge<=_e.MIN_DYNAMIC_RANGE&&(Oe=ge/2,O>0&&V>0)){const Ue=(E[O-1][V]+2*E[O][V-1]+E[O-1][V-1])/4;ge<Ue&&(Oe=Ue)}E[O][V]=Oe}}return E}}_e.BLOCK_SIZE_POWER=3,_e.BLOCK_SIZE=1<<_e.BLOCK_SIZE_POWER,_e.BLOCK_SIZE_MASK=_e.BLOCK_SIZE-1,_e.MINIMUM_DIMENSION=_e.BLOCK_SIZE*5,_e.MIN_DYNAMIC_RANGE=24;class Ge{constructor(n,s){this.width=n,this.height=s}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(n,s,l,f){throw new Qe("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Qe("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Qe("This luminance source does not support rotation by 45 degrees.")}toString(){const n=new Uint8ClampedArray(this.width);let s=new at;for(let l=0;l<this.height;l++){const f=this.getRow(l,n);for(let d=0;d<this.width;d++){const g=f[d]&255;let w;g<64?w="#":g<128?w="+":g<192?w=".":w=" ",s.append(w)}s.append(`
`)}return s.toString()}}class qe extends Ge{constructor(n){super(n.getWidth(),n.getHeight()),this.delegate=n}getRow(n,s){const l=this.delegate.getRow(n,s),f=this.getWidth();for(let d=0;d<f;d++)l[d]=255-(l[d]&255);return l}getMatrix(){const n=this.delegate.getMatrix(),s=this.getWidth()*this.getHeight(),l=new Uint8ClampedArray(s);for(let f=0;f<s;f++)l[f]=255-(n[f]&255);return l}isCropSupported(){return this.delegate.isCropSupported()}crop(n,s,l,f){return new qe(this.delegate.crop(n,s,l,f))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new qe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new qe(this.delegate.rotateCounterClockwise45())}}class ft extends Ge{constructor(n){super(n.width,n.height),this.canvas=n,this.tempCanvasElement=null,this.buffer=ft.makeBufferFromCanvasImageData(n)}static makeBufferFromCanvasImageData(n){const s=n.getContext("2d").getImageData(0,0,n.width,n.height);return ft.toGrayscaleBuffer(s.data,n.width,n.height)}static toGrayscaleBuffer(n,s,l){const f=new Uint8ClampedArray(s*l);for(let d=0,g=0,w=n.length;d<w;d+=4,g++){let E;if(n[d+3]===0)E=255;else{const L=n[d],V=n[d+1],Y=n[d+2];E=306*L+601*V+117*Y+512>>10}f[g]=E}return f}getRow(n,s){if(n<0||n>=this.getHeight())throw new R("Requested row is outside the image: "+n);const l=this.getWidth(),f=n*l;return s===null?s=this.buffer.slice(f,f+l):(s.length<l&&(s=new Uint8ClampedArray(l)),s.set(this.buffer.slice(f,f+l))),s}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(n,s,l,f){return super.crop(n,s,l,f),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const n=this.canvas.ownerDocument.createElement("canvas");n.width=this.canvas.width,n.height=this.canvas.height,this.tempCanvasElement=n}return this.tempCanvasElement}rotate(n){const s=this.getTempCanvasElement(),l=s.getContext("2d"),f=n*ft.DEGREE_TO_RADIANS,d=this.canvas.width,g=this.canvas.height,w=Math.ceil(Math.abs(Math.cos(f))*d+Math.abs(Math.sin(f))*g),E=Math.ceil(Math.abs(Math.sin(f))*d+Math.abs(Math.cos(f))*g);return s.width=w,s.height=E,l.translate(w/2,E/2),l.rotate(f),l.drawImage(this.canvas,d/-2,g/-2),this.buffer=ft.makeBufferFromCanvasImageData(s),this}invert(){return new qe(this)}}ft.DEGREE_TO_RADIANS=Math.PI/180;class ne{constructor(n,s,l){this.deviceId=n,this.label=s,this.kind="videoinput",this.groupId=l||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var fe=(globalThis||Cc||self||window||void 0)&&(globalThis||Cc||self||window||void 0).__awaiter||function(G,n,s,l){function f(d){return d instanceof s?d:new s(function(g){g(d)})}return new(s||(s=Promise))(function(d,g){function w(L){try{O(l.next(L))}catch(V){g(V)}}function E(L){try{O(l.throw(L))}catch(V){g(V)}}function O(L){L.done?d(L.value):f(L.value).then(w,E)}O((l=l.apply(G,n||[])).next())})};class De{constructor(n,s=500,l){this.reader=n,this.timeBetweenScansMillis=s,this._hints=l,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(n){this._timeBetweenDecodingAttempts=n<0?0:n}set hints(n){this._hints=n||null}get hints(){return this._hints}listVideoInputDevices(){return fe(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const n=yield navigator.mediaDevices.enumerateDevices(),s=[];for(const l of n){const f=l.kind==="video"?"videoinput":l.kind;if(f!=="videoinput")continue;const d=l.deviceId||l.id,g=l.label||`Video device ${s.length+1}`,w=l.groupId,E={deviceId:d,label:g,kind:f,groupId:w};s.push(E)}return s})}getVideoInputDevices(){return fe(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(s=>new ne(s.deviceId,s.label))})}findDeviceById(n){return fe(this,void 0,void 0,function*(){const s=yield this.listVideoInputDevices();return s?s.find(l=>l.deviceId===n):null})}decodeFromInputVideoDevice(n,s){return fe(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(n,s)})}decodeOnceFromVideoDevice(n,s){return fe(this,void 0,void 0,function*(){this.reset();let l;n?l={deviceId:{exact:n}}:l={facingMode:"environment"};const f={video:l};return yield this.decodeOnceFromConstraints(f,s)})}decodeOnceFromConstraints(n,s){return fe(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(n);return yield this.decodeOnceFromStream(l,s)})}decodeOnceFromStream(n,s){return fe(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(n,s);return yield this.decodeOnce(l)})}decodeFromInputVideoDeviceContinuously(n,s,l){return fe(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(n,s,l)})}decodeFromVideoDevice(n,s,l){return fe(this,void 0,void 0,function*(){let f;n?f={deviceId:{exact:n}}:f={facingMode:"environment"};const d={video:f};return yield this.decodeFromConstraints(d,s,l)})}decodeFromConstraints(n,s,l){return fe(this,void 0,void 0,function*(){const f=yield navigator.mediaDevices.getUserMedia(n);return yield this.decodeFromStream(f,s,l)})}decodeFromStream(n,s,l){return fe(this,void 0,void 0,function*(){this.reset();const f=yield this.attachStreamToVideo(n,s);return yield this.decodeContinuously(f,l)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(n,s){return fe(this,void 0,void 0,function*(){const l=this.prepareVideoElement(s);return this.addVideoSource(l,n),this.videoElement=l,this.stream=n,yield this.playVideoOnLoadAsync(l),l})}playVideoOnLoadAsync(n){return new Promise((s,l)=>this.playVideoOnLoad(n,()=>s()))}playVideoOnLoad(n,s){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(n),n.addEventListener("ended",this.videoEndedListener),n.addEventListener("canplay",this.videoCanPlayListener),n.addEventListener("playing",s),this.tryPlayVideo(n)}isVideoPlaying(n){return n.currentTime>0&&!n.paused&&!n.ended&&n.readyState>2}tryPlayVideo(n){return fe(this,void 0,void 0,function*(){if(this.isVideoPlaying(n)){console.warn("Trying to play video that is already playing.");return}try{yield n.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(n,s){const l=document.getElementById(n);if(!l)throw new S(`element with id '${n}' not found`);if(l.nodeName.toLowerCase()!==s.toLowerCase())throw new S(`element with id '${n}' must be an ${s} element`);return l}decodeFromImage(n,s){if(!n&&!s)throw new S("either imageElement with a src set or an url must be provided");return s&&!n?this.decodeFromImageUrl(s):this.decodeFromImageElement(n)}decodeFromVideo(n,s){if(!n&&!s)throw new S("Either an element with a src set or an URL must be provided");return s&&!n?this.decodeFromVideoUrl(s):this.decodeFromVideoElement(n)}decodeFromVideoContinuously(n,s,l){if(n===void 0&&s===void 0)throw new S("Either an element with a src set or an URL must be provided");return s&&!n?this.decodeFromVideoUrlContinuously(s,l):this.decodeFromVideoElementContinuously(n,l)}decodeFromImageElement(n){if(!n)throw new S("An image element must be provided.");this.reset();const s=this.prepareImageElement(n);this.imageElement=s;let l;return this.isImageLoaded(s)?l=this.decodeOnce(s,!1,!0):l=this._decodeOnLoadImage(s),l}decodeFromVideoElement(n){const s=this._decodeFromVideoElementSetup(n);return this._decodeOnLoadVideo(s)}decodeFromVideoElementContinuously(n,s){const l=this._decodeFromVideoElementSetup(n);return this._decodeOnLoadVideoContinuously(l,s)}_decodeFromVideoElementSetup(n){if(!n)throw new S("A video element must be provided.");this.reset();const s=this.prepareVideoElement(n);return this.videoElement=s,s}decodeFromImageUrl(n){if(!n)throw new S("An URL must be provided.");this.reset();const s=this.prepareImageElement();this.imageElement=s;const l=this._decodeOnLoadImage(s);return s.src=n,l}decodeFromVideoUrl(n){if(!n)throw new S("An URL must be provided.");this.reset();const s=this.prepareVideoElement(),l=this.decodeFromVideoElement(s);return s.src=n,l}decodeFromVideoUrlContinuously(n,s){if(!n)throw new S("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),f=this.decodeFromVideoElementContinuously(l,s);return l.src=n,f}_decodeOnLoadImage(n){return new Promise((s,l)=>{this.imageLoadedListener=()=>this.decodeOnce(n,!1,!0).then(s,l),n.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(n){return fe(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(n),yield this.decodeOnce(n)})}_decodeOnLoadVideoContinuously(n,s){return fe(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(n),this.decodeContinuously(n,s)})}isImageLoaded(n){return!(!n.complete||n.naturalWidth===0)}prepareImageElement(n){let s;return typeof n>"u"&&(s=document.createElement("img"),s.width=200,s.height=200),typeof n=="string"&&(s=this.getMediaElement(n,"img")),n instanceof HTMLImageElement&&(s=n),s}prepareVideoElement(n){let s;return!n&&typeof document<"u"&&(s=document.createElement("video"),s.width=200,s.height=200),typeof n=="string"&&(s=this.getMediaElement(n,"video")),n instanceof HTMLVideoElement&&(s=n),s.setAttribute("autoplay","true"),s.setAttribute("muted","true"),s.setAttribute("playsinline","true"),s}decodeOnce(n,s=!0,l=!0){this._stopAsyncDecode=!1;const f=(d,g)=>{if(this._stopAsyncDecode){g(new ve("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const w=this.decode(n);d(w)}catch(w){const E=s&&w instanceof ve,L=(w instanceof N||w instanceof ee)&&l;if(E||L)return setTimeout(f,this._timeBetweenDecodingAttempts,d,g);g(w)}};return new Promise((d,g)=>f(d,g))}decodeContinuously(n,s){this._stopContinuousDecode=!1;const l=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const f=this.decode(n);s(f,null),setTimeout(l,this.timeBetweenScansMillis)}catch(f){s(null,f);const d=f instanceof N||f instanceof ee,g=f instanceof ve;(d||g)&&setTimeout(l,this._timeBetweenDecodingAttempts)}};l()}decode(n){const s=this.createBinaryBitmap(n);return this.decodeBitmap(s)}_isHTMLVideoElement(n){return n.videoWidth!==0}drawFrameOnCanvas(n,s,l){s||(s={sx:0,sy:0,sWidth:n.videoWidth,sHeight:n.videoHeight,dx:0,dy:0,dWidth:n.videoWidth,dHeight:n.videoHeight}),l||(l=this.captureCanvasContext),l.drawImage(n,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}drawImageOnCanvas(n,s,l=this.captureCanvasContext){s||(s={sx:0,sy:0,sWidth:n.naturalWidth,sHeight:n.naturalHeight,dx:0,dy:0,dWidth:n.naturalWidth,dHeight:n.naturalHeight}),l||(l=this.captureCanvasContext),l.drawImage(n,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}createBinaryBitmap(n){this.getCaptureCanvasContext(n),this._isHTMLVideoElement(n)?this.drawFrameOnCanvas(n):this.drawImageOnCanvas(n);const s=this.getCaptureCanvas(n),l=new ft(s),f=new _e(l);return new B(f)}getCaptureCanvasContext(n){if(!this.captureCanvasContext){const l=this.getCaptureCanvas(n).getContext("2d");this.captureCanvasContext=l}return this.captureCanvasContext}getCaptureCanvas(n){if(!this.captureCanvas){const s=this.createCaptureCanvas(n);this.captureCanvas=s}return this.captureCanvas}decodeBitmap(n){return this.reader.decode(n,this._hints)}createCaptureCanvas(n){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const s=document.createElement("canvas");let l,f;return typeof n<"u"&&(n instanceof HTMLVideoElement?(l=n.videoWidth,f=n.videoHeight):n instanceof HTMLImageElement&&(l=n.naturalWidth||n.width,f=n.naturalHeight||n.height)),s.style.width=l+"px",s.style.height=f+"px",s.width=l,s.height=f,s}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(n=>n.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(n,s){try{n.srcObject=s}catch{n.src=URL.createObjectURL(s)}}cleanVideoSource(n){try{n.srcObject=null}catch{n.src=""}this.videoElement.removeAttribute("src")}}class Le{constructor(n,s,l=s==null?0:8*s.length,f,d,g=z.currentTimeMillis()){this.text=n,this.rawBytes=s,this.numBits=l,this.resultPoints=f,this.format=d,this.timestamp=g,this.text=n,this.rawBytes=s,l==null?this.numBits=s==null?0:8*s.length:this.numBits=l,this.resultPoints=f,this.format=d,this.resultMetadata=null,g==null?this.timestamp=z.currentTimeMillis():this.timestamp=g}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(n,s){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(n,s)}putAllMetadata(n){n!==null&&(this.resultMetadata===null?this.resultMetadata=n:this.resultMetadata=new Map(n))}addResultPoints(n){const s=this.resultPoints;if(s===null)this.resultPoints=n;else if(n!==null&&n.length>0){const l=new Array(s.length+n.length);z.arraycopy(s,0,l,0,s.length),z.arraycopy(n,0,l,s.length,n.length),this.resultPoints=l}}getTimestamp(){return this.timestamp}toString(){return this.text}}var pe;(function(G){G[G.AZTEC=0]="AZTEC",G[G.CODABAR=1]="CODABAR",G[G.CODE_39=2]="CODE_39",G[G.CODE_93=3]="CODE_93",G[G.CODE_128=4]="CODE_128",G[G.DATA_MATRIX=5]="DATA_MATRIX",G[G.EAN_8=6]="EAN_8",G[G.EAN_13=7]="EAN_13",G[G.ITF=8]="ITF",G[G.MAXICODE=9]="MAXICODE",G[G.PDF_417=10]="PDF_417",G[G.QR_CODE=11]="QR_CODE",G[G.RSS_14=12]="RSS_14",G[G.RSS_EXPANDED=13]="RSS_EXPANDED",G[G.UPC_A=14]="UPC_A",G[G.UPC_E=15]="UPC_E",G[G.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(pe||(pe={}));var Me=pe,Bt;(function(G){G[G.OTHER=0]="OTHER",G[G.ORIENTATION=1]="ORIENTATION",G[G.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",G[G.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",G[G.ISSUE_NUMBER=4]="ISSUE_NUMBER",G[G.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",G[G.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",G[G.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",G[G.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",G[G.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",G[G.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Bt||(Bt={}));var At=Bt;class It{constructor(n,s,l,f,d=-1,g=-1){this.rawBytes=n,this.text=s,this.byteSegments=l,this.ecLevel=f,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=g,this.numBits=n==null?0:8*n.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(n){this.numBits=n}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(n){this.errorsCorrected=n}getErasures(){return this.erasures}setErasures(n){this.erasures=n}getOther(){return this.other}setOther(n){this.other=n}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Rt{exp(n){return this.expTable[n]}log(n){if(n===0)throw new R;return this.logTable[n]}static addOrSubtract(n,s){return n^s}}class ht{constructor(n,s){if(s.length===0)throw new R;this.field=n;const l=s.length;if(l>1&&s[0]===0){let f=1;for(;f<l&&s[f]===0;)f++;f===l?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(l-f),z.arraycopy(s,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(n){return this.coefficients[this.coefficients.length-1-n]}evaluateAt(n){if(n===0)return this.getCoefficient(0);const s=this.coefficients;let l;if(n===1){l=0;for(let g=0,w=s.length;g!==w;g++){const E=s[g];l=Rt.addOrSubtract(l,E)}return l}l=s[0];const f=s.length,d=this.field;for(let g=1;g<f;g++)l=Rt.addOrSubtract(d.multiply(n,l),s[g]);return l}addOrSubtract(n){if(!this.field.equals(n.field))throw new R("GenericGFPolys do not have same GenericGF field");if(this.isZero())return n;if(n.isZero())return this;let s=this.coefficients,l=n.coefficients;if(s.length>l.length){const g=s;s=l,l=g}let f=new Int32Array(l.length);const d=l.length-s.length;z.arraycopy(l,0,f,0,d);for(let g=d;g<l.length;g++)f[g]=Rt.addOrSubtract(s[g-d],l[g]);return new ht(this.field,f)}multiply(n){if(!this.field.equals(n.field))throw new R("GenericGFPolys do not have same GenericGF field");if(this.isZero()||n.isZero())return this.field.getZero();const s=this.coefficients,l=s.length,f=n.coefficients,d=f.length,g=new Int32Array(l+d-1),w=this.field;for(let E=0;E<l;E++){const O=s[E];for(let L=0;L<d;L++)g[E+L]=Rt.addOrSubtract(g[E+L],w.multiply(O,f[L]))}return new ht(w,g)}multiplyScalar(n){if(n===0)return this.field.getZero();if(n===1)return this;const s=this.coefficients.length,l=this.field,f=new Int32Array(s),d=this.coefficients;for(let g=0;g<s;g++)f[g]=l.multiply(d[g],n);return new ht(l,f)}multiplyByMonomial(n,s){if(n<0)throw new R;if(s===0)return this.field.getZero();const l=this.coefficients,f=l.length,d=new Int32Array(f+n),g=this.field;for(let w=0;w<f;w++)d[w]=g.multiply(l[w],s);return new ht(g,d)}divide(n){if(!this.field.equals(n.field))throw new R("GenericGFPolys do not have same GenericGF field");if(n.isZero())throw new R("Divide by 0");const s=this.field;let l=s.getZero(),f=this;const d=n.getCoefficient(n.getDegree()),g=s.inverse(d);for(;f.getDegree()>=n.getDegree()&&!f.isZero();){const w=f.getDegree()-n.getDegree(),E=s.multiply(f.getCoefficient(f.getDegree()),g),O=n.multiplyByMonomial(w,E),L=s.buildMonomial(w,E);l=l.addOrSubtract(L),f=f.addOrSubtract(O)}return[l,f]}toString(){let n="";for(let s=this.getDegree();s>=0;s--){let l=this.getCoefficient(s);if(l!==0){if(l<0?(n+=" - ",l=-l):n.length>0&&(n+=" + "),s===0||l!==1){const f=this.field.log(l);f===0?n+="1":f===1?n+="a":(n+="a^",n+=f)}s!==0&&(s===1?n+="x":(n+="x^",n+=s))}}return n}}class mt extends y{}mt.kind="ArithmeticException";class qt extends Rt{constructor(n,s,l){super(),this.primitive=n,this.size=s,this.generatorBase=l;const f=new Int32Array(s);let d=1;for(let w=0;w<s;w++)f[w]=d,d*=2,d>=s&&(d^=n,d&=s-1);this.expTable=f;const g=new Int32Array(s);for(let w=0;w<s-1;w++)g[f[w]]=w;this.logTable=g,this.zero=new ht(this,Int32Array.from([0])),this.one=new ht(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(n,s){if(n<0)throw new R;if(s===0)return this.zero;const l=new Int32Array(n+1);return l[0]=s,new ht(this,l)}inverse(n){if(n===0)throw new mt;return this.expTable[this.size-this.logTable[n]-1]}multiply(n,s){return n===0||s===0?0:this.expTable[(this.logTable[n]+this.logTable[s])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+te.toHexString(this.primitive)+","+this.size+")"}equals(n){return n===this}}qt.AZTEC_DATA_12=new qt(4201,4096,1),qt.AZTEC_DATA_10=new qt(1033,1024,1),qt.AZTEC_DATA_6=new qt(67,64,1),qt.AZTEC_PARAM=new qt(19,16,1),qt.QR_CODE_FIELD_256=new qt(285,256,0),qt.DATA_MATRIX_FIELD_256=new qt(301,256,1),qt.AZTEC_DATA_8=qt.DATA_MATRIX_FIELD_256,qt.MAXICODE_FIELD_64=qt.AZTEC_DATA_6;class Sn extends y{}Sn.kind="ReedSolomonException";class Zn extends y{}Zn.kind="IllegalStateException";class _n{constructor(n){this.field=n}decode(n,s){const l=this.field,f=new ht(l,n),d=new Int32Array(s);let g=!0;for(let ae=0;ae<s;ae++){const ge=f.evaluateAt(l.exp(ae+l.getGeneratorBase()));d[d.length-1-ae]=ge,ge!==0&&(g=!1)}if(g)return;const w=new ht(l,d),E=this.runEuclideanAlgorithm(l.buildMonomial(s,1),w,s),O=E[0],L=E[1],V=this.findErrorLocations(O),Y=this.findErrorMagnitudes(L,V);for(let ae=0;ae<V.length;ae++){const ge=n.length-1-l.log(V[ae]);if(ge<0)throw new Sn("Bad error location");n[ge]=qt.addOrSubtract(n[ge],Y[ae])}}runEuclideanAlgorithm(n,s,l){if(n.getDegree()<s.getDegree()){const ae=n;n=s,s=ae}const f=this.field;let d=n,g=s,w=f.getZero(),E=f.getOne();for(;g.getDegree()>=(l/2|0);){let ae=d,ge=w;if(d=g,w=E,d.isZero())throw new Sn("r_{i-1} was zero");g=ae;let we=f.getZero();const Oe=d.getCoefficient(d.getDegree()),Ue=f.inverse(Oe);for(;g.getDegree()>=d.getDegree()&&!g.isZero();){const pt=g.getDegree()-d.getDegree(),dt=f.multiply(g.getCoefficient(g.getDegree()),Ue);we=we.addOrSubtract(f.buildMonomial(pt,dt)),g=g.addOrSubtract(d.multiplyByMonomial(pt,dt))}if(E=we.multiply(w).addOrSubtract(ge),g.getDegree()>=d.getDegree())throw new Zn("Division algorithm failed to reduce polynomial?")}const O=E.getCoefficient(0);if(O===0)throw new Sn("sigmaTilde(0) was zero");const L=f.inverse(O),V=E.multiplyScalar(L),Y=g.multiplyScalar(L);return[V,Y]}findErrorLocations(n){const s=n.getDegree();if(s===1)return Int32Array.from([n.getCoefficient(1)]);const l=new Int32Array(s);let f=0;const d=this.field;for(let g=1;g<d.getSize()&&f<s;g++)n.evaluateAt(g)===0&&(l[f]=d.inverse(g),f++);if(f!==s)throw new Sn("Error locator degree does not match number of roots");return l}findErrorMagnitudes(n,s){const l=s.length,f=new Int32Array(l),d=this.field;for(let g=0;g<l;g++){const w=d.inverse(s[g]);let E=1;for(let O=0;O<l;O++)if(g!==O){const L=d.multiply(s[O],w),V=(L&1)===0?L|1:L&-2;E=d.multiply(E,V)}f[g]=d.multiply(n.evaluateAt(w),d.inverse(E)),d.getGeneratorBase()!==0&&(f[g]=d.multiply(f[g],w))}return f}}var zn;(function(G){G[G.UPPER=0]="UPPER",G[G.LOWER=1]="LOWER",G[G.MIXED=2]="MIXED",G[G.DIGIT=3]="DIGIT",G[G.PUNCT=4]="PUNCT",G[G.BINARY=5]="BINARY"})(zn||(zn={}));class mn{decode(n){this.ddata=n;let s=n.getBits(),l=this.extractBits(s),f=this.correctBits(l),d=mn.convertBoolArrayToByteArray(f),g=mn.getEncodedData(f),w=new It(d,g,null,null);return w.setNumBits(f.length),w}static highLevelDecode(n){return this.getEncodedData(n)}static getEncodedData(n){let s=n.length,l=zn.UPPER,f=zn.UPPER,d="",g=0;for(;g<s;)if(f===zn.BINARY){if(s-g<5)break;let w=mn.readCode(n,g,5);if(g+=5,w===0){if(s-g<11)break;w=mn.readCode(n,g,11)+31,g+=11}for(let E=0;E<w;E++){if(s-g<8){g=s;break}const O=mn.readCode(n,g,8);d+=ke.castAsNonUtf8Char(O),g+=8}f=l}else{let w=f===zn.DIGIT?4:5;if(s-g<w)break;let E=mn.readCode(n,g,w);g+=w;let O=mn.getCharacter(f,E);O.startsWith("CTRL_")?(l=f,f=mn.getTable(O.charAt(5)),O.charAt(6)==="L"&&(l=f)):(d+=O,f=l)}return d}static getTable(n){switch(n){case"L":return zn.LOWER;case"P":return zn.PUNCT;case"M":return zn.MIXED;case"D":return zn.DIGIT;case"B":return zn.BINARY;default:return zn.UPPER}}static getCharacter(n,s){switch(n){case zn.UPPER:return mn.UPPER_TABLE[s];case zn.LOWER:return mn.LOWER_TABLE[s];case zn.MIXED:return mn.MIXED_TABLE[s];case zn.PUNCT:return mn.PUNCT_TABLE[s];case zn.DIGIT:return mn.DIGIT_TABLE[s];default:throw new Zn("Bad table")}}correctBits(n){let s,l;this.ddata.getNbLayers()<=2?(l=6,s=qt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(l=8,s=qt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(l=10,s=qt.AZTEC_DATA_10):(l=12,s=qt.AZTEC_DATA_12);let f=this.ddata.getNbDatablocks(),d=n.length/l;if(d<f)throw new ee;let g=n.length%l,w=new Int32Array(d);for(let Y=0;Y<d;Y++,g+=l)w[Y]=mn.readCode(n,g,l);try{new _n(s).decode(w,d-f)}catch(Y){throw new ee(Y)}let E=(1<<l)-1,O=0;for(let Y=0;Y<f;Y++){let ae=w[Y];if(ae===0||ae===E)throw new ee;(ae===1||ae===E-1)&&O++}let L=new Array(f*l-O),V=0;for(let Y=0;Y<f;Y++){let ae=w[Y];if(ae===1||ae===E-1)L.fill(ae>1,V,V+l-1),V+=l-1;else for(let ge=l-1;ge>=0;--ge)L[V++]=(ae&1<<ge)!==0}return L}extractBits(n){let s=this.ddata.isCompact(),l=this.ddata.getNbLayers(),f=(s?11:14)+l*4,d=new Int32Array(f),g=new Array(this.totalBitsInLayer(l,s));if(s)for(let w=0;w<d.length;w++)d[w]=w;else{let w=f+1+2*te.truncDivision(te.truncDivision(f,2)-1,15),E=f/2,O=te.truncDivision(w,2);for(let L=0;L<E;L++){let V=L+te.truncDivision(L,15);d[E-L-1]=O-V-1,d[E+L]=O+V+1}}for(let w=0,E=0;w<l;w++){let O=(l-w)*4+(s?9:12),L=w*2,V=f-1-L;for(let Y=0;Y<O;Y++){let ae=Y*2;for(let ge=0;ge<2;ge++)g[E+ae+ge]=n.get(d[L+ge],d[L+Y]),g[E+2*O+ae+ge]=n.get(d[L+Y],d[V-ge]),g[E+4*O+ae+ge]=n.get(d[V-ge],d[V-Y]),g[E+6*O+ae+ge]=n.get(d[V-Y],d[L+ge])}E+=O*8}return g}static readCode(n,s,l){let f=0;for(let d=s;d<s+l;d++)f<<=1,n[d]&&(f|=1);return f}static readByte(n,s){let l=n.length-s;return l>=8?mn.readCode(n,s,8):mn.readCode(n,s,l)<<8-l}static convertBoolArrayToByteArray(n){let s=new Uint8Array((n.length+7)/8);for(let l=0;l<s.length;l++)s[l]=mn.readByte(n,8*l);return s}totalBitsInLayer(n,s){return((s?88:112)+16*n)*n}}mn.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],mn.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],mn.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],mn.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],mn.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Qt{constructor(){}static round(n){return n===NaN?0:n<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:n>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:n+(n<0?-.5:.5)|0}static distance(n,s,l,f){const d=n-l,g=s-f;return Math.sqrt(d*d+g*g)}static sum(n){let s=0;for(let l=0,f=n.length;l!==f;l++){const d=n[l];s+=d}return s}}class nr{static floatToIntBits(n){return n}}nr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class wt{constructor(n,s){this.x=n,this.y=s}getX(){return this.x}getY(){return this.y}equals(n){if(n instanceof wt){const s=n;return this.x===s.x&&this.y===s.y}return!1}hashCode(){return 31*nr.floatToIntBits(this.x)+nr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(n){const s=this.distance(n[0],n[1]),l=this.distance(n[1],n[2]),f=this.distance(n[0],n[2]);let d,g,w;if(l>=s&&l>=f?(g=n[0],d=n[1],w=n[2]):f>=l&&f>=s?(g=n[1],d=n[0],w=n[2]):(g=n[2],d=n[0],w=n[1]),this.crossProductZ(d,g,w)<0){const E=d;d=w,w=E}n[0]=d,n[1]=g,n[2]=w}static distance(n,s){return Qt.distance(n.x,n.y,s.x,s.y)}static crossProductZ(n,s,l){const f=s.x,d=s.y;return(l.x-f)*(n.y-d)-(l.y-d)*(n.x-f)}}class Er{constructor(n,s){this.bits=n,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class Bn extends Er{constructor(n,s,l,f,d){super(n,s),this.compact=l,this.nbDatablocks=f,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class kn{constructor(n,s,l,f){this.image=n,this.height=n.getHeight(),this.width=n.getWidth(),s==null&&(s=kn.INIT_SIZE),l==null&&(l=n.getWidth()/2|0),f==null&&(f=n.getHeight()/2|0);const d=s/2|0;if(this.leftInit=l-d,this.rightInit=l+d,this.upInit=f-d,this.downInit=f+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ve}detect(){let n=this.leftInit,s=this.rightInit,l=this.upInit,f=this.downInit,d=!1,g=!0,w=!1,E=!1,O=!1,L=!1,V=!1;const Y=this.width,ae=this.height;for(;g;){g=!1;let ge=!0;for(;(ge||!E)&&s<Y;)ge=this.containsBlackPoint(l,f,s,!1),ge?(s++,g=!0,E=!0):E||s++;if(s>=Y){d=!0;break}let we=!0;for(;(we||!O)&&f<ae;)we=this.containsBlackPoint(n,s,f,!0),we?(f++,g=!0,O=!0):O||f++;if(f>=ae){d=!0;break}let Oe=!0;for(;(Oe||!L)&&n>=0;)Oe=this.containsBlackPoint(l,f,n,!1),Oe?(n--,g=!0,L=!0):L||n--;if(n<0){d=!0;break}let Ue=!0;for(;(Ue||!V)&&l>=0;)Ue=this.containsBlackPoint(n,s,l,!0),Ue?(l--,g=!0,V=!0):V||l--;if(l<0){d=!0;break}g&&(w=!0)}if(!d&&w){const ge=s-n;let we=null;for(let dt=1;we===null&&dt<ge;dt++)we=this.getBlackPointOnSegment(n,f-dt,n+dt,f);if(we==null)throw new ve;let Oe=null;for(let dt=1;Oe===null&&dt<ge;dt++)Oe=this.getBlackPointOnSegment(n,l+dt,n+dt,l);if(Oe==null)throw new ve;let Ue=null;for(let dt=1;Ue===null&&dt<ge;dt++)Ue=this.getBlackPointOnSegment(s,l+dt,s-dt,l);if(Ue==null)throw new ve;let pt=null;for(let dt=1;pt===null&&dt<ge;dt++)pt=this.getBlackPointOnSegment(s,f-dt,s-dt,f);if(pt==null)throw new ve;return this.centerEdges(pt,we,Ue,Oe)}else throw new ve}getBlackPointOnSegment(n,s,l,f){const d=Qt.round(Qt.distance(n,s,l,f)),g=(l-n)/d,w=(f-s)/d,E=this.image;for(let O=0;O<d;O++){const L=Qt.round(n+O*g),V=Qt.round(s+O*w);if(E.get(L,V))return new wt(L,V)}return null}centerEdges(n,s,l,f){const d=n.getX(),g=n.getY(),w=s.getX(),E=s.getY(),O=l.getX(),L=l.getY(),V=f.getX(),Y=f.getY(),ae=kn.CORR;return d<this.width/2?[new wt(V-ae,Y+ae),new wt(w+ae,E+ae),new wt(O-ae,L-ae),new wt(d+ae,g-ae)]:[new wt(V+ae,Y+ae),new wt(w+ae,E-ae),new wt(O-ae,L+ae),new wt(d-ae,g-ae)]}containsBlackPoint(n,s,l,f){const d=this.image;if(f){for(let g=n;g<=s;g++)if(d.get(g,l))return!0}else for(let g=n;g<=s;g++)if(d.get(l,g))return!0;return!1}}kn.INIT_SIZE=10,kn.CORR=1;class ai{static checkAndNudgePoints(n,s){const l=n.getWidth(),f=n.getHeight();let d=!0;for(let g=0;g<s.length&&d;g+=2){const w=Math.floor(s[g]),E=Math.floor(s[g+1]);if(w<-1||w>l||E<-1||E>f)throw new ve;d=!1,w===-1?(s[g]=0,d=!0):w===l&&(s[g]=l-1,d=!0),E===-1?(s[g+1]=0,d=!0):E===f&&(s[g+1]=f-1,d=!0)}d=!0;for(let g=s.length-2;g>=0&&d;g-=2){const w=Math.floor(s[g]),E=Math.floor(s[g+1]);if(w<-1||w>l||E<-1||E>f)throw new ve;d=!1,w===-1?(s[g]=0,d=!0):w===l&&(s[g]=l-1,d=!0),E===-1?(s[g+1]=0,d=!0):E===f&&(s[g+1]=f-1,d=!0)}}}class hr{constructor(n,s,l,f,d,g,w,E,O){this.a11=n,this.a21=s,this.a31=l,this.a12=f,this.a22=d,this.a32=g,this.a13=w,this.a23=E,this.a33=O}static quadrilateralToQuadrilateral(n,s,l,f,d,g,w,E,O,L,V,Y,ae,ge,we,Oe){const Ue=hr.quadrilateralToSquare(n,s,l,f,d,g,w,E);return hr.squareToQuadrilateral(O,L,V,Y,ae,ge,we,Oe).times(Ue)}transformPoints(n){const s=n.length,l=this.a11,f=this.a12,d=this.a13,g=this.a21,w=this.a22,E=this.a23,O=this.a31,L=this.a32,V=this.a33;for(let Y=0;Y<s;Y+=2){const ae=n[Y],ge=n[Y+1],we=d*ae+E*ge+V;n[Y]=(l*ae+g*ge+O)/we,n[Y+1]=(f*ae+w*ge+L)/we}}transformPointsWithValues(n,s){const l=this.a11,f=this.a12,d=this.a13,g=this.a21,w=this.a22,E=this.a23,O=this.a31,L=this.a32,V=this.a33,Y=n.length;for(let ae=0;ae<Y;ae++){const ge=n[ae],we=s[ae],Oe=d*ge+E*we+V;n[ae]=(l*ge+g*we+O)/Oe,s[ae]=(f*ge+w*we+L)/Oe}}static squareToQuadrilateral(n,s,l,f,d,g,w,E){const O=n-l+d-w,L=s-f+g-E;if(O===0&&L===0)return new hr(l-n,d-l,n,f-s,g-f,s,0,0,1);{const V=l-d,Y=w-d,ae=f-g,ge=E-g,we=V*ge-Y*ae,Oe=(O*ge-Y*L)/we,Ue=(V*L-O*ae)/we;return new hr(l-n+Oe*l,w-n+Ue*w,n,f-s+Oe*f,E-s+Ue*E,s,Oe,Ue,1)}}static quadrilateralToSquare(n,s,l,f,d,g,w,E){return hr.squareToQuadrilateral(n,s,l,f,d,g,w,E).buildAdjoint()}buildAdjoint(){return new hr(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(n){return new hr(this.a11*n.a11+this.a21*n.a12+this.a31*n.a13,this.a11*n.a21+this.a21*n.a22+this.a31*n.a23,this.a11*n.a31+this.a21*n.a32+this.a31*n.a33,this.a12*n.a11+this.a22*n.a12+this.a32*n.a13,this.a12*n.a21+this.a22*n.a22+this.a32*n.a23,this.a12*n.a31+this.a22*n.a32+this.a32*n.a33,this.a13*n.a11+this.a23*n.a12+this.a33*n.a13,this.a13*n.a21+this.a23*n.a22+this.a33*n.a23,this.a13*n.a31+this.a23*n.a32+this.a33*n.a33)}}class Or extends ai{sampleGrid(n,s,l,f,d,g,w,E,O,L,V,Y,ae,ge,we,Oe,Ue,pt,dt){const v=hr.quadrilateralToQuadrilateral(f,d,g,w,E,O,L,V,Y,ae,ge,we,Oe,Ue,pt,dt);return this.sampleGridWithTransform(n,s,l,v)}sampleGridWithTransform(n,s,l,f){if(s<=0||l<=0)throw new ve;const d=new et(s,l),g=new Float32Array(2*s);for(let w=0;w<l;w++){const E=g.length,O=w+.5;for(let L=0;L<E;L+=2)g[L]=L/2+.5,g[L+1]=O;f.transformPoints(g),ai.checkAndNudgePoints(n,g);try{for(let L=0;L<E;L+=2)n.get(Math.floor(g[L]),Math.floor(g[L+1]))&&d.set(L/2,w)}catch{throw new ve}}return d}}class vr{static setGridSampler(n){vr.gridSampler=n}static getInstance(){return vr.gridSampler}}vr.gridSampler=new Or;class cr{constructor(n,s){this.x=n,this.y=s}toResultPoint(){return new wt(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Nt{constructor(n){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=n}detect(){return this.detectMirror(!1)}detectMirror(n){let s=this.getMatrixCenter(),l=this.getBullsEyeCorners(s);if(n){let g=l[0];l[0]=l[2],l[2]=g}this.extractParameters(l);let f=this.sampleGrid(this.image,l[this.shift%4],l[(this.shift+1)%4],l[(this.shift+2)%4],l[(this.shift+3)%4]),d=this.getMatrixCornerPoints(l);return new Bn(f,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(n){if(!this.isValidPoint(n[0])||!this.isValidPoint(n[1])||!this.isValidPoint(n[2])||!this.isValidPoint(n[3]))throw new ve;let s=2*this.nbCenterLayers,l=new Int32Array([this.sampleLine(n[0],n[1],s),this.sampleLine(n[1],n[2],s),this.sampleLine(n[2],n[3],s),this.sampleLine(n[3],n[0],s)]);this.shift=this.getRotation(l,s);let f=0;for(let g=0;g<4;g++){let w=l[(this.shift+g)%4];this.compact?(f<<=7,f+=w>>1&127):(f<<=10,f+=(w>>2&992)+(w>>1&31))}let d=this.getCorrectedParameterData(f,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(n,s){let l=0;n.forEach((f,d,g)=>{let w=(f>>s-2<<1)+(f&1);l=(l<<3)+w}),l=((l&1)<<11)+(l>>1);for(let f=0;f<4;f++)if(te.bitCount(l^this.EXPECTED_CORNER_BITS[f])<=2)return f;throw new ve}getCorrectedParameterData(n,s){let l,f;s?(l=7,f=2):(l=10,f=4);let d=l-f,g=new Int32Array(l);for(let E=l-1;E>=0;--E)g[E]=n&15,n>>=4;try{new _n(qt.AZTEC_PARAM).decode(g,d)}catch{throw new ve}let w=0;for(let E=0;E<f;E++)w=(w<<4)+g[E];return w}getBullsEyeCorners(n){let s=n,l=n,f=n,d=n,g=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let V=this.getFirstDifferent(s,g,1,-1),Y=this.getFirstDifferent(l,g,1,1),ae=this.getFirstDifferent(f,g,-1,1),ge=this.getFirstDifferent(d,g,-1,-1);if(this.nbCenterLayers>2){let we=this.distancePoint(ge,V)*this.nbCenterLayers/(this.distancePoint(d,s)*(this.nbCenterLayers+2));if(we<.75||we>1.25||!this.isWhiteOrBlackRectangle(V,Y,ae,ge))break}s=V,l=Y,f=ae,d=ge,g=!g}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ve;this.compact=this.nbCenterLayers===5;let w=new wt(s.getX()+.5,s.getY()-.5),E=new wt(l.getX()+.5,l.getY()+.5),O=new wt(f.getX()-.5,f.getY()+.5),L=new wt(d.getX()-.5,d.getY()-.5);return this.expandSquare([w,E,O,L],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let n,s,l,f;try{let w=new kn(this.image).detect();n=w[0],s=w[1],l=w[2],f=w[3]}catch{let E=this.image.getWidth()/2,O=this.image.getHeight()/2;n=this.getFirstDifferent(new cr(E+7,O-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new cr(E+7,O+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new cr(E-7,O+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new cr(E-7,O-7),!1,-1,-1).toResultPoint()}let d=Qt.round((n.getX()+f.getX()+s.getX()+l.getX())/4),g=Qt.round((n.getY()+f.getY()+s.getY()+l.getY())/4);try{let w=new kn(this.image,15,d,g).detect();n=w[0],s=w[1],l=w[2],f=w[3]}catch{n=this.getFirstDifferent(new cr(d+7,g-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new cr(d+7,g+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new cr(d-7,g+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new cr(d-7,g-7),!1,-1,-1).toResultPoint()}return d=Qt.round((n.getX()+f.getX()+s.getX()+l.getX())/4),g=Qt.round((n.getY()+f.getY()+s.getY()+l.getY())/4),new cr(d,g)}getMatrixCornerPoints(n){return this.expandSquare(n,2*this.nbCenterLayers,this.getDimension())}sampleGrid(n,s,l,f,d){let g=vr.getInstance(),w=this.getDimension(),E=w/2-this.nbCenterLayers,O=w/2+this.nbCenterLayers;return g.sampleGrid(n,w,w,E,E,O,E,O,O,E,O,s.getX(),s.getY(),l.getX(),l.getY(),f.getX(),f.getY(),d.getX(),d.getY())}sampleLine(n,s,l){let f=0,d=this.distanceResultPoint(n,s),g=d/l,w=n.getX(),E=n.getY(),O=g*(s.getX()-n.getX())/d,L=g*(s.getY()-n.getY())/d;for(let V=0;V<l;V++)this.image.get(Qt.round(w+V*O),Qt.round(E+V*L))&&(f|=1<<l-V-1);return f}isWhiteOrBlackRectangle(n,s,l,f){let d=3;n=new cr(n.getX()-d,n.getY()+d),s=new cr(s.getX()-d,s.getY()-d),l=new cr(l.getX()+d,l.getY()-d),f=new cr(f.getX()+d,f.getY()+d);let g=this.getColor(f,n);if(g===0)return!1;let w=this.getColor(n,s);return w!==g||(w=this.getColor(s,l),w!==g)?!1:(w=this.getColor(l,f),w===g)}getColor(n,s){let l=this.distancePoint(n,s),f=(s.getX()-n.getX())/l,d=(s.getY()-n.getY())/l,g=0,w=n.getX(),E=n.getY(),O=this.image.get(n.getX(),n.getY()),L=Math.ceil(l);for(let Y=0;Y<L;Y++)w+=f,E+=d,this.image.get(Qt.round(w),Qt.round(E))!==O&&g++;let V=g/l;return V>.1&&V<.9?0:V<=.1===O?1:-1}getFirstDifferent(n,s,l,f){let d=n.getX()+l,g=n.getY()+f;for(;this.isValid(d,g)&&this.image.get(d,g)===s;)d+=l,g+=f;for(d-=l,g-=f;this.isValid(d,g)&&this.image.get(d,g)===s;)d+=l;for(d-=l;this.isValid(d,g)&&this.image.get(d,g)===s;)g+=f;return g-=f,new cr(d,g)}expandSquare(n,s,l){let f=l/(2*s),d=n[0].getX()-n[2].getX(),g=n[0].getY()-n[2].getY(),w=(n[0].getX()+n[2].getX())/2,E=(n[0].getY()+n[2].getY())/2,O=new wt(w+f*d,E+f*g),L=new wt(w-f*d,E-f*g);d=n[1].getX()-n[3].getX(),g=n[1].getY()-n[3].getY(),w=(n[1].getX()+n[3].getX())/2,E=(n[1].getY()+n[3].getY())/2;let V=new wt(w+f*d,E+f*g),Y=new wt(w-f*d,E-f*g);return[O,V,L,Y]}isValid(n,s){return n>=0&&n<this.image.getWidth()&&s>0&&s<this.image.getHeight()}isValidPoint(n){let s=Qt.round(n.getX()),l=Qt.round(n.getY());return this.isValid(s,l)}distancePoint(n,s){return Qt.distance(n.getX(),n.getY(),s.getX(),s.getY())}distanceResultPoint(n,s){return Qt.distance(n.getX(),n.getY(),s.getX(),s.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(te.truncDivision(this.nbLayers-4,8)+1)+15}}class Wt{decode(n,s=null){let l=null,f=new Nt(n.getBlackMatrix()),d=null,g=null;try{let L=f.detectMirror(!1);d=L.getPoints(),this.reportFoundResultPoints(s,d),g=new mn().decode(L)}catch(L){l=L}if(g==null)try{let L=f.detectMirror(!0);d=L.getPoints(),this.reportFoundResultPoints(s,d),g=new mn().decode(L)}catch(L){throw l??L}let w=new Le(g.getText(),g.getRawBytes(),g.getNumBits(),d,Me.AZTEC,z.currentTimeMillis()),E=g.getByteSegments();E!=null&&w.putMetadata(At.BYTE_SEGMENTS,E);let O=g.getECLevel();return O!=null&&w.putMetadata(At.ERROR_CORRECTION_LEVEL,O),w}reportFoundResultPoints(n,s){if(n!=null){let l=n.get(ue.NEED_RESULT_POINT_CALLBACK);l!=null&&s.forEach((f,d,g)=>{l.foundPossibleResultPoint(f)})}}reset(){}}class Lt extends De{constructor(n=500){super(new Wt,n)}}class an{decode(n,s){try{return this.doDecode(n,s)}catch{if(s&&s.get(ue.TRY_HARDER)===!0&&n.isRotateSupported()){const d=n.rotateCounterClockwise(),g=this.doDecode(d,s),w=g.getResultMetadata();let E=270;w!==null&&w.get(At.ORIENTATION)===!0&&(E=E+w.get(At.ORIENTATION)%360),g.putMetadata(At.ORIENTATION,E);const O=g.getResultPoints();if(O!==null){const L=d.getHeight();for(let V=0;V<O.length;V++)O[V]=new wt(L-O[V].getY()-1,O[V].getX())}return g}else throw new ve}}reset(){}doDecode(n,s){const l=n.getWidth(),f=n.getHeight();let d=new Q(l);const g=s&&s.get(ue.TRY_HARDER)===!0,w=Math.max(1,f>>(g?8:5));let E;g?E=f:E=15;const O=Math.trunc(f/2);for(let L=0;L<E;L++){const V=Math.trunc((L+1)/2),Y=(L&1)===0,ae=O+w*(Y?V:-V);if(ae<0||ae>=f)break;try{d=n.getBlackRow(ae,d)}catch{continue}for(let ge=0;ge<2;ge++){if(ge===1&&(d.reverse(),s&&s.get(ue.NEED_RESULT_POINT_CALLBACK)===!0)){const we=new Map;s.forEach((Oe,Ue)=>we.set(Ue,Oe)),we.delete(ue.NEED_RESULT_POINT_CALLBACK),s=we}try{const we=this.decodeRow(ae,d,s);if(ge===1){we.putMetadata(At.ORIENTATION,180);const Oe=we.getResultPoints();Oe!==null&&(Oe[0]=new wt(l-Oe[0].getX()-1,Oe[0].getY()),Oe[1]=new wt(l-Oe[1].getX()-1,Oe[1].getY()))}return we}catch{}}}throw new ve}static recordPattern(n,s,l){const f=l.length;for(let O=0;O<f;O++)l[O]=0;const d=n.getSize();if(s>=d)throw new ve;let g=!n.get(s),w=0,E=s;for(;E<d;){if(n.get(E)!==g)l[w]++;else{if(++w===f)break;l[w]=1,g=!g}E++}if(!(w===f||w===f-1&&E===d))throw new ve}static recordPatternInReverse(n,s,l){let f=l.length,d=n.get(s);for(;s>0&&f>=0;)n.get(--s)!==d&&(f--,d=!d);if(f>=0)throw new ve;an.recordPattern(n,s+1,l)}static patternMatchVariance(n,s,l){const f=n.length;let d=0,g=0;for(let O=0;O<f;O++)d+=n[O],g+=s[O];if(d<g)return Number.POSITIVE_INFINITY;const w=d/g;l*=w;let E=0;for(let O=0;O<f;O++){const L=n[O],V=s[O]*w,Y=L>V?L-V:V-L;if(Y>l)return Number.POSITIVE_INFINITY;E+=Y}return E/d}}class tt extends an{static findStartPattern(n){const s=n.getSize(),l=n.getNextSet(0);let f=0,d=Int32Array.from([0,0,0,0,0,0]),g=l,w=!1;const E=6;for(let O=l;O<s;O++)if(n.get(O)!==w)d[f]++;else{if(f===E-1){let L=tt.MAX_AVG_VARIANCE,V=-1;for(let Y=tt.CODE_START_A;Y<=tt.CODE_START_C;Y++){const ae=an.patternMatchVariance(d,tt.CODE_PATTERNS[Y],tt.MAX_INDIVIDUAL_VARIANCE);ae<L&&(L=ae,V=Y)}if(V>=0&&n.isRange(Math.max(0,g-(O-g)/2),g,!1))return Int32Array.from([g,O,V]);g+=d[0]+d[1],d=d.slice(2,d.length-1),d[f-1]=0,d[f]=0,f--}else f++;d[f]=1,w=!w}throw new ve}static decodeCode(n,s,l){an.recordPattern(n,l,s);let f=tt.MAX_AVG_VARIANCE,d=-1;for(let g=0;g<tt.CODE_PATTERNS.length;g++){const w=tt.CODE_PATTERNS[g],E=this.patternMatchVariance(s,w,tt.MAX_INDIVIDUAL_VARIANCE);E<f&&(f=E,d=g)}if(d>=0)return d;throw new ve}decodeRow(n,s,l){const f=l&&l.get(ue.ASSUME_GS1)===!0,d=tt.findStartPattern(s),g=d[2];let w=0;const E=new Uint8Array(20);E[w++]=g;let O;switch(g){case tt.CODE_START_A:O=tt.CODE_CODE_A;break;case tt.CODE_START_B:O=tt.CODE_CODE_B;break;case tt.CODE_START_C:O=tt.CODE_CODE_C;break;default:throw new ee}let L=!1,V=!1,Y="",ae=d[0],ge=d[1];const we=Int32Array.from([0,0,0,0,0,0]);let Oe=0,Ue=0,pt=g,dt=0,v=!0,I=!1,b=!1;for(;!L;){const Te=V;switch(V=!1,Oe=Ue,Ue=tt.decodeCode(s,we,ge),E[w++]=Ue,Ue!==tt.CODE_STOP&&(v=!0),Ue!==tt.CODE_STOP&&(dt++,pt+=dt*Ue),ae=ge,ge+=we.reduce((je,lt)=>je+lt,0),Ue){case tt.CODE_START_A:case tt.CODE_START_B:case tt.CODE_START_C:throw new ee}switch(O){case tt.CODE_CODE_A:if(Ue<64)b===I?Y+=String.fromCharCode(32+Ue):Y+=String.fromCharCode(32+Ue+128),b=!1;else if(Ue<96)b===I?Y+=String.fromCharCode(Ue-64):Y+=String.fromCharCode(Ue+64),b=!1;else switch(Ue!==tt.CODE_STOP&&(v=!1),Ue){case tt.CODE_FNC_1:f&&(Y.length===0?Y+="]C1":Y+="");break;case tt.CODE_FNC_2:case tt.CODE_FNC_3:break;case tt.CODE_FNC_4_A:!I&&b?(I=!0,b=!1):I&&b?(I=!1,b=!1):b=!0;break;case tt.CODE_SHIFT:V=!0,O=tt.CODE_CODE_B;break;case tt.CODE_CODE_B:O=tt.CODE_CODE_B;break;case tt.CODE_CODE_C:O=tt.CODE_CODE_C;break;case tt.CODE_STOP:L=!0;break}break;case tt.CODE_CODE_B:if(Ue<96)b===I?Y+=String.fromCharCode(32+Ue):Y+=String.fromCharCode(32+Ue+128),b=!1;else switch(Ue!==tt.CODE_STOP&&(v=!1),Ue){case tt.CODE_FNC_1:f&&(Y.length===0?Y+="]C1":Y+="");break;case tt.CODE_FNC_2:case tt.CODE_FNC_3:break;case tt.CODE_FNC_4_B:!I&&b?(I=!0,b=!1):I&&b?(I=!1,b=!1):b=!0;break;case tt.CODE_SHIFT:V=!0,O=tt.CODE_CODE_A;break;case tt.CODE_CODE_A:O=tt.CODE_CODE_A;break;case tt.CODE_CODE_C:O=tt.CODE_CODE_C;break;case tt.CODE_STOP:L=!0;break}break;case tt.CODE_CODE_C:if(Ue<100)Ue<10&&(Y+="0"),Y+=Ue;else switch(Ue!==tt.CODE_STOP&&(v=!1),Ue){case tt.CODE_FNC_1:f&&(Y.length===0?Y+="]C1":Y+="");break;case tt.CODE_CODE_A:O=tt.CODE_CODE_A;break;case tt.CODE_CODE_B:O=tt.CODE_CODE_B;break;case tt.CODE_STOP:L=!0;break}break}Te&&(O=O===tt.CODE_CODE_A?tt.CODE_CODE_B:tt.CODE_CODE_A)}const A=ge-ae;if(ge=s.getNextUnset(ge),!s.isRange(ge,Math.min(s.getSize(),ge+(ge-ae)/2),!1))throw new ve;if(pt-=dt*Oe,pt%103!==Oe)throw new N;const D=Y.length;if(D===0)throw new ve;D>0&&v&&(O===tt.CODE_CODE_C?Y=Y.substring(0,D-2):Y=Y.substring(0,D-1));const $=(d[1]+d[0])/2,q=ae+A/2,Z=E.length,se=new Uint8Array(Z);for(let Te=0;Te<Z;Te++)se[Te]=E[Te];const de=[new wt($,n),new wt(q,n)];return new Le(Y,se,0,de,Me.CODE_128,new Date().getTime())}}tt.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],tt.MAX_AVG_VARIANCE=.25,tt.MAX_INDIVIDUAL_VARIANCE=.7,tt.CODE_SHIFT=98,tt.CODE_CODE_C=99,tt.CODE_CODE_B=100,tt.CODE_CODE_A=101,tt.CODE_FNC_1=102,tt.CODE_FNC_2=97,tt.CODE_FNC_3=96,tt.CODE_FNC_4_A=101,tt.CODE_FNC_4_B=100,tt.CODE_START_A=103,tt.CODE_START_B=104,tt.CODE_START_C=105,tt.CODE_STOP=106;class xn extends an{constructor(n=!1,s=!1){super(),this.usingCheckDigit=n,this.extendedMode=s,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(n,s,l){let f=this.counters;f.fill(0),this.decodeRowResult="";let d=xn.findAsteriskPattern(s,f),g=s.getNextSet(d[1]),w=s.getSize(),E,O;do{xn.recordPattern(s,g,f);let we=xn.toNarrowWidePattern(f);if(we<0)throw new ve;E=xn.patternToChar(we),this.decodeRowResult+=E,O=g;for(let Oe of f)g+=Oe;g=s.getNextSet(g)}while(E!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let L=0;for(let we of f)L+=we;let V=g-O-L;if(g!==w&&V*2<L)throw new ve;if(this.usingCheckDigit){let we=this.decodeRowResult.length-1,Oe=0;for(let Ue=0;Ue<we;Ue++)Oe+=xn.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Ue));if(this.decodeRowResult.charAt(we)!==xn.ALPHABET_STRING.charAt(Oe%43))throw new N;this.decodeRowResult=this.decodeRowResult.substring(0,we)}if(this.decodeRowResult.length===0)throw new ve;let Y;this.extendedMode?Y=xn.decodeExtended(this.decodeRowResult):Y=this.decodeRowResult;let ae=(d[1]+d[0])/2,ge=O+L/2;return new Le(Y,null,0,[new wt(ae,n),new wt(ge,n)],Me.CODE_39,new Date().getTime())}static findAsteriskPattern(n,s){let l=n.getSize(),f=n.getNextSet(0),d=0,g=f,w=!1,E=s.length;for(let O=f;O<l;O++)if(n.get(O)!==w)s[d]++;else{if(d===E-1){if(this.toNarrowWidePattern(s)===xn.ASTERISK_ENCODING&&n.isRange(Math.max(0,g-Math.floor((O-g)/2)),g,!1))return[g,O];g+=s[0]+s[1],s.copyWithin(0,2,2+d-1),s[d-1]=0,s[d]=0,d--}else d++;s[d]=1,w=!w}throw new ve}static toNarrowWidePattern(n){let s=n.length,l=0,f;do{let d=2147483647;for(let E of n)E<d&&E>l&&(d=E);l=d,f=0;let g=0,w=0;for(let E=0;E<s;E++){let O=n[E];O>l&&(w|=1<<s-1-E,f++,g+=O)}if(f===3){for(let E=0;E<s&&f>0;E++){let O=n[E];if(O>l&&(f--,O*2>=g))return-1}return w}}while(f>3);return-1}static patternToChar(n){for(let s=0;s<xn.CHARACTER_ENCODINGS.length;s++)if(xn.CHARACTER_ENCODINGS[s]===n)return xn.ALPHABET_STRING.charAt(s);if(n===xn.ASTERISK_ENCODING)return"*";throw new ve}static decodeExtended(n){let s=n.length,l="";for(let f=0;f<s;f++){let d=n.charAt(f);if(d==="+"||d==="$"||d==="%"||d==="/"){let g=n.charAt(f+1),w="\0";switch(d){case"+":if(g>="A"&&g<="Z")w=String.fromCharCode(g.charCodeAt(0)+32);else throw new ee;break;case"$":if(g>="A"&&g<="Z")w=String.fromCharCode(g.charCodeAt(0)-64);else throw new ee;break;case"%":if(g>="A"&&g<="E")w=String.fromCharCode(g.charCodeAt(0)-38);else if(g>="F"&&g<="J")w=String.fromCharCode(g.charCodeAt(0)-11);else if(g>="K"&&g<="O")w=String.fromCharCode(g.charCodeAt(0)+16);else if(g>="P"&&g<="T")w=String.fromCharCode(g.charCodeAt(0)+43);else if(g==="U")w="\0";else if(g==="V")w="@";else if(g==="W")w="`";else if(g==="X"||g==="Y"||g==="Z")w="";else throw new ee;break;case"/":if(g>="A"&&g<="O")w=String.fromCharCode(g.charCodeAt(0)-32);else if(g==="Z")w=":";else throw new ee;break}l+=w,f++}else l+=d}return l}}xn.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",xn.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],xn.ASTERISK_ENCODING=148;class Xt extends an{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(n,s,l){let f=this.decodeStart(s),d=this.decodeEnd(s),g=new at;Xt.decodeMiddle(s,f[1],d[0],g);let w=g.toString(),E=null;l!=null&&(E=l.get(ue.ALLOWED_LENGTHS)),E==null&&(E=Xt.DEFAULT_ALLOWED_LENGTHS);let O=w.length,L=!1,V=0;for(let ge of E){if(O===ge){L=!0;break}ge>V&&(V=ge)}if(!L&&O>V&&(L=!0),!L)throw new ee;const Y=[new wt(f[1],n),new wt(d[0],n)];return new Le(w,null,0,Y,Me.ITF,new Date().getTime())}static decodeMiddle(n,s,l,f){let d=new Int32Array(10),g=new Int32Array(5),w=new Int32Array(5);for(d.fill(0),g.fill(0),w.fill(0);s<l;){an.recordPattern(n,s,d);for(let O=0;O<5;O++){let L=2*O;g[O]=d[L],w[O]=d[L+1]}let E=Xt.decodeDigit(g);f.append(E.toString()),E=this.decodeDigit(w),f.append(E.toString()),d.forEach(function(O){s+=O})}}decodeStart(n){let s=Xt.skipWhiteSpace(n),l=Xt.findGuardPattern(n,s,Xt.START_PATTERN);return this.narrowLineWidth=(l[1]-l[0])/4,this.validateQuietZone(n,l[0]),l}validateQuietZone(n,s){let l=this.narrowLineWidth*10;l=l<s?l:s;for(let f=s-1;l>0&&f>=0&&!n.get(f);f--)l--;if(l!==0)throw new ve}static skipWhiteSpace(n){const s=n.getSize(),l=n.getNextSet(0);if(l===s)throw new ve;return l}decodeEnd(n){n.reverse();try{let s=Xt.skipWhiteSpace(n),l;try{l=Xt.findGuardPattern(n,s,Xt.END_PATTERN_REVERSED[0])}catch(d){d instanceof ve&&(l=Xt.findGuardPattern(n,s,Xt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(n,l[0]);let f=l[0];return l[0]=n.getSize()-l[1],l[1]=n.getSize()-f,l}finally{n.reverse()}}static findGuardPattern(n,s,l){let f=l.length,d=new Int32Array(f),g=n.getSize(),w=!1,E=0,O=s;d.fill(0);for(let L=s;L<g;L++)if(n.get(L)!==w)d[E]++;else{if(E===f-1){if(an.patternMatchVariance(d,l,Xt.MAX_INDIVIDUAL_VARIANCE)<Xt.MAX_AVG_VARIANCE)return[O,L];O+=d[0]+d[1],z.arraycopy(d,2,d,0,E-1),d[E-1]=0,d[E]=0,E--}else E++;d[E]=1,w=!w}throw new ve}static decodeDigit(n){let s=Xt.MAX_AVG_VARIANCE,l=-1,f=Xt.PATTERNS.length;for(let d=0;d<f;d++){let g=Xt.PATTERNS[d],w=an.patternMatchVariance(n,g,Xt.MAX_INDIVIDUAL_VARIANCE);w<s?(s=w,l=d):w===s&&(l=-1)}if(l>=0)return l%10;throw new ve}}Xt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Xt.MAX_AVG_VARIANCE=.38,Xt.MAX_INDIVIDUAL_VARIANCE=.5,Xt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Xt.START_PATTERN=Int32Array.from([1,1,1,1]),Xt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class En extends an{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(n){let s=!1,l,f=0,d=Int32Array.from([0,0,0]);for(;!s;){d=Int32Array.from([0,0,0]),l=En.findGuardPattern(n,f,!1,this.START_END_PATTERN,d);let g=l[0];f=l[1];let w=g-(f-g);w>=0&&(s=n.isRange(w,g,!1))}return l}static checkChecksum(n){return En.checkStandardUPCEANChecksum(n)}static checkStandardUPCEANChecksum(n){let s=n.length;if(s===0)return!1;let l=parseInt(n.charAt(s-1),10);return En.getStandardUPCEANChecksum(n.substring(0,s-1))===l}static getStandardUPCEANChecksum(n){let s=n.length,l=0;for(let f=s-1;f>=0;f-=2){let d=n.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new ee;l+=d}l*=3;for(let f=s-2;f>=0;f-=2){let d=n.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new ee;l+=d}return(1e3-l)%10}static decodeEnd(n,s){return En.findGuardPattern(n,s,!1,En.START_END_PATTERN,new Int32Array(En.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(n,s,l,f){return this.findGuardPattern(n,s,l,f,new Int32Array(f.length))}static findGuardPattern(n,s,l,f,d){let g=n.getSize();s=l?n.getNextUnset(s):n.getNextSet(s);let w=0,E=s,O=f.length,L=l;for(let V=s;V<g;V++)if(n.get(V)!==L)d[w]++;else{if(w===O-1){if(an.patternMatchVariance(d,f,En.MAX_INDIVIDUAL_VARIANCE)<En.MAX_AVG_VARIANCE)return Int32Array.from([E,V]);E+=d[0]+d[1];let Y=d.slice(2,d.length-1);for(let ae=0;ae<w-1;ae++)d[ae]=Y[ae];d[w-1]=0,d[w]=0,w--}else w++;d[w]=1,L=!L}throw new ve}static decodeDigit(n,s,l,f){this.recordPattern(n,l,s);let d=this.MAX_AVG_VARIANCE,g=-1,w=f.length;for(let E=0;E<w;E++){let O=f[E],L=an.patternMatchVariance(s,O,En.MAX_INDIVIDUAL_VARIANCE);L<d&&(d=L,g=E)}if(g>=0)return g;throw new ve}}En.MAX_AVG_VARIANCE=.48,En.MAX_INDIVIDUAL_VARIANCE=.7,En.START_END_PATTERN=Int32Array.from([1,1,1]),En.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),En.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),En.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Nn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(n,s,l){let f=this.decodeRowStringBuffer,d=this.decodeMiddle(s,l,f),g=f.toString(),w=Nn.parseExtensionString(g),E=[new wt((l[0]+l[1])/2,n),new wt(d,n)],O=new Le(g,null,0,E,Me.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&O.putAllMetadata(w),O}decodeMiddle(n,s,l){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=n.getSize(),g=s[1],w=0;for(let O=0;O<5&&g<d;O++){let L=En.decodeDigit(n,f,g,En.L_AND_G_PATTERNS);l+=String.fromCharCode(48+L%10);for(let V of f)g+=V;L>=10&&(w|=1<<4-O),O!==4&&(g=n.getNextSet(g),g=n.getNextUnset(g))}if(l.length!==5)throw new ve;let E=this.determineCheckDigit(w);if(Nn.extensionChecksum(l.toString())!==E)throw new ve;return g}static extensionChecksum(n){let s=n.length,l=0;for(let f=s-2;f>=0;f-=2)l+=n.charAt(f).charCodeAt(0)-48;l*=3;for(let f=s-1;f>=0;f-=2)l+=n.charAt(f).charCodeAt(0)-48;return l*=3,l%10}determineCheckDigit(n){for(let s=0;s<10;s++)if(n===this.CHECK_DIGIT_ENCODINGS[s])return s;throw new ve}static parseExtensionString(n){if(n.length!==5)return null;let s=Nn.parseExtension5String(n);return s==null?null:new Map([[At.SUGGESTED_PRICE,s]])}static parseExtension5String(n){let s;switch(n.charAt(0)){case"0":s="";break;case"5":s="$";break;case"9":switch(n){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}s="";break;default:s="";break}let l=parseInt(n.substring(1)),f=(l/100).toString(),d=l%100,g=d<10?"0"+d:d.toString();return s+f+"."+g}}class Jr{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(n,s,l){let f=this.decodeRowStringBuffer,d=this.decodeMiddle(s,l,f),g=f.toString(),w=Jr.parseExtensionString(g),E=[new wt((l[0]+l[1])/2,n),new wt(d,n)],O=new Le(g,null,0,E,Me.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&O.putAllMetadata(w),O}decodeMiddle(n,s,l){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=n.getSize(),g=s[1],w=0;for(let E=0;E<2&&g<d;E++){let O=En.decodeDigit(n,f,g,En.L_AND_G_PATTERNS);l+=String.fromCharCode(48+O%10);for(let L of f)g+=L;O>=10&&(w|=1<<1-E),E!==1&&(g=n.getNextSet(g),g=n.getNextUnset(g))}if(l.length!==2)throw new ve;if(parseInt(l.toString())%4!==w)throw new ve;return g}static parseExtensionString(n){return n.length!==2?null:new Map([[At.ISSUE_NUMBER,parseInt(n)]])}}class In{static decodeRow(n,s,l){let f=En.findGuardPattern(s,l,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Nn().decodeRow(n,s,f)}catch{return new Jr().decodeRow(n,s,f)}}}In.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class on extends En{constructor(){super(),this.decodeRowStringBuffer="",on.L_AND_G_PATTERNS=on.L_PATTERNS.map(n=>Int32Array.from(n));for(let n=10;n<20;n++){let s=on.L_PATTERNS[n-10],l=new Int32Array(s.length);for(let f=0;f<s.length;f++)l[f]=s[s.length-f-1];on.L_AND_G_PATTERNS[n]=l}}decodeRow(n,s,l){let f=on.findStartGuardPattern(s),d=l==null?null:l.get(ue.NEED_RESULT_POINT_CALLBACK);if(d!=null){const v=new wt((f[0]+f[1])/2,n);d.foundPossibleResultPoint(v)}let g=this.decodeMiddle(s,f,this.decodeRowStringBuffer),w=g.rowOffset,E=g.resultString;if(d!=null){const v=new wt(w,n);d.foundPossibleResultPoint(v)}let O=this.decodeEnd(s,w);if(d!=null){const v=new wt((O[0]+O[1])/2,n);d.foundPossibleResultPoint(v)}let L=O[1],V=L+(L-O[0]);if(V>=s.getSize()||!s.isRange(L,V,!1))throw new ve;let Y=E.toString();if(Y.length<8)throw new ee;if(!on.checkChecksum(Y))throw new N;let ae=(f[1]+f[0])/2,ge=(O[1]+O[0])/2,we=this.getBarcodeFormat(),Oe=[new wt(ae,n),new wt(ge,n)],Ue=new Le(Y,null,0,Oe,we,new Date().getTime()),pt=0;try{let v=In.decodeRow(n,s,O[1]);Ue.putMetadata(At.UPC_EAN_EXTENSION,v.getText()),Ue.putAllMetadata(v.getResultMetadata()),Ue.addResultPoints(v.getResultPoints()),pt=v.getText().length}catch{}let dt=l==null?null:l.get(ue.ALLOWED_EAN_EXTENSIONS);if(dt!=null){let v=!1;for(let I in dt)if(pt.toString()===I){v=!0;break}if(!v)throw new ve}return Ue}decodeEnd(n,s){return on.findGuardPattern(n,s,!1,on.START_END_PATTERN,new Int32Array(on.START_END_PATTERN.length).fill(0))}static checkChecksum(n){return on.checkStandardUPCEANChecksum(n)}static checkStandardUPCEANChecksum(n){let s=n.length;if(s===0)return!1;let l=parseInt(n.charAt(s-1),10);return on.getStandardUPCEANChecksum(n.substring(0,s-1))===l}static getStandardUPCEANChecksum(n){let s=n.length,l=0;for(let f=s-1;f>=0;f-=2){let d=n.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new ee;l+=d}l*=3;for(let f=s-2;f>=0;f-=2){let d=n.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new ee;l+=d}return(1e3-l)%10}}class Ft extends on{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(n,s,l){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=n.getSize(),g=s[1],w=0;for(let O=0;O<6&&g<d;O++){let L=on.decodeDigit(n,f,g,on.L_AND_G_PATTERNS);l+=String.fromCharCode(48+L%10);for(let V of f)g+=V;L>=10&&(w|=1<<5-O)}l=Ft.determineFirstDigit(l,w),g=on.findGuardPattern(n,g,!0,on.MIDDLE_PATTERN,new Int32Array(on.MIDDLE_PATTERN.length).fill(0))[1];for(let O=0;O<6&&g<d;O++){let L=on.decodeDigit(n,f,g,on.L_PATTERNS);l+=String.fromCharCode(48+L);for(let V of f)g+=V}return{rowOffset:g,resultString:l}}getBarcodeFormat(){return Me.EAN_13}static determineFirstDigit(n,s){for(let l=0;l<10;l++)if(s===this.FIRST_DIGIT_ENCODINGS[l])return n=String.fromCharCode(48+l)+n,n;throw new ve}}Ft.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Gn extends on{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(n,s,l){const f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=n.getSize(),g=s[1];for(let E=0;E<4&&g<d;E++){let O=on.decodeDigit(n,f,g,on.L_PATTERNS);l+=String.fromCharCode(48+O);for(let L of f)g+=L}g=on.findGuardPattern(n,g,!0,on.MIDDLE_PATTERN,new Int32Array(on.MIDDLE_PATTERN.length).fill(0))[1];for(let E=0;E<4&&g<d;E++){let O=on.decodeDigit(n,f,g,on.L_PATTERNS);l+=String.fromCharCode(48+O);for(let L of f)g+=L}return{rowOffset:g,resultString:l}}getBarcodeFormat(){return Me.EAN_8}}class sr extends on{constructor(){super(...arguments),this.ean13Reader=new Ft}getBarcodeFormat(){return Me.UPC_A}decode(n,s){return this.maybeReturnResult(this.ean13Reader.decode(n))}decodeRow(n,s,l){return this.maybeReturnResult(this.ean13Reader.decodeRow(n,s,l))}decodeMiddle(n,s,l){return this.ean13Reader.decodeMiddle(n,s,l)}maybeReturnResult(n){let s=n.getText();if(s.charAt(0)==="0"){let l=new Le(s.substring(1),null,null,n.getResultPoints(),Me.UPC_A);return n.getResultMetadata()!=null&&l.putAllMetadata(n.getResultMetadata()),l}else throw new ve}reset(){this.ean13Reader.reset()}}class fr extends on{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(n,s,l){const f=this.decodeMiddleCounters.map(O=>O);f[0]=0,f[1]=0,f[2]=0,f[3]=0;const d=n.getSize();let g=s[1],w=0;for(let O=0;O<6&&g<d;O++){const L=fr.decodeDigit(n,f,g,fr.L_AND_G_PATTERNS);l+=String.fromCharCode(48+L%10);for(let V of f)g+=V;L>=10&&(w|=1<<5-O)}let E=fr.determineNumSysAndCheckDigit(l,w);return{rowOffset:g,resultString:E}}decodeEnd(n,s){return fr.findGuardPatternWithoutCounters(n,s,!0,fr.MIDDLE_END_PATTERN)}checkChecksum(n){return on.checkChecksum(fr.convertUPCEtoUPCA(n))}static determineNumSysAndCheckDigit(n,s){for(let l=0;l<=1;l++)for(let f=0;f<10;f++)if(s===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[l][f]){let d=String.fromCharCode(48+l),g=String.fromCharCode(48+f);return d+n+g}throw ve.getNotFoundInstance()}getBarcodeFormat(){return Me.UPC_E}static convertUPCEtoUPCA(n){const s=n.slice(1,7).split("").map(d=>d.charCodeAt(0)),l=new at;l.append(n.charAt(0));let f=s[5];switch(f){case 0:case 1:case 2:l.appendChars(s,0,2),l.append(f),l.append("0000"),l.appendChars(s,2,3);break;case 3:l.appendChars(s,0,3),l.append("00000"),l.appendChars(s,3,2);break;case 4:l.appendChars(s,0,4),l.append("00000"),l.append(s[4]);break;default:l.appendChars(s,0,5),l.append("0000"),l.append(f);break}return n.length>=8&&l.append(n.charAt(7)),l.toString()}}fr.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),fr.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class hi extends an{constructor(n){super();let s=n==null?null:n.get(ue.POSSIBLE_FORMATS),l=[];o(s)?(l.push(new Ft),l.push(new sr),l.push(new Gn),l.push(new fr)):(s.indexOf(Me.EAN_13)>-1&&l.push(new Ft),s.indexOf(Me.UPC_A)>-1&&l.push(new sr),s.indexOf(Me.EAN_8)>-1&&l.push(new Gn),s.indexOf(Me.UPC_E)>-1&&l.push(new fr)),this.readers=l}decodeRow(n,s,l){for(let f of this.readers)try{const d=f.decodeRow(n,s,l),g=d.getBarcodeFormat()===Me.EAN_13&&d.getText().charAt(0)==="0",w=l==null?null:l.get(ue.POSSIBLE_FORMATS),E=w==null||w.includes(Me.UPC_A);if(g&&E){const O=d.getRawBytes(),L=new Le(d.getText().substring(1),O,O?O.length:null,d.getResultPoints(),Me.UPC_A);return L.putAllMetadata(d.getResultMetadata()),L}return d}catch{}throw new ve}reset(){for(let n of this.readers)n.reset()}}class dr extends an{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(n,s){for(let l=0;l<s.length;l++)if(an.patternMatchVariance(n,s[l],dr.MAX_INDIVIDUAL_VARIANCE)<dr.MAX_AVG_VARIANCE)return l;throw new ve}static count(n){return Qt.sum(new Int32Array(n))}static increment(n,s){let l=0,f=s[0];for(let d=1;d<n.length;d++)s[d]>f&&(f=s[d],l=d);n[l]++}static decrement(n,s){let l=0,f=s[0];for(let d=1;d<n.length;d++)s[d]<f&&(f=s[d],l=d);n[l]--}static isFinderPattern(n){let s=n[0]+n[1],l=s+n[2]+n[3],f=s/l;if(f>=dr.MIN_FINDER_PATTERN_RATIO&&f<=dr.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;for(let w of n)w>g&&(g=w),w<d&&(d=w);return g<10*d}return!1}}dr.MAX_AVG_VARIANCE=.2,dr.MAX_INDIVIDUAL_VARIANCE=.45,dr.MIN_FINDER_PATTERN_RATIO=9.5/12,dr.MAX_FINDER_PATTERN_RATIO=12.5/14;class qr{constructor(n,s){this.value=n,this.checksumPortion=s}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(n){if(!(n instanceof qr))return!1;const s=n;return this.value===s.value&&this.checksumPortion===s.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class ei{constructor(n,s,l,f,d){this.value=n,this.startEnd=s,this.value=n,this.startEnd=s,this.resultPoints=new Array,this.resultPoints.push(new wt(l,d)),this.resultPoints.push(new wt(f,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(n){if(!(n instanceof ei))return!1;const s=n;return this.value===s.value}hashCode(){return this.value}}class ti{constructor(){}static getRSSvalue(n,s,l){let f=0;for(let E of n)f+=E;let d=0,g=0,w=n.length;for(let E=0;E<w-1;E++){let O;for(O=1,g|=1<<E;O<n[E];O++,g&=~(1<<E)){let L=ti.combins(f-O-1,w-E-2);if(l&&g===0&&f-O-(w-E-1)>=w-E-1&&(L-=ti.combins(f-O-(w-E),w-E-2)),w-E-1>1){let V=0;for(let Y=f-O-(w-E-2);Y>s;Y--)V+=ti.combins(f-O-Y-1,w-E-3);L-=V*(w-1-E)}else f-O>s&&L--;d+=L}f-=O}return d}static combins(n,s){let l,f;n-s>s?(f=s,l=n-s):(f=n-s,l=s);let d=1,g=1;for(let w=n;w>l;w--)d*=w,g<=f&&(d/=g,g++);for(;g<=f;)d/=g,g++;return d}}class Dr{static buildBitArray(n){let s=n.length*2-1;n[n.length-1].getRightChar()==null&&(s-=1);let l=12*s,f=new Q(l),d=0,w=n[0].getRightChar().getValue();for(let E=11;E>=0;--E)(w&1<<E)!=0&&f.set(d),d++;for(let E=1;E<n.length;++E){let O=n[E],L=O.getLeftChar().getValue();for(let V=11;V>=0;--V)(L&1<<V)!=0&&f.set(d),d++;if(O.getRightChar()!=null){let V=O.getRightChar().getValue();for(let Y=11;Y>=0;--Y)(V&1<<Y)!=0&&f.set(d),d++}}return f}}class Pr{constructor(n,s){s?this.decodedInformation=null:(this.finished=n,this.decodedInformation=s)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class P{constructor(n){this.newPosition=n}getNewPosition(){return this.newPosition}}class W extends P{constructor(n,s){super(n),this.value=s}getValue(){return this.value}isFNC1(){return this.value===W.FNC1}}W.FNC1="$";class K extends P{constructor(n,s,l){super(n),l?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=s}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class M extends P{constructor(n,s,l){if(super(n),s<0||s>10||l<0||l>10)throw new ee;this.firstDigit=s,this.secondDigit=l}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===M.FNC1}isSecondDigitFNC1(){return this.secondDigit===M.FNC1}isAnyFNC1(){return this.firstDigit===M.FNC1||this.secondDigit===M.FNC1}}M.FNC1=10;class H{constructor(){}static parseFieldsInGeneralPurpose(n){if(!n)return null;if(n.length<2)throw new ve;let s=n.substring(0,2);for(let d of H.TWO_DIGIT_DATA_LENGTH)if(d[0]===s)return d[1]===H.VARIABLE_LENGTH?H.processVariableAI(2,d[2],n):H.processFixedAI(2,d[1],n);if(n.length<3)throw new ve;let l=n.substring(0,3);for(let d of H.THREE_DIGIT_DATA_LENGTH)if(d[0]===l)return d[1]===H.VARIABLE_LENGTH?H.processVariableAI(3,d[2],n):H.processFixedAI(3,d[1],n);for(let d of H.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===l)return d[1]===H.VARIABLE_LENGTH?H.processVariableAI(4,d[2],n):H.processFixedAI(4,d[1],n);if(n.length<4)throw new ve;let f=n.substring(0,4);for(let d of H.FOUR_DIGIT_DATA_LENGTH)if(d[0]===f)return d[1]===H.VARIABLE_LENGTH?H.processVariableAI(4,d[2],n):H.processFixedAI(4,d[1],n);throw new ve}static processFixedAI(n,s,l){if(l.length<n)throw new ve;let f=l.substring(0,n);if(l.length<n+s)throw new ve;let d=l.substring(n,n+s),g=l.substring(n+s),w="("+f+")"+d,E=H.parseFieldsInGeneralPurpose(g);return E==null?w:w+E}static processVariableAI(n,s,l){let f=l.substring(0,n),d;l.length<n+s?d=l.length:d=n+s;let g=l.substring(n,d),w=l.substring(d),E="("+f+")"+g,O=H.parseFieldsInGeneralPurpose(w);return O==null?E:E+O}}H.VARIABLE_LENGTH=[],H.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",H.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",H.VARIABLE_LENGTH,20],["22",H.VARIABLE_LENGTH,29],["30",H.VARIABLE_LENGTH,8],["37",H.VARIABLE_LENGTH,8],["90",H.VARIABLE_LENGTH,30],["91",H.VARIABLE_LENGTH,30],["92",H.VARIABLE_LENGTH,30],["93",H.VARIABLE_LENGTH,30],["94",H.VARIABLE_LENGTH,30],["95",H.VARIABLE_LENGTH,30],["96",H.VARIABLE_LENGTH,30],["97",H.VARIABLE_LENGTH,3],["98",H.VARIABLE_LENGTH,30],["99",H.VARIABLE_LENGTH,30]],H.THREE_DIGIT_DATA_LENGTH=[["240",H.VARIABLE_LENGTH,30],["241",H.VARIABLE_LENGTH,30],["242",H.VARIABLE_LENGTH,6],["250",H.VARIABLE_LENGTH,30],["251",H.VARIABLE_LENGTH,30],["253",H.VARIABLE_LENGTH,17],["254",H.VARIABLE_LENGTH,20],["400",H.VARIABLE_LENGTH,30],["401",H.VARIABLE_LENGTH,30],["402",17],["403",H.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",H.VARIABLE_LENGTH,20],["421",H.VARIABLE_LENGTH,15],["422",3],["423",H.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],H.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",H.VARIABLE_LENGTH,15],["391",H.VARIABLE_LENGTH,18],["392",H.VARIABLE_LENGTH,15],["393",H.VARIABLE_LENGTH,18],["703",H.VARIABLE_LENGTH,30]],H.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",H.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",H.VARIABLE_LENGTH,20],["8003",H.VARIABLE_LENGTH,30],["8004",H.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",H.VARIABLE_LENGTH,30],["8008",H.VARIABLE_LENGTH,12],["8018",18],["8020",H.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",H.VARIABLE_LENGTH,70],["8200",H.VARIABLE_LENGTH,70]];class Ee{constructor(n){this.buffer=new at,this.information=n}decodeAllCodes(n,s){let l=s,f=null;do{let d=this.decodeGeneralPurposeField(l,f),g=H.parseFieldsInGeneralPurpose(d.getNewString());if(g!=null&&n.append(g),d.isRemaining()?f=""+d.getRemainingValue():f=null,l===d.getNewPosition())break;l=d.getNewPosition()}while(!0);return n.toString()}isStillNumeric(n){if(n+7>this.information.getSize())return n+4<=this.information.getSize();for(let s=n;s<n+3;++s)if(this.information.get(s))return!0;return this.information.get(n+3)}decodeNumeric(n){if(n+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(n,4);return d===0?new M(this.information.getSize(),M.FNC1,M.FNC1):new M(this.information.getSize(),d-1,M.FNC1)}let s=this.extractNumericValueFromBitArray(n,7),l=(s-8)/11,f=(s-8)%11;return new M(n+7,l,f)}extractNumericValueFromBitArray(n,s){return Ee.extractNumericValueFromBitArray(this.information,n,s)}static extractNumericValueFromBitArray(n,s,l){let f=0;for(let d=0;d<l;++d)n.get(s+d)&&(f|=1<<l-d-1);return f}decodeGeneralPurposeField(n,s){this.buffer.setLengthToZero(),s!=null&&this.buffer.append(s),this.current.setPosition(n);let l=this.parseBlocks();return l!=null&&l.isRemaining()?new K(this.current.getPosition(),this.buffer.toString(),l.getRemainingValue()):new K(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let n,s;do{let l=this.current.getPosition();if(this.current.isAlpha()?(s=this.parseAlphaBlock(),n=s.isFinished()):this.current.isIsoIec646()?(s=this.parseIsoIec646Block(),n=s.isFinished()):(s=this.parseNumericBlock(),n=s.isFinished()),!(l!==this.current.getPosition())&&!n)break}while(!n);return s.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let n=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFirstDigitFNC1()){let s;return n.isSecondDigitFNC1()?s=new K(this.current.getPosition(),this.buffer.toString()):s=new K(this.current.getPosition(),this.buffer.toString(),n.getSecondDigit()),new Pr(!0,s)}if(this.buffer.append(n.getFirstDigit()),n.isSecondDigitFNC1()){let s=new K(this.current.getPosition(),this.buffer.toString());return new Pr(!0,s)}this.buffer.append(n.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Pr(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let n=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFNC1()){let s=new K(this.current.getPosition(),this.buffer.toString());return new Pr(!0,s)}this.buffer.append(n.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Pr(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let n=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFNC1()){let s=new K(this.current.getPosition(),this.buffer.toString());return new Pr(!0,s)}this.buffer.append(n.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Pr(!1)}isStillIsoIec646(n){if(n+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(n,5);if(s>=5&&s<16)return!0;if(n+7>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(n,7);if(l>=64&&l<116)return!0;if(n+8>this.information.getSize())return!1;let f=this.extractNumericValueFromBitArray(n,8);return f>=232&&f<253}decodeIsoIec646(n){let s=this.extractNumericValueFromBitArray(n,5);if(s===15)return new W(n+5,W.FNC1);if(s>=5&&s<15)return new W(n+5,"0"+(s-5));let l=this.extractNumericValueFromBitArray(n,7);if(l>=64&&l<90)return new W(n+7,""+(l+1));if(l>=90&&l<116)return new W(n+7,""+(l+7));let f=this.extractNumericValueFromBitArray(n,8),d;switch(f){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new ee}return new W(n+8,d)}isStillAlpha(n){if(n+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(n,5);if(s>=5&&s<16)return!0;if(n+6>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(n,6);return l>=16&&l<63}decodeAlphanumeric(n){let s=this.extractNumericValueFromBitArray(n,5);if(s===15)return new W(n+5,W.FNC1);if(s>=5&&s<15)return new W(n+5,"0"+(s-5));let l=this.extractNumericValueFromBitArray(n,6);if(l>=32&&l<58)return new W(n+6,""+(l+33));let f;switch(l){case 58:f="*";break;case 59:f=",";break;case 60:f="-";break;case 61:f=".";break;case 62:f="/";break;default:throw new Zn("Decoding invalid alphanumeric value: "+l)}return new W(n+6,f)}isAlphaTo646ToAlphaLatch(n){if(n+1>this.information.getSize())return!1;for(let s=0;s<5&&s+n<this.information.getSize();++s)if(s===2){if(!this.information.get(n+2))return!1}else if(this.information.get(n+s))return!1;return!0}isAlphaOr646ToNumericLatch(n){if(n+3>this.information.getSize())return!1;for(let s=n;s<n+3;++s)if(this.information.get(s))return!1;return!0}isNumericToAlphaNumericLatch(n){if(n+1>this.information.getSize())return!1;for(let s=0;s<4&&s+n<this.information.getSize();++s)if(this.information.get(n+s))return!1;return!0}}class Ae{constructor(n){this.information=n,this.generalDecoder=new Ee(n)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Fe extends Ae{constructor(n){super(n)}encodeCompressedGtin(n,s){n.append("(01)");let l=n.length();n.append("9"),this.encodeCompressedGtinWithoutAI(n,s,l)}encodeCompressedGtinWithoutAI(n,s,l){for(let f=0;f<4;++f){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(s+10*f,10);d/100===0&&n.append("0"),d/10===0&&n.append("0"),n.append(d)}Fe.appendCheckDigit(n,l)}static appendCheckDigit(n,s){let l=0;for(let f=0;f<13;f++){let d=n.charAt(f+s).charCodeAt(0)-48;l+=(f&1)===0?3*d:d}l=10-l%10,l===10&&(l=0),n.append(l)}}Fe.GTIN_SIZE=40;class ut extends Fe{constructor(n){super(n)}parseInformation(){let n=new at;n.append("(01)");let s=n.length(),l=this.getGeneralDecoder().extractNumericValueFromBitArray(ut.HEADER_SIZE,4);return n.append(l),this.encodeCompressedGtinWithoutAI(n,ut.HEADER_SIZE+4,s),this.getGeneralDecoder().decodeAllCodes(n,ut.HEADER_SIZE+44)}}ut.HEADER_SIZE=4;class Tt extends Ae{constructor(n){super(n)}parseInformation(){let n=new at;return this.getGeneralDecoder().decodeAllCodes(n,Tt.HEADER_SIZE)}}Tt.HEADER_SIZE=5;class xt extends Fe{constructor(n){super(n)}encodeCompressedWeight(n,s,l){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(s,l);this.addWeightCode(n,f);let d=this.checkWeight(f),g=1e5;for(let w=0;w<5;++w)d/g===0&&n.append("0"),g/=10;n.append(d)}}class dn extends xt{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()!=dn.HEADER_SIZE+xt.GTIN_SIZE+dn.WEIGHT_SIZE)throw new ve;let n=new at;return this.encodeCompressedGtin(n,dn.HEADER_SIZE),this.encodeCompressedWeight(n,dn.HEADER_SIZE+xt.GTIN_SIZE,dn.WEIGHT_SIZE),n.toString()}}dn.HEADER_SIZE=5,dn.WEIGHT_SIZE=15;class Mt extends dn{constructor(n){super(n)}addWeightCode(n,s){n.append("(3103)")}checkWeight(n){return n}}class Gt extends dn{constructor(n){super(n)}addWeightCode(n,s){s<1e4?n.append("(3202)"):n.append("(3203)")}checkWeight(n){return n<1e4?n:n-1e4}}class jt extends Fe{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()<jt.HEADER_SIZE+Fe.GTIN_SIZE)throw new ve;let n=new at;this.encodeCompressedGtin(n,jt.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(jt.HEADER_SIZE+Fe.GTIN_SIZE,jt.LAST_DIGIT_SIZE);n.append("(392"),n.append(s),n.append(")");let l=this.getGeneralDecoder().decodeGeneralPurposeField(jt.HEADER_SIZE+Fe.GTIN_SIZE+jt.LAST_DIGIT_SIZE,null);return n.append(l.getNewString()),n.toString()}}jt.HEADER_SIZE=8,jt.LAST_DIGIT_SIZE=2;class kt extends Fe{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()<kt.HEADER_SIZE+Fe.GTIN_SIZE)throw new ve;let n=new at;this.encodeCompressedGtin(n,kt.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(kt.HEADER_SIZE+Fe.GTIN_SIZE,kt.LAST_DIGIT_SIZE);n.append("(393"),n.append(s),n.append(")");let l=this.getGeneralDecoder().extractNumericValueFromBitArray(kt.HEADER_SIZE+Fe.GTIN_SIZE+kt.LAST_DIGIT_SIZE,kt.FIRST_THREE_DIGITS_SIZE);l/100==0&&n.append("0"),l/10==0&&n.append("0"),n.append(l);let f=this.getGeneralDecoder().decodeGeneralPurposeField(kt.HEADER_SIZE+Fe.GTIN_SIZE+kt.LAST_DIGIT_SIZE+kt.FIRST_THREE_DIGITS_SIZE,null);return n.append(f.getNewString()),n.toString()}}kt.HEADER_SIZE=8,kt.LAST_DIGIT_SIZE=2,kt.FIRST_THREE_DIGITS_SIZE=10;class bt extends xt{constructor(n,s,l){super(n),this.dateCode=l,this.firstAIdigits=s}parseInformation(){if(this.getInformation().getSize()!=bt.HEADER_SIZE+bt.GTIN_SIZE+bt.WEIGHT_SIZE+bt.DATE_SIZE)throw new ve;let n=new at;return this.encodeCompressedGtin(n,bt.HEADER_SIZE),this.encodeCompressedWeight(n,bt.HEADER_SIZE+bt.GTIN_SIZE,bt.WEIGHT_SIZE),this.encodeCompressedDate(n,bt.HEADER_SIZE+bt.GTIN_SIZE+bt.WEIGHT_SIZE),n.toString()}encodeCompressedDate(n,s){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(s,bt.DATE_SIZE);if(l==38400)return;n.append("("),n.append(this.dateCode),n.append(")");let f=l%32;l/=32;let d=l%12+1;l/=12;let g=l;g/10==0&&n.append("0"),n.append(g),d/10==0&&n.append("0"),n.append(d),f/10==0&&n.append("0"),n.append(f)}addWeightCode(n,s){n.append("("),n.append(this.firstAIdigits),n.append(s/1e5),n.append(")")}checkWeight(n){return n%1e5}}bt.HEADER_SIZE=8,bt.WEIGHT_SIZE=20,bt.DATE_SIZE=16;function Zt(G){try{if(G.get(1))return new ut(G);if(!G.get(2))return new Tt(G);switch(Ee.extractNumericValueFromBitArray(G,1,4)){case 4:return new Mt(G);case 5:return new Gt(G)}switch(Ee.extractNumericValueFromBitArray(G,1,5)){case 12:return new jt(G);case 13:return new kt(G)}switch(Ee.extractNumericValueFromBitArray(G,1,7)){case 56:return new bt(G,"310","11");case 57:return new bt(G,"320","11");case 58:return new bt(G,"310","13");case 59:return new bt(G,"320","13");case 60:return new bt(G,"310","15");case 61:return new bt(G,"320","15");case 62:return new bt(G,"310","17");case 63:return new bt(G,"320","17")}}catch(n){throw console.log(n),new Zn("unknown decoder: "+G)}}class St{constructor(n,s,l,f){this.leftchar=n,this.rightchar=s,this.finderpattern=l,this.maybeLast=f}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(n,s){return n instanceof St?St.equalsOrNull(n.leftchar,s.leftchar)&&St.equalsOrNull(n.rightchar,s.rightchar)&&St.equalsOrNull(n.finderpattern,s.finderpattern):!1}static equalsOrNull(n,s){return n===null?s===null:St.equals(n,s)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class vt{constructor(n,s,l){this.pairs=n,this.rowNumber=s,this.wasReversed=l}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(n){return this.checkEqualitity(this,n)}toString(){return"{ "+this.pairs+" }"}equals(n,s){return n instanceof vt?this.checkEqualitity(n,s)&&n.wasReversed===s.wasReversed:!1}checkEqualitity(n,s){if(!n||!s)return;let l;return n.forEach((f,d)=>{s.forEach(g=>{f.getLeftChar().getValue()===g.getLeftChar().getValue()&&f.getRightChar().getValue()===g.getRightChar().getValue()&&f.getFinderPatter().getValue()===g.getFinderPatter().getValue()&&(l=!0)})}),l}}class Se extends dr{constructor(n){super(...arguments),this.pairs=new Array(Se.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=n===!0}decodeRow(n,s,l){this.pairs.length=0,this.startFromEven=!1;try{return Se.constructResult(this.decodeRow2pairs(n,s))}catch(f){this.verbose&&console.log(f)}return this.pairs.length=0,this.startFromEven=!0,Se.constructResult(this.decodeRow2pairs(n,s))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(n,s){let l=!1;for(;!l;)try{this.pairs.push(this.retrieveNextPair(s,this.pairs,n))}catch(d){if(d instanceof ve){if(!this.pairs.length)throw new ve;l=!0}}if(this.checkChecksum())return this.pairs;let f;if(this.rows.length?f=!0:f=!1,this.storeRow(n,!1),f){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new ve}checkRowsBoolean(n){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,n&&(this.rows=this.rows.reverse());let s=null;try{s=this.checkRows(new Array,0)}catch(l){this.verbose&&console.log(l)}return n&&(this.rows=this.rows.reverse()),s}checkRows(n,s){for(let l=s;l<this.rows.length;l++){let f=this.rows[l];this.pairs.length=0;for(let g of n)this.pairs.push(g.getPairs());if(this.pairs.push(f.getPairs()),!Se.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(n);d.push(f);try{return this.checkRows(d,l+1)}catch(g){this.verbose&&console.log(g)}}throw new ve}static isValidSequence(n){for(let s of Se.FINDER_PATTERN_SEQUENCES){if(n.length>s.length)continue;let l=!0;for(let f=0;f<n.length;f++)if(n[f].getFinderPattern().getValue()!=s[f]){l=!1;break}if(l)return!0}return!1}storeRow(n,s){let l=0,f=!1,d=!1;for(;l<this.rows.length;){let g=this.rows[l];if(g.getRowNumber()>n){d=g.isEquivalent(this.pairs);break}f=g.isEquivalent(this.pairs),l++}d||f||Se.isPartialRow(this.pairs,this.rows)||(this.rows.push(l,new vt(this.pairs,n,s)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(n,s){for(let l of s)if(l.getPairs().length!==n.length){for(let f of l.getPairs())for(let d of n)if(St.equals(f,d))break}}static isPartialRow(n,s){for(let l of s){let f=!0;for(let d of n){let g=!1;for(let w of l.getPairs())if(d.equals(w)){g=!0;break}if(!g){f=!1;break}}if(f)return!0}return!1}getRows(){return this.rows}static constructResult(n){let s=Dr.buildBitArray(n),f=Zt(s).parseInformation(),d=n[0].getFinderPattern().getResultPoints(),g=n[n.length-1].getFinderPattern().getResultPoints(),w=[d[0],d[1],g[0],g[1]];return new Le(f,null,null,w,Me.RSS_EXPANDED,null)}checkChecksum(){let n=this.pairs.get(0),s=n.getLeftChar(),l=n.getRightChar();if(l==null)return!1;let f=l.getChecksumPortion(),d=2;for(let w=1;w<this.pairs.size();++w){let E=this.pairs.get(w);f+=E.getLeftChar().getChecksumPortion(),d++;let O=E.getRightChar();O!=null&&(f+=O.getChecksumPortion(),d++)}return f%=211,211*(d-4)+f==s.getValue()}static getNextSecondBar(n,s){let l;return n.get(s)?(l=n.getNextUnset(s),l=n.getNextSet(l)):(l=n.getNextSet(s),l=n.getNextUnset(l)),l}retrieveNextPair(n,s,l){let f=s.length%2==0;this.startFromEven&&(f=!f);let d,g=!0,w=-1;do this.findNextPair(n,s,w),d=this.parseFoundFinderPattern(n,l,f),d==null?w=Se.getNextSecondBar(n,this.startEnd[0]):g=!1;while(g);let E=this.decodeDataCharacter(n,d,f,!0);if(!this.isEmptyPair(s)&&s[s.length-1].mustBeLast())throw new ve;let O;try{O=this.decodeDataCharacter(n,d,f,!1)}catch(L){O=null,this.verbose&&console.log(L)}return new St(E,O,d,!0)}isEmptyPair(n){return n.length===0}findNextPair(n,s,l){let f=this.getDecodeFinderCounters();f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=n.getSize(),g;l>=0?g=l:this.isEmptyPair(s)?g=0:g=s[s.length-1].getFinderPattern().getStartEnd()[1];let w=s.length%2!=0;this.startFromEven&&(w=!w);let E=!1;for(;g<d&&(E=!n.get(g),!!E);)g++;let O=0,L=g;for(let V=g;V<d;V++)if(n.get(V)!=E)f[O]++;else{if(O==3){if(w&&Se.reverseCounters(f),Se.isFinderPattern(f)){this.startEnd[0]=L,this.startEnd[1]=V;return}w&&Se.reverseCounters(f),L+=f[0]+f[1],f[0]=f[2],f[1]=f[3],f[2]=0,f[3]=0,O--}else O++;f[O]=1,E=!E}throw new ve}static reverseCounters(n){let s=n.length;for(let l=0;l<s/2;++l){let f=n[l];n[l]=n[s-l-1],n[s-l-1]=f}}parseFoundFinderPattern(n,s,l){let f,d,g;if(l){let O=this.startEnd[0]-1;for(;O>=0&&!n.get(O);)O--;O++,f=this.startEnd[0]-O,d=O,g=this.startEnd[1]}else d=this.startEnd[0],g=n.getNextUnset(this.startEnd[1]+1),f=g-this.startEnd[1];let w=this.getDecodeFinderCounters();z.arraycopy(w,0,w,1,w.length-1),w[0]=f;let E;try{E=this.parseFinderValue(w,Se.FINDER_PATTERNS)}catch{return null}return new ei(E,[d,g],d,g,s)}decodeDataCharacter(n,s,l,f){let d=this.getDataCharacterCounters();for(let q=0;q<d.length;q++)d[q]=0;if(f)Se.recordPatternInReverse(n,s.getStartEnd()[0],d);else{Se.recordPattern(n,s.getStartEnd()[1],d);for(let q=0,Z=d.length-1;q<Z;q++,Z--){let se=d[q];d[q]=d[Z],d[Z]=se}}let g=17,w=Qt.sum(new Int32Array(d))/g,E=(s.getStartEnd()[1]-s.getStartEnd()[0])/15;if(Math.abs(w-E)/E>.3)throw new ve;let O=this.getOddCounts(),L=this.getEvenCounts(),V=this.getOddRoundingErrors(),Y=this.getEvenRoundingErrors();for(let q=0;q<d.length;q++){let Z=1*d[q]/w,se=Z+.5;if(se<1){if(Z<.3)throw new ve;se=1}else if(se>8){if(Z>8.7)throw new ve;se=8}let de=q/2;(q&1)==0?(O[de]=se,V[de]=Z-se):(L[de]=se,Y[de]=Z-se)}this.adjustOddEvenCounts(g);let ae=4*s.getValue()+(l?0:2)+(f?0:1)-1,ge=0,we=0;for(let q=O.length-1;q>=0;q--){if(Se.isNotA1left(s,l,f)){let Z=Se.WEIGHTS[ae][2*q];we+=O[q]*Z}ge+=O[q]}let Oe=0;for(let q=L.length-1;q>=0;q--)if(Se.isNotA1left(s,l,f)){let Z=Se.WEIGHTS[ae][2*q+1];Oe+=L[q]*Z}let Ue=we+Oe;if((ge&1)!=0||ge>13||ge<4)throw new ve;let pt=(13-ge)/2,dt=Se.SYMBOL_WIDEST[pt],v=9-dt,I=ti.getRSSvalue(O,dt,!0),b=ti.getRSSvalue(L,v,!1),A=Se.EVEN_TOTAL_SUBSET[pt],D=Se.GSUM[pt],$=I*A+b+D;return new qr($,Ue)}static isNotA1left(n,s,l){return!(n.getValue()==0&&s&&l)}adjustOddEvenCounts(n){let s=Qt.sum(new Int32Array(this.getOddCounts())),l=Qt.sum(new Int32Array(this.getEvenCounts())),f=!1,d=!1;s>13?d=!0:s<4&&(f=!0);let g=!1,w=!1;l>13?w=!0:l<4&&(g=!0);let E=s+l-n,O=(s&1)==1,L=(l&1)==0;if(E==1)if(O){if(L)throw new ve;d=!0}else{if(!L)throw new ve;w=!0}else if(E==-1)if(O){if(L)throw new ve;f=!0}else{if(!L)throw new ve;g=!0}else if(E==0){if(O){if(!L)throw new ve;s<l?(f=!0,w=!0):(d=!0,g=!0)}else if(L)throw new ve}else throw new ve;if(f){if(d)throw new ve;Se.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Se.decrement(this.getOddCounts(),this.getOddRoundingErrors()),g){if(w)throw new ve;Se.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&Se.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Se.SYMBOL_WIDEST=[7,5,4,3,1],Se.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Se.GSUM=[0,348,1388,2948,3988],Se.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Se.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Se.FINDER_PAT_A=0,Se.FINDER_PAT_B=1,Se.FINDER_PAT_C=2,Se.FINDER_PAT_D=3,Se.FINDER_PAT_E=4,Se.FINDER_PAT_F=5,Se.FINDER_PATTERN_SEQUENCES=[[Se.FINDER_PAT_A,Se.FINDER_PAT_A],[Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B],[Se.FINDER_PAT_A,Se.FINDER_PAT_C,Se.FINDER_PAT_B,Se.FINDER_PAT_D],[Se.FINDER_PAT_A,Se.FINDER_PAT_E,Se.FINDER_PAT_B,Se.FINDER_PAT_D,Se.FINDER_PAT_C],[Se.FINDER_PAT_A,Se.FINDER_PAT_E,Se.FINDER_PAT_B,Se.FINDER_PAT_D,Se.FINDER_PAT_D,Se.FINDER_PAT_F],[Se.FINDER_PAT_A,Se.FINDER_PAT_E,Se.FINDER_PAT_B,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_F,Se.FINDER_PAT_F],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_D],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_E],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_F,Se.FINDER_PAT_F],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_E,Se.FINDER_PAT_F,Se.FINDER_PAT_F]],Se.MAX_PAIRS=11;class Vt extends qr{constructor(n,s,l){super(n,s),this.count=0,this.finderPattern=l}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class ct extends dr{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(n,s,l){const f=this.decodePair(s,!1,n,l);ct.addOrTally(this.possibleLeftPairs,f),s.reverse();let d=this.decodePair(s,!0,n,l);ct.addOrTally(this.possibleRightPairs,d),s.reverse();for(let g of this.possibleLeftPairs)if(g.getCount()>1){for(let w of this.possibleRightPairs)if(w.getCount()>1&&ct.checkChecksum(g,w))return ct.constructResult(g,w)}throw new ve}static addOrTally(n,s){if(s==null)return;let l=!1;for(let f of n)if(f.getValue()===s.getValue()){f.incrementCount(),l=!0;break}l||n.push(s)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(n,s){let l=4537077*n.getValue()+s.getValue(),f=new String(l).toString(),d=new at;for(let O=13-f.length;O>0;O--)d.append("0");d.append(f);let g=0;for(let O=0;O<13;O++){let L=d.charAt(O).charCodeAt(0)-48;g+=(O&1)===0?3*L:L}g=10-g%10,g===10&&(g=0),d.append(g.toString());let w=n.getFinderPattern().getResultPoints(),E=s.getFinderPattern().getResultPoints();return new Le(d.toString(),null,0,[w[0],w[1],E[0],E[1]],Me.RSS_14,new Date().getTime())}static checkChecksum(n,s){let l=(n.getChecksumPortion()+16*s.getChecksumPortion())%79,f=9*n.getFinderPattern().getValue()+s.getFinderPattern().getValue();return f>72&&f--,f>8&&f--,l===f}decodePair(n,s,l,f){try{let d=this.findFinderPattern(n,s),g=this.parseFoundFinderPattern(n,l,s,d),w=f==null?null:f.get(ue.NEED_RESULT_POINT_CALLBACK);if(w!=null){let L=(d[0]+d[1])/2;s&&(L=n.getSize()-1-L),w.foundPossibleResultPoint(new wt(L,l))}let E=this.decodeDataCharacter(n,g,!0),O=this.decodeDataCharacter(n,g,!1);return new Vt(1597*E.getValue()+O.getValue(),E.getChecksumPortion()+4*O.getChecksumPortion(),g)}catch{return null}}decodeDataCharacter(n,s,l){let f=this.getDataCharacterCounters();for(let Oe=0;Oe<f.length;Oe++)f[Oe]=0;if(l)an.recordPatternInReverse(n,s.getStartEnd()[0],f);else{an.recordPattern(n,s.getStartEnd()[1]+1,f);for(let Oe=0,Ue=f.length-1;Oe<Ue;Oe++,Ue--){let pt=f[Oe];f[Oe]=f[Ue],f[Ue]=pt}}let d=l?16:15,g=Qt.sum(new Int32Array(f))/d,w=this.getOddCounts(),E=this.getEvenCounts(),O=this.getOddRoundingErrors(),L=this.getEvenRoundingErrors();for(let Oe=0;Oe<f.length;Oe++){let Ue=f[Oe]/g,pt=Math.floor(Ue+.5);pt<1?pt=1:pt>8&&(pt=8);let dt=Math.floor(Oe/2);(Oe&1)===0?(w[dt]=pt,O[dt]=Ue-pt):(E[dt]=pt,L[dt]=Ue-pt)}this.adjustOddEvenCounts(l,d);let V=0,Y=0;for(let Oe=w.length-1;Oe>=0;Oe--)Y*=9,Y+=w[Oe],V+=w[Oe];let ae=0,ge=0;for(let Oe=E.length-1;Oe>=0;Oe--)ae*=9,ae+=E[Oe],ge+=E[Oe];let we=Y+3*ae;if(l){if((V&1)!==0||V>12||V<4)throw new ve;let Oe=(12-V)/2,Ue=ct.OUTSIDE_ODD_WIDEST[Oe],pt=9-Ue,dt=ti.getRSSvalue(w,Ue,!1),v=ti.getRSSvalue(E,pt,!0),I=ct.OUTSIDE_EVEN_TOTAL_SUBSET[Oe],b=ct.OUTSIDE_GSUM[Oe];return new qr(dt*I+v+b,we)}else{if((ge&1)!==0||ge>10||ge<4)throw new ve;let Oe=(10-ge)/2,Ue=ct.INSIDE_ODD_WIDEST[Oe],pt=9-Ue,dt=ti.getRSSvalue(w,Ue,!0),v=ti.getRSSvalue(E,pt,!1),I=ct.INSIDE_ODD_TOTAL_SUBSET[Oe],b=ct.INSIDE_GSUM[Oe];return new qr(v*I+dt+b,we)}}findFinderPattern(n,s){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=n.getSize(),d=!1,g=0;for(;g<f&&(d=!n.get(g),s!==d);)g++;let w=0,E=g;for(let O=g;O<f;O++)if(n.get(O)!==d)l[w]++;else{if(w===3){if(dr.isFinderPattern(l))return[E,O];E+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,w--}else w++;l[w]=1,d=!d}throw new ve}parseFoundFinderPattern(n,s,l,f){let d=n.get(f[0]),g=f[0]-1;for(;g>=0&&d!==n.get(g);)g--;g++;const w=f[0]-g,E=this.getDecodeFinderCounters(),O=new Int32Array(E.length);z.arraycopy(E,0,O,1,E.length-1),O[0]=w;const L=this.parseFinderValue(O,ct.FINDER_PATTERNS);let V=g,Y=f[1];return l&&(V=n.getSize()-1-V,Y=n.getSize()-1-Y),new ei(L,[g,f[1]],V,Y,s)}adjustOddEvenCounts(n,s){let l=Qt.sum(new Int32Array(this.getOddCounts())),f=Qt.sum(new Int32Array(this.getEvenCounts())),d=!1,g=!1,w=!1,E=!1;n?(l>12?g=!0:l<4&&(d=!0),f>12?E=!0:f<4&&(w=!0)):(l>11?g=!0:l<5&&(d=!0),f>10?E=!0:f<4&&(w=!0));let O=l+f-s,L=(l&1)===(n?1:0),V=(f&1)===1;if(O===1)if(L){if(V)throw new ve;g=!0}else{if(!V)throw new ve;E=!0}else if(O===-1)if(L){if(V)throw new ve;d=!0}else{if(!V)throw new ve;w=!0}else if(O===0){if(L){if(!V)throw new ve;l<f?(d=!0,E=!0):(g=!0,w=!0)}else if(V)throw new ve}else throw new ve;if(d){if(g)throw new ve;dr.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&dr.decrement(this.getOddCounts(),this.getOddRoundingErrors()),w){if(E)throw new ve;dr.increment(this.getEvenCounts(),this.getOddRoundingErrors())}E&&dr.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ct.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],ct.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],ct.OUTSIDE_GSUM=[0,161,961,2015,2715],ct.INSIDE_GSUM=[0,336,1036,1516],ct.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],ct.INSIDE_ODD_WIDEST=[2,4,6,8],ct.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class _t extends an{constructor(n,s){super(),this.readers=[],this.verbose=s===!0;const l=n?n.get(ue.POSSIBLE_FORMATS):null,f=n&&n.get(ue.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;l?((l.includes(Me.EAN_13)||l.includes(Me.UPC_A)||l.includes(Me.EAN_8)||l.includes(Me.UPC_E))&&this.readers.push(new hi(n)),l.includes(Me.CODE_39)&&this.readers.push(new xn(f)),l.includes(Me.CODE_128)&&this.readers.push(new tt),l.includes(Me.ITF)&&this.readers.push(new Xt),l.includes(Me.RSS_14)&&this.readers.push(new ct),l.includes(Me.RSS_EXPANDED)&&this.readers.push(new Se(this.verbose))):(this.readers.push(new hi(n)),this.readers.push(new xn),this.readers.push(new hi(n)),this.readers.push(new tt),this.readers.push(new Xt),this.readers.push(new ct),this.readers.push(new Se(this.verbose)))}decodeRow(n,s,l){for(let f=0;f<this.readers.length;f++)try{return this.readers[f].decodeRow(n,s,l)}catch{}throw new ve}reset(){this.readers.forEach(n=>n.reset())}}class Ot extends De{constructor(n=500,s){super(new _t(s),n,s)}}class st{constructor(n,s,l){this.ecCodewords=n,this.ecBlocks=[s],l&&this.ecBlocks.push(l)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ie{constructor(n,s){this.count=n,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ye{constructor(n,s,l,f,d,g){this.versionNumber=n,this.symbolSizeRows=s,this.symbolSizeColumns=l,this.dataRegionSizeRows=f,this.dataRegionSizeColumns=d,this.ecBlocks=g;let w=0;const E=g.getECCodewords(),O=g.getECBlocks();for(let L of O)w+=L.getCount()*(L.getDataCodewords()+E);this.totalCodewords=w}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(n,s){if((n&1)!==0||(s&1)!==0)throw new ee;for(let l of ye.VERSIONS)if(l.symbolSizeRows===n&&l.symbolSizeColumns===s)return l;throw new ee}toString(){return""+this.versionNumber}static buildVersions(){return[new ye(1,10,10,8,8,new st(5,new Ie(1,3))),new ye(2,12,12,10,10,new st(7,new Ie(1,5))),new ye(3,14,14,12,12,new st(10,new Ie(1,8))),new ye(4,16,16,14,14,new st(12,new Ie(1,12))),new ye(5,18,18,16,16,new st(14,new Ie(1,18))),new ye(6,20,20,18,18,new st(18,new Ie(1,22))),new ye(7,22,22,20,20,new st(20,new Ie(1,30))),new ye(8,24,24,22,22,new st(24,new Ie(1,36))),new ye(9,26,26,24,24,new st(28,new Ie(1,44))),new ye(10,32,32,14,14,new st(36,new Ie(1,62))),new ye(11,36,36,16,16,new st(42,new Ie(1,86))),new ye(12,40,40,18,18,new st(48,new Ie(1,114))),new ye(13,44,44,20,20,new st(56,new Ie(1,144))),new ye(14,48,48,22,22,new st(68,new Ie(1,174))),new ye(15,52,52,24,24,new st(42,new Ie(2,102))),new ye(16,64,64,14,14,new st(56,new Ie(2,140))),new ye(17,72,72,16,16,new st(36,new Ie(4,92))),new ye(18,80,80,18,18,new st(48,new Ie(4,114))),new ye(19,88,88,20,20,new st(56,new Ie(4,144))),new ye(20,96,96,22,22,new st(68,new Ie(4,174))),new ye(21,104,104,24,24,new st(56,new Ie(6,136))),new ye(22,120,120,18,18,new st(68,new Ie(6,175))),new ye(23,132,132,20,20,new st(62,new Ie(8,163))),new ye(24,144,144,22,22,new st(62,new Ie(8,156),new Ie(2,155))),new ye(25,8,18,6,16,new st(7,new Ie(1,5))),new ye(26,8,32,6,14,new st(11,new Ie(1,10))),new ye(27,12,26,10,24,new st(14,new Ie(1,16))),new ye(28,12,36,10,16,new st(18,new Ie(1,22))),new ye(29,16,36,14,16,new st(24,new Ie(1,32))),new ye(30,16,48,14,22,new st(28,new Ie(1,49)))]}}ye.VERSIONS=ye.buildVersions();class rt{constructor(n){const s=n.getHeight();if(s<8||s>144||(s&1)!==0)throw new ee;this.version=rt.readVersion(n),this.mappingBitMatrix=this.extractDataRegion(n),this.readMappingMatrix=new et(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(n){const s=n.getHeight(),l=n.getWidth();return ye.getVersionForDimensions(s,l)}readCodewords(){const n=new Int8Array(this.version.getTotalCodewords());let s=0,l=4,f=0;const d=this.mappingBitMatrix.getHeight(),g=this.mappingBitMatrix.getWidth();let w=!1,E=!1,O=!1,L=!1;do if(l===d&&f===0&&!w)n[s++]=this.readCorner1(d,g)&255,l-=2,f+=2,w=!0;else if(l===d-2&&f===0&&(g&3)!==0&&!E)n[s++]=this.readCorner2(d,g)&255,l-=2,f+=2,E=!0;else if(l===d+4&&f===2&&(g&7)===0&&!O)n[s++]=this.readCorner3(d,g)&255,l-=2,f+=2,O=!0;else if(l===d-2&&f===0&&(g&7)===4&&!L)n[s++]=this.readCorner4(d,g)&255,l-=2,f+=2,L=!0;else{do l<d&&f>=0&&!this.readMappingMatrix.get(f,l)&&(n[s++]=this.readUtah(l,f,d,g)&255),l-=2,f+=2;while(l>=0&&f<g);l+=1,f+=3;do l>=0&&f<g&&!this.readMappingMatrix.get(f,l)&&(n[s++]=this.readUtah(l,f,d,g)&255),l+=2,f-=2;while(l<d&&f>=0);l+=3,f+=1}while(l<d||f<g);if(s!==this.version.getTotalCodewords())throw new ee;return n}readModule(n,s,l,f){return n<0&&(n+=l,s+=4-(l+4&7)),s<0&&(s+=f,n+=4-(f+4&7)),this.readMappingMatrix.set(s,n),this.mappingBitMatrix.get(s,n)}readUtah(n,s,l,f){let d=0;return this.readModule(n-2,s-2,l,f)&&(d|=1),d<<=1,this.readModule(n-2,s-1,l,f)&&(d|=1),d<<=1,this.readModule(n-1,s-2,l,f)&&(d|=1),d<<=1,this.readModule(n-1,s-1,l,f)&&(d|=1),d<<=1,this.readModule(n-1,s,l,f)&&(d|=1),d<<=1,this.readModule(n,s-2,l,f)&&(d|=1),d<<=1,this.readModule(n,s-1,l,f)&&(d|=1),d<<=1,this.readModule(n,s,l,f)&&(d|=1),d}readCorner1(n,s){let l=0;return this.readModule(n-1,0,n,s)&&(l|=1),l<<=1,this.readModule(n-1,1,n,s)&&(l|=1),l<<=1,this.readModule(n-1,2,n,s)&&(l|=1),l<<=1,this.readModule(0,s-2,n,s)&&(l|=1),l<<=1,this.readModule(0,s-1,n,s)&&(l|=1),l<<=1,this.readModule(1,s-1,n,s)&&(l|=1),l<<=1,this.readModule(2,s-1,n,s)&&(l|=1),l<<=1,this.readModule(3,s-1,n,s)&&(l|=1),l}readCorner2(n,s){let l=0;return this.readModule(n-3,0,n,s)&&(l|=1),l<<=1,this.readModule(n-2,0,n,s)&&(l|=1),l<<=1,this.readModule(n-1,0,n,s)&&(l|=1),l<<=1,this.readModule(0,s-4,n,s)&&(l|=1),l<<=1,this.readModule(0,s-3,n,s)&&(l|=1),l<<=1,this.readModule(0,s-2,n,s)&&(l|=1),l<<=1,this.readModule(0,s-1,n,s)&&(l|=1),l<<=1,this.readModule(1,s-1,n,s)&&(l|=1),l}readCorner3(n,s){let l=0;return this.readModule(n-1,0,n,s)&&(l|=1),l<<=1,this.readModule(n-1,s-1,n,s)&&(l|=1),l<<=1,this.readModule(0,s-3,n,s)&&(l|=1),l<<=1,this.readModule(0,s-2,n,s)&&(l|=1),l<<=1,this.readModule(0,s-1,n,s)&&(l|=1),l<<=1,this.readModule(1,s-3,n,s)&&(l|=1),l<<=1,this.readModule(1,s-2,n,s)&&(l|=1),l<<=1,this.readModule(1,s-1,n,s)&&(l|=1),l}readCorner4(n,s){let l=0;return this.readModule(n-3,0,n,s)&&(l|=1),l<<=1,this.readModule(n-2,0,n,s)&&(l|=1),l<<=1,this.readModule(n-1,0,n,s)&&(l|=1),l<<=1,this.readModule(0,s-2,n,s)&&(l|=1),l<<=1,this.readModule(0,s-1,n,s)&&(l|=1),l<<=1,this.readModule(1,s-1,n,s)&&(l|=1),l<<=1,this.readModule(2,s-1,n,s)&&(l|=1),l<<=1,this.readModule(3,s-1,n,s)&&(l|=1),l}extractDataRegion(n){const s=this.version.getSymbolSizeRows(),l=this.version.getSymbolSizeColumns();if(n.getHeight()!==s)throw new R("Dimension of bitMatrix must match the version size");const f=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),g=s/f|0,w=l/d|0,E=g*f,O=w*d,L=new et(O,E);for(let V=0;V<g;++V){const Y=V*f;for(let ae=0;ae<w;++ae){const ge=ae*d;for(let we=0;we<f;++we){const Oe=V*(f+2)+1+we,Ue=Y+we;for(let pt=0;pt<d;++pt){const dt=ae*(d+2)+1+pt;if(n.get(dt,Oe)){const v=ge+pt;L.set(v,Ue)}}}}}return L}}class Xe{constructor(n,s){this.numDataCodewords=n,this.codewords=s}static getDataBlocks(n,s){const l=s.getECBlocks();let f=0;const d=l.getECBlocks();for(let we of d)f+=we.getCount();const g=new Array(f);let w=0;for(let we of d)for(let Oe=0;Oe<we.getCount();Oe++){const Ue=we.getDataCodewords(),pt=l.getECCodewords()+Ue;g[w++]=new Xe(Ue,new Uint8Array(pt))}const O=g[0].codewords.length-l.getECCodewords(),L=O-1;let V=0;for(let we=0;we<L;we++)for(let Oe=0;Oe<w;Oe++)g[Oe].codewords[we]=n[V++];const Y=s.getVersionNumber()===24,ae=Y?8:w;for(let we=0;we<ae;we++)g[we].codewords[O-1]=n[V++];const ge=g[0].codewords.length;for(let we=O;we<ge;we++)for(let Oe=0;Oe<w;Oe++){const Ue=Y?(Oe+8)%w:Oe,pt=Y&&Ue>7?we-1:we;g[Ue].codewords[pt]=n[V++]}if(V!==n.length)throw new R;return g}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class He{constructor(n){this.bytes=n,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(n){if(n<1||n>32||n>this.available())throw new R(""+n);let s=0,l=this.bitOffset,f=this.byteOffset;const d=this.bytes;if(l>0){const g=8-l,w=n<g?n:g,E=g-w,O=255>>8-w<<E;s=(d[f]&O)>>E,n-=w,l+=w,l===8&&(l=0,f++)}if(n>0){for(;n>=8;)s=s<<8|d[f]&255,f++,n-=8;if(n>0){const g=8-n,w=255>>g<<g;s=s<<n|(d[f]&w)>>g,l+=n}}return this.bitOffset=l,this.byteOffset=f,s}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var We;(function(G){G[G.PAD_ENCODE=0]="PAD_ENCODE",G[G.ASCII_ENCODE=1]="ASCII_ENCODE",G[G.C40_ENCODE=2]="C40_ENCODE",G[G.TEXT_ENCODE=3]="TEXT_ENCODE",G[G.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",G[G.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",G[G.BASE256_ENCODE=6]="BASE256_ENCODE"})(We||(We={}));class zt{static decode(n){const s=new He(n),l=new at,f=new at,d=new Array;let g=We.ASCII_ENCODE;do if(g===We.ASCII_ENCODE)g=this.decodeAsciiSegment(s,l,f);else{switch(g){case We.C40_ENCODE:this.decodeC40Segment(s,l);break;case We.TEXT_ENCODE:this.decodeTextSegment(s,l);break;case We.ANSIX12_ENCODE:this.decodeAnsiX12Segment(s,l);break;case We.EDIFACT_ENCODE:this.decodeEdifactSegment(s,l);break;case We.BASE256_ENCODE:this.decodeBase256Segment(s,l,d);break;default:throw new ee}g=We.ASCII_ENCODE}while(g!==We.PAD_ENCODE&&s.available()>0);return f.length()>0&&l.append(f.toString()),new It(n,l.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(n,s,l){let f=!1;do{let d=n.readBits(8);if(d===0)throw new ee;if(d<=128)return f&&(d+=128),s.append(String.fromCharCode(d-1)),We.ASCII_ENCODE;if(d===129)return We.PAD_ENCODE;if(d<=229){const g=d-130;g<10&&s.append("0"),s.append(""+g)}else switch(d){case 230:return We.C40_ENCODE;case 231:return We.BASE256_ENCODE;case 232:s.append("");break;case 233:case 234:break;case 235:f=!0;break;case 236:s.append("[)>05"),l.insert(0,"");break;case 237:s.append("[)>06"),l.insert(0,"");break;case 238:return We.ANSIX12_ENCODE;case 239:return We.TEXT_ENCODE;case 240:return We.EDIFACT_ENCODE;case 241:break;default:if(d!==254||n.available()!==0)throw new ee;break}}while(n.available()>0);return We.ASCII_ENCODE}static decodeC40Segment(n,s){let l=!1;const f=[];let d=0;do{if(n.available()===8)return;const g=n.readBits(8);if(g===254)return;this.parseTwoBytes(g,n.readBits(8),f);for(let w=0;w<3;w++){const E=f[w];switch(d){case 0:if(E<3)d=E+1;else if(E<this.C40_BASIC_SET_CHARS.length){const O=this.C40_BASIC_SET_CHARS[E];l?(s.append(String.fromCharCode(O.charCodeAt(0)+128)),l=!1):s.append(O)}else throw new ee;break;case 1:l?(s.append(String.fromCharCode(E+128)),l=!1):s.append(String.fromCharCode(E)),d=0;break;case 2:if(E<this.C40_SHIFT2_SET_CHARS.length){const O=this.C40_SHIFT2_SET_CHARS[E];l?(s.append(String.fromCharCode(O.charCodeAt(0)+128)),l=!1):s.append(O)}else switch(E){case 27:s.append("");break;case 30:l=!0;break;default:throw new ee}d=0;break;case 3:l?(s.append(String.fromCharCode(E+224)),l=!1):s.append(String.fromCharCode(E+96)),d=0;break;default:throw new ee}}}while(n.available()>0)}static decodeTextSegment(n,s){let l=!1,f=[],d=0;do{if(n.available()===8)return;const g=n.readBits(8);if(g===254)return;this.parseTwoBytes(g,n.readBits(8),f);for(let w=0;w<3;w++){const E=f[w];switch(d){case 0:if(E<3)d=E+1;else if(E<this.TEXT_BASIC_SET_CHARS.length){const O=this.TEXT_BASIC_SET_CHARS[E];l?(s.append(String.fromCharCode(O.charCodeAt(0)+128)),l=!1):s.append(O)}else throw new ee;break;case 1:l?(s.append(String.fromCharCode(E+128)),l=!1):s.append(String.fromCharCode(E)),d=0;break;case 2:if(E<this.TEXT_SHIFT2_SET_CHARS.length){const O=this.TEXT_SHIFT2_SET_CHARS[E];l?(s.append(String.fromCharCode(O.charCodeAt(0)+128)),l=!1):s.append(O)}else switch(E){case 27:s.append("");break;case 30:l=!0;break;default:throw new ee}d=0;break;case 3:if(E<this.TEXT_SHIFT3_SET_CHARS.length){const O=this.TEXT_SHIFT3_SET_CHARS[E];l?(s.append(String.fromCharCode(O.charCodeAt(0)+128)),l=!1):s.append(O),d=0}else throw new ee;break;default:throw new ee}}}while(n.available()>0)}static decodeAnsiX12Segment(n,s){const l=[];do{if(n.available()===8)return;const f=n.readBits(8);if(f===254)return;this.parseTwoBytes(f,n.readBits(8),l);for(let d=0;d<3;d++){const g=l[d];switch(g){case 0:s.append("\r");break;case 1:s.append("*");break;case 2:s.append(">");break;case 3:s.append(" ");break;default:if(g<14)s.append(String.fromCharCode(g+44));else if(g<40)s.append(String.fromCharCode(g+51));else throw new ee;break}}}while(n.available()>0)}static parseTwoBytes(n,s,l){let f=(n<<8)+s-1,d=Math.floor(f/1600);l[0]=d,f-=d*1600,d=Math.floor(f/40),l[1]=d,l[2]=f-d*40}static decodeEdifactSegment(n,s){do{if(n.available()<=16)return;for(let l=0;l<4;l++){let f=n.readBits(6);if(f===31){const d=8-n.getBitOffset();d!==8&&n.readBits(d);return}(f&32)===0&&(f|=64),s.append(String.fromCharCode(f))}}while(n.available()>0)}static decodeBase256Segment(n,s,l){let f=1+n.getByteOffset();const d=this.unrandomize255State(n.readBits(8),f++);let g;if(d===0?g=n.available()/8|0:d<250?g=d:g=250*(d-249)+this.unrandomize255State(n.readBits(8),f++),g<0)throw new ee;const w=new Uint8Array(g);for(let E=0;E<g;E++){if(n.available()<8)throw new ee;w[E]=this.unrandomize255State(n.readBits(8),f++)}l.push(w);try{s.append(Je.decode(w,ke.ISO88591))}catch(E){throw new Zn("Platform does not support required encoding: "+E.message)}}static unrandomize255State(n,s){const l=149*s%255+1,f=n-l;return f>=0?f:f+256}}zt.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],zt.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],zt.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],zt.TEXT_SHIFT2_SET_CHARS=zt.C40_SHIFT2_SET_CHARS,zt.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class hn{constructor(){this.rsDecoder=new _n(qt.DATA_MATRIX_FIELD_256)}decode(n){const s=new rt(n),l=s.getVersion(),f=s.readCodewords(),d=Xe.getDataBlocks(f,l);let g=0;for(let O of d)g+=O.getNumDataCodewords();const w=new Uint8Array(g),E=d.length;for(let O=0;O<E;O++){const L=d[O],V=L.getCodewords(),Y=L.getNumDataCodewords();this.correctErrors(V,Y);for(let ae=0;ae<Y;ae++)w[ae*E+O]=V[ae]}return zt.decode(w)}correctErrors(n,s){const l=new Int32Array(n);try{this.rsDecoder.decode(l,n.length-s)}catch{throw new N}for(let f=0;f<s;f++)n[f]=l[f]}}class $t{constructor(n){this.image=n,this.rectangleDetector=new kn(this.image)}detect(){const n=this.rectangleDetector.detect();let s=this.detectSolid1(n);if(s=this.detectSolid2(s),s[3]=this.correctTopRight(s),!s[3])throw new ve;s=this.shiftToModuleCenter(s);const l=s[0],f=s[1],d=s[2],g=s[3];let w=this.transitionsBetween(l,g)+1,E=this.transitionsBetween(d,g)+1;(w&1)===1&&(w+=1),(E&1)===1&&(E+=1),4*w<7*E&&4*E<7*w&&(w=E=Math.max(w,E));let O=$t.sampleGrid(this.image,l,f,d,g,w,E);return new Er(O,[l,f,d,g])}static shiftPoint(n,s,l){let f=(s.getX()-n.getX())/(l+1),d=(s.getY()-n.getY())/(l+1);return new wt(n.getX()+f,n.getY()+d)}static moveAway(n,s,l){let f=n.getX(),d=n.getY();return f<s?f-=1:f+=1,d<l?d-=1:d+=1,new wt(f,d)}detectSolid1(n){let s=n[0],l=n[1],f=n[3],d=n[2],g=this.transitionsBetween(s,l),w=this.transitionsBetween(l,f),E=this.transitionsBetween(f,d),O=this.transitionsBetween(d,s),L=g,V=[d,s,l,f];return L>w&&(L=w,V[0]=s,V[1]=l,V[2]=f,V[3]=d),L>E&&(L=E,V[0]=l,V[1]=f,V[2]=d,V[3]=s),L>O&&(V[0]=f,V[1]=d,V[2]=s,V[3]=l),V}detectSolid2(n){let s=n[0],l=n[1],f=n[2],d=n[3],g=this.transitionsBetween(s,d),w=$t.shiftPoint(l,f,(g+1)*4),E=$t.shiftPoint(f,l,(g+1)*4),O=this.transitionsBetween(w,s),L=this.transitionsBetween(E,d);return O<L?(n[0]=s,n[1]=l,n[2]=f,n[3]=d):(n[0]=l,n[1]=f,n[2]=d,n[3]=s),n}correctTopRight(n){let s=n[0],l=n[1],f=n[2],d=n[3],g=this.transitionsBetween(s,d),w=this.transitionsBetween(l,d),E=$t.shiftPoint(s,l,(w+1)*4),O=$t.shiftPoint(f,l,(g+1)*4);g=this.transitionsBetween(E,d),w=this.transitionsBetween(O,d);let L=new wt(d.getX()+(f.getX()-l.getX())/(g+1),d.getY()+(f.getY()-l.getY())/(g+1)),V=new wt(d.getX()+(s.getX()-l.getX())/(w+1),d.getY()+(s.getY()-l.getY())/(w+1));if(!this.isValid(L))return this.isValid(V)?V:null;if(!this.isValid(V))return L;let Y=this.transitionsBetween(E,L)+this.transitionsBetween(O,L),ae=this.transitionsBetween(E,V)+this.transitionsBetween(O,V);return Y>ae?L:V}shiftToModuleCenter(n){let s=n[0],l=n[1],f=n[2],d=n[3],g=this.transitionsBetween(s,d)+1,w=this.transitionsBetween(f,d)+1,E=$t.shiftPoint(s,l,w*4),O=$t.shiftPoint(f,l,g*4);g=this.transitionsBetween(E,d)+1,w=this.transitionsBetween(O,d)+1,(g&1)===1&&(g+=1),(w&1)===1&&(w+=1);let L=(s.getX()+l.getX()+f.getX()+d.getX())/4,V=(s.getY()+l.getY()+f.getY()+d.getY())/4;s=$t.moveAway(s,L,V),l=$t.moveAway(l,L,V),f=$t.moveAway(f,L,V),d=$t.moveAway(d,L,V);let Y,ae;return E=$t.shiftPoint(s,l,w*4),E=$t.shiftPoint(E,d,g*4),Y=$t.shiftPoint(l,s,w*4),Y=$t.shiftPoint(Y,f,g*4),O=$t.shiftPoint(f,d,w*4),O=$t.shiftPoint(O,l,g*4),ae=$t.shiftPoint(d,f,w*4),ae=$t.shiftPoint(ae,s,g*4),[E,Y,O,ae]}isValid(n){return n.getX()>=0&&n.getX()<this.image.getWidth()&&n.getY()>0&&n.getY()<this.image.getHeight()}static sampleGrid(n,s,l,f,d,g,w){return vr.getInstance().sampleGrid(n,g,w,.5,.5,g-.5,.5,g-.5,w-.5,.5,w-.5,s.getX(),s.getY(),d.getX(),d.getY(),f.getX(),f.getY(),l.getX(),l.getY())}transitionsBetween(n,s){let l=Math.trunc(n.getX()),f=Math.trunc(n.getY()),d=Math.trunc(s.getX()),g=Math.trunc(s.getY()),w=Math.abs(g-f)>Math.abs(d-l);if(w){let we=l;l=f,f=we,we=d,d=g,g=we}let E=Math.abs(d-l),O=Math.abs(g-f),L=-E/2,V=f<g?1:-1,Y=l<d?1:-1,ae=0,ge=this.image.get(w?f:l,w?l:f);for(let we=l,Oe=f;we!==d;we+=Y){let Ue=this.image.get(w?Oe:we,w?we:Oe);if(Ue!==ge&&(ae++,ge=Ue),L+=O,L>0){if(Oe===g)break;Oe+=V,L-=E}}return ae}}class en{constructor(){this.decoder=new hn}decode(n,s=null){let l,f;if(s!=null&&s.has(ue.PURE_BARCODE)){const O=en.extractPureBits(n.getBlackMatrix());l=this.decoder.decode(O),f=en.NO_POINTS}else{const O=new $t(n.getBlackMatrix()).detect();l=this.decoder.decode(O.getBits()),f=O.getPoints()}const d=l.getRawBytes(),g=new Le(l.getText(),d,8*d.length,f,Me.DATA_MATRIX,z.currentTimeMillis()),w=l.getByteSegments();w!=null&&g.putMetadata(At.BYTE_SEGMENTS,w);const E=l.getECLevel();return E!=null&&g.putMetadata(At.ERROR_CORRECTION_LEVEL,E),g}reset(){}static extractPureBits(n){const s=n.getTopLeftOnBit(),l=n.getBottomRightOnBit();if(s==null||l==null)throw new ve;const f=this.moduleSize(s,n);let d=s[1];const g=l[1];let w=s[0];const O=(l[0]-w+1)/f,L=(g-d+1)/f;if(O<=0||L<=0)throw new ve;const V=f/2;d+=V,w+=V;const Y=new et(O,L);for(let ae=0;ae<L;ae++){const ge=d+ae*f;for(let we=0;we<O;we++)n.get(w+we*f,ge)&&Y.set(we,ae)}return Y}static moduleSize(n,s){const l=s.getWidth();let f=n[0];const d=n[1];for(;f<l&&s.get(f,d);)f++;if(f===l)throw new ve;const g=f-n[0];if(g===0)throw new ve;return g}}en.NO_POINTS=[];class he extends De{constructor(n=500){super(new en,n)}}var un;(function(G){G[G.L=0]="L",G[G.M=1]="M",G[G.Q=2]="Q",G[G.H=3]="H"})(un||(un={}));class Dt{constructor(n,s,l){this.value=n,this.stringValue=s,this.bits=l,Dt.FOR_BITS.set(l,this),Dt.FOR_VALUE.set(n,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(n){switch(n){case"L":return Dt.L;case"M":return Dt.M;case"Q":return Dt.Q;case"H":return Dt.H;default:throw new S(n+"not available")}}toString(){return this.stringValue}equals(n){if(!(n instanceof Dt))return!1;const s=n;return this.value===s.value}static forBits(n){if(n<0||n>=Dt.FOR_BITS.size)throw new R;return Dt.FOR_BITS.get(n)}}Dt.FOR_BITS=new Map,Dt.FOR_VALUE=new Map,Dt.L=new Dt(un.L,"L",1),Dt.M=new Dt(un.M,"M",0),Dt.Q=new Dt(un.Q,"Q",3),Dt.H=new Dt(un.H,"H",2);class nn{constructor(n){this.errorCorrectionLevel=Dt.forBits(n>>3&3),this.dataMask=n&7}static numBitsDiffering(n,s){return te.bitCount(n^s)}static decodeFormatInformation(n,s){const l=nn.doDecodeFormatInformation(n,s);return l!==null?l:nn.doDecodeFormatInformation(n^nn.FORMAT_INFO_MASK_QR,s^nn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(n,s){let l=Number.MAX_SAFE_INTEGER,f=0;for(const d of nn.FORMAT_INFO_DECODE_LOOKUP){const g=d[0];if(g===n||g===s)return new nn(d[1]);let w=nn.numBitsDiffering(n,g);w<l&&(f=d[1],l=w),n!==s&&(w=nn.numBitsDiffering(s,g),w<l&&(f=d[1],l=w))}return l<=3?new nn(f):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(n){if(!(n instanceof nn))return!1;const s=n;return this.errorCorrectionLevel===s.errorCorrectionLevel&&this.dataMask===s.dataMask}}nn.FORMAT_INFO_MASK_QR=21522,nn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class be{constructor(n,...s){this.ecCodewordsPerBlock=n,this.ecBlocks=s}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let n=0;const s=this.ecBlocks;for(const l of s)n+=l.getCount();return n}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class re{constructor(n,s){this.count=n,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ot{constructor(n,s,...l){this.versionNumber=n,this.alignmentPatternCenters=s,this.ecBlocks=l;let f=0;const d=l[0].getECCodewordsPerBlock(),g=l[0].getECBlocks();for(const w of g)f+=w.getCount()*(w.getDataCodewords()+d);this.totalCodewords=f}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(n){return this.ecBlocks[n.getValue()]}static getProvisionalVersionForDimension(n){if(n%4!==1)throw new ee;try{return this.getVersionForNumber((n-17)/4)}catch{throw new ee}}static getVersionForNumber(n){if(n<1||n>40)throw new R;return ot.VERSIONS[n-1]}static decodeVersionInformation(n){let s=Number.MAX_SAFE_INTEGER,l=0;for(let f=0;f<ot.VERSION_DECODE_INFO.length;f++){const d=ot.VERSION_DECODE_INFO[f];if(d===n)return ot.getVersionForNumber(f+7);const g=nn.numBitsDiffering(n,d);g<s&&(l=f+7,s=g)}return s<=3?ot.getVersionForNumber(l):null}buildFunctionPattern(){const n=this.getDimensionForVersion(),s=new et(n);s.setRegion(0,0,9,9),s.setRegion(n-8,0,8,9),s.setRegion(0,n-8,9,8);const l=this.alignmentPatternCenters.length;for(let f=0;f<l;f++){const d=this.alignmentPatternCenters[f]-2;for(let g=0;g<l;g++)f===0&&(g===0||g===l-1)||f===l-1&&g===0||s.setRegion(this.alignmentPatternCenters[g]-2,d,5,5)}return s.setRegion(6,9,1,n-17),s.setRegion(9,6,n-17,1),this.versionNumber>6&&(s.setRegion(n-11,0,3,6),s.setRegion(0,n-11,6,3)),s}toString(){return""+this.versionNumber}}ot.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ot.VERSIONS=[new ot(1,new Int32Array(0),new be(7,new re(1,19)),new be(10,new re(1,16)),new be(13,new re(1,13)),new be(17,new re(1,9))),new ot(2,Int32Array.from([6,18]),new be(10,new re(1,34)),new be(16,new re(1,28)),new be(22,new re(1,22)),new be(28,new re(1,16))),new ot(3,Int32Array.from([6,22]),new be(15,new re(1,55)),new be(26,new re(1,44)),new be(18,new re(2,17)),new be(22,new re(2,13))),new ot(4,Int32Array.from([6,26]),new be(20,new re(1,80)),new be(18,new re(2,32)),new be(26,new re(2,24)),new be(16,new re(4,9))),new ot(5,Int32Array.from([6,30]),new be(26,new re(1,108)),new be(24,new re(2,43)),new be(18,new re(2,15),new re(2,16)),new be(22,new re(2,11),new re(2,12))),new ot(6,Int32Array.from([6,34]),new be(18,new re(2,68)),new be(16,new re(4,27)),new be(24,new re(4,19)),new be(28,new re(4,15))),new ot(7,Int32Array.from([6,22,38]),new be(20,new re(2,78)),new be(18,new re(4,31)),new be(18,new re(2,14),new re(4,15)),new be(26,new re(4,13),new re(1,14))),new ot(8,Int32Array.from([6,24,42]),new be(24,new re(2,97)),new be(22,new re(2,38),new re(2,39)),new be(22,new re(4,18),new re(2,19)),new be(26,new re(4,14),new re(2,15))),new ot(9,Int32Array.from([6,26,46]),new be(30,new re(2,116)),new be(22,new re(3,36),new re(2,37)),new be(20,new re(4,16),new re(4,17)),new be(24,new re(4,12),new re(4,13))),new ot(10,Int32Array.from([6,28,50]),new be(18,new re(2,68),new re(2,69)),new be(26,new re(4,43),new re(1,44)),new be(24,new re(6,19),new re(2,20)),new be(28,new re(6,15),new re(2,16))),new ot(11,Int32Array.from([6,30,54]),new be(20,new re(4,81)),new be(30,new re(1,50),new re(4,51)),new be(28,new re(4,22),new re(4,23)),new be(24,new re(3,12),new re(8,13))),new ot(12,Int32Array.from([6,32,58]),new be(24,new re(2,92),new re(2,93)),new be(22,new re(6,36),new re(2,37)),new be(26,new re(4,20),new re(6,21)),new be(28,new re(7,14),new re(4,15))),new ot(13,Int32Array.from([6,34,62]),new be(26,new re(4,107)),new be(22,new re(8,37),new re(1,38)),new be(24,new re(8,20),new re(4,21)),new be(22,new re(12,11),new re(4,12))),new ot(14,Int32Array.from([6,26,46,66]),new be(30,new re(3,115),new re(1,116)),new be(24,new re(4,40),new re(5,41)),new be(20,new re(11,16),new re(5,17)),new be(24,new re(11,12),new re(5,13))),new ot(15,Int32Array.from([6,26,48,70]),new be(22,new re(5,87),new re(1,88)),new be(24,new re(5,41),new re(5,42)),new be(30,new re(5,24),new re(7,25)),new be(24,new re(11,12),new re(7,13))),new ot(16,Int32Array.from([6,26,50,74]),new be(24,new re(5,98),new re(1,99)),new be(28,new re(7,45),new re(3,46)),new be(24,new re(15,19),new re(2,20)),new be(30,new re(3,15),new re(13,16))),new ot(17,Int32Array.from([6,30,54,78]),new be(28,new re(1,107),new re(5,108)),new be(28,new re(10,46),new re(1,47)),new be(28,new re(1,22),new re(15,23)),new be(28,new re(2,14),new re(17,15))),new ot(18,Int32Array.from([6,30,56,82]),new be(30,new re(5,120),new re(1,121)),new be(26,new re(9,43),new re(4,44)),new be(28,new re(17,22),new re(1,23)),new be(28,new re(2,14),new re(19,15))),new ot(19,Int32Array.from([6,30,58,86]),new be(28,new re(3,113),new re(4,114)),new be(26,new re(3,44),new re(11,45)),new be(26,new re(17,21),new re(4,22)),new be(26,new re(9,13),new re(16,14))),new ot(20,Int32Array.from([6,34,62,90]),new be(28,new re(3,107),new re(5,108)),new be(26,new re(3,41),new re(13,42)),new be(30,new re(15,24),new re(5,25)),new be(28,new re(15,15),new re(10,16))),new ot(21,Int32Array.from([6,28,50,72,94]),new be(28,new re(4,116),new re(4,117)),new be(26,new re(17,42)),new be(28,new re(17,22),new re(6,23)),new be(30,new re(19,16),new re(6,17))),new ot(22,Int32Array.from([6,26,50,74,98]),new be(28,new re(2,111),new re(7,112)),new be(28,new re(17,46)),new be(30,new re(7,24),new re(16,25)),new be(24,new re(34,13))),new ot(23,Int32Array.from([6,30,54,78,102]),new be(30,new re(4,121),new re(5,122)),new be(28,new re(4,47),new re(14,48)),new be(30,new re(11,24),new re(14,25)),new be(30,new re(16,15),new re(14,16))),new ot(24,Int32Array.from([6,28,54,80,106]),new be(30,new re(6,117),new re(4,118)),new be(28,new re(6,45),new re(14,46)),new be(30,new re(11,24),new re(16,25)),new be(30,new re(30,16),new re(2,17))),new ot(25,Int32Array.from([6,32,58,84,110]),new be(26,new re(8,106),new re(4,107)),new be(28,new re(8,47),new re(13,48)),new be(30,new re(7,24),new re(22,25)),new be(30,new re(22,15),new re(13,16))),new ot(26,Int32Array.from([6,30,58,86,114]),new be(28,new re(10,114),new re(2,115)),new be(28,new re(19,46),new re(4,47)),new be(28,new re(28,22),new re(6,23)),new be(30,new re(33,16),new re(4,17))),new ot(27,Int32Array.from([6,34,62,90,118]),new be(30,new re(8,122),new re(4,123)),new be(28,new re(22,45),new re(3,46)),new be(30,new re(8,23),new re(26,24)),new be(30,new re(12,15),new re(28,16))),new ot(28,Int32Array.from([6,26,50,74,98,122]),new be(30,new re(3,117),new re(10,118)),new be(28,new re(3,45),new re(23,46)),new be(30,new re(4,24),new re(31,25)),new be(30,new re(11,15),new re(31,16))),new ot(29,Int32Array.from([6,30,54,78,102,126]),new be(30,new re(7,116),new re(7,117)),new be(28,new re(21,45),new re(7,46)),new be(30,new re(1,23),new re(37,24)),new be(30,new re(19,15),new re(26,16))),new ot(30,Int32Array.from([6,26,52,78,104,130]),new be(30,new re(5,115),new re(10,116)),new be(28,new re(19,47),new re(10,48)),new be(30,new re(15,24),new re(25,25)),new be(30,new re(23,15),new re(25,16))),new ot(31,Int32Array.from([6,30,56,82,108,134]),new be(30,new re(13,115),new re(3,116)),new be(28,new re(2,46),new re(29,47)),new be(30,new re(42,24),new re(1,25)),new be(30,new re(23,15),new re(28,16))),new ot(32,Int32Array.from([6,34,60,86,112,138]),new be(30,new re(17,115)),new be(28,new re(10,46),new re(23,47)),new be(30,new re(10,24),new re(35,25)),new be(30,new re(19,15),new re(35,16))),new ot(33,Int32Array.from([6,30,58,86,114,142]),new be(30,new re(17,115),new re(1,116)),new be(28,new re(14,46),new re(21,47)),new be(30,new re(29,24),new re(19,25)),new be(30,new re(11,15),new re(46,16))),new ot(34,Int32Array.from([6,34,62,90,118,146]),new be(30,new re(13,115),new re(6,116)),new be(28,new re(14,46),new re(23,47)),new be(30,new re(44,24),new re(7,25)),new be(30,new re(59,16),new re(1,17))),new ot(35,Int32Array.from([6,30,54,78,102,126,150]),new be(30,new re(12,121),new re(7,122)),new be(28,new re(12,47),new re(26,48)),new be(30,new re(39,24),new re(14,25)),new be(30,new re(22,15),new re(41,16))),new ot(36,Int32Array.from([6,24,50,76,102,128,154]),new be(30,new re(6,121),new re(14,122)),new be(28,new re(6,47),new re(34,48)),new be(30,new re(46,24),new re(10,25)),new be(30,new re(2,15),new re(64,16))),new ot(37,Int32Array.from([6,28,54,80,106,132,158]),new be(30,new re(17,122),new re(4,123)),new be(28,new re(29,46),new re(14,47)),new be(30,new re(49,24),new re(10,25)),new be(30,new re(24,15),new re(46,16))),new ot(38,Int32Array.from([6,32,58,84,110,136,162]),new be(30,new re(4,122),new re(18,123)),new be(28,new re(13,46),new re(32,47)),new be(30,new re(48,24),new re(14,25)),new be(30,new re(42,15),new re(32,16))),new ot(39,Int32Array.from([6,26,54,82,110,138,166]),new be(30,new re(20,117),new re(4,118)),new be(28,new re(40,47),new re(7,48)),new be(30,new re(43,24),new re(22,25)),new be(30,new re(10,15),new re(67,16))),new ot(40,Int32Array.from([6,30,58,86,114,142,170]),new be(30,new re(19,118),new re(6,119)),new be(28,new re(18,47),new re(31,48)),new be(30,new re(34,24),new re(34,25)),new be(30,new re(20,15),new re(61,16)))];var bn;(function(G){G[G.DATA_MASK_000=0]="DATA_MASK_000",G[G.DATA_MASK_001=1]="DATA_MASK_001",G[G.DATA_MASK_010=2]="DATA_MASK_010",G[G.DATA_MASK_011=3]="DATA_MASK_011",G[G.DATA_MASK_100=4]="DATA_MASK_100",G[G.DATA_MASK_101=5]="DATA_MASK_101",G[G.DATA_MASK_110=6]="DATA_MASK_110",G[G.DATA_MASK_111=7]="DATA_MASK_111"})(bn||(bn={}));class tn{constructor(n,s){this.value=n,this.isMasked=s}unmaskBitMatrix(n,s){for(let l=0;l<s;l++)for(let f=0;f<s;f++)this.isMasked(l,f)&&n.flip(f,l)}}tn.values=new Map([[bn.DATA_MASK_000,new tn(bn.DATA_MASK_000,(G,n)=>(G+n&1)===0)],[bn.DATA_MASK_001,new tn(bn.DATA_MASK_001,(G,n)=>(G&1)===0)],[bn.DATA_MASK_010,new tn(bn.DATA_MASK_010,(G,n)=>n%3===0)],[bn.DATA_MASK_011,new tn(bn.DATA_MASK_011,(G,n)=>(G+n)%3===0)],[bn.DATA_MASK_100,new tn(bn.DATA_MASK_100,(G,n)=>(Math.floor(G/2)+Math.floor(n/3)&1)===0)],[bn.DATA_MASK_101,new tn(bn.DATA_MASK_101,(G,n)=>G*n%6===0)],[bn.DATA_MASK_110,new tn(bn.DATA_MASK_110,(G,n)=>G*n%6<3)],[bn.DATA_MASK_111,new tn(bn.DATA_MASK_111,(G,n)=>(G+n+G*n%3&1)===0)]]);class Vn{constructor(n){const s=n.getHeight();if(s<21||(s&3)!==1)throw new ee;this.bitMatrix=n}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let n=0;for(let d=0;d<6;d++)n=this.copyBit(d,8,n);n=this.copyBit(7,8,n),n=this.copyBit(8,8,n),n=this.copyBit(8,7,n);for(let d=5;d>=0;d--)n=this.copyBit(8,d,n);const s=this.bitMatrix.getHeight();let l=0;const f=s-7;for(let d=s-1;d>=f;d--)l=this.copyBit(8,d,l);for(let d=s-8;d<s;d++)l=this.copyBit(d,8,l);if(this.parsedFormatInfo=nn.decodeFormatInformation(n,l),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new ee}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const n=this.bitMatrix.getHeight(),s=Math.floor((n-17)/4);if(s<=6)return ot.getVersionForNumber(s);let l=0;const f=n-11;for(let g=5;g>=0;g--)for(let w=n-9;w>=f;w--)l=this.copyBit(w,g,l);let d=ot.decodeVersionInformation(l);if(d!==null&&d.getDimensionForVersion()===n)return this.parsedVersion=d,d;l=0;for(let g=5;g>=0;g--)for(let w=n-9;w>=f;w--)l=this.copyBit(g,w,l);if(d=ot.decodeVersionInformation(l),d!==null&&d.getDimensionForVersion()===n)return this.parsedVersion=d,d;throw new ee}copyBit(n,s,l){return(this.isMirror?this.bitMatrix.get(s,n):this.bitMatrix.get(n,s))?l<<1|1:l<<1}readCodewords(){const n=this.readFormatInformation(),s=this.readVersion(),l=tn.values.get(n.getDataMask()),f=this.bitMatrix.getHeight();l.unmaskBitMatrix(this.bitMatrix,f);const d=s.buildFunctionPattern();let g=!0;const w=new Uint8Array(s.getTotalCodewords());let E=0,O=0,L=0;for(let V=f-1;V>0;V-=2){V===6&&V--;for(let Y=0;Y<f;Y++){const ae=g?f-1-Y:Y;for(let ge=0;ge<2;ge++)d.get(V-ge,ae)||(L++,O<<=1,this.bitMatrix.get(V-ge,ae)&&(O|=1),L===8&&(w[E++]=O,L=0,O=0))}g=!g}if(E!==s.getTotalCodewords())throw new ee;return w}remask(){if(this.parsedFormatInfo===null)return;const n=tn.values[this.parsedFormatInfo.getDataMask()],s=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,s)}setMirror(n){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=n}mirror(){const n=this.bitMatrix;for(let s=0,l=n.getWidth();s<l;s++)for(let f=s+1,d=n.getHeight();f<d;f++)n.get(s,f)!==n.get(f,s)&&(n.flip(f,s),n.flip(s,f))}}class rr{constructor(n,s){this.numDataCodewords=n,this.codewords=s}static getDataBlocks(n,s,l){if(n.length!==s.getTotalCodewords())throw new R;const f=s.getECBlocksForLevel(l);let d=0;const g=f.getECBlocks();for(const ge of g)d+=ge.getCount();const w=new Array(d);let E=0;for(const ge of g)for(let we=0;we<ge.getCount();we++){const Oe=ge.getDataCodewords(),Ue=f.getECCodewordsPerBlock()+Oe;w[E++]=new rr(Oe,new Uint8Array(Ue))}const O=w[0].codewords.length;let L=w.length-1;for(;L>=0&&w[L].codewords.length!==O;)L--;L++;const V=O-f.getECCodewordsPerBlock();let Y=0;for(let ge=0;ge<V;ge++)for(let we=0;we<E;we++)w[we].codewords[ge]=n[Y++];for(let ge=L;ge<E;ge++)w[ge].codewords[V]=n[Y++];const ae=w[0].codewords.length;for(let ge=V;ge<ae;ge++)for(let we=0;we<E;we++){const Oe=we<L?ge:ge+1;w[we].codewords[Oe]=n[Y++]}return w}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var On;(function(G){G[G.TERMINATOR=0]="TERMINATOR",G[G.NUMERIC=1]="NUMERIC",G[G.ALPHANUMERIC=2]="ALPHANUMERIC",G[G.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",G[G.BYTE=4]="BYTE",G[G.ECI=5]="ECI",G[G.KANJI=6]="KANJI",G[G.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",G[G.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",G[G.HANZI=9]="HANZI"})(On||(On={}));class Et{constructor(n,s,l,f){this.value=n,this.stringValue=s,this.characterCountBitsForVersions=l,this.bits=f,Et.FOR_BITS.set(f,this),Et.FOR_VALUE.set(n,this)}static forBits(n){const s=Et.FOR_BITS.get(n);if(s===void 0)throw new R;return s}getCharacterCountBits(n){const s=n.getVersionNumber();let l;return s<=9?l=0:s<=26?l=1:l=2,this.characterCountBitsForVersions[l]}getValue(){return this.value}getBits(){return this.bits}equals(n){if(!(n instanceof Et))return!1;const s=n;return this.value===s.value}toString(){return this.stringValue}}Et.FOR_BITS=new Map,Et.FOR_VALUE=new Map,Et.TERMINATOR=new Et(On.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Et.NUMERIC=new Et(On.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Et.ALPHANUMERIC=new Et(On.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Et.STRUCTURED_APPEND=new Et(On.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Et.BYTE=new Et(On.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Et.ECI=new Et(On.ECI,"ECI",Int32Array.from([0,0,0]),7),Et.KANJI=new Et(On.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Et.FNC1_FIRST_POSITION=new Et(On.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Et.FNC1_SECOND_POSITION=new Et(On.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Et.HANZI=new Et(On.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class yn{static decode(n,s,l,f){const d=new He(n);let g=new at;const w=new Array;let E=-1,O=-1;try{let L=null,V=!1,Y;do{if(d.available()<4)Y=Et.TERMINATOR;else{const ae=d.readBits(4);Y=Et.forBits(ae)}switch(Y){case Et.TERMINATOR:break;case Et.FNC1_FIRST_POSITION:case Et.FNC1_SECOND_POSITION:V=!0;break;case Et.STRUCTURED_APPEND:if(d.available()<16)throw new ee;E=d.readBits(8),O=d.readBits(8);break;case Et.ECI:const ae=yn.parseECIValue(d);if(L=le.getCharacterSetECIByValue(ae),L===null)throw new ee;break;case Et.HANZI:const ge=d.readBits(4),we=d.readBits(Y.getCharacterCountBits(s));ge===yn.GB2312_SUBSET&&yn.decodeHanziSegment(d,g,we);break;default:const Oe=d.readBits(Y.getCharacterCountBits(s));switch(Y){case Et.NUMERIC:yn.decodeNumericSegment(d,g,Oe);break;case Et.ALPHANUMERIC:yn.decodeAlphanumericSegment(d,g,Oe,V);break;case Et.BYTE:yn.decodeByteSegment(d,g,Oe,L,w,f);break;case Et.KANJI:yn.decodeKanjiSegment(d,g,Oe);break;default:throw new ee}break}}while(Y!==Et.TERMINATOR)}catch{throw new ee}return new It(n,g.toString(),w.length===0?null:w,l===null?null:l.toString(),E,O)}static decodeHanziSegment(n,s,l){if(l*13>n.available())throw new ee;const f=new Uint8Array(2*l);let d=0;for(;l>0;){const g=n.readBits(13);let w=g/96<<8&4294967295|g%96;w<959?w+=41377:w+=42657,f[d]=w>>8&255,f[d+1]=w&255,d+=2,l--}try{s.append(Je.decode(f,ke.GB2312))}catch(g){throw new ee(g)}}static decodeKanjiSegment(n,s,l){if(l*13>n.available())throw new ee;const f=new Uint8Array(2*l);let d=0;for(;l>0;){const g=n.readBits(13);let w=g/192<<8&4294967295|g%192;w<7936?w+=33088:w+=49472,f[d]=w>>8,f[d+1]=w,d+=2,l--}try{s.append(Je.decode(f,ke.SHIFT_JIS))}catch(g){throw new ee(g)}}static decodeByteSegment(n,s,l,f,d,g){if(8*l>n.available())throw new ee;const w=new Uint8Array(l);for(let O=0;O<l;O++)w[O]=n.readBits(8);let E;f===null?E=ke.guessEncoding(w,g):E=f.getName();try{s.append(Je.decode(w,E))}catch(O){throw new ee(O)}d.push(w)}static toAlphaNumericChar(n){if(n>=yn.ALPHANUMERIC_CHARS.length)throw new ee;return yn.ALPHANUMERIC_CHARS[n]}static decodeAlphanumericSegment(n,s,l,f){const d=s.length();for(;l>1;){if(n.available()<11)throw new ee;const g=n.readBits(11);s.append(yn.toAlphaNumericChar(Math.floor(g/45))),s.append(yn.toAlphaNumericChar(g%45)),l-=2}if(l===1){if(n.available()<6)throw new ee;s.append(yn.toAlphaNumericChar(n.readBits(6)))}if(f)for(let g=d;g<s.length();g++)s.charAt(g)==="%"&&(g<s.length()-1&&s.charAt(g+1)==="%"?s.deleteCharAt(g+1):s.setCharAt(g,""))}static decodeNumericSegment(n,s,l){for(;l>=3;){if(n.available()<10)throw new ee;const f=n.readBits(10);if(f>=1e3)throw new ee;s.append(yn.toAlphaNumericChar(Math.floor(f/100))),s.append(yn.toAlphaNumericChar(Math.floor(f/10)%10)),s.append(yn.toAlphaNumericChar(f%10)),l-=3}if(l===2){if(n.available()<7)throw new ee;const f=n.readBits(7);if(f>=100)throw new ee;s.append(yn.toAlphaNumericChar(Math.floor(f/10))),s.append(yn.toAlphaNumericChar(f%10))}else if(l===1){if(n.available()<4)throw new ee;const f=n.readBits(4);if(f>=10)throw new ee;s.append(yn.toAlphaNumericChar(f))}}static parseECIValue(n){const s=n.readBits(8);if((s&128)===0)return s&127;if((s&192)===128){const l=n.readBits(8);return(s&63)<<8&4294967295|l}if((s&224)===192){const l=n.readBits(16);return(s&31)<<16&4294967295|l}throw new ee}}yn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",yn.GB2312_SUBSET=1;class Cr{constructor(n){this.mirrored=n}isMirrored(){return this.mirrored}applyMirroredCorrection(n){if(!this.mirrored||n===null||n.length<3)return;const s=n[0];n[0]=n[2],n[2]=s}}class Mr{constructor(){this.rsDecoder=new _n(qt.QR_CODE_FIELD_256)}decodeBooleanArray(n,s){return this.decodeBitMatrix(et.parseFromBooleanArray(n),s)}decodeBitMatrix(n,s){const l=new Vn(n);let f=null;try{return this.decodeBitMatrixParser(l,s)}catch(d){f=d}try{l.remask(),l.setMirror(!0),l.readVersion(),l.readFormatInformation(),l.mirror();const d=this.decodeBitMatrixParser(l,s);return d.setOther(new Cr(!0)),d}catch(d){throw f!==null?f:d}}decodeBitMatrixParser(n,s){const l=n.readVersion(),f=n.readFormatInformation().getErrorCorrectionLevel(),d=n.readCodewords(),g=rr.getDataBlocks(d,l,f);let w=0;for(const L of g)w+=L.getNumDataCodewords();const E=new Uint8Array(w);let O=0;for(const L of g){const V=L.getCodewords(),Y=L.getNumDataCodewords();this.correctErrors(V,Y);for(let ae=0;ae<Y;ae++)E[O++]=V[ae]}return yn.decode(E,l,f,s)}correctErrors(n,s){const l=new Int32Array(n);try{this.rsDecoder.decode(l,n.length-s)}catch{throw new N}for(let f=0;f<s;f++)n[f]=l[f]}}class ua extends wt{constructor(n,s,l){super(n,s),this.estimatedModuleSize=l}aboutEquals(n,s,l){if(Math.abs(s-this.getY())<=n&&Math.abs(l-this.getX())<=n){const f=Math.abs(n-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(n,s,l){const f=(this.getX()+s)/2,d=(this.getY()+n)/2,g=(this.estimatedModuleSize+l)/2;return new ua(f,d,g)}}class jr{constructor(n,s,l,f,d,g,w){this.image=n,this.startX=s,this.startY=l,this.width=f,this.height=d,this.moduleSize=g,this.resultPointCallback=w,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const n=this.startX,s=this.height,l=this.width,f=n+l,d=this.startY+s/2,g=new Int32Array(3),w=this.image;for(let E=0;E<s;E++){const O=d+((E&1)===0?Math.floor((E+1)/2):-Math.floor((E+1)/2));g[0]=0,g[1]=0,g[2]=0;let L=n;for(;L<f&&!w.get(L,O);)L++;let V=0;for(;L<f;){if(w.get(L,O))if(V===1)g[1]++;else if(V===2){if(this.foundPatternCross(g)){const Y=this.handlePossibleCenter(g,O,L);if(Y!==null)return Y}g[0]=g[2],g[1]=1,g[2]=0,V=1}else g[++V]++;else V===1&&V++,g[V]++;L++}if(this.foundPatternCross(g)){const Y=this.handlePossibleCenter(g,O,f);if(Y!==null)return Y}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ve}static centerFromEnd(n,s){return s-n[2]-n[1]/2}foundPatternCross(n){const s=this.moduleSize,l=s/2;for(let f=0;f<3;f++)if(Math.abs(s-n[f])>=l)return!1;return!0}crossCheckVertical(n,s,l,f){const d=this.image,g=d.getHeight(),w=this.crossCheckStateCount;w[0]=0,w[1]=0,w[2]=0;let E=n;for(;E>=0&&d.get(s,E)&&w[1]<=l;)w[1]++,E--;if(E<0||w[1]>l)return NaN;for(;E>=0&&!d.get(s,E)&&w[0]<=l;)w[0]++,E--;if(w[0]>l)return NaN;for(E=n+1;E<g&&d.get(s,E)&&w[1]<=l;)w[1]++,E++;if(E===g||w[1]>l)return NaN;for(;E<g&&!d.get(s,E)&&w[2]<=l;)w[2]++,E++;if(w[2]>l)return NaN;const O=w[0]+w[1]+w[2];return 5*Math.abs(O-f)>=2*f?NaN:this.foundPatternCross(w)?jr.centerFromEnd(w,E):NaN}handlePossibleCenter(n,s,l){const f=n[0]+n[1]+n[2],d=jr.centerFromEnd(n,l),g=this.crossCheckVertical(s,d,2*n[1],f);if(!isNaN(g)){const w=(n[0]+n[1]+n[2])/3;for(const O of this.possibleCenters)if(O.aboutEquals(w,g,d))return O.combineEstimate(g,d,w);const E=new ua(d,g,w);this.possibleCenters.push(E),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(E)}return null}}class si extends wt{constructor(n,s,l,f){super(n,s),this.estimatedModuleSize=l,this.count=f,f===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(n,s,l){if(Math.abs(s-this.getY())<=n&&Math.abs(l-this.getX())<=n){const f=Math.abs(n-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(n,s,l){const f=this.count+1,d=(this.count*this.getX()+s)/f,g=(this.count*this.getY()+n)/f,w=(this.count*this.estimatedModuleSize+l)/f;return new si(d,g,w,f)}}class oi{constructor(n){this.bottomLeft=n[0],this.topLeft=n[1],this.topRight=n[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Wn{constructor(n,s){this.image=n,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=s}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(n){const s=n!=null&&n.get(ue.TRY_HARDER)!==void 0,l=n!=null&&n.get(ue.PURE_BARCODE)!==void 0,f=this.image,d=f.getHeight(),g=f.getWidth();let w=Math.floor(3*d/(4*Wn.MAX_MODULES));(w<Wn.MIN_SKIP||s)&&(w=Wn.MIN_SKIP);let E=!1;const O=new Int32Array(5);for(let V=w-1;V<d&&!E;V+=w){O[0]=0,O[1]=0,O[2]=0,O[3]=0,O[4]=0;let Y=0;for(let ae=0;ae<g;ae++)if(f.get(ae,V))(Y&1)===1&&Y++,O[Y]++;else if((Y&1)===0)if(Y===4)if(Wn.foundPatternCross(O)){if(this.handlePossibleCenter(O,V,ae,l)===!0)if(w=2,this.hasSkipped===!0)E=this.haveMultiplyConfirmedCenters();else{const we=this.findRowSkip();we>O[2]&&(V+=we-O[2]-w,ae=g-1)}else{O[0]=O[2],O[1]=O[3],O[2]=O[4],O[3]=1,O[4]=0,Y=3;continue}Y=0,O[0]=0,O[1]=0,O[2]=0,O[3]=0,O[4]=0}else O[0]=O[2],O[1]=O[3],O[2]=O[4],O[3]=1,O[4]=0,Y=3;else O[++Y]++;else O[Y]++;Wn.foundPatternCross(O)&&this.handlePossibleCenter(O,V,g,l)===!0&&(w=O[0],this.hasSkipped&&(E=this.haveMultiplyConfirmedCenters()))}const L=this.selectBestPatterns();return wt.orderBestPatterns(L),new oi(L)}static centerFromEnd(n,s){return s-n[4]-n[3]-n[2]/2}static foundPatternCross(n){let s=0;for(let d=0;d<5;d++){const g=n[d];if(g===0)return!1;s+=g}if(s<7)return!1;const l=s/7,f=l/2;return Math.abs(l-n[0])<f&&Math.abs(l-n[1])<f&&Math.abs(3*l-n[2])<3*f&&Math.abs(l-n[3])<f&&Math.abs(l-n[4])<f}getCrossCheckStateCount(){const n=this.crossCheckStateCount;return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n}crossCheckDiagonal(n,s,l,f){const d=this.getCrossCheckStateCount();let g=0;const w=this.image;for(;n>=g&&s>=g&&w.get(s-g,n-g);)d[2]++,g++;if(n<g||s<g)return!1;for(;n>=g&&s>=g&&!w.get(s-g,n-g)&&d[1]<=l;)d[1]++,g++;if(n<g||s<g||d[1]>l)return!1;for(;n>=g&&s>=g&&w.get(s-g,n-g)&&d[0]<=l;)d[0]++,g++;if(d[0]>l)return!1;const E=w.getHeight(),O=w.getWidth();for(g=1;n+g<E&&s+g<O&&w.get(s+g,n+g);)d[2]++,g++;if(n+g>=E||s+g>=O)return!1;for(;n+g<E&&s+g<O&&!w.get(s+g,n+g)&&d[3]<l;)d[3]++,g++;if(n+g>=E||s+g>=O||d[3]>=l)return!1;for(;n+g<E&&s+g<O&&w.get(s+g,n+g)&&d[4]<l;)d[4]++,g++;if(d[4]>=l)return!1;const L=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(L-f)<2*f&&Wn.foundPatternCross(d)}crossCheckVertical(n,s,l,f){const d=this.image,g=d.getHeight(),w=this.getCrossCheckStateCount();let E=n;for(;E>=0&&d.get(s,E);)w[2]++,E--;if(E<0)return NaN;for(;E>=0&&!d.get(s,E)&&w[1]<=l;)w[1]++,E--;if(E<0||w[1]>l)return NaN;for(;E>=0&&d.get(s,E)&&w[0]<=l;)w[0]++,E--;if(w[0]>l)return NaN;for(E=n+1;E<g&&d.get(s,E);)w[2]++,E++;if(E===g)return NaN;for(;E<g&&!d.get(s,E)&&w[3]<l;)w[3]++,E++;if(E===g||w[3]>=l)return NaN;for(;E<g&&d.get(s,E)&&w[4]<l;)w[4]++,E++;if(w[4]>=l)return NaN;const O=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(O-f)>=2*f?NaN:Wn.foundPatternCross(w)?Wn.centerFromEnd(w,E):NaN}crossCheckHorizontal(n,s,l,f){const d=this.image,g=d.getWidth(),w=this.getCrossCheckStateCount();let E=n;for(;E>=0&&d.get(E,s);)w[2]++,E--;if(E<0)return NaN;for(;E>=0&&!d.get(E,s)&&w[1]<=l;)w[1]++,E--;if(E<0||w[1]>l)return NaN;for(;E>=0&&d.get(E,s)&&w[0]<=l;)w[0]++,E--;if(w[0]>l)return NaN;for(E=n+1;E<g&&d.get(E,s);)w[2]++,E++;if(E===g)return NaN;for(;E<g&&!d.get(E,s)&&w[3]<l;)w[3]++,E++;if(E===g||w[3]>=l)return NaN;for(;E<g&&d.get(E,s)&&w[4]<l;)w[4]++,E++;if(w[4]>=l)return NaN;const O=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(O-f)>=f?NaN:Wn.foundPatternCross(w)?Wn.centerFromEnd(w,E):NaN}handlePossibleCenter(n,s,l,f){const d=n[0]+n[1]+n[2]+n[3]+n[4];let g=Wn.centerFromEnd(n,l),w=this.crossCheckVertical(s,Math.floor(g),n[2],d);if(!isNaN(w)&&(g=this.crossCheckHorizontal(Math.floor(g),Math.floor(w),n[2],d),!isNaN(g)&&(!f||this.crossCheckDiagonal(Math.floor(w),Math.floor(g),n[2],d)))){const E=d/7;let O=!1;const L=this.possibleCenters;for(let V=0,Y=L.length;V<Y;V++){const ae=L[V];if(ae.aboutEquals(E,w,g)){L[V]=ae.combineEstimate(w,g,E),O=!0;break}}if(!O){const V=new si(g,w,E);L.push(V),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(V)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let s=null;for(const l of this.possibleCenters)if(l.getCount()>=Wn.CENTER_QUORUM)if(s==null)s=l;else return this.hasSkipped=!0,Math.floor((Math.abs(s.getX()-l.getX())-Math.abs(s.getY()-l.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let n=0,s=0;const l=this.possibleCenters.length;for(const g of this.possibleCenters)g.getCount()>=Wn.CENTER_QUORUM&&(n++,s+=g.getEstimatedModuleSize());if(n<3)return!1;const f=s/l;let d=0;for(const g of this.possibleCenters)d+=Math.abs(g.getEstimatedModuleSize()-f);return d<=.05*s}selectBestPatterns(){const n=this.possibleCenters.length;if(n<3)throw new ve;const s=this.possibleCenters;let l;if(n>3){let f=0,d=0;for(const E of this.possibleCenters){const O=E.getEstimatedModuleSize();f+=O,d+=O*O}l=f/n;let g=Math.sqrt(d/n-l*l);s.sort((E,O)=>{const L=Math.abs(O.getEstimatedModuleSize()-l),V=Math.abs(E.getEstimatedModuleSize()-l);return L<V?-1:L>V?1:0});const w=Math.max(.2*l,g);for(let E=0;E<s.length&&s.length>3;E++){const O=s[E];Math.abs(O.getEstimatedModuleSize()-l)>w&&(s.splice(E,1),E--)}}if(s.length>3){let f=0;for(const d of s)f+=d.getEstimatedModuleSize();l=f/s.length,s.sort((d,g)=>{if(g.getCount()===d.getCount()){const w=Math.abs(g.getEstimatedModuleSize()-l),E=Math.abs(d.getEstimatedModuleSize()-l);return w<E?1:w>E?-1:0}else return g.getCount()-d.getCount()}),s.splice(3)}return[s[0],s[1],s[2]]}}Wn.CENTER_QUORUM=2,Wn.MIN_SKIP=3,Wn.MAX_MODULES=57;class Wr{constructor(n){this.image=n}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(n){this.resultPointCallback=n==null?null:n.get(ue.NEED_RESULT_POINT_CALLBACK);const l=new Wn(this.image,this.resultPointCallback).find(n);return this.processFinderPatternInfo(l)}processFinderPatternInfo(n){const s=n.getTopLeft(),l=n.getTopRight(),f=n.getBottomLeft(),d=this.calculateModuleSize(s,l,f);if(d<1)throw new ve("No pattern found in proccess finder.");const g=Wr.computeDimension(s,l,f,d),w=ot.getProvisionalVersionForDimension(g),E=w.getDimensionForVersion()-7;let O=null;if(w.getAlignmentPatternCenters().length>0){const ae=l.getX()-s.getX()+f.getX(),ge=l.getY()-s.getY()+f.getY(),we=1-3/E,Oe=Math.floor(s.getX()+we*(ae-s.getX())),Ue=Math.floor(s.getY()+we*(ge-s.getY()));for(let pt=4;pt<=16;pt<<=1)try{O=this.findAlignmentInRegion(d,Oe,Ue,pt);break}catch(dt){if(!(dt instanceof ve))throw dt}}const L=Wr.createTransform(s,l,f,O,g),V=Wr.sampleGrid(this.image,L,g);let Y;return O===null?Y=[f,s,l]:Y=[f,s,l,O],new Er(V,Y)}static createTransform(n,s,l,f,d){const g=d-3.5;let w,E,O,L;return f!==null?(w=f.getX(),E=f.getY(),O=g-3,L=O):(w=s.getX()-n.getX()+l.getX(),E=s.getY()-n.getY()+l.getY(),O=g,L=g),hr.quadrilateralToQuadrilateral(3.5,3.5,g,3.5,O,L,3.5,g,n.getX(),n.getY(),s.getX(),s.getY(),w,E,l.getX(),l.getY())}static sampleGrid(n,s,l){return vr.getInstance().sampleGridWithTransform(n,l,l,s)}static computeDimension(n,s,l,f){const d=Qt.round(wt.distance(n,s)/f),g=Qt.round(wt.distance(n,l)/f);let w=Math.floor((d+g)/2)+7;switch(w&3){case 0:w++;break;case 2:w--;break;case 3:throw new ve("Dimensions could be not found.")}return w}calculateModuleSize(n,s,l){return(this.calculateModuleSizeOneWay(n,s)+this.calculateModuleSizeOneWay(n,l))/2}calculateModuleSizeOneWay(n,s){const l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(n.getX()),Math.floor(n.getY()),Math.floor(s.getX()),Math.floor(s.getY())),f=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(n.getX()),Math.floor(n.getY()));return isNaN(l)?f/7:isNaN(f)?l/7:(l+f)/14}sizeOfBlackWhiteBlackRunBothWays(n,s,l,f){let d=this.sizeOfBlackWhiteBlackRun(n,s,l,f),g=1,w=n-(l-n);w<0?(g=n/(n-w),w=0):w>=this.image.getWidth()&&(g=(this.image.getWidth()-1-n)/(w-n),w=this.image.getWidth()-1);let E=Math.floor(s-(f-s)*g);return g=1,E<0?(g=s/(s-E),E=0):E>=this.image.getHeight()&&(g=(this.image.getHeight()-1-s)/(E-s),E=this.image.getHeight()-1),w=Math.floor(n+(w-n)*g),d+=this.sizeOfBlackWhiteBlackRun(n,s,w,E),d-1}sizeOfBlackWhiteBlackRun(n,s,l,f){const d=Math.abs(f-s)>Math.abs(l-n);if(d){let ae=n;n=s,s=ae,ae=l,l=f,f=ae}const g=Math.abs(l-n),w=Math.abs(f-s);let E=-g/2;const O=n<l?1:-1,L=s<f?1:-1;let V=0;const Y=l+O;for(let ae=n,ge=s;ae!==Y;ae+=O){const we=d?ge:ae,Oe=d?ae:ge;if(V===1===this.image.get(we,Oe)){if(V===2)return Qt.distance(ae,ge,n,s);V++}if(E+=w,E>0){if(ge===f)break;ge+=L,E-=g}}return V===2?Qt.distance(l+O,f,n,s):NaN}findAlignmentInRegion(n,s,l,f){const d=Math.floor(f*n),g=Math.max(0,s-d),w=Math.min(this.image.getWidth()-1,s+d);if(w-g<n*3)throw new ve("Alignment top exceeds estimated module size.");const E=Math.max(0,l-d),O=Math.min(this.image.getHeight()-1,l+d);if(O-E<n*3)throw new ve("Alignment bottom exceeds estimated module size.");return new jr(this.image,g,E,w-g,O-E,n,this.resultPointCallback).find()}}class pi{constructor(){this.decoder=new Mr}getDecoder(){return this.decoder}decode(n,s){let l,f;if(s!=null&&s.get(ue.PURE_BARCODE)!==void 0){const E=pi.extractPureBits(n.getBlackMatrix());l=this.decoder.decodeBitMatrix(E,s),f=pi.NO_POINTS}else{const E=new Wr(n.getBlackMatrix()).detect(s);l=this.decoder.decodeBitMatrix(E.getBits(),s),f=E.getPoints()}l.getOther()instanceof Cr&&l.getOther().applyMirroredCorrection(f);const d=new Le(l.getText(),l.getRawBytes(),void 0,f,Me.QR_CODE,void 0),g=l.getByteSegments();g!==null&&d.putMetadata(At.BYTE_SEGMENTS,g);const w=l.getECLevel();return w!==null&&d.putMetadata(At.ERROR_CORRECTION_LEVEL,w),l.hasStructuredAppend()&&(d.putMetadata(At.STRUCTURED_APPEND_SEQUENCE,l.getStructuredAppendSequenceNumber()),d.putMetadata(At.STRUCTURED_APPEND_PARITY,l.getStructuredAppendParity())),d}reset(){}static extractPureBits(n){const s=n.getTopLeftOnBit(),l=n.getBottomRightOnBit();if(s===null||l===null)throw new ve;const f=this.moduleSize(s,n);let d=s[1],g=l[1],w=s[0],E=l[0];if(w>=E||d>=g)throw new ve;if(g-d!==E-w&&(E=w+(g-d),E>=n.getWidth()))throw new ve;const O=Math.round((E-w+1)/f),L=Math.round((g-d+1)/f);if(O<=0||L<=0)throw new ve;if(L!==O)throw new ve;const V=Math.floor(f/2);d+=V,w+=V;const Y=w+Math.floor((O-1)*f)-E;if(Y>0){if(Y>V)throw new ve;w-=Y}const ae=d+Math.floor((L-1)*f)-g;if(ae>0){if(ae>V)throw new ve;d-=ae}const ge=new et(O,L);for(let we=0;we<L;we++){const Oe=d+Math.floor(we*f);for(let Ue=0;Ue<O;Ue++)n.get(w+Math.floor(Ue*f),Oe)&&ge.set(Ue,we)}return ge}static moduleSize(n,s){const l=s.getHeight(),f=s.getWidth();let d=n[0],g=n[1],w=!0,E=0;for(;d<f&&g<l;){if(w!==s.get(d,g)){if(++E===5)break;w=!w}d++,g++}if(d===f||g===l)throw new ve;return(d-n[0])/7}}pi.NO_POINTS=new Array;class rn{PDF417Common(){}static getBitCountSum(n){return Qt.sum(n)}static toIntArray(n){if(n==null||!n.length)return rn.EMPTY_INT_ARRAY;const s=new Int32Array(n.length);let l=0;for(const f of n)s[l++]=f;return s}static getCodeword(n){const s=F.binarySearch(rn.SYMBOL_TABLE,n&262143);return s<0?-1:(rn.CODEWORD_TABLE[s]-1)%rn.NUMBER_OF_CODEWORDS}}rn.NUMBER_OF_CODEWORDS=929,rn.MAX_CODEWORDS_IN_BARCODE=rn.NUMBER_OF_CODEWORDS-1,rn.MIN_ROWS_IN_BARCODE=3,rn.MAX_ROWS_IN_BARCODE=90,rn.MODULES_IN_CODEWORD=17,rn.MODULES_IN_STOP_PATTERN=18,rn.BARS_IN_MODULE=8,rn.EMPTY_INT_ARRAY=new Int32Array([]),rn.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),rn.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class as{constructor(n,s){this.bits=n,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class pn{static detectMultiple(n,s,l){let f=n.getBlackMatrix(),d=pn.detect(l,f);return d.length||(f=f.clone(),f.rotate180(),d=pn.detect(l,f)),new as(f,d)}static detect(n,s){const l=new Array;let f=0,d=0,g=!1;for(;f<s.getHeight();){const w=pn.findVertices(s,f,d);if(w[0]==null&&w[3]==null){if(!g)break;g=!1,d=0;for(const E of l)E[1]!=null&&(f=Math.trunc(Math.max(f,E[1].getY()))),E[3]!=null&&(f=Math.max(f,Math.trunc(E[3].getY())));f+=pn.ROW_STEP;continue}if(g=!0,l.push(w),!n)break;w[2]!=null?(d=Math.trunc(w[2].getX()),f=Math.trunc(w[2].getY())):(d=Math.trunc(w[4].getX()),f=Math.trunc(w[4].getY()))}return l}static findVertices(n,s,l){const f=n.getHeight(),d=n.getWidth(),g=new Array(8);return pn.copyToResult(g,pn.findRowsWithPattern(n,f,d,s,l,pn.START_PATTERN),pn.INDEXES_START_PATTERN),g[4]!=null&&(l=Math.trunc(g[4].getX()),s=Math.trunc(g[4].getY())),pn.copyToResult(g,pn.findRowsWithPattern(n,f,d,s,l,pn.STOP_PATTERN),pn.INDEXES_STOP_PATTERN),g}static copyToResult(n,s,l){for(let f=0;f<l.length;f++)n[l[f]]=s[f]}static findRowsWithPattern(n,s,l,f,d,g){const w=new Array(4);let E=!1;const O=new Int32Array(g.length);for(;f<s;f+=pn.ROW_STEP){let V=pn.findGuardPattern(n,d,f,l,!1,g,O);if(V!=null){for(;f>0;){const Y=pn.findGuardPattern(n,d,--f,l,!1,g,O);if(Y!=null)V=Y;else{f++;break}}w[0]=new wt(V[0],f),w[1]=new wt(V[1],f),E=!0;break}}let L=f+1;if(E){let V=0,Y=Int32Array.from([Math.trunc(w[0].getX()),Math.trunc(w[1].getX())]);for(;L<s;L++){const ae=pn.findGuardPattern(n,Y[0],L,l,!1,g,O);if(ae!=null&&Math.abs(Y[0]-ae[0])<pn.MAX_PATTERN_DRIFT&&Math.abs(Y[1]-ae[1])<pn.MAX_PATTERN_DRIFT)Y=ae,V=0;else{if(V>pn.SKIPPED_ROW_COUNT_MAX)break;V++}}L-=V+1,w[2]=new wt(Y[0],L),w[3]=new wt(Y[1],L)}return L-f<pn.BARCODE_MIN_HEIGHT&&F.fill(w,null),w}static findGuardPattern(n,s,l,f,d,g,w){F.fillWithin(w,0,w.length,0);let E=s,O=0;for(;n.get(E,l)&&E>0&&O++<pn.MAX_PIXEL_DRIFT;)E--;let L=E,V=0,Y=g.length;for(let ae=d;L<f;L++)if(n.get(L,l)!==ae)w[V]++;else{if(V===Y-1){if(pn.patternMatchVariance(w,g,pn.MAX_INDIVIDUAL_VARIANCE)<pn.MAX_AVG_VARIANCE)return new Int32Array([E,L]);E+=w[0]+w[1],z.arraycopy(w,2,w,0,V-1),w[V-1]=0,w[V]=0,V--}else V++;w[V]=1,ae=!ae}return V===Y-1&&pn.patternMatchVariance(w,g,pn.MAX_INDIVIDUAL_VARIANCE)<pn.MAX_AVG_VARIANCE?new Int32Array([E,L-1]):null}static patternMatchVariance(n,s,l){let f=n.length,d=0,g=0;for(let O=0;O<f;O++)d+=n[O],g+=s[O];if(d<g)return 1/0;let w=d/g;l*=w;let E=0;for(let O=0;O<f;O++){let L=n[O],V=s[O]*w,Y=L>V?L-V:V-L;if(Y>l)return 1/0;E+=Y}return E/d}}pn.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),pn.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),pn.MAX_AVG_VARIANCE=.42,pn.MAX_INDIVIDUAL_VARIANCE=.8,pn.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),pn.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),pn.MAX_PIXEL_DRIFT=3,pn.MAX_PATTERN_DRIFT=5,pn.SKIPPED_ROW_COUNT_MAX=25,pn.ROW_STEP=5,pn.BARCODE_MIN_HEIGHT=10;class or{constructor(n,s){if(s.length===0)throw new R;this.field=n;let l=s.length;if(l>1&&s[0]===0){let f=1;for(;f<l&&s[f]===0;)f++;f===l?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(l-f),z.arraycopy(s,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(n){return this.coefficients[this.coefficients.length-1-n]}evaluateAt(n){if(n===0)return this.getCoefficient(0);if(n===1){let f=0;for(let d of this.coefficients)f=this.field.add(f,d);return f}let s=this.coefficients[0],l=this.coefficients.length;for(let f=1;f<l;f++)s=this.field.add(this.field.multiply(n,s),this.coefficients[f]);return s}add(n){if(!this.field.equals(n.field))throw new R("ModulusPolys do not have same ModulusGF field");if(this.isZero())return n;if(n.isZero())return this;let s=this.coefficients,l=n.coefficients;if(s.length>l.length){let g=s;s=l,l=g}let f=new Int32Array(l.length),d=l.length-s.length;z.arraycopy(l,0,f,0,d);for(let g=d;g<l.length;g++)f[g]=this.field.add(s[g-d],l[g]);return new or(this.field,f)}subtract(n){if(!this.field.equals(n.field))throw new R("ModulusPolys do not have same ModulusGF field");return n.isZero()?this:this.add(n.negative())}multiply(n){return n instanceof or?this.multiplyOther(n):this.multiplyScalar(n)}multiplyOther(n){if(!this.field.equals(n.field))throw new R("ModulusPolys do not have same ModulusGF field");if(this.isZero()||n.isZero())return new or(this.field,new Int32Array([0]));let s=this.coefficients,l=s.length,f=n.coefficients,d=f.length,g=new Int32Array(l+d-1);for(let w=0;w<l;w++){let E=s[w];for(let O=0;O<d;O++)g[w+O]=this.field.add(g[w+O],this.field.multiply(E,f[O]))}return new or(this.field,g)}negative(){let n=this.coefficients.length,s=new Int32Array(n);for(let l=0;l<n;l++)s[l]=this.field.subtract(0,this.coefficients[l]);return new or(this.field,s)}multiplyScalar(n){if(n===0)return new or(this.field,new Int32Array([0]));if(n===1)return this;let s=this.coefficients.length,l=new Int32Array(s);for(let f=0;f<s;f++)l[f]=this.field.multiply(this.coefficients[f],n);return new or(this.field,l)}multiplyByMonomial(n,s){if(n<0)throw new R;if(s===0)return new or(this.field,new Int32Array([0]));let l=this.coefficients.length,f=new Int32Array(l+n);for(let d=0;d<l;d++)f[d]=this.field.multiply(this.coefficients[d],s);return new or(this.field,f)}toString(){let n=new at;for(let s=this.getDegree();s>=0;s--){let l=this.getCoefficient(s);l!==0&&(l<0?(n.append(" - "),l=-l):n.length()>0&&n.append(" + "),(s===0||l!==1)&&n.append(l),s!==0&&(s===1?n.append("x"):(n.append("x^"),n.append(s))))}return n.toString()}}class Ea{add(n,s){return(n+s)%this.modulus}subtract(n,s){return(this.modulus+n-s)%this.modulus}exp(n){return this.expTable[n]}log(n){if(n===0)throw new R;return this.logTable[n]}inverse(n){if(n===0)throw new mt;return this.expTable[this.modulus-this.logTable[n]-1]}multiply(n,s){return n===0||s===0?0:this.expTable[(this.logTable[n]+this.logTable[s])%(this.modulus-1)]}getSize(){return this.modulus}equals(n){return n===this}}class ji extends Ea{constructor(n,s){super(),this.modulus=n,this.expTable=new Int32Array(n),this.logTable=new Int32Array(n);let l=1;for(let f=0;f<n;f++)this.expTable[f]=l,l=l*s%n;for(let f=0;f<n-1;f++)this.logTable[this.expTable[f]]=f;this.zero=new or(this,new Int32Array([0])),this.one=new or(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(n,s){if(n<0)throw new R;if(s===0)return this.zero;let l=new Int32Array(n+1);return l[0]=s,new or(this,l)}}ji.PDF417_GF=new ji(rn.NUMBER_OF_CODEWORDS,3);class li{constructor(){this.field=ji.PDF417_GF}decode(n,s,l){let f=new or(this.field,n),d=new Int32Array(s),g=!1;for(let ge=s;ge>0;ge--){let we=f.evaluateAt(this.field.exp(ge));d[s-ge]=we,we!==0&&(g=!0)}if(!g)return 0;let w=this.field.getOne();if(l!=null)for(const ge of l){let we=this.field.exp(n.length-1-ge),Oe=new or(this.field,new Int32Array([this.field.subtract(0,we),1]));w=w.multiply(Oe)}let E=new or(this.field,d),O=this.runEuclideanAlgorithm(this.field.buildMonomial(s,1),E,s),L=O[0],V=O[1],Y=this.findErrorLocations(L),ae=this.findErrorMagnitudes(V,L,Y);for(let ge=0;ge<Y.length;ge++){let we=n.length-1-this.field.log(Y[ge]);if(we<0)throw N.getChecksumInstance();n[we]=this.field.subtract(n[we],ae[ge])}return Y.length}runEuclideanAlgorithm(n,s,l){if(n.getDegree()<s.getDegree()){let Y=n;n=s,s=Y}let f=n,d=s,g=this.field.getZero(),w=this.field.getOne();for(;d.getDegree()>=Math.round(l/2);){let Y=f,ae=g;if(f=d,g=w,f.isZero())throw N.getChecksumInstance();d=Y;let ge=this.field.getZero(),we=f.getCoefficient(f.getDegree()),Oe=this.field.inverse(we);for(;d.getDegree()>=f.getDegree()&&!d.isZero();){let Ue=d.getDegree()-f.getDegree(),pt=this.field.multiply(d.getCoefficient(d.getDegree()),Oe);ge=ge.add(this.field.buildMonomial(Ue,pt)),d=d.subtract(f.multiplyByMonomial(Ue,pt))}w=ge.multiply(g).subtract(ae).negative()}let E=w.getCoefficient(0);if(E===0)throw N.getChecksumInstance();let O=this.field.inverse(E),L=w.multiply(O),V=d.multiply(O);return[L,V]}findErrorLocations(n){let s=n.getDegree(),l=new Int32Array(s),f=0;for(let d=1;d<this.field.getSize()&&f<s;d++)n.evaluateAt(d)===0&&(l[f]=this.field.inverse(d),f++);if(f!==s)throw N.getChecksumInstance();return l}findErrorMagnitudes(n,s,l){let f=s.getDegree(),d=new Int32Array(f);for(let O=1;O<=f;O++)d[f-O]=this.field.multiply(O,s.getCoefficient(O));let g=new or(this.field,d),w=l.length,E=new Int32Array(w);for(let O=0;O<w;O++){let L=this.field.inverse(l[O]),V=this.field.subtract(0,n.evaluateAt(L)),Y=this.field.inverse(g.evaluateAt(L));E[O]=this.field.multiply(V,Y)}return E}}class Ti{constructor(n,s,l,f,d){n instanceof Ti?this.constructor_2(n):this.constructor_1(n,s,l,f,d)}constructor_1(n,s,l,f,d){const g=s==null||l==null,w=f==null||d==null;if(g&&w)throw new ve;g?(s=new wt(0,f.getY()),l=new wt(0,d.getY())):w&&(f=new wt(n.getWidth()-1,s.getY()),d=new wt(n.getWidth()-1,l.getY())),this.image=n,this.topLeft=s,this.bottomLeft=l,this.topRight=f,this.bottomRight=d,this.minX=Math.trunc(Math.min(s.getX(),l.getX())),this.maxX=Math.trunc(Math.max(f.getX(),d.getX())),this.minY=Math.trunc(Math.min(s.getY(),f.getY())),this.maxY=Math.trunc(Math.max(l.getY(),d.getY()))}constructor_2(n){this.image=n.image,this.topLeft=n.getTopLeft(),this.bottomLeft=n.getBottomLeft(),this.topRight=n.getTopRight(),this.bottomRight=n.getBottomRight(),this.minX=n.getMinX(),this.maxX=n.getMaxX(),this.minY=n.getMinY(),this.maxY=n.getMaxY()}static merge(n,s){return n==null?s:s==null?n:new Ti(n.image,n.topLeft,n.bottomLeft,s.topRight,s.bottomRight)}addMissingRows(n,s,l){let f=this.topLeft,d=this.bottomLeft,g=this.topRight,w=this.bottomRight;if(n>0){let E=l?this.topLeft:this.topRight,O=Math.trunc(E.getY()-n);O<0&&(O=0);let L=new wt(E.getX(),O);l?f=L:g=L}if(s>0){let E=l?this.bottomLeft:this.bottomRight,O=Math.trunc(E.getY()+s);O>=this.image.getHeight()&&(O=this.image.getHeight()-1);let L=new wt(E.getX(),O);l?d=L:w=L}return new Ti(this.image,f,d,g,w)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Va{constructor(n,s,l,f){this.columnCount=n,this.errorCorrectionLevel=f,this.rowCountUpperPart=s,this.rowCountLowerPart=l,this.rowCount=s+l}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Si{constructor(){this.buffer=""}static form(n,s){let l=-1;function f(g,w,E,O,L,V){if(g==="%%")return"%";if(s[++l]===void 0)return;g=O?parseInt(O.substr(1)):void 0;let Y=L?parseInt(L.substr(1)):void 0,ae;switch(V){case"s":ae=s[l];break;case"c":ae=s[l][0];break;case"f":ae=parseFloat(s[l]).toFixed(g);break;case"p":ae=parseFloat(s[l]).toPrecision(g);break;case"e":ae=parseFloat(s[l]).toExponential(g);break;case"x":ae=parseInt(s[l]).toString(Y||16);break;case"d":ae=parseFloat(parseInt(s[l],Y||10).toPrecision(g)).toFixed(0);break}ae=typeof ae=="object"?JSON.stringify(ae):(+ae).toString(Y);let ge=parseInt(E),we=E&&E[0]+""=="0"?"0":" ";for(;ae.length<ge;)ae=w!==void 0?ae+we:we+ae;return ae}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return n.replace(d,f)}format(n,...s){this.buffer+=Si.form(n,s)}toString(){return this.buffer}}class Mi{constructor(n){this.boundingBox=new Ti(n),this.codewords=new Array(n.getMaxY()-n.getMinY()+1)}getCodewordNearby(n){let s=this.getCodeword(n);if(s!=null)return s;for(let l=1;l<Mi.MAX_NEARBY_DISTANCE;l++){let f=this.imageRowToCodewordIndex(n)-l;if(f>=0&&(s=this.codewords[f],s!=null)||(f=this.imageRowToCodewordIndex(n)+l,f<this.codewords.length&&(s=this.codewords[f],s!=null)))return s}return null}imageRowToCodewordIndex(n){return n-this.boundingBox.getMinY()}setCodeword(n,s){this.codewords[this.imageRowToCodewordIndex(n)]=s}getCodeword(n){return this.codewords[this.imageRowToCodewordIndex(n)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const n=new Si;let s=0;for(const l of this.codewords){if(l==null){n.format("%3d:    |   %n",s++);continue}n.format("%3d: %3d|%3d%n",s++,l.getRowNumber(),l.getValue())}return n.toString()}}Mi.MAX_NEARBY_DISTANCE=5;class Bi{constructor(){this.values=new Map}setValue(n){n=Math.trunc(n);let s=this.values.get(n);s==null&&(s=0),s++,this.values.set(n,s)}getValue(){let n=-1,s=new Array;for(const[l,f]of this.values.entries()){const d={getKey:()=>l,getValue:()=>f};d.getValue()>n?(n=d.getValue(),s=[],s.push(d.getKey())):d.getValue()===n&&s.push(d.getKey())}return rn.toIntArray(s)}getConfidence(n){return this.values.get(n)}}class qa extends Mi{constructor(n,s){super(n),this._isLeft=s}setRowNumbers(){for(let n of this.getCodewords())n?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(n){let s=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(s,n);let l=this.getBoundingBox(),f=this._isLeft?l.getTopLeft():l.getTopRight(),d=this._isLeft?l.getBottomLeft():l.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(f.getY())),w=this.imageRowToCodewordIndex(Math.trunc(d.getY())),E=-1,O=1,L=0;for(let V=g;V<w;V++){if(s[V]==null)continue;let Y=s[V],ae=Y.getRowNumber()-E;if(ae===0)L++;else if(ae===1)O=Math.max(O,L),L=1,E=Y.getRowNumber();else if(ae<0||Y.getRowNumber()>=n.getRowCount()||ae>V)s[V]=null;else{let ge;O>2?ge=(O-2)*ae:ge=ae;let we=ge>=V;for(let Oe=1;Oe<=ge&&!we;Oe++)we=s[V-Oe]!=null;we?s[V]=null:(E=Y.getRowNumber(),L=1)}}}getRowHeights(){let n=this.getBarcodeMetadata();if(n==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(n);let s=new Int32Array(n.getRowCount());for(let l of this.getCodewords())if(l!=null){let f=l.getRowNumber();if(f>=s.length)continue;s[f]++}return s}adjustIncompleteIndicatorColumnRowNumbers(n){let s=this.getBoundingBox(),l=this._isLeft?s.getTopLeft():s.getTopRight(),f=this._isLeft?s.getBottomLeft():s.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),g=this.imageRowToCodewordIndex(Math.trunc(f.getY())),w=this.getCodewords(),E=-1;for(let O=d;O<g;O++){if(w[O]==null)continue;let L=w[O];L.setRowNumberAsRowIndicatorColumn();let V=L.getRowNumber()-E;V===0||(V===1?E=L.getRowNumber():L.getRowNumber()>=n.getRowCount()?w[O]=null:E=L.getRowNumber())}}getBarcodeMetadata(){let n=this.getCodewords(),s=new Bi,l=new Bi,f=new Bi,d=new Bi;for(let w of n){if(w==null)continue;w.setRowNumberAsRowIndicatorColumn();let E=w.getValue()%30,O=w.getRowNumber();switch(this._isLeft||(O+=2),O%3){case 0:l.setValue(E*3+1);break;case 1:d.setValue(E/3),f.setValue(E%3);break;case 2:s.setValue(E+1);break}}if(s.getValue().length===0||l.getValue().length===0||f.getValue().length===0||d.getValue().length===0||s.getValue()[0]<1||l.getValue()[0]+f.getValue()[0]<rn.MIN_ROWS_IN_BARCODE||l.getValue()[0]+f.getValue()[0]>rn.MAX_ROWS_IN_BARCODE)return null;let g=new Va(s.getValue()[0],l.getValue()[0],f.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(n,g),g}removeIncorrectCodewords(n,s){for(let l=0;l<n.length;l++){let f=n[l];if(n[l]==null)continue;let d=f.getValue()%30,g=f.getRowNumber();if(g>s.getRowCount()){n[l]=null;continue}switch(this._isLeft||(g+=2),g%3){case 0:d*3+1!==s.getRowCountUpperPart()&&(n[l]=null);break;case 1:(Math.trunc(d/3)!==s.getErrorCorrectionLevel()||d%3!==s.getRowCountLowerPart())&&(n[l]=null);break;case 2:d+1!==s.getColumnCount()&&(n[l]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Br{constructor(n,s){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=n,this.barcodeColumnCount=n.getColumnCount(),this.boundingBox=s,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let n=rn.MAX_CODEWORDS_IN_BARCODE,s;do s=n,n=this.adjustRowNumbersAndGetCount();while(n>0&&n<s);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(n){n?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let n=this.adjustRowNumbersByRow();if(n===0)return 0;for(let s=1;s<this.barcodeColumnCount+1;s++){let l=this.detectionResultColumns[s].getCodewords();for(let f=0;f<l.length;f++)l[f]!=null&&(l[f].hasValidRowNumber()||this.adjustRowNumbers(s,f,l))}return n}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let n=this.detectionResultColumns[0].getCodewords(),s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<n.length;l++)if(n[l]!=null&&s[l]!=null&&n[l].getRowNumber()===s[l].getRowNumber())for(let f=1;f<=this.barcodeColumnCount;f++){let d=this.detectionResultColumns[f].getCodewords()[l];d!=null&&(d.setRowNumber(n[l].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[f].getCodewords()[l]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let n=0,s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<s.length;l++){if(s[l]==null)continue;let f=s[l].getRowNumber(),d=0;for(let g=this.barcodeColumnCount+1;g>0&&d<this.ADJUST_ROW_NUMBER_SKIP;g--){let w=this.detectionResultColumns[g].getCodewords()[l];w!=null&&(d=Br.adjustRowNumberIfValid(f,d,w),w.hasValidRowNumber()||n++)}}return n}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let n=0,s=this.detectionResultColumns[0].getCodewords();for(let l=0;l<s.length;l++){if(s[l]==null)continue;let f=s[l].getRowNumber(),d=0;for(let g=1;g<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;g++){let w=this.detectionResultColumns[g].getCodewords()[l];w!=null&&(d=Br.adjustRowNumberIfValid(f,d,w),w.hasValidRowNumber()||n++)}}return n}static adjustRowNumberIfValid(n,s,l){return l==null||l.hasValidRowNumber()||(l.isValidRowNumber(n)?(l.setRowNumber(n),s=0):++s),s}adjustRowNumbers(n,s,l){if(!this.detectionResultColumns[n-1])return;let f=l[s],d=this.detectionResultColumns[n-1].getCodewords(),g=d;this.detectionResultColumns[n+1]!=null&&(g=this.detectionResultColumns[n+1].getCodewords());let w=new Array(14);w[2]=d[s],w[3]=g[s],s>0&&(w[0]=l[s-1],w[4]=d[s-1],w[5]=g[s-1]),s>1&&(w[8]=l[s-2],w[10]=d[s-2],w[11]=g[s-2]),s<l.length-1&&(w[1]=l[s+1],w[6]=d[s+1],w[7]=g[s+1]),s<l.length-2&&(w[9]=l[s+2],w[12]=d[s+2],w[13]=g[s+2]);for(let E of w)if(Br.adjustRowNumber(f,E))return}static adjustRowNumber(n,s){return s==null?!1:s.hasValidRowNumber()&&s.getBucket()===n.getBucket()?(n.setRowNumber(s.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(n){this.boundingBox=n}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(n,s){this.detectionResultColumns[n]=s}getDetectionResultColumn(n){return this.detectionResultColumns[n]}toString(){let n=this.detectionResultColumns[0];n==null&&(n=this.detectionResultColumns[this.barcodeColumnCount+1]);let s=new Si;for(let l=0;l<n.getCodewords().length;l++){s.format("CW %3d:",l);for(let f=0;f<this.barcodeColumnCount+2;f++){if(this.detectionResultColumns[f]==null){s.format("    |   ");continue}let d=this.detectionResultColumns[f].getCodewords()[l];if(d==null){s.format("    |   ");continue}s.format(" %3d|%3d",d.getRowNumber(),d.getValue())}s.format("%n")}return s.toString()}}class gi{constructor(n,s,l,f){this.rowNumber=gi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(n),this.endX=Math.trunc(s),this.bucket=Math.trunc(l),this.value=Math.trunc(f)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(n){return n!==gi.BARCODE_ROW_UNKNOWN&&this.bucket===n%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(n){this.rowNumber=n}toString(){return this.rowNumber+"|"+this.value}}gi.BARCODE_ROW_UNKNOWN=-1;class Tr{static initialize(){for(let n=0;n<rn.SYMBOL_TABLE.length;n++){let s=rn.SYMBOL_TABLE[n],l=s&1;for(let f=0;f<rn.BARS_IN_MODULE;f++){let d=0;for(;(s&1)===l;)d+=1,s>>=1;l=s&1,Tr.RATIOS_TABLE[n]||(Tr.RATIOS_TABLE[n]=new Array(rn.BARS_IN_MODULE)),Tr.RATIOS_TABLE[n][rn.BARS_IN_MODULE-f-1]=Math.fround(d/rn.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(n){let s=Tr.getDecodedCodewordValue(Tr.sampleBitCounts(n));return s!==-1?s:Tr.getClosestDecodedValue(n)}static sampleBitCounts(n){let s=Qt.sum(n),l=new Int32Array(rn.BARS_IN_MODULE),f=0,d=0;for(let g=0;g<rn.MODULES_IN_CODEWORD;g++){let w=s/(2*rn.MODULES_IN_CODEWORD)+g*s/rn.MODULES_IN_CODEWORD;d+n[f]<=w&&(d+=n[f],f++),l[f]++}return l}static getDecodedCodewordValue(n){let s=Tr.getBitValue(n);return rn.getCodeword(s)===-1?-1:s}static getBitValue(n){let s=0;for(let l=0;l<n.length;l++)for(let f=0;f<n[l];f++)s=s<<1|(l%2===0?1:0);return Math.trunc(s)}static getClosestDecodedValue(n){let s=Qt.sum(n),l=new Array(rn.BARS_IN_MODULE);if(s>1)for(let g=0;g<l.length;g++)l[g]=Math.fround(n[g]/s);let f=nr.MAX_VALUE,d=-1;this.bSymbolTableReady||Tr.initialize();for(let g=0;g<Tr.RATIOS_TABLE.length;g++){let w=0,E=Tr.RATIOS_TABLE[g];for(let O=0;O<rn.BARS_IN_MODULE;O++){let L=Math.fround(E[O]-l[O]);if(w+=Math.fround(L*L),w>=f)break}w<f&&(f=w,d=rn.SYMBOL_TABLE[g])}return d}}Tr.bSymbolTableReady=!1,Tr.RATIOS_TABLE=new Array(rn.SYMBOL_TABLE.length).map(G=>new Array(rn.BARS_IN_MODULE));class ca{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(n){this.segmentIndex=n}getFileId(){return this.fileId}setFileId(n){this.fileId=n}getOptionalData(){return this.optionalData}setOptionalData(n){this.optionalData=n}isLastSegment(){return this.lastSegment}setLastSegment(n){this.lastSegment=n}getSegmentCount(){return this.segmentCount}setSegmentCount(n){this.segmentCount=n}getSender(){return this.sender||null}setSender(n){this.sender=n}getAddressee(){return this.addressee||null}setAddressee(n){this.addressee=n}getFileName(){return this.fileName}setFileName(n){this.fileName=n}getFileSize(){return this.fileSize}setFileSize(n){this.fileSize=n}getChecksum(){return this.checksum}setChecksum(n){this.checksum=n}getTimestamp(){return this.timestamp}setTimestamp(n){this.timestamp=n}}class Is{static parseLong(n,s=void 0){return parseInt(n,s)}}class ja extends y{}ja.kind="NullPointerException";class ss{writeBytes(n){this.writeBytesOffset(n,0,n.length)}writeBytesOffset(n,s,l){if(n==null)throw new ja;if(s<0||s>n.length||l<0||s+l>n.length||s+l<0)throw new X;if(l===0)return;for(let f=0;f<l;f++)this.write(n[s+f])}flush(){}close(){}}class Ta extends y{}class Sa extends ss{constructor(n=32){if(super(),this.count=0,n<0)throw new R("Negative initial size: "+n);this.buf=new Uint8Array(n)}ensureCapacity(n){n-this.buf.length>0&&this.grow(n)}grow(n){let l=this.buf.length<<1;if(l-n<0&&(l=n),l<0){if(n<0)throw new Ta;l=te.MAX_VALUE}this.buf=F.copyOfUint8Array(this.buf,l)}write(n){this.ensureCapacity(this.count+1),this.buf[this.count]=n,this.count+=1}writeBytesOffset(n,s,l){if(s<0||s>n.length||l<0||s+l-n.length>0)throw new X;this.ensureCapacity(this.count+l),z.arraycopy(n,s,this.buf,this.count,l),this.count+=l}writeTo(n){n.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return F.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(n){return n?typeof n=="string"?this.toString_string(n):this.toString_number(n):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(n){return new String(this.buf).toString()}toString_number(n){return new String(this.buf).toString()}close(){}}var Kn;(function(G){G[G.ALPHA=0]="ALPHA",G[G.LOWER=1]="LOWER",G[G.MIXED=2]="MIXED",G[G.PUNCT=3]="PUNCT",G[G.ALPHA_SHIFT=4]="ALPHA_SHIFT",G[G.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Kn||(Kn={}));function Rs(){if(typeof window<"u")return window.BigInt||null;if(typeof Cc<"u")return Cc.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ha;function Ni(G){if(typeof Ha>"u"&&(Ha=Rs()),Ha===null)throw new Error("BigInt is not supported!");return Ha(G)}function os(){let G=[];G[0]=Ni(1);let n=Ni(900);G[1]=n;for(let s=2;s<16;s++)G[s]=G[s-1]*n;return G}class Pe{static decode(n,s){let l=new at(""),f=le.ISO8859_1;l.enableDecoding(f);let d=1,g=n[d++],w=new ca;for(;d<n[0];){switch(g){case Pe.TEXT_COMPACTION_MODE_LATCH:d=Pe.textCompaction(n,d,l);break;case Pe.BYTE_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH_6:d=Pe.byteCompaction(g,n,f,d,l);break;case Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[d++]);break;case Pe.NUMERIC_COMPACTION_MODE_LATCH:d=Pe.numericCompaction(n,d,l);break;case Pe.ECI_CHARSET:le.getCharacterSetECIByValue(n[d++]);break;case Pe.ECI_GENERAL_PURPOSE:d+=2;break;case Pe.ECI_USER_DEFINED:d++;break;case Pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=Pe.decodeMacroBlock(n,d,w);break;case Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Pe.MACRO_PDF417_TERMINATOR:throw new ee;default:d--,d=Pe.textCompaction(n,d,l);break}if(d<n.length)g=n[d++];else throw ee.getFormatInstance()}if(l.length()===0)throw ee.getFormatInstance();let E=new It(null,l.toString(),null,s);return E.setOther(w),E}static decodeMacroBlock(n,s,l){if(s+Pe.NUMBER_OF_SEQUENCE_CODEWORDS>n[0])throw ee.getFormatInstance();let f=new Int32Array(Pe.NUMBER_OF_SEQUENCE_CODEWORDS);for(let w=0;w<Pe.NUMBER_OF_SEQUENCE_CODEWORDS;w++,s++)f[w]=n[s];l.setSegmentIndex(te.parseInt(Pe.decodeBase900toBase10(f,Pe.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new at;s=Pe.textCompaction(n,s,d),l.setFileId(d.toString());let g=-1;for(n[s]===Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(g=s+1);s<n[0];)switch(n[s]){case Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(s++,n[s]){case Pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let w=new at;s=Pe.textCompaction(n,s+1,w),l.setFileName(w.toString());break;case Pe.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let E=new at;s=Pe.textCompaction(n,s+1,E),l.setSender(E.toString());break;case Pe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let O=new at;s=Pe.textCompaction(n,s+1,O),l.setAddressee(O.toString());break;case Pe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let L=new at;s=Pe.numericCompaction(n,s+1,L),l.setSegmentCount(te.parseInt(L.toString()));break;case Pe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let V=new at;s=Pe.numericCompaction(n,s+1,V),l.setTimestamp(Is.parseLong(V.toString()));break;case Pe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let Y=new at;s=Pe.numericCompaction(n,s+1,Y),l.setChecksum(te.parseInt(Y.toString()));break;case Pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let ae=new at;s=Pe.numericCompaction(n,s+1,ae),l.setFileSize(Is.parseLong(ae.toString()));break;default:throw ee.getFormatInstance()}break;case Pe.MACRO_PDF417_TERMINATOR:s++,l.setLastSegment(!0);break;default:throw ee.getFormatInstance()}if(g!==-1){let w=s-g;l.isLastSegment()&&w--,l.setOptionalData(F.copyOfRange(n,g,g+w))}return s}static textCompaction(n,s,l){let f=new Int32Array((n[0]-s)*2),d=new Int32Array((n[0]-s)*2),g=0,w=!1;for(;s<n[0]&&!w;){let E=n[s++];if(E<Pe.TEXT_COMPACTION_MODE_LATCH)f[g]=E/30,f[g+1]=E%30,g+=2;else switch(E){case Pe.TEXT_COMPACTION_MODE_LATCH:f[g++]=Pe.TEXT_COMPACTION_MODE_LATCH;break;case Pe.BYTE_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH_6:case Pe.NUMERIC_COMPACTION_MODE_LATCH:case Pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Pe.MACRO_PDF417_TERMINATOR:s--,w=!0;break;case Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f[g]=Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,E=n[s++],d[g]=E,g++;break}}return Pe.decodeTextCompaction(f,d,g,l),s}static decodeTextCompaction(n,s,l,f){let d=Kn.ALPHA,g=Kn.ALPHA,w=0;for(;w<l;){let E=n[w],O="";switch(d){case Kn.ALPHA:if(E<26)O=String.fromCharCode(65+E);else switch(E){case 26:O=" ";break;case Pe.LL:d=Kn.LOWER;break;case Pe.ML:d=Kn.MIXED;break;case Pe.PS:g=d,d=Kn.PUNCT_SHIFT;break;case Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[w]);break;case Pe.TEXT_COMPACTION_MODE_LATCH:d=Kn.ALPHA;break}break;case Kn.LOWER:if(E<26)O=String.fromCharCode(97+E);else switch(E){case 26:O=" ";break;case Pe.AS:g=d,d=Kn.ALPHA_SHIFT;break;case Pe.ML:d=Kn.MIXED;break;case Pe.PS:g=d,d=Kn.PUNCT_SHIFT;break;case Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[w]);break;case Pe.TEXT_COMPACTION_MODE_LATCH:d=Kn.ALPHA;break}break;case Kn.MIXED:if(E<Pe.PL)O=Pe.MIXED_CHARS[E];else switch(E){case Pe.PL:d=Kn.PUNCT;break;case 26:O=" ";break;case Pe.LL:d=Kn.LOWER;break;case Pe.AL:d=Kn.ALPHA;break;case Pe.PS:g=d,d=Kn.PUNCT_SHIFT;break;case Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[w]);break;case Pe.TEXT_COMPACTION_MODE_LATCH:d=Kn.ALPHA;break}break;case Kn.PUNCT:if(E<Pe.PAL)O=Pe.PUNCT_CHARS[E];else switch(E){case Pe.PAL:d=Kn.ALPHA;break;case Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[w]);break;case Pe.TEXT_COMPACTION_MODE_LATCH:d=Kn.ALPHA;break}break;case Kn.ALPHA_SHIFT:if(d=g,E<26)O=String.fromCharCode(65+E);else switch(E){case 26:O=" ";break;case Pe.TEXT_COMPACTION_MODE_LATCH:d=Kn.ALPHA;break}break;case Kn.PUNCT_SHIFT:if(d=g,E<Pe.PAL)O=Pe.PUNCT_CHARS[E];else switch(E){case Pe.PAL:d=Kn.ALPHA;break;case Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[w]);break;case Pe.TEXT_COMPACTION_MODE_LATCH:d=Kn.ALPHA;break}break}O!==""&&f.append(O),w++}}static byteCompaction(n,s,l,f,d){let g=new Sa,w=0,E=0,O=!1;switch(n){case Pe.BYTE_COMPACTION_MODE_LATCH:let L=new Int32Array(6),V=s[f++];for(;f<s[0]&&!O;)switch(L[w++]=V,E=900*E+V,V=s[f++],V){case Pe.TEXT_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH:case Pe.NUMERIC_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH_6:case Pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Pe.MACRO_PDF417_TERMINATOR:f--,O=!0;break;default:if(w%5===0&&w>0){for(let Y=0;Y<6;++Y)g.write(Number(Ni(E)>>Ni(8*(5-Y))));E=0,w=0}break}f===s[0]&&V<Pe.TEXT_COMPACTION_MODE_LATCH&&(L[w++]=V);for(let Y=0;Y<w;Y++)g.write(L[Y]);break;case Pe.BYTE_COMPACTION_MODE_LATCH_6:for(;f<s[0]&&!O;){let Y=s[f++];if(Y<Pe.TEXT_COMPACTION_MODE_LATCH)w++,E=900*E+Y;else switch(Y){case Pe.TEXT_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH:case Pe.NUMERIC_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH_6:case Pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Pe.MACRO_PDF417_TERMINATOR:f--,O=!0;break}if(w%5===0&&w>0){for(let ae=0;ae<6;++ae)g.write(Number(Ni(E)>>Ni(8*(5-ae))));E=0,w=0}}break}return d.append(Je.decode(g.toByteArray(),l)),f}static numericCompaction(n,s,l){let f=0,d=!1,g=new Int32Array(Pe.MAX_NUMERIC_CODEWORDS);for(;s<n[0]&&!d;){let w=n[s++];if(s===n[0]&&(d=!0),w<Pe.TEXT_COMPACTION_MODE_LATCH)g[f]=w,f++;else switch(w){case Pe.TEXT_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH:case Pe.BYTE_COMPACTION_MODE_LATCH_6:case Pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Pe.MACRO_PDF417_TERMINATOR:s--,d=!0;break}(f%Pe.MAX_NUMERIC_CODEWORDS===0||w===Pe.NUMERIC_COMPACTION_MODE_LATCH||d)&&f>0&&(l.append(Pe.decodeBase900toBase10(g,f)),f=0)}return s}static decodeBase900toBase10(n,s){let l=Ni(0);for(let d=0;d<s;d++)l+=Pe.EXP900[s-d-1]*Ni(n[d]);let f=l.toString();if(f.charAt(0)!=="1")throw new ee;return f.substring(1)}}Pe.TEXT_COMPACTION_MODE_LATCH=900,Pe.BYTE_COMPACTION_MODE_LATCH=901,Pe.NUMERIC_COMPACTION_MODE_LATCH=902,Pe.BYTE_COMPACTION_MODE_LATCH_6=924,Pe.ECI_USER_DEFINED=925,Pe.ECI_GENERAL_PURPOSE=926,Pe.ECI_CHARSET=927,Pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Pe.MACRO_PDF417_TERMINATOR=922,Pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Pe.MAX_NUMERIC_CODEWORDS=15,Pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Pe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Pe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Pe.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Pe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Pe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Pe.PL=25,Pe.LL=27,Pe.AS=27,Pe.ML=28,Pe.AL=28,Pe.PS=29,Pe.PAL=29,Pe.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Pe.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Pe.EXP900=Rs()?os():[],Pe.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Cn{constructor(){}static decode(n,s,l,f,d,g,w){let E=new Ti(n,s,l,f,d),O=null,L=null,V;for(let ge=!0;;ge=!1){if(s!=null&&(O=Cn.getRowIndicatorColumn(n,E,s,!0,g,w)),f!=null&&(L=Cn.getRowIndicatorColumn(n,E,f,!1,g,w)),V=Cn.merge(O,L),V==null)throw ve.getNotFoundInstance();let we=V.getBoundingBox();if(ge&&we!=null&&(we.getMinY()<E.getMinY()||we.getMaxY()>E.getMaxY()))E=we;else break}V.setBoundingBox(E);let Y=V.getBarcodeColumnCount()+1;V.setDetectionResultColumn(0,O),V.setDetectionResultColumn(Y,L);let ae=O!=null;for(let ge=1;ge<=Y;ge++){let we=ae?ge:Y-ge;if(V.getDetectionResultColumn(we)!==void 0)continue;let Oe;we===0||we===Y?Oe=new qa(E,we===0):Oe=new Mi(E),V.setDetectionResultColumn(we,Oe);let Ue=-1,pt=Ue;for(let dt=E.getMinY();dt<=E.getMaxY();dt++){if(Ue=Cn.getStartColumn(V,we,dt,ae),Ue<0||Ue>E.getMaxX()){if(pt===-1)continue;Ue=pt}let v=Cn.detectCodeword(n,E.getMinX(),E.getMaxX(),ae,Ue,dt,g,w);v!=null&&(Oe.setCodeword(dt,v),pt=Ue,g=Math.min(g,v.getWidth()),w=Math.max(w,v.getWidth()))}}return Cn.createDecoderResult(V)}static merge(n,s){if(n==null&&s==null)return null;let l=Cn.getBarcodeMetadata(n,s);if(l==null)return null;let f=Ti.merge(Cn.adjustBoundingBox(n),Cn.adjustBoundingBox(s));return new Br(l,f)}static adjustBoundingBox(n){if(n==null)return null;let s=n.getRowHeights();if(s==null)return null;let l=Cn.getMax(s),f=0;for(let w of s)if(f+=l-w,w>0)break;let d=n.getCodewords();for(let w=0;f>0&&d[w]==null;w++)f--;let g=0;for(let w=s.length-1;w>=0&&(g+=l-s[w],!(s[w]>0));w--);for(let w=d.length-1;g>0&&d[w]==null;w--)g--;return n.getBoundingBox().addMissingRows(f,g,n.isLeft())}static getMax(n){let s=-1;for(let l of n)s=Math.max(s,l);return s}static getBarcodeMetadata(n,s){let l;if(n==null||(l=n.getBarcodeMetadata())==null)return s==null?null:s.getBarcodeMetadata();let f;return s==null||(f=s.getBarcodeMetadata())==null?l:l.getColumnCount()!==f.getColumnCount()&&l.getErrorCorrectionLevel()!==f.getErrorCorrectionLevel()&&l.getRowCount()!==f.getRowCount()?null:l}static getRowIndicatorColumn(n,s,l,f,d,g){let w=new qa(s,f);for(let E=0;E<2;E++){let O=E===0?1:-1,L=Math.trunc(Math.trunc(l.getX()));for(let V=Math.trunc(Math.trunc(l.getY()));V<=s.getMaxY()&&V>=s.getMinY();V+=O){let Y=Cn.detectCodeword(n,0,n.getWidth(),f,L,V,d,g);Y!=null&&(w.setCodeword(V,Y),f?L=Y.getStartX():L=Y.getEndX())}}return w}static adjustCodewordCount(n,s){let l=s[0][1],f=l.getValue(),d=n.getBarcodeColumnCount()*n.getBarcodeRowCount()-Cn.getNumberOfECCodeWords(n.getBarcodeECLevel());if(f.length===0){if(d<1||d>rn.MAX_CODEWORDS_IN_BARCODE)throw ve.getNotFoundInstance();l.setValue(d)}else f[0]!==d&&l.setValue(d)}static createDecoderResult(n){let s=Cn.createBarcodeMatrix(n);Cn.adjustCodewordCount(n,s);let l=new Array,f=new Int32Array(n.getBarcodeRowCount()*n.getBarcodeColumnCount()),d=[],g=new Array;for(let E=0;E<n.getBarcodeRowCount();E++)for(let O=0;O<n.getBarcodeColumnCount();O++){let L=s[E][O+1].getValue(),V=E*n.getBarcodeColumnCount()+O;L.length===0?l.push(V):L.length===1?f[V]=L[0]:(g.push(V),d.push(L))}let w=new Array(d.length);for(let E=0;E<w.length;E++)w[E]=d[E];return Cn.createDecoderResultFromAmbiguousValues(n.getBarcodeECLevel(),f,rn.toIntArray(l),rn.toIntArray(g),w)}static createDecoderResultFromAmbiguousValues(n,s,l,f,d){let g=new Int32Array(f.length),w=100;for(;w-- >0;){for(let E=0;E<g.length;E++)s[f[E]]=d[E][g[E]];try{return Cn.decodeCodewords(s,n,l)}catch(E){if(!(E instanceof N))throw E}if(g.length===0)throw N.getChecksumInstance();for(let E=0;E<g.length;E++)if(g[E]<d[E].length-1){g[E]++;break}else if(g[E]=0,E===g.length-1)throw N.getChecksumInstance()}throw N.getChecksumInstance()}static createBarcodeMatrix(n){let s=Array.from({length:n.getBarcodeRowCount()},()=>new Array(n.getBarcodeColumnCount()+2));for(let f=0;f<s.length;f++)for(let d=0;d<s[f].length;d++)s[f][d]=new Bi;let l=0;for(let f of n.getDetectionResultColumns()){if(f!=null){for(let d of f.getCodewords())if(d!=null){let g=d.getRowNumber();if(g>=0){if(g>=s.length)continue;s[g][l].setValue(d.getValue())}}}l++}return s}static isValidBarcodeColumn(n,s){return s>=0&&s<=n.getBarcodeColumnCount()+1}static getStartColumn(n,s,l,f){let d=f?1:-1,g=null;if(Cn.isValidBarcodeColumn(n,s-d)&&(g=n.getDetectionResultColumn(s-d).getCodeword(l)),g!=null)return f?g.getEndX():g.getStartX();if(g=n.getDetectionResultColumn(s).getCodewordNearby(l),g!=null)return f?g.getStartX():g.getEndX();if(Cn.isValidBarcodeColumn(n,s-d)&&(g=n.getDetectionResultColumn(s-d).getCodewordNearby(l)),g!=null)return f?g.getEndX():g.getStartX();let w=0;for(;Cn.isValidBarcodeColumn(n,s-d);){s-=d;for(let E of n.getDetectionResultColumn(s).getCodewords())if(E!=null)return(f?E.getEndX():E.getStartX())+d*w*(E.getEndX()-E.getStartX());w++}return f?n.getBoundingBox().getMinX():n.getBoundingBox().getMaxX()}static detectCodeword(n,s,l,f,d,g,w,E){d=Cn.adjustCodewordStartColumn(n,s,l,f,d,g);let O=Cn.getModuleBitCount(n,s,l,f,d,g);if(O==null)return null;let L,V=Qt.sum(O);if(f)L=d+V;else{for(let ge=0;ge<O.length/2;ge++){let we=O[ge];O[ge]=O[O.length-1-ge],O[O.length-1-ge]=we}L=d,d=L-V}if(!Cn.checkCodewordSkew(V,w,E))return null;let Y=Tr.getDecodedValue(O),ae=rn.getCodeword(Y);return ae===-1?null:new gi(d,L,Cn.getCodewordBucketNumber(Y),ae)}static getModuleBitCount(n,s,l,f,d,g){let w=d,E=new Int32Array(8),O=0,L=f?1:-1,V=f;for(;(f?w<l:w>=s)&&O<E.length;)n.get(w,g)===V?(E[O]++,w+=L):(O++,V=!V);return O===E.length||w===(f?l:s)&&O===E.length-1?E:null}static getNumberOfECCodeWords(n){return 2<<n}static adjustCodewordStartColumn(n,s,l,f,d,g){let w=d,E=f?-1:1;for(let O=0;O<2;O++){for(;(f?w>=s:w<l)&&f===n.get(w,g);){if(Math.abs(d-w)>Cn.CODEWORD_SKEW_SIZE)return d;w+=E}E=-E,f=!f}return w}static checkCodewordSkew(n,s,l){return s-Cn.CODEWORD_SKEW_SIZE<=n&&n<=l+Cn.CODEWORD_SKEW_SIZE}static decodeCodewords(n,s,l){if(n.length===0)throw ee.getFormatInstance();let f=1<<s+1,d=Cn.correctErrors(n,l,f);Cn.verifyCodewordCount(n,f);let g=Pe.decode(n,""+s);return g.setErrorsCorrected(d),g.setErasures(l.length),g}static correctErrors(n,s,l){if(s!=null&&s.length>l/2+Cn.MAX_ERRORS||l<0||l>Cn.MAX_EC_CODEWORDS)throw N.getChecksumInstance();return Cn.errorCorrection.decode(n,l,s)}static verifyCodewordCount(n,s){if(n.length<4)throw ee.getFormatInstance();let l=n[0];if(l>n.length)throw ee.getFormatInstance();if(l===0)if(s<n.length)n[0]=n.length-s;else throw ee.getFormatInstance()}static getBitCountForCodeword(n){let s=new Int32Array(8),l=0,f=s.length-1;for(;!((n&1)!==l&&(l=n&1,f--,f<0));)s[f]++,n>>=1;return s}static getCodewordBucketNumber(n){return n instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(n):this.getCodewordBucketNumber_number(n)}static getCodewordBucketNumber_number(n){return Cn.getCodewordBucketNumber(Cn.getBitCountForCodeword(n))}static getCodewordBucketNumber_Int32Array(n){return(n[0]-n[2]+n[4]-n[6]+9)%9}static toString(n){let s=new Si;for(let l=0;l<n.length;l++){s.format("Row %2d: ",l);for(let f=0;f<n[l].length;f++){let d=n[l][f];d.getValue().length===0?s.format("        ",null):s.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}s.format("%n")}return s.toString()}}Cn.CODEWORD_SKEW_SIZE=2,Cn.MAX_ERRORS=3,Cn.MAX_EC_CODEWORDS=512,Cn.errorCorrection=new li;class Nr{decode(n,s=null){let l=Nr.decode(n,s,!1);if(l==null||l.length===0||l[0]==null)throw ve.getNotFoundInstance();return l[0]}decodeMultiple(n,s=null){try{return Nr.decode(n,s,!0)}catch(l){throw l instanceof ee||l instanceof N?ve.getNotFoundInstance():l}}static decode(n,s,l){const f=new Array,d=pn.detectMultiple(n,s,l);for(const g of d.getPoints()){const w=Cn.decode(d.getBits(),g[4],g[5],g[6],g[7],Nr.getMinCodewordWidth(g),Nr.getMaxCodewordWidth(g)),E=new Le(w.getText(),w.getRawBytes(),void 0,g,Me.PDF_417);E.putMetadata(At.ERROR_CORRECTION_LEVEL,w.getECLevel());const O=w.getOther();O!=null&&E.putMetadata(At.PDF417_EXTRA_METADATA,O),f.push(E)}return f.map(g=>g)}static getMaxWidth(n,s){return n==null||s==null?0:Math.trunc(Math.abs(n.getX()-s.getX()))}static getMinWidth(n,s){return n==null||s==null?te.MAX_VALUE:Math.trunc(Math.abs(n.getX()-s.getX()))}static getMaxCodewordWidth(n){return Math.floor(Math.max(Math.max(Nr.getMaxWidth(n[0],n[4]),Nr.getMaxWidth(n[6],n[2])*rn.MODULES_IN_CODEWORD/rn.MODULES_IN_STOP_PATTERN),Math.max(Nr.getMaxWidth(n[1],n[5]),Nr.getMaxWidth(n[7],n[3])*rn.MODULES_IN_CODEWORD/rn.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(n){return Math.floor(Math.min(Math.min(Nr.getMinWidth(n[0],n[4]),Nr.getMinWidth(n[6],n[2])*rn.MODULES_IN_CODEWORD/rn.MODULES_IN_STOP_PATTERN),Math.min(Nr.getMinWidth(n[1],n[5]),Nr.getMinWidth(n[7],n[3])*rn.MODULES_IN_CODEWORD/rn.MODULES_IN_STOP_PATTERN)))}reset(){}}class Ia extends y{}Ia.kind="ReaderException";class Os{constructor(n,s){this.verbose=n===!0,s&&this.setHints(s)}decode(n,s){return s&&this.setHints(s),this.decodeInternal(n)}decodeWithState(n){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(n)}setHints(n){this.hints=n;const s=!o(n)&&n.get(ue.TRY_HARDER)===!0,l=o(n)?null:n.get(ue.POSSIBLE_FORMATS),f=new Array;if(!o(l)){const d=l.some(g=>g===Me.UPC_A||g===Me.UPC_E||g===Me.EAN_13||g===Me.EAN_8||g===Me.CODABAR||g===Me.CODE_39||g===Me.CODE_93||g===Me.CODE_128||g===Me.ITF||g===Me.RSS_14||g===Me.RSS_EXPANDED);d&&!s&&f.push(new _t(n,this.verbose)),l.includes(Me.QR_CODE)&&f.push(new pi),l.includes(Me.DATA_MATRIX)&&f.push(new en),l.includes(Me.AZTEC)&&f.push(new Wt),l.includes(Me.PDF_417)&&f.push(new Nr),d&&s&&f.push(new _t(n,this.verbose))}f.length===0&&(s||f.push(new _t(n,this.verbose)),f.push(new pi),f.push(new en),f.push(new Wt),f.push(new Nr),s&&f.push(new _t(n,this.verbose))),this.readers=f}reset(){if(this.readers!==null)for(const n of this.readers)n.reset()}decodeInternal(n){if(this.readers===null)throw new Ia("No readers where selected, nothing can be read.");for(const s of this.readers)try{return s.decode(n,this.hints)}catch(l){if(l instanceof Ia)continue}throw new ve("No MultiFormat Readers were able to detect the code.")}}class Ya extends De{constructor(n=null,s=500){const l=new Os;l.setHints(n),super(l,s)}decodeBitmap(n){return this.reader.decodeWithState(n)}}class Ds extends De{constructor(n=500){super(new Nr,n)}}class fa extends De{constructor(n=500){super(new pi,n)}}var Hi;(function(G){G[G.ERROR_CORRECTION=0]="ERROR_CORRECTION",G[G.CHARACTER_SET=1]="CHARACTER_SET",G[G.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",G[G.MIN_SIZE=3]="MIN_SIZE",G[G.MAX_SIZE=4]="MAX_SIZE",G[G.MARGIN=5]="MARGIN",G[G.PDF417_COMPACT=6]="PDF417_COMPACT",G[G.PDF417_COMPACTION=7]="PDF417_COMPACTION",G[G.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",G[G.AZTEC_LAYERS=9]="AZTEC_LAYERS",G[G.QR_VERSION=10]="QR_VERSION"})(Hi||(Hi={}));var Sr=Hi;class da{constructor(n){this.field=n,this.cachedGenerators=[],this.cachedGenerators.push(new ht(n,Int32Array.from([1])))}buildGenerator(n){const s=this.cachedGenerators;if(n>=s.length){let l=s[s.length-1];const f=this.field;for(let d=s.length;d<=n;d++){const g=l.multiply(new ht(f,Int32Array.from([1,f.exp(d-1+f.getGeneratorBase())])));s.push(g),l=g}}return s[n]}encode(n,s){if(s===0)throw new R("No error correction bytes");const l=n.length-s;if(l<=0)throw new R("No data bytes provided");const f=this.buildGenerator(s),d=new Int32Array(l);z.arraycopy(n,0,d,0,l);let g=new ht(this.field,d);g=g.multiplyByMonomial(s,1);const E=g.divide(f)[1].getCoefficients(),O=s-E.length;for(let L=0;L<O;L++)n[l+L]=0;z.arraycopy(E,0,n,l+O,E.length)}}class mr{constructor(){}static applyMaskPenaltyRule1(n){return mr.applyMaskPenaltyRule1Internal(n,!0)+mr.applyMaskPenaltyRule1Internal(n,!1)}static applyMaskPenaltyRule2(n){let s=0;const l=n.getArray(),f=n.getWidth(),d=n.getHeight();for(let g=0;g<d-1;g++){const w=l[g];for(let E=0;E<f-1;E++){const O=w[E];O===w[E+1]&&O===l[g+1][E]&&O===l[g+1][E+1]&&s++}}return mr.N2*s}static applyMaskPenaltyRule3(n){let s=0;const l=n.getArray(),f=n.getWidth(),d=n.getHeight();for(let g=0;g<d;g++)for(let w=0;w<f;w++){const E=l[g];w+6<f&&E[w]===1&&E[w+1]===0&&E[w+2]===1&&E[w+3]===1&&E[w+4]===1&&E[w+5]===0&&E[w+6]===1&&(mr.isWhiteHorizontal(E,w-4,w)||mr.isWhiteHorizontal(E,w+7,w+11))&&s++,g+6<d&&l[g][w]===1&&l[g+1][w]===0&&l[g+2][w]===1&&l[g+3][w]===1&&l[g+4][w]===1&&l[g+5][w]===0&&l[g+6][w]===1&&(mr.isWhiteVertical(l,w,g-4,g)||mr.isWhiteVertical(l,w,g+7,g+11))&&s++}return s*mr.N3}static isWhiteHorizontal(n,s,l){s=Math.max(s,0),l=Math.min(l,n.length);for(let f=s;f<l;f++)if(n[f]===1)return!1;return!0}static isWhiteVertical(n,s,l,f){l=Math.max(l,0),f=Math.min(f,n.length);for(let d=l;d<f;d++)if(n[d][s]===1)return!1;return!0}static applyMaskPenaltyRule4(n){let s=0;const l=n.getArray(),f=n.getWidth(),d=n.getHeight();for(let E=0;E<d;E++){const O=l[E];for(let L=0;L<f;L++)O[L]===1&&s++}const g=n.getHeight()*n.getWidth();return Math.floor(Math.abs(s*2-g)*10/g)*mr.N4}static getDataMaskBit(n,s,l){let f,d;switch(n){case 0:f=l+s&1;break;case 1:f=l&1;break;case 2:f=s%3;break;case 3:f=(l+s)%3;break;case 4:f=Math.floor(l/2)+Math.floor(s/3)&1;break;case 5:d=l*s,f=(d&1)+d%3;break;case 6:d=l*s,f=(d&1)+d%3&1;break;case 7:d=l*s,f=d%3+(l+s&1)&1;break;default:throw new R("Invalid mask pattern: "+n)}return f===0}static applyMaskPenaltyRule1Internal(n,s){let l=0;const f=s?n.getHeight():n.getWidth(),d=s?n.getWidth():n.getHeight(),g=n.getArray();for(let w=0;w<f;w++){let E=0,O=-1;for(let L=0;L<d;L++){const V=s?g[w][L]:g[L][w];V===O?E++:(E>=5&&(l+=mr.N1+(E-5)),E=1,O=V)}E>=5&&(l+=mr.N1+(E-5))}return l}}mr.N1=3,mr.N2=3,mr.N3=40,mr.N4=10;class Wa{constructor(n,s){this.width=n,this.height=s;const l=new Array(s);for(let f=0;f!==s;f++)l[f]=new Uint8Array(n);this.bytes=l}getHeight(){return this.height}getWidth(){return this.width}get(n,s){return this.bytes[s][n]}getArray(){return this.bytes}setNumber(n,s,l){this.bytes[s][n]=l}setBoolean(n,s,l){this.bytes[s][n]=l?1:0}clear(n){for(const s of this.bytes)F.fill(s,n)}equals(n){if(!(n instanceof Wa))return!1;const s=n;if(this.width!==s.width||this.height!==s.height)return!1;for(let l=0,f=this.height;l<f;++l){const d=this.bytes[l],g=s.bytes[l];for(let w=0,E=this.width;w<E;++w)if(d[w]!==g[w])return!1}return!0}toString(){const n=new at;for(let s=0,l=this.height;s<l;++s){const f=this.bytes[s];for(let d=0,g=this.width;d<g;++d)switch(f[d]){case 0:n.append(" 0");break;case 1:n.append(" 1");break;default:n.append("  ");break}n.append(`
`)}return n.toString()}}class Yi{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const n=new at;return n.append(`<<
`),n.append(" mode: "),n.append(this.mode?this.mode.toString():"null"),n.append(`
 ecLevel: `),n.append(this.ecLevel?this.ecLevel.toString():"null"),n.append(`
 version: `),n.append(this.version?this.version.toString():"null"),n.append(`
 maskPattern: `),n.append(this.maskPattern.toString()),this.matrix?(n.append(`
 matrix:
`),n.append(this.matrix.toString())):n.append(`
 matrix: null
`),n.append(`>>
`),n.toString()}setMode(n){this.mode=n}setECLevel(n){this.ecLevel=n}setVersion(n){this.version=n}setMaskPattern(n){this.maskPattern=n}setMatrix(n){this.matrix=n}static isValidMaskPattern(n){return n>=0&&n<Yi.NUM_MASK_PATTERNS}}Yi.NUM_MASK_PATTERNS=8;class qn extends y{}qn.kind="WriterException";class sn{constructor(){}static clearMatrix(n){n.clear(255)}static buildMatrix(n,s,l,f,d){sn.clearMatrix(d),sn.embedBasicPatterns(l,d),sn.embedTypeInfo(s,f,d),sn.maybeEmbedVersionInfo(l,d),sn.embedDataBits(n,f,d)}static embedBasicPatterns(n,s){sn.embedPositionDetectionPatternsAndSeparators(s),sn.embedDarkDotAtLeftBottomCorner(s),sn.maybeEmbedPositionAdjustmentPatterns(n,s),sn.embedTimingPatterns(s)}static embedTypeInfo(n,s,l){const f=new Q;sn.makeTypeInfoBits(n,s,f);for(let d=0,g=f.getSize();d<g;++d){const w=f.get(f.getSize()-1-d),E=sn.TYPE_INFO_COORDINATES[d],O=E[0],L=E[1];if(l.setBoolean(O,L,w),d<8){const V=l.getWidth()-d-1;l.setBoolean(V,8,w)}else{const Y=l.getHeight()-7+(d-8);l.setBoolean(8,Y,w)}}}static maybeEmbedVersionInfo(n,s){if(n.getVersionNumber()<7)return;const l=new Q;sn.makeVersionInfoBits(n,l);let f=17;for(let d=0;d<6;++d)for(let g=0;g<3;++g){const w=l.get(f);f--,s.setBoolean(d,s.getHeight()-11+g,w),s.setBoolean(s.getHeight()-11+g,d,w)}}static embedDataBits(n,s,l){let f=0,d=-1,g=l.getWidth()-1,w=l.getHeight()-1;for(;g>0;){for(g===6&&(g-=1);w>=0&&w<l.getHeight();){for(let E=0;E<2;++E){const O=g-E;if(!sn.isEmpty(l.get(O,w)))continue;let L;f<n.getSize()?(L=n.get(f),++f):L=!1,s!==255&&mr.getDataMaskBit(s,O,w)&&(L=!L),l.setBoolean(O,w,L)}w+=d}d=-d,w+=d,g-=2}if(f!==n.getSize())throw new qn("Not all bits consumed: "+f+"/"+n.getSize())}static findMSBSet(n){return 32-te.numberOfLeadingZeros(n)}static calculateBCHCode(n,s){if(s===0)throw new R("0 polynomial");const l=sn.findMSBSet(s);for(n<<=l-1;sn.findMSBSet(n)>=l;)n^=s<<sn.findMSBSet(n)-l;return n}static makeTypeInfoBits(n,s,l){if(!Yi.isValidMaskPattern(s))throw new qn("Invalid mask pattern");const f=n.getBits()<<3|s;l.appendBits(f,5);const d=sn.calculateBCHCode(f,sn.TYPE_INFO_POLY);l.appendBits(d,10);const g=new Q;if(g.appendBits(sn.TYPE_INFO_MASK_PATTERN,15),l.xor(g),l.getSize()!==15)throw new qn("should not happen but we got: "+l.getSize())}static makeVersionInfoBits(n,s){s.appendBits(n.getVersionNumber(),6);const l=sn.calculateBCHCode(n.getVersionNumber(),sn.VERSION_INFO_POLY);if(s.appendBits(l,12),s.getSize()!==18)throw new qn("should not happen but we got: "+s.getSize())}static isEmpty(n){return n===255}static embedTimingPatterns(n){for(let s=8;s<n.getWidth()-8;++s){const l=(s+1)%2;sn.isEmpty(n.get(s,6))&&n.setNumber(s,6,l),sn.isEmpty(n.get(6,s))&&n.setNumber(6,s,l)}}static embedDarkDotAtLeftBottomCorner(n){if(n.get(8,n.getHeight()-8)===0)throw new qn;n.setNumber(8,n.getHeight()-8,1)}static embedHorizontalSeparationPattern(n,s,l){for(let f=0;f<8;++f){if(!sn.isEmpty(l.get(n+f,s)))throw new qn;l.setNumber(n+f,s,0)}}static embedVerticalSeparationPattern(n,s,l){for(let f=0;f<7;++f){if(!sn.isEmpty(l.get(n,s+f)))throw new qn;l.setNumber(n,s+f,0)}}static embedPositionAdjustmentPattern(n,s,l){for(let f=0;f<5;++f){const d=sn.POSITION_ADJUSTMENT_PATTERN[f];for(let g=0;g<5;++g)l.setNumber(n+g,s+f,d[g])}}static embedPositionDetectionPattern(n,s,l){for(let f=0;f<7;++f){const d=sn.POSITION_DETECTION_PATTERN[f];for(let g=0;g<7;++g)l.setNumber(n+g,s+f,d[g])}}static embedPositionDetectionPatternsAndSeparators(n){const s=sn.POSITION_DETECTION_PATTERN[0].length;sn.embedPositionDetectionPattern(0,0,n),sn.embedPositionDetectionPattern(n.getWidth()-s,0,n),sn.embedPositionDetectionPattern(0,n.getWidth()-s,n);const l=8;sn.embedHorizontalSeparationPattern(0,l-1,n),sn.embedHorizontalSeparationPattern(n.getWidth()-l,l-1,n),sn.embedHorizontalSeparationPattern(0,n.getWidth()-l,n);const f=7;sn.embedVerticalSeparationPattern(f,0,n),sn.embedVerticalSeparationPattern(n.getHeight()-f-1,0,n),sn.embedVerticalSeparationPattern(f,n.getHeight()-f,n)}static maybeEmbedPositionAdjustmentPatterns(n,s){if(n.getVersionNumber()<2)return;const l=n.getVersionNumber()-1,f=sn.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[l];for(let d=0,g=f.length;d!==g;d++){const w=f[d];if(w>=0)for(let E=0;E!==g;E++){const O=f[E];O>=0&&sn.isEmpty(s.get(O,w))&&sn.embedPositionAdjustmentPattern(O-2,w-2,s)}}}}sn.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),sn.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),sn.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),sn.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),sn.VERSION_INFO_POLY=7973,sn.TYPE_INFO_POLY=1335,sn.TYPE_INFO_MASK_PATTERN=21522;class Ms{constructor(n,s){this.dataBytes=n,this.errorCorrectionBytes=s}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class $n{constructor(){}static calculateMaskPenalty(n){return mr.applyMaskPenaltyRule1(n)+mr.applyMaskPenaltyRule2(n)+mr.applyMaskPenaltyRule3(n)+mr.applyMaskPenaltyRule4(n)}static encode(n,s,l=null){let f=$n.DEFAULT_BYTE_MODE_ENCODING;const d=l!==null&&l.get(Sr.CHARACTER_SET)!==void 0;d&&(f=l.get(Sr.CHARACTER_SET).toString());const g=this.chooseMode(n,f),w=new Q;if(g===Et.BYTE&&(d||$n.DEFAULT_BYTE_MODE_ENCODING!==f)){const dt=le.getCharacterSetECIByName(f);dt!==void 0&&this.appendECI(dt,w)}this.appendModeInfo(g,w);const E=new Q;this.appendBytes(n,g,E,f);let O;if(l!==null&&l.get(Sr.QR_VERSION)!==void 0){const dt=Number.parseInt(l.get(Sr.QR_VERSION).toString(),10);O=ot.getVersionForNumber(dt);const v=this.calculateBitsNeeded(g,w,E,O);if(!this.willFit(v,O,s))throw new qn("Data too big for requested version")}else O=this.recommendVersion(s,g,w,E);const L=new Q;L.appendBitArray(w);const V=g===Et.BYTE?E.getSizeInBytes():n.length;this.appendLengthInfo(V,O,g,L),L.appendBitArray(E);const Y=O.getECBlocksForLevel(s),ae=O.getTotalCodewords()-Y.getTotalECCodewords();this.terminateBits(ae,L);const ge=this.interleaveWithECBytes(L,O.getTotalCodewords(),ae,Y.getNumBlocks()),we=new Yi;we.setECLevel(s),we.setMode(g),we.setVersion(O);const Oe=O.getDimensionForVersion(),Ue=new Wa(Oe,Oe),pt=this.chooseMaskPattern(ge,s,O,Ue);return we.setMaskPattern(pt),sn.buildMatrix(ge,s,O,pt,Ue),we.setMatrix(Ue),we}static recommendVersion(n,s,l,f){const d=this.calculateBitsNeeded(s,l,f,ot.getVersionForNumber(1)),g=this.chooseVersion(d,n),w=this.calculateBitsNeeded(s,l,f,g);return this.chooseVersion(w,n)}static calculateBitsNeeded(n,s,l,f){return s.getSize()+n.getCharacterCountBits(f)+l.getSize()}static getAlphanumericCode(n){return n<$n.ALPHANUMERIC_TABLE.length?$n.ALPHANUMERIC_TABLE[n]:-1}static chooseMode(n,s=null){if(le.SJIS.getName()===s&&this.isOnlyDoubleByteKanji(n))return Et.KANJI;let l=!1,f=!1;for(let d=0,g=n.length;d<g;++d){const w=n.charAt(d);if($n.isDigit(w))l=!0;else if(this.getAlphanumericCode(w.charCodeAt(0))!==-1)f=!0;else return Et.BYTE}return f?Et.ALPHANUMERIC:l?Et.NUMERIC:Et.BYTE}static isOnlyDoubleByteKanji(n){let s;try{s=Je.encode(n,le.SJIS)}catch{return!1}const l=s.length;if(l%2!==0)return!1;for(let f=0;f<l;f+=2){const d=s[f]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(n,s,l,f){let d=Number.MAX_SAFE_INTEGER,g=-1;for(let w=0;w<Yi.NUM_MASK_PATTERNS;w++){sn.buildMatrix(n,s,l,w,f);let E=this.calculateMaskPenalty(f);E<d&&(d=E,g=w)}return g}static chooseVersion(n,s){for(let l=1;l<=40;l++){const f=ot.getVersionForNumber(l);if($n.willFit(n,f,s))return f}throw new qn("Data too big")}static willFit(n,s,l){const f=s.getTotalCodewords(),g=s.getECBlocksForLevel(l).getTotalECCodewords(),w=f-g,E=(n+7)/8;return w>=E}static terminateBits(n,s){const l=n*8;if(s.getSize()>l)throw new qn("data bits cannot fit in the QR Code"+s.getSize()+" > "+l);for(let g=0;g<4&&s.getSize()<l;++g)s.appendBit(!1);const f=s.getSize()&7;if(f>0)for(let g=f;g<8;g++)s.appendBit(!1);const d=n-s.getSizeInBytes();for(let g=0;g<d;++g)s.appendBits((g&1)===0?236:17,8);if(s.getSize()!==l)throw new qn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(n,s,l,f,d,g){if(f>=l)throw new qn("Block ID too large");const w=n%l,E=l-w,O=Math.floor(n/l),L=O+1,V=Math.floor(s/l),Y=V+1,ae=O-V,ge=L-Y;if(ae!==ge)throw new qn("EC bytes mismatch");if(l!==E+w)throw new qn("RS blocks mismatch");if(n!==(V+ae)*E+(Y+ge)*w)throw new qn("Total bytes mismatch");f<E?(d[0]=V,g[0]=ae):(d[0]=Y,g[0]=ge)}static interleaveWithECBytes(n,s,l,f){if(n.getSizeInBytes()!==l)throw new qn("Number of bits and data bytes does not match");let d=0,g=0,w=0;const E=new Array;for(let L=0;L<f;++L){const V=new Int32Array(1),Y=new Int32Array(1);$n.getNumDataBytesAndNumECBytesForBlockID(s,l,f,L,V,Y);const ae=V[0],ge=new Uint8Array(ae);n.toBytes(8*d,ge,0,ae);const we=$n.generateECBytes(ge,Y[0]);E.push(new Ms(ge,we)),g=Math.max(g,ae),w=Math.max(w,we.length),d+=V[0]}if(l!==d)throw new qn("Data bytes does not match offset");const O=new Q;for(let L=0;L<g;++L)for(const V of E){const Y=V.getDataBytes();L<Y.length&&O.appendBits(Y[L],8)}for(let L=0;L<w;++L)for(const V of E){const Y=V.getErrorCorrectionBytes();L<Y.length&&O.appendBits(Y[L],8)}if(s!==O.getSizeInBytes())throw new qn("Interleaving error: "+s+" and "+O.getSizeInBytes()+" differ.");return O}static generateECBytes(n,s){const l=n.length,f=new Int32Array(l+s);for(let g=0;g<l;g++)f[g]=n[g]&255;new da(qt.QR_CODE_FIELD_256).encode(f,s);const d=new Uint8Array(s);for(let g=0;g<s;g++)d[g]=f[l+g];return d}static appendModeInfo(n,s){s.appendBits(n.getBits(),4)}static appendLengthInfo(n,s,l,f){const d=l.getCharacterCountBits(s);if(n>=1<<d)throw new qn(n+" is bigger than "+((1<<d)-1));f.appendBits(n,d)}static appendBytes(n,s,l,f){switch(s){case Et.NUMERIC:$n.appendNumericBytes(n,l);break;case Et.ALPHANUMERIC:$n.appendAlphanumericBytes(n,l);break;case Et.BYTE:$n.append8BitBytes(n,l,f);break;case Et.KANJI:$n.appendKanjiBytes(n,l);break;default:throw new qn("Invalid mode: "+s)}}static getDigit(n){return n.charCodeAt(0)-48}static isDigit(n){const s=$n.getDigit(n);return s>=0&&s<=9}static appendNumericBytes(n,s){const l=n.length;let f=0;for(;f<l;){const d=$n.getDigit(n.charAt(f));if(f+2<l){const g=$n.getDigit(n.charAt(f+1)),w=$n.getDigit(n.charAt(f+2));s.appendBits(d*100+g*10+w,10),f+=3}else if(f+1<l){const g=$n.getDigit(n.charAt(f+1));s.appendBits(d*10+g,7),f+=2}else s.appendBits(d,4),f++}}static appendAlphanumericBytes(n,s){const l=n.length;let f=0;for(;f<l;){const d=$n.getAlphanumericCode(n.charCodeAt(f));if(d===-1)throw new qn;if(f+1<l){const g=$n.getAlphanumericCode(n.charCodeAt(f+1));if(g===-1)throw new qn;s.appendBits(d*45+g,11),f+=2}else s.appendBits(d,6),f++}}static append8BitBytes(n,s,l){let f;try{f=Je.encode(n,l)}catch(d){throw new qn(d)}for(let d=0,g=f.length;d!==g;d++){const w=f[d];s.appendBits(w,8)}}static appendKanjiBytes(n,s){let l;try{l=Je.encode(n,le.SJIS)}catch(d){throw new qn(d)}const f=l.length;for(let d=0;d<f;d+=2){const g=l[d]&255,w=l[d+1]&255,E=g<<8&4294967295|w;let O=-1;if(E>=33088&&E<=40956?O=E-33088:E>=57408&&E<=60351&&(O=E-49472),O===-1)throw new qn("Invalid byte sequence");const L=(O>>8)*192+(O&255);s.appendBits(L,13)}}static appendECI(n,s){s.appendBits(Et.ECI.getBits(),4),s.appendBits(n.getValue(),8)}}$n.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),$n.DEFAULT_BYTE_MODE_ENCODING=le.UTF8.getName();class Ii{write(n,s,l,f=null){if(n.length===0)throw new R("Found empty contents");if(s<0||l<0)throw new R("Requested dimensions are too small: "+s+"x"+l);let d=Dt.L,g=Ii.QUIET_ZONE_SIZE;f!==null&&(f.get(Sr.ERROR_CORRECTION)!==void 0&&(d=Dt.fromString(f.get(Sr.ERROR_CORRECTION).toString())),f.get(Sr.MARGIN)!==void 0&&(g=Number.parseInt(f.get(Sr.MARGIN).toString(),10)));const w=$n.encode(n,d,f);return this.renderResult(w,s,l,g)}writeToDom(n,s,l,f,d=null){typeof n=="string"&&(n=document.querySelector(n));const g=this.write(s,l,f,d);n&&n.appendChild(g)}renderResult(n,s,l,f){const d=n.getMatrix();if(d===null)throw new Zn;const g=d.getWidth(),w=d.getHeight(),E=g+f*2,O=w+f*2,L=Math.max(s,E),V=Math.max(l,O),Y=Math.min(Math.floor(L/E),Math.floor(V/O)),ae=Math.floor((L-g*Y)/2),ge=Math.floor((V-w*Y)/2),we=this.createSVGElement(L,V);for(let Oe=0,Ue=ge;Oe<w;Oe++,Ue+=Y)for(let pt=0,dt=ae;pt<g;pt++,dt+=Y)if(d.get(pt,Oe)===1){const v=this.createSvgRectElement(dt,Ue,Y,Y);we.appendChild(v)}return we}createSVGElement(n,s){const l=document.createElementNS(Ii.SVG_NS,"svg");return l.setAttributeNS(null,"height",n.toString()),l.setAttributeNS(null,"width",s.toString()),l}createSvgRectElement(n,s,l,f){const d=document.createElementNS(Ii.SVG_NS,"rect");return d.setAttributeNS(null,"x",n.toString()),d.setAttributeNS(null,"y",s.toString()),d.setAttributeNS(null,"height",l.toString()),d.setAttributeNS(null,"width",f.toString()),d.setAttributeNS(null,"fill","#000000"),d}}Ii.QUIET_ZONE_SIZE=4,Ii.SVG_NS="http://www.w3.org/2000/svg";class Wi{encode(n,s,l,f,d){if(n.length===0)throw new R("Found empty contents");if(s!==Me.QR_CODE)throw new R("Can only encode QR_CODE, but got "+s);if(l<0||f<0)throw new R(`Requested dimensions are too small: ${l}x${f}`);let g=Dt.L,w=Wi.QUIET_ZONE_SIZE;d!==null&&(d.get(Sr.ERROR_CORRECTION)!==void 0&&(g=Dt.fromString(d.get(Sr.ERROR_CORRECTION).toString())),d.get(Sr.MARGIN)!==void 0&&(w=Number.parseInt(d.get(Sr.MARGIN).toString(),10)));const E=$n.encode(n,g,d);return Wi.renderResult(E,l,f,w)}static renderResult(n,s,l,f){const d=n.getMatrix();if(d===null)throw new Zn;const g=d.getWidth(),w=d.getHeight(),E=g+f*2,O=w+f*2,L=Math.max(s,E),V=Math.max(l,O),Y=Math.min(Math.floor(L/E),Math.floor(V/O)),ae=Math.floor((L-g*Y)/2),ge=Math.floor((V-w*Y)/2),we=new et(L,V);for(let Oe=0,Ue=ge;Oe<w;Oe++,Ue+=Y)for(let pt=0,dt=ae;pt<g;pt++,dt+=Y)d.get(pt,Oe)===1&&we.setRegion(dt,Ue,Y,Y);return we}}Wi.QUIET_ZONE_SIZE=4;class Rn{encode(n,s,l,f,d){let g;if(s===Me.QR_CODE)g=new Wi;else throw new R("No encoder available for format "+s);return g.encode(n,s,l,f,d)}}class mi extends Ge{constructor(n,s,l,f,d,g,w,E){if(super(g,w),this.yuvData=n,this.dataWidth=s,this.dataHeight=l,this.left=f,this.top=d,f+g>s||d+w>l)throw new R("Crop rectangle does not fit within image data.");E&&this.reverseHorizontal(g,w)}getRow(n,s){if(n<0||n>=this.getHeight())throw new R("Requested row is outside the image: "+n);const l=this.getWidth();(s==null||s.length<l)&&(s=new Uint8ClampedArray(l));const f=(n+this.top)*this.dataWidth+this.left;return z.arraycopy(this.yuvData,f,s,0,l),s}getMatrix(){const n=this.getWidth(),s=this.getHeight();if(n===this.dataWidth&&s===this.dataHeight)return this.yuvData;const l=n*s,f=new Uint8ClampedArray(l);let d=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return z.arraycopy(this.yuvData,d,f,0,l),f;for(let g=0;g<s;g++){const w=g*n;z.arraycopy(this.yuvData,d,f,w,n),d+=this.dataWidth}return f}isCropSupported(){return!0}crop(n,s,l,f){return new mi(this.yuvData,this.dataWidth,this.dataHeight,this.left+n,this.top+s,l,f,!1)}renderThumbnail(){const n=this.getWidth()/mi.THUMBNAIL_SCALE_FACTOR,s=this.getHeight()/mi.THUMBNAIL_SCALE_FACTOR,l=new Int32Array(n*s),f=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let g=0;g<s;g++){const w=g*n;for(let E=0;E<n;E++){const O=f[d+E*mi.THUMBNAIL_SCALE_FACTOR]&255;l[w+E]=4278190080|O*65793}d+=this.dataWidth*mi.THUMBNAIL_SCALE_FACTOR}return l}getThumbnailWidth(){return this.getWidth()/mi.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/mi.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(n,s){const l=this.yuvData;for(let f=0,d=this.top*this.dataWidth+this.left;f<s;f++,d+=this.dataWidth){const g=d+n/2;for(let w=d,E=d+n-1;w<g;w++,E--){const O=l[w];l[w]=l[E],l[E]=O}}}invert(){return new qe(this)}}mi.THUMBNAIL_SCALE_FACTOR=2;class Ka extends Ge{constructor(n,s,l,f,d,g,w){if(super(s,l),this.dataWidth=f,this.dataHeight=d,this.left=g,this.top=w,n.BYTES_PER_ELEMENT===4){const E=s*l,O=new Uint8ClampedArray(E);for(let L=0;L<E;L++){const V=n[L],Y=V>>16&255,ae=V>>7&510,ge=V&255;O[L]=(Y+ae+ge)/4&255}this.luminances=O}else this.luminances=n;if(f===void 0&&(this.dataWidth=s),d===void 0&&(this.dataHeight=l),g===void 0&&(this.left=0),w===void 0&&(this.top=0),this.left+s>this.dataWidth||this.top+l>this.dataHeight)throw new R("Crop rectangle does not fit within image data.")}getRow(n,s){if(n<0||n>=this.getHeight())throw new R("Requested row is outside the image: "+n);const l=this.getWidth();(s==null||s.length<l)&&(s=new Uint8ClampedArray(l));const f=(n+this.top)*this.dataWidth+this.left;return z.arraycopy(this.luminances,f,s,0,l),s}getMatrix(){const n=this.getWidth(),s=this.getHeight();if(n===this.dataWidth&&s===this.dataHeight)return this.luminances;const l=n*s,f=new Uint8ClampedArray(l);let d=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return z.arraycopy(this.luminances,d,f,0,l),f;for(let g=0;g<s;g++){const w=g*n;z.arraycopy(this.luminances,d,f,w,n),d+=this.dataWidth}return f}isCropSupported(){return!0}crop(n,s,l,f){return new Ka(this.luminances,l,f,this.dataWidth,this.dataHeight,this.left+n,this.top+s)}invert(){return new qe(this)}}class ls extends le{static forName(n){return this.getCharacterSetECIByName(n)}}class ha{}ha.ISO_8859_1=le.ISO8859_1;class _i{isCompact(){return this.compact}setCompact(n){this.compact=n}getSize(){return this.size}setSize(n){this.size=n}getLayers(){return this.layers}setLayers(n){this.layers=n}getCodeWords(){return this.codeWords}setCodeWords(n){this.codeWords=n}getMatrix(){return this.matrix}setMatrix(n){this.matrix=n}}class Ki{static singletonList(n){return[n]}static min(n,s){return n.sort(s)[0]}}class Qa{constructor(n){this.previous=n}getPrevious(){return this.previous}}class ki extends Qa{constructor(n,s,l){super(n),this.value=s,this.bitCount=l}appendTo(n,s){n.appendBits(this.value,this.bitCount)}add(n,s){return new ki(this,n,s)}addBinaryShift(n,s){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new ki(this,n,s)}toString(){let n=this.value&(1<<this.bitCount)-1;return n|=1<<this.bitCount,"<"+te.toBinaryString(n|1<<this.bitCount).substring(1)+">"}}class Qi extends ki{constructor(n,s,l){super(n,0,0),this.binaryShiftStart=s,this.binaryShiftByteCount=l}appendTo(n,s){for(let l=0;l<this.binaryShiftByteCount;l++)(l===0||l===31&&this.binaryShiftByteCount<=62)&&(n.appendBits(31,5),this.binaryShiftByteCount>62?n.appendBits(this.binaryShiftByteCount-31,16):l===0?n.appendBits(Math.min(this.binaryShiftByteCount,31),5):n.appendBits(this.binaryShiftByteCount-31,5)),n.appendBits(s[this.binaryShiftStart+l],8)}addBinaryShift(n,s){return new Qi(this,n,s)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Ra(G,n,s){return new Qi(G,n,s)}function $i(G,n,s){return new ki(G,n,s)}const Xi=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Ri=0,Oa=1,ni=2,Xa=3,ui=4,Da=new ki(null,0,0),Li=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Bs(G){for(let n of G)F.fill(n,-1);return G[Ri][ui]=0,G[Oa][ui]=0,G[Oa][Ri]=28,G[Xa][ui]=0,G[ni][ui]=0,G[ni][Ri]=15,G}const zi=Bs(F.createInt32Array(6,6));class xi{constructor(n,s,l,f){this.token=n,this.mode=s,this.binaryShiftByteCount=l,this.bitCount=f}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(n,s){let l=this.bitCount,f=this.token;if(n!==this.mode){let g=Li[this.mode][n];f=$i(f,g&65535,g>>16),l+=g>>16}let d=n===ni?4:5;return f=$i(f,s,d),new xi(f,n,0,l+d)}shiftAndAppend(n,s){let l=this.token,f=this.mode===ni?4:5;return l=$i(l,zi[this.mode][n],f),l=$i(l,s,5),new xi(l,this.mode,0,this.bitCount+f+5)}addBinaryShiftChar(n){let s=this.token,l=this.mode,f=this.bitCount;if(this.mode===ui||this.mode===ni){let w=Li[l][Ri];s=$i(s,w&65535,w>>16),f+=w>>16,l=Ri}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,g=new xi(s,l,this.binaryShiftByteCount+1,f+d);return g.binaryShiftByteCount===2078&&(g=g.endBinaryShift(n+1)),g}endBinaryShift(n){if(this.binaryShiftByteCount===0)return this;let s=this.token;return s=Ra(s,n-this.binaryShiftByteCount,this.binaryShiftByteCount),new xi(s,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(n){let s=this.bitCount+(Li[this.mode][n.mode]>>16);return this.binaryShiftByteCount<n.binaryShiftByteCount?s+=xi.calculateBinaryShiftCost(n)-xi.calculateBinaryShiftCost(this):this.binaryShiftByteCount>n.binaryShiftByteCount&&n.binaryShiftByteCount>0&&(s+=10),s<=n.bitCount}toBitArray(n){let s=[];for(let f=this.endBinaryShift(n.length).token;f!==null;f=f.getPrevious())s.unshift(f);let l=new Q;for(const f of s)f.appendTo(l,n);return l}toString(){return ke.format("%s bits=%d bytes=%d",Xi[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(n){return n.binaryShiftByteCount>62?21:n.binaryShiftByteCount>31?20:n.binaryShiftByteCount>0?10:0}}xi.INITIAL_STATE=new xi(Da,Ri,0,0);function Za(G){const n=ke.getCharCode(" "),s=ke.getCharCode("."),l=ke.getCharCode(",");G[Ri][n]=1;const f=ke.getCharCode("Z"),d=ke.getCharCode("A");for(let Y=d;Y<=f;Y++)G[Ri][Y]=Y-d+2;G[Oa][n]=1;const g=ke.getCharCode("z"),w=ke.getCharCode("a");for(let Y=w;Y<=g;Y++)G[Oa][Y]=Y-w+2;G[ni][n]=1;const E=ke.getCharCode("9"),O=ke.getCharCode("0");for(let Y=O;Y<=E;Y++)G[ni][Y]=Y-O+2;G[ni][l]=12,G[ni][s]=13;const L=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let Y=0;Y<L.length;Y++)G[Xa][ke.getCharCode(L[Y])]=Y;const V=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let Y=0;Y<V.length;Y++)ke.getCharCode(V[Y])>0&&(G[ui][ke.getCharCode(V[Y])]=Y);return G}const Ma=Za(F.createInt32Array(5,256));class Zi{constructor(n){this.text=n}encode(){const n=ke.getCharCode(" "),s=ke.getCharCode(`
`);let l=Ki.singletonList(xi.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let g,w=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case ke.getCharCode("\r"):g=w===s?2:0;break;case ke.getCharCode("."):g=w===n?3:0;break;case ke.getCharCode(","):g=w===n?4:0;break;case ke.getCharCode(":"):g=w===n?5:0;break;default:g=0}g>0?(l=Zi.updateStateListForPair(l,d,g),d++):l=this.updateStateListForChar(l,d)}return Ki.min(l,(d,g)=>d.getBitCount()-g.getBitCount()).toBitArray(this.text)}updateStateListForChar(n,s){const l=[];for(let f of n)this.updateStateForChar(f,s,l);return Zi.simplifyStates(l)}updateStateForChar(n,s,l){let f=this.text[s]&255,d=Ma[n.getMode()][f]>0,g=null;for(let w=0;w<=ui;w++){let E=Ma[w][f];if(E>0){if(g==null&&(g=n.endBinaryShift(s)),!d||w===n.getMode()||w===ni){const O=g.latchAndAppend(w,E);l.push(O)}if(!d&&zi[n.getMode()][w]>=0){const O=g.shiftAndAppend(w,E);l.push(O)}}}if(n.getBinaryShiftByteCount()>0||Ma[n.getMode()][f]===0){let w=n.addBinaryShiftChar(s);l.push(w)}}static updateStateListForPair(n,s,l){const f=[];for(let d of n)this.updateStateForPair(d,s,l,f);return this.simplifyStates(f)}static updateStateForPair(n,s,l,f){let d=n.endBinaryShift(s);if(f.push(d.latchAndAppend(ui,l)),n.getMode()!==ui&&f.push(d.shiftAndAppend(ui,l)),l===3||l===4){let g=d.latchAndAppend(ni,16-l).latchAndAppend(ni,1);f.push(g)}if(n.getBinaryShiftByteCount()>0){let g=n.addBinaryShiftChar(s).addBinaryShiftChar(s+1);f.push(g)}}static simplifyStates(n){let s=[];for(const l of n){let f=!0;for(const d of s){if(d.isBetterThanOrEqualTo(l)){f=!1;break}l.isBetterThanOrEqualTo(d)&&(s=s.filter(g=>g!==d))}f&&s.push(l)}return s}}class Be{constructor(){}static encodeBytes(n){return Be.encode(n,Be.DEFAULT_EC_PERCENT,Be.DEFAULT_AZTEC_LAYERS)}static encode(n,s,l){let f=new Zi(n).encode(),d=te.truncDivision(f.getSize()*s,100)+11,g=f.getSize()+d,w,E,O,L,V;if(l!==Be.DEFAULT_AZTEC_LAYERS){if(w=l<0,E=Math.abs(l),E>(w?Be.MAX_NB_BITS_COMPACT:Be.MAX_NB_BITS))throw new R(ke.format("Illegal value %s for layers",l));O=Be.totalBitsInLayer(E,w),L=Be.WORD_SIZE[E];let v=O-O%L;if(V=Be.stuffBits(f,L),V.getSize()+d>v)throw new R("Data to large for user specified layer");if(w&&V.getSize()>L*64)throw new R("Data to large for user specified layer")}else{L=0,V=null;for(let v=0;;v++){if(v>Be.MAX_NB_BITS)throw new R("Data too large for an Aztec code");if(w=v<=3,E=w?v+1:v,O=Be.totalBitsInLayer(E,w),g>O)continue;(V==null||L!==Be.WORD_SIZE[E])&&(L=Be.WORD_SIZE[E],V=Be.stuffBits(f,L));let I=O-O%L;if(!(w&&V.getSize()>L*64)&&V.getSize()+d<=I)break}}let Y=Be.generateCheckWords(V,O,L),ae=V.getSize()/L,ge=Be.generateModeMessage(w,E,ae),we=(w?11:14)+E*4,Oe=new Int32Array(we),Ue;if(w){Ue=we;for(let v=0;v<Oe.length;v++)Oe[v]=v}else{Ue=we+1+2*te.truncDivision(te.truncDivision(we,2)-1,15);let v=te.truncDivision(we,2),I=te.truncDivision(Ue,2);for(let b=0;b<v;b++){let A=b+te.truncDivision(b,15);Oe[v-b-1]=I-A-1,Oe[v+b]=I+A+1}}let pt=new et(Ue);for(let v=0,I=0;v<E;v++){let b=(E-v)*4+(w?9:12);for(let A=0;A<b;A++){let D=A*2;for(let $=0;$<2;$++)Y.get(I+D+$)&&pt.set(Oe[v*2+$],Oe[v*2+A]),Y.get(I+b*2+D+$)&&pt.set(Oe[v*2+A],Oe[we-1-v*2-$]),Y.get(I+b*4+D+$)&&pt.set(Oe[we-1-v*2-$],Oe[we-1-v*2-A]),Y.get(I+b*6+D+$)&&pt.set(Oe[we-1-v*2-A],Oe[v*2+$])}I+=b*8}if(Be.drawModeMessage(pt,w,Ue,ge),w)Be.drawBullsEye(pt,te.truncDivision(Ue,2),5);else{Be.drawBullsEye(pt,te.truncDivision(Ue,2),7);for(let v=0,I=0;v<te.truncDivision(we,2)-1;v+=15,I+=16)for(let b=te.truncDivision(Ue,2)&1;b<Ue;b+=2)pt.set(te.truncDivision(Ue,2)-I,b),pt.set(te.truncDivision(Ue,2)+I,b),pt.set(b,te.truncDivision(Ue,2)-I),pt.set(b,te.truncDivision(Ue,2)+I)}let dt=new _i;return dt.setCompact(w),dt.setSize(Ue),dt.setLayers(E),dt.setCodeWords(ae),dt.setMatrix(pt),dt}static drawBullsEye(n,s,l){for(let f=0;f<l;f+=2)for(let d=s-f;d<=s+f;d++)n.set(d,s-f),n.set(d,s+f),n.set(s-f,d),n.set(s+f,d);n.set(s-l,s-l),n.set(s-l+1,s-l),n.set(s-l,s-l+1),n.set(s+l,s-l),n.set(s+l,s-l+1),n.set(s+l,s+l-1)}static generateModeMessage(n,s,l){let f=new Q;return n?(f.appendBits(s-1,2),f.appendBits(l-1,6),f=Be.generateCheckWords(f,28,4)):(f.appendBits(s-1,5),f.appendBits(l-1,11),f=Be.generateCheckWords(f,40,4)),f}static drawModeMessage(n,s,l,f){let d=te.truncDivision(l,2);if(s)for(let g=0;g<7;g++){let w=d-3+g;f.get(g)&&n.set(w,d-5),f.get(g+7)&&n.set(d+5,w),f.get(20-g)&&n.set(w,d+5),f.get(27-g)&&n.set(d-5,w)}else for(let g=0;g<10;g++){let w=d-5+g+te.truncDivision(g,5);f.get(g)&&n.set(w,d-7),f.get(g+10)&&n.set(d+7,w),f.get(29-g)&&n.set(w,d+7),f.get(39-g)&&n.set(d-7,w)}}static generateCheckWords(n,s,l){let f=n.getSize()/l,d=new da(Be.getGF(l)),g=te.truncDivision(s,l),w=Be.bitsToWords(n,l,g);d.encode(w,g-f);let E=s%l,O=new Q;O.appendBits(0,E);for(const L of Array.from(w))O.appendBits(L,l);return O}static bitsToWords(n,s,l){let f=new Int32Array(l),d,g;for(d=0,g=n.getSize()/s;d<g;d++){let w=0;for(let E=0;E<s;E++)w|=n.get(d*s+E)?1<<s-E-1:0;f[d]=w}return f}static getGF(n){switch(n){case 4:return qt.AZTEC_PARAM;case 6:return qt.AZTEC_DATA_6;case 8:return qt.AZTEC_DATA_8;case 10:return qt.AZTEC_DATA_10;case 12:return qt.AZTEC_DATA_12;default:throw new R("Unsupported word size "+n)}}static stuffBits(n,s){let l=new Q,f=n.getSize(),d=(1<<s)-2;for(let g=0;g<f;g+=s){let w=0;for(let E=0;E<s;E++)(g+E>=f||n.get(g+E))&&(w|=1<<s-1-E);(w&d)===d?(l.appendBits(w&d,s),g--):(w&d)===0?(l.appendBits(w|1,s),g--):l.appendBits(w,s)}return l}static totalBitsInLayer(n,s){return((s?88:112)+16*n)*n}}Be.DEFAULT_EC_PERCENT=33,Be.DEFAULT_AZTEC_LAYERS=0,Be.MAX_NB_BITS=32,Be.MAX_NB_BITS_COMPACT=4,Be.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class pa{encode(n,s,l,f){return this.encodeWithHints(n,s,l,f,null)}encodeWithHints(n,s,l,f,d){let g=ha.ISO_8859_1,w=Be.DEFAULT_EC_PERCENT,E=Be.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(Sr.CHARACTER_SET)&&(g=ls.forName(d.get(Sr.CHARACTER_SET).toString())),d.has(Sr.ERROR_CORRECTION)&&(w=te.parseInt(d.get(Sr.ERROR_CORRECTION).toString())),d.has(Sr.AZTEC_LAYERS)&&(E=te.parseInt(d.get(Sr.AZTEC_LAYERS).toString()))),pa.encodeLayers(n,s,l,f,g,w,E)}static encodeLayers(n,s,l,f,d,g,w){if(s!==Me.AZTEC)throw new R("Can only encode AZTEC, but got "+s);let E=Be.encode(ke.getBytes(n,d),g,w);return pa.renderResult(E,l,f)}static renderResult(n,s,l){let f=n.getMatrix();if(f==null)throw new Zn;let d=f.getWidth(),g=f.getHeight(),w=Math.max(s,d),E=Math.max(l,g),O=Math.min(w/d,E/g),L=(w-d*O)/2,V=(E-g*O)/2,Y=new et(w,E);for(let ae=0,ge=V;ae<g;ae++,ge+=O)for(let we=0,Oe=L;we<d;we++,Oe+=O)f.get(we,ae)&&Y.setRegion(Oe,ge,O,O);return Y}}a.AbstractExpandedDecoder=Ae,a.ArgumentException=S,a.ArithmeticException=mt,a.AztecCode=_i,a.AztecCodeReader=Wt,a.AztecCodeWriter=pa,a.AztecDecoder=mn,a.AztecDetector=Nt,a.AztecDetectorResult=Bn,a.AztecEncoder=Be,a.AztecHighLevelEncoder=Zi,a.AztecPoint=cr,a.BarcodeFormat=Me,a.Binarizer=k,a.BinaryBitmap=B,a.BitArray=Q,a.BitMatrix=et,a.BitSource=He,a.BrowserAztecCodeReader=Lt,a.BrowserBarcodeReader=Ot,a.BrowserCodeReader=De,a.BrowserDatamatrixCodeReader=he,a.BrowserMultiFormatReader=Ya,a.BrowserPDF417Reader=Ds,a.BrowserQRCodeReader=fa,a.BrowserQRCodeSvgWriter=Ii,a.CharacterSetECI=le,a.ChecksumException=N,a.Code128Reader=tt,a.Code39Reader=xn,a.DataMatrixDecodedBitStreamParser=zt,a.DataMatrixReader=en,a.DecodeHintType=ue,a.DecoderResult=It,a.DefaultGridSampler=Or,a.DetectorResult=Er,a.EAN13Reader=Ft,a.EncodeHintType=Sr,a.Exception=y,a.FormatException=ee,a.GenericGF=qt,a.GenericGFPoly=ht,a.GlobalHistogramBinarizer=xe,a.GridSampler=ai,a.GridSamplerInstance=vr,a.HTMLCanvasElementLuminanceSource=ft,a.HybridBinarizer=_e,a.ITFReader=Xt,a.IllegalArgumentException=R,a.IllegalStateException=Zn,a.InvertedLuminanceSource=qe,a.LuminanceSource=Ge,a.MathUtils=Qt,a.MultiFormatOneDReader=_t,a.MultiFormatReader=Os,a.MultiFormatWriter=Rn,a.NotFoundException=ve,a.OneDReader=an,a.PDF417DecodedBitStreamParser=Pe,a.PDF417DecoderErrorCorrection=li,a.PDF417Reader=Nr,a.PDF417ResultMetadata=ca,a.PerspectiveTransform=hr,a.PlanarYUVLuminanceSource=mi,a.QRCodeByteMatrix=Wa,a.QRCodeDataMask=tn,a.QRCodeDecodedBitStreamParser=yn,a.QRCodeDecoderErrorCorrectionLevel=Dt,a.QRCodeDecoderFormatInformation=nn,a.QRCodeEncoder=$n,a.QRCodeEncoderQRCode=Yi,a.QRCodeMaskUtil=mr,a.QRCodeMatrixUtil=sn,a.QRCodeMode=Et,a.QRCodeReader=pi,a.QRCodeVersion=ot,a.QRCodeWriter=Wi,a.RGBLuminanceSource=Ka,a.RSS14Reader=ct,a.RSSExpandedReader=Se,a.ReaderException=Ia,a.ReedSolomonDecoder=_n,a.ReedSolomonEncoder=da,a.ReedSolomonException=Sn,a.Result=Le,a.ResultMetadataType=At,a.ResultPoint=wt,a.StringUtils=ke,a.UnsupportedOperationException=Qe,a.VideoInputDevice=ne,a.WhiteRectangleDetector=kn,a.WriterException=qn,a.ZXingArrays=F,a.ZXingCharset=ls,a.ZXingInteger=te,a.ZXingStandardCharsets=ha,a.ZXingStringBuilder=at,a.ZXingStringEncoding=Je,a.ZXingSystem=z,a.createAbstractExpandedDecoder=Zt,Object.defineProperty(a,"__esModule",{value:!0})}))})(mu,mu.exports)),mu.exports}var zr=p4();const g4=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var jm=(function(){function e(r,a,o){if(this.formatMap=new Map([[Ut.QR_CODE,zr.BarcodeFormat.QR_CODE],[Ut.AZTEC,zr.BarcodeFormat.AZTEC],[Ut.CODABAR,zr.BarcodeFormat.CODABAR],[Ut.CODE_39,zr.BarcodeFormat.CODE_39],[Ut.CODE_93,zr.BarcodeFormat.CODE_93],[Ut.CODE_128,zr.BarcodeFormat.CODE_128],[Ut.DATA_MATRIX,zr.BarcodeFormat.DATA_MATRIX],[Ut.MAXICODE,zr.BarcodeFormat.MAXICODE],[Ut.ITF,zr.BarcodeFormat.ITF],[Ut.EAN_13,zr.BarcodeFormat.EAN_13],[Ut.EAN_8,zr.BarcodeFormat.EAN_8],[Ut.PDF_417,zr.BarcodeFormat.PDF_417],[Ut.RSS_14,zr.BarcodeFormat.RSS_14],[Ut.RSS_EXPANDED,zr.BarcodeFormat.RSS_EXPANDED],[Ut.UPC_A,zr.BarcodeFormat.UPC_A],[Ut.UPC_E,zr.BarcodeFormat.UPC_E],[Ut.UPC_EAN_EXTENSION,zr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!g4)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=a,this.logger=o;var c=this.createZXingFormats(r),h=new Map;h.set(zr.DecodeHintType.POSSIBLE_FORMATS,c),h.set(zr.DecodeHintType.TRY_HARDER,!1),this.hints=h}return e.prototype.decodeAsync=function(r){var a=this;return new Promise(function(o,c){try{o(a.decode(r))}catch(h){c(h)}})},e.prototype.decode=function(r){var a=new zr.MultiFormatReader(this.verbose,this.hints),o=new zr.HTMLCanvasElementLuminanceSource(r),c=new zr.BinaryBitmap(new zr.HybridBinarizer(o)),h=a.decode(c);return{text:h.text,format:Nb.create(this.toHtml5QrcodeSupportedFormats(h.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(a,o,c){r.set(a,o)}),r},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createZXingFormats=function(r){for(var a=[],o=0,c=r;o<c.length;o++){var h=c[o];this.formatMap.has(h)?a.push(this.formatMap.get(h)):this.logger.logError("".concat(h," is not supported by")+"ZXingHtml5QrcodeShim")}return a},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e})(),m4=function(e,r,a,o){function c(h){return h instanceof a?h:new a(function(m){m(h)})}return new(a||(a=Promise))(function(h,m){function x(S){try{y(o.next(S))}catch(R){m(R)}}function _(S){try{y(o.throw(S))}catch(R){m(R)}}function y(S){S.done?h(S.value):c(S.value).then(x,_)}y((o=o.apply(e,r||[])).next())})},x4=function(e,r){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},o,c,h,m;return m={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function x(y){return function(S){return _([y,S])}}function _(y){if(o)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(a=0)),a;)try{if(o=1,c&&(h=y[0]&2?c.return:y[0]?c.throw||((h=c.return)&&h.call(c),0):c.next)&&!(h=h.call(c,y[1])).done)return h;switch(c=0,h&&(y=[y[0]&2,h.value]),y[0]){case 0:case 1:h=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,c=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){a.label=y[1];break}if(y[0]===6&&a.label<h[1]){a.label=h[1],h=y;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(y);break}h[2]&&a.ops.pop(),a.trys.pop();continue}y=r.call(e,a)}catch(S){y=[6,S],c=0}finally{o=h=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},Hm=(function(){function e(r,a,o){if(this.formatMap=new Map([[Ut.QR_CODE,"qr_code"],[Ut.AZTEC,"aztec"],[Ut.CODABAR,"codabar"],[Ut.CODE_39,"code_39"],[Ut.CODE_93,"code_93"],[Ut.CODE_128,"code_128"],[Ut.DATA_MATRIX,"data_matrix"],[Ut.ITF,"itf"],[Ut.EAN_13,"ean_13"],[Ut.EAN_8,"ean_8"],[Ut.PDF_417,"pdf417"],[Ut.UPC_A,"upc_a"],[Ut.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=a,this.logger=o;var c=this.createBarcodeDetectorFormats(r);if(this.detector=new BarcodeDetector(c),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var r=new BarcodeDetector({formats:["qr_code"]});return typeof r<"u"},e.prototype.decodeAsync=function(r){return m4(this,void 0,void 0,function(){var a,o;return x4(this,function(c){switch(c.label){case 0:return[4,this.detector.detect(r)];case 1:if(a=c.sent(),!a||a.length===0)throw"No barcode or QR code detected.";return o=this.selectLargestBarcode(a),[2,{text:o.rawValue,format:Nb.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(r){for(var a=null,o=0,c=0,h=r;c<h.length;c++){var m=h[c],x=m.boundingBox.width*m.boundingBox.height;x>o&&(o=x,a=m)}if(!a)throw"No largest barcode found";return a},e.prototype.createBarcodeDetectorFormats=function(r){for(var a=[],o=0,c=r;o<c.length;o++){var h=c[o];this.formatMap.has(h)?a.push(this.formatMap.get(h)):this.logger.warn("".concat(h," is not supported by")+"BarcodeDetectorDelegate")}return{formats:a}},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(a,o,c){r.set(a,o)}),r},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e})(),Ym=function(e,r,a,o){function c(h){return h instanceof a?h:new a(function(m){m(h)})}return new(a||(a=Promise))(function(h,m){function x(S){try{y(o.next(S))}catch(R){m(R)}}function _(S){try{y(o.throw(S))}catch(R){m(R)}}function y(S){S.done?h(S.value):c(S.value).then(x,_)}y((o=o.apply(e,r||[])).next())})},Wm=function(e,r){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},o,c,h,m;return m={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function x(y){return function(S){return _([y,S])}}function _(y){if(o)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(a=0)),a;)try{if(o=1,c&&(h=y[0]&2?c.return:y[0]?c.throw||((h=c.return)&&h.call(c),0):c.next)&&!(h=h.call(c,y[1])).done)return h;switch(c=0,h&&(y=[y[0]&2,h.value]),y[0]){case 0:case 1:h=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,c=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){a.label=y[1];break}if(y[0]===6&&a.label<h[1]){a.label=h[1],h=y;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(y);break}h[2]&&a.ops.pop(),a.trys.pop();continue}y=r.call(e,a)}catch(S){y=[6,S],c=0}finally{o=h=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},y4=(function(){function e(r,a,o,c){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=o,a&&Hm.isSupported()?(this.primaryDecoder=new Hm(r,o,c),this.secondaryDecoder=new jm(r,o,c)):this.primaryDecoder=new jm(r,o,c)}return e.prototype.decodeAsync=function(r){return Ym(this,void 0,void 0,function(){var a;return Wm(this,function(o){switch(o.label){case 0:a=performance.now(),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(r)];case 2:return[2,o.sent()];case 3:return this.possiblyLogPerformance(a),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(r){return Ym(this,void 0,void 0,function(){var a,o;return Wm(this,function(c){switch(c.label){case 0:a=performance.now(),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(r)];case 2:return[2,c.sent()];case 3:if(o=c.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(r)];throw o;case 4:return this.possiblyLogPerformance(a),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(r){if(this.verbose){var a=performance.now()-r;this.executionResults.push(a),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var r=0,a=0,o=this.executionResults;a<o.length;a++){var c=o[a];r+=c}var h=r/this.executionResults.length;console.log("".concat(h," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e})(),Ph=(function(){var e=function(r,a){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(o[h]=c[h])},e(r,a)};return function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");e(r,a);function o(){this.constructor=r}r.prototype=a===null?Object.create(a):(o.prototype=a.prototype,new o)}})(),Qc=function(e,r,a,o){function c(h){return h instanceof a?h:new a(function(m){m(h)})}return new(a||(a=Promise))(function(h,m){function x(S){try{y(o.next(S))}catch(R){m(R)}}function _(S){try{y(o.throw(S))}catch(R){m(R)}}function y(S){S.done?h(S.value):c(S.value).then(x,_)}y((o=o.apply(e,r||[])).next())})},Xc=function(e,r){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},o,c,h,m;return m={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function x(y){return function(S){return _([y,S])}}function _(y){if(o)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(a=0)),a;)try{if(o=1,c&&(h=y[0]&2?c.return:y[0]?c.throw||((h=c.return)&&h.call(c),0):c.next)&&!(h=h.call(c,y[1])).done)return h;switch(c=0,h&&(y=[y[0]&2,h.value]),y[0]){case 0:case 1:h=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,c=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){a.label=y[1];break}if(y[0]===6&&a.label<h[1]){a.label=h[1],h=y;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(y);break}h[2]&&a.ops.pop(),a.trys.pop();continue}y=r.call(e,a)}catch(S){y=[6,S],c=0}finally{o=h=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},$b=(function(){function e(r,a){this.name=r,this.track=a}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(r){var a={};a[this.name]=r;var o={advanced:[a]};return this.track.applyConstraints(o)},e.prototype.value=function(){var r=this.track.getSettings();if(this.name in r){var a=r[this.name];return a}return null},e})(),w4=(function(e){Ph(r,e);function r(a,o){return e.call(this,a,o)||this}return r.prototype.min=function(){return this.getCapabilities().min},r.prototype.max=function(){return this.getCapabilities().max},r.prototype.step=function(){return this.getCapabilities().step},r.prototype.apply=function(a){var o={};o[this.name]=a;var c={advanced:[o]};return this.track.applyConstraints(c)},r.prototype.getCapabilities=function(){this.failIfNotSupported();var a=this.track.getCapabilities(),o=a[this.name];return{min:o.min,max:o.max,step:o.step}},r.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},r})($b),b4=(function(e){Ph(r,e);function r(a){return e.call(this,"zoom",a)||this}return r})(w4),v4=(function(e){Ph(r,e);function r(a){return e.call(this,"torch",a)||this}return r})($b),_4=(function(){function e(r){this.track=r}return e.prototype.zoomFeature=function(){return new b4(this.track)},e.prototype.torchFeature=function(){return new v4(this.track)},e})(),C4=(function(){function e(r,a,o){this.isClosed=!1,this.parentElement=r,this.mediaStream=a,this.callbacks=o,this.surface=this.createVideoElement(this.parentElement.clientWidth),r.append(this.surface)}return e.prototype.createVideoElement=function(r){var a=document.createElement("video");return a.style.width="".concat(r,"px"),a.style.display="block",a.muted=!0,a.setAttribute("muted","true"),a.playsInline=!0,a},e.prototype.setupSurface=function(){var r=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var a=function(){var o=r.surface.clientWidth,c=r.surface.clientHeight;r.callbacks.onRenderSurfaceReady(o,c),r.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(r,a,o,c){return Qc(this,void 0,void 0,function(){var h,m;return Xc(this,function(x){switch(x.label){case 0:return h=new e(r,a,c),o.aspectRatio?(m={aspectRatio:o.aspectRatio},[4,h.getFirstTrackOrFail().applyConstraints(m)]):[3,2];case 1:x.sent(),x.label=2;case 2:return h.setupSurface(),[2,h]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(r){this.failIfClosed();var a=this,o=function(){setTimeout(r,200),a.surface.removeEventListener("playing",o)};this.surface.addEventListener("playing",o),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(r){return Qc(this,void 0,void 0,function(){return Xc(this,function(a){if("aspectRatio"in r)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(r)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var r=this;return new Promise(function(a,o){var c=r.mediaStream.getVideoTracks(),h=c.length,m=0;r.mediaStream.getVideoTracks().forEach(function(x){r.mediaStream.removeTrack(x),x.stop(),++m,m>=h&&(r.isClosed=!0,r.parentElement.removeChild(r.surface),a())})})},e.prototype.getCapabilities=function(){return new _4(this.getFirstTrackOrFail())},e})(),A4=(function(){function e(r){this.mediaStream=r}return e.prototype.render=function(r,a,o){return Qc(this,void 0,void 0,function(){return Xc(this,function(c){return[2,C4.create(r,this.mediaStream,a,o)]})})},e.create=function(r){return Qc(this,void 0,void 0,function(){var a,o;return Xc(this,function(c){switch(c.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return a={audio:!1,video:r},[4,navigator.mediaDevices.getUserMedia(a)];case 1:return o=c.sent(),[2,new e(o)]}})})},e})(),Km=function(e,r,a,o){function c(h){return h instanceof a?h:new a(function(m){m(h)})}return new(a||(a=Promise))(function(h,m){function x(S){try{y(o.next(S))}catch(R){m(R)}}function _(S){try{y(o.throw(S))}catch(R){m(R)}}function y(S){S.done?h(S.value):c(S.value).then(x,_)}y((o=o.apply(e,r||[])).next())})},Qm=function(e,r){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},o,c,h,m;return m={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function x(y){return function(S){return _([y,S])}}function _(y){if(o)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(a=0)),a;)try{if(o=1,c&&(h=y[0]&2?c.return:y[0]?c.throw||((h=c.return)&&h.call(c),0):c.next)&&!(h=h.call(c,y[1])).done)return h;switch(c=0,h&&(y=[y[0]&2,h.value]),y[0]){case 0:case 1:h=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,c=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){a.label=y[1];break}if(y[0]===6&&a.label<h[1]){a.label=h[1],h=y;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(y);break}h[2]&&a.ops.pop(),a.trys.pop();continue}y=r.call(e,a)}catch(S){y=[6,S],c=0}finally{o=h=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},E4=(function(){function e(){}return e.failIfNotSupported=function(){return Km(this,void 0,void 0,function(){return Qm(this,function(r){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(r){return Km(this,void 0,void 0,function(){return Qm(this,function(a){return[2,A4.create(r)]})})},e})(),T4=function(e,r,a,o){function c(h){return h instanceof a?h:new a(function(m){m(h)})}return new(a||(a=Promise))(function(h,m){function x(S){try{y(o.next(S))}catch(R){m(R)}}function _(S){try{y(o.throw(S))}catch(R){m(R)}}function y(S){S.done?h(S.value):c(S.value).then(x,_)}y((o=o.apply(e,r||[])).next())})},S4=function(e,r){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},o,c,h,m;return m={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function x(y){return function(S){return _([y,S])}}function _(y){if(o)throw new TypeError("Generator is already executing.");for(;m&&(m=0,y[0]&&(a=0)),a;)try{if(o=1,c&&(h=y[0]&2?c.return:y[0]?c.throw||((h=c.return)&&h.call(c),0):c.next)&&!(h=h.call(c,y[1])).done)return h;switch(c=0,h&&(y=[y[0]&2,h.value]),y[0]){case 0:case 1:h=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,c=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){a.label=y[1];break}if(y[0]===6&&a.label<h[1]){a.label=h[1],h=y;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(y);break}h[2]&&a.ops.pop(),a.trys.pop();continue}y=r.call(e,a)}catch(S){y=[6,S],c=0}finally{o=h=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},I4=(function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var r=MediaStreamTrack;return MediaStreamTrack&&r.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var r=dl.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(r=dl.insecureContextCameraQueryError()),Promise.reject(r)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var r=location.host.split(":")[0];return r==="127.0.0.1"||r==="localhost"},e.getCamerasFromMediaDevices=function(){return T4(this,void 0,void 0,function(){var r,a,o,c,h,m,x;return S4(this,function(_){switch(_.label){case 0:return r=function(y){for(var S=y.getVideoTracks(),R=0,B=S;R<B.length;R++){var N=B[R];N.enabled=!1,N.stop(),y.removeTrack(N)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return a=_.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(o=_.sent(),c=[],h=0,m=o;h<m.length;h++)x=m[h],x.kind==="videoinput"&&c.push({id:x.deviceId,label:x.label});return r(a),[2,c]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(r,a){var o=function(h){for(var m=[],x=0,_=h;x<_.length;x++){var y=_[x];y.kind==="video"&&m.push({id:y.id,label:y.label})}r(m)},c=MediaStreamTrack;c.getSources(o)})},e})(),Vr;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Vr||(Vr={}));var R4=(function(){function e(){this.state=Vr.NOT_STARTED,this.onGoingTransactionNewState=Vr.UNKNOWN}return e.prototype.directTransition=function(r){this.failIfTransitionOngoing(),this.validateTransition(r),this.state=r},e.prototype.startTransition=function(r){return this.failIfTransitionOngoing(),this.validateTransition(r),this.onGoingTransactionNewState=r,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Vr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var r=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Vr.UNKNOWN,this.directTransition(r)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Vr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Vr.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Vr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(r){switch(this.state){case Vr.UNKNOWN:throw"Transition from unknown is not allowed";case Vr.NOT_STARTED:this.failIfNewStateIs(r,[Vr.PAUSED]);break;case Vr.SCANNING:break;case Vr.PAUSED:break}},e.prototype.failIfNewStateIs=function(r,a){for(var o=0,c=a;o<c.length;o++){var h=c[o];if(r===h)throw"Cannot transition from ".concat(this.state," to ").concat(r)}},e})(),O4=(function(){function e(r){this.stateManager=r}return e.prototype.startTransition=function(r){return this.stateManager.startTransition(r)},e.prototype.directTransition=function(r){this.stateManager.directTransition(r)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Vr.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Vr.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Vr.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Vr.PAUSED},e})(),D4=(function(){function e(){}return e.create=function(){return new O4(new R4)},e})(),M4=(function(){var e=function(r,a){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(o[h]=c[h])},e(r,a)};return function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");e(r,a);function o(){this.constructor=r}r.prototype=a===null?Object.create(a):(o.prototype=a.prototype,new o)}})(),sa=(function(e){M4(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.DEFAULT_WIDTH=300,r.DEFAULT_WIDTH_OFFSET=2,r.FILE_SCAN_MIN_HEIGHT=300,r.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,r.MIN_QR_BOX_SIZE=50,r.SHADED_LEFT=1,r.SHADED_RIGHT=2,r.SHADED_TOP=3,r.SHADED_BOTTOM=4,r.SHADED_REGION_ELEMENT_ID="qr-shaded-region",r.VERBOSE=!1,r.BORDER_SHADER_DEFAULT_COLOR="#ffffff",r.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",r})(c4),B4=(function(){function e(r,a){this.logger=a,this.fps=sa.SCAN_DEFAULT_FPS,r?(r.fps&&(this.fps=r.fps),this.disableFlip=r.disableFlip===!0,this.qrbox=r.qrbox,this.aspectRatio=r.aspectRatio,this.videoConstraints=r.videoConstraints):this.disableFlip=sa.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?kb.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Es(this.qrbox)},e.create=function(r,a){return new e(r,a)},e})(),N4=(function(){function e(r,a){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(r))throw"HTML Element with id=".concat(r," not found");this.elementId=r,this.verbose=!1;var o;typeof a=="boolean"?this.verbose=a===!0:a&&(o=a,this.verbose=o.verbose===!0,o.experimentalFeatures),this.logger=new d4(this.verbose),this.qrcode=new y4(this.getSupportedFormats(a),this.getUseBarCodeDetectorIfSupported(o),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=D4.create()}return e.prototype.start=function(r,a,o,c){var h=this;if(!r)throw"cameraIdOrConfig is required";if(!o||typeof o!="function")throw"qrCodeSuccessCallback is required and should be a function.";var m;c?m=c:m=this.verbose?this.logger.log:function(){};var x=B4.create(a,this.logger);this.clearElement();var _=!1;x.videoConstraints&&(x.isMediaStreamConstraintsValid()?_=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var y=_,S=document.getElementById(this.elementId);S.clientWidth?S.clientWidth:sa.DEFAULT_WIDTH,S.style.position="relative",this.shouldScan=!0,this.element=S;var R=this,B=this.stateManagerProxy.startTransition(Vr.SCANNING);return new Promise(function(N,k){var z=y?x.videoConstraints:R.createVideoConstraints(r);if(!z){B.cancel(),k("videoConstraints should be defined");return}var X={};(!y||x.aspectRatio)&&(X.aspectRatio=x.aspectRatio);var j={onRenderSurfaceReady:function(F,te){R.setupUi(F,te,x),R.isScanning=!0,R.foreverScan(x,o,m)}};E4.failIfNotSupported().then(function(F){F.create(z).then(function(te){return te.render(h.element,X,j).then(function(Q){R.renderedCamera=Q,B.execute(),N(null)}).catch(function(Q){B.cancel(),k(Q)})}).catch(function(te){B.cancel(),k(dl.errorGettingUserMedia(te))})}).catch(function(F){B.cancel(),k(dl.cameraStreamingNotSupported())})})},e.prototype.pause=function(r){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Vr.PAUSED),this.showPausedState(),(Es(r)||r!==!0)&&(r=!1),r&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var r=this,a=function(){r.stateManagerProxy.directTransition(Vr.SCANNING),r.hidePausedState()};if(!this.renderedCamera.isPaused()){a();return}this.renderedCamera.resume(function(){a()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var r=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var a=this.stateManagerProxy.startTransition(Vr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var o=function(){if(r.element){var h=document.getElementById(sa.SHADED_REGION_ELEMENT_ID);h&&r.element.removeChild(h)}},c=this;return this.renderedCamera.close().then(function(){return c.renderedCamera=null,c.element&&(c.element.removeChild(c.canvasElement),c.canvasElement=null),o(),c.qrRegion&&(c.qrRegion=null),c.context&&(c.context=null),a.execute(),c.hidePausedState(),c.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(r,a){return this.scanFileV2(r,a).then(function(o){return o.decodedText})},e.prototype.scanFileV2=function(r,a){var o=this;if(!r||!(r instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Es(a)&&(a=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(c,h){o.possiblyCloseLastScanImageFile(),o.clearElement(),o.lastScanImageFile=URL.createObjectURL(r);var m=new Image;m.onload=function(){var x=m.width,_=m.height,y=document.getElementById(o.elementId),S=y.clientWidth?y.clientWidth:sa.DEFAULT_WIDTH,R=Math.max(y.clientHeight?y.clientHeight:_,sa.FILE_SCAN_MIN_HEIGHT),B=o.computeCanvasDrawConfig(x,_,S,R);if(a){var N=o.createCanvasElement(S,R,"qr-canvas-visible");N.style.display="inline-block",y.appendChild(N);var k=N.getContext("2d");if(!k)throw"Unable to get 2d context from canvas";k.canvas.width=S,k.canvas.height=R,k.drawImage(m,0,0,x,_,B.x,B.y,B.width,B.height)}var z=sa.FILE_SCAN_HIDDEN_CANVAS_PADDING,X=Math.max(m.width,B.width),j=Math.max(m.height,B.height),F=X+2*z,te=j+2*z,Q=o.createCanvasElement(F,te);y.appendChild(Q);var oe=Q.getContext("2d");if(!oe)throw"Unable to get 2d context from canvas";oe.canvas.width=F,oe.canvas.height=te,oe.drawImage(m,0,0,x,_,z,z,X,j);try{o.qrcode.decodeRobustlyAsync(Q).then(function(ue){c(Vm.createFromQrcodeResult(ue))}).catch(h)}catch(ue){h("QR code parse error, error = ".concat(ue))}},m.onerror=h,m.onabort=h,m.onstalled=h,m.onsuspend=h,m.src=URL.createObjectURL(r)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return I4.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(r){if(r){if(!kb.isMediaStreamConstraintsValid(r,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(r)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(r){var a=[Ut.QR_CODE,Ut.AZTEC,Ut.CODABAR,Ut.CODE_39,Ut.CODE_93,Ut.CODE_128,Ut.DATA_MATRIX,Ut.MAXICODE,Ut.ITF,Ut.EAN_13,Ut.EAN_8,Ut.PDF_417,Ut.RSS_14,Ut.RSS_EXPANDED,Ut.UPC_A,Ut.UPC_E,Ut.UPC_EAN_EXTENSION];if(!r||typeof r=="boolean"||!r.formatsToSupport)return a;if(!Array.isArray(r.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(r.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var o=[],c=0,h=r.formatsToSupport;c<h.length;c++){var m=h[c];u4(m)?o.push(m):this.logger.warn("Invalid format: ".concat(m," passed in config, ignoring."))}if(o.length===0)throw"None of formatsToSupport match supported values.";return o},e.prototype.getUseBarCodeDetectorIfSupported=function(r){if(Es(r))return!0;if(!Es(r.useBarCodeDetectorIfSupported))return r.useBarCodeDetectorIfSupported!==!1;if(Es(r.experimentalFeatures))return!0;var a=r.experimentalFeatures;return Es(a.useBarCodeDetectorIfSupported)?!0:a.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(r,a,o){var c=this,h=o.qrbox;this.validateQrboxConfig(h);var m=this.toQrdimensions(r,a,h),x=function(y){if(y<sa.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(sa.MIN_QR_BOX_SIZE,"px.")},_=function(y){return y>r&&(c.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),y=r),y};x(m.width),x(m.height),m.width=_(m.width)},e.prototype.validateQrboxConfig=function(r){if(typeof r!="number"&&typeof r!="function"&&(r.width===void 0||r.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(r,a,o){if(typeof o=="number")return{width:o,height:o};if(typeof o=="function")try{return o(r,a)}catch(c){throw new Error("qrbox config was passed as a function but it failed with unknown error"+c)}return o},e.prototype.setupUi=function(r,a,o){o.isShadedBoxEnabled()&&this.validateQrboxSize(r,a,o);var c=Es(o.qrbox)?{width:r,height:a}:o.qrbox;this.validateQrboxConfig(c);var h=this.toQrdimensions(r,a,c);h.height>a&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var m=o.isShadedBoxEnabled()&&h.height<=a,x={x:0,y:0,width:r,height:a},_=m?this.getShadedRegionBounds(r,a,h):x,y=this.createCanvasElement(_.width,_.height),S={willReadFrequently:!0},R=y.getContext("2d",S);R.canvas.width=_.width,R.canvas.height=_.height,this.element.append(y),m&&this.possiblyInsertShadingElement(this.element,r,a,h),this.createScannerPausedUiElement(this.element),this.qrRegion=_,this.context=R,this.canvasElement=y},e.prototype.createScannerPausedUiElement=function(r){var a=document.createElement("div");a.innerText=dl.scannerPaused(),a.style.display="none",a.style.position="absolute",a.style.top="0px",a.style.zIndex="1",a.style.background="rgba(9, 9, 9, 0.46)",a.style.color="#FFECEC",a.style.textAlign="center",a.style.width="100%",r.appendChild(a),this.scannerPausedUiElement=a},e.prototype.scanContext=function(r,a){var o=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(c){return r(c.text,Vm.createFromQrcodeResult(c)),o.possiblyUpdateShaders(!0),!0}).catch(function(c){o.possiblyUpdateShaders(!1);var h=dl.codeParseError(c);return a(h,f4.createFrom(h)),!1})},e.prototype.foreverScan=function(r,a,o){var c=this;if(this.shouldScan&&this.renderedCamera){var h=this.renderedCamera.getSurface(),m=h.videoWidth/h.clientWidth,x=h.videoHeight/h.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var _=this.qrRegion.width*m,y=this.qrRegion.height*x,S=this.qrRegion.x*m,R=this.qrRegion.y*x;this.context.drawImage(h,S,R,_,y,0,0,this.qrRegion.width,this.qrRegion.height);var B=function(){c.foreverScanTimeout=setTimeout(function(){c.foreverScan(r,a,o)},c.getTimeoutFps(r.fps))};this.scanContext(a,o).then(function(N){!N&&r.disableFlip!==!0?(c.context.translate(c.context.canvas.width,0),c.context.scale(-1,1),c.scanContext(a,o).finally(function(){B()})):B()}).catch(function(N){c.logger.logError("Error happend while scanning context",N),B()})}},e.prototype.createVideoConstraints=function(r){if(typeof r=="string")return{deviceId:{exact:r}};if(typeof r=="object"){var a="facingMode",o="deviceId",c={user:!0,environment:!0},h="exact",m=function(k){if(k in c)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(k,"'")},x=Object.keys(r);if(x.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(x.length," keys");var _=Object.keys(r)[0];if(_!==a&&_!==o)throw"Only '".concat(a,"' and '").concat(o,"' ")+" are supported for 'cameraIdOrConfig'";if(_===a){var y=r.facingMode;if(typeof y=="string"){if(m(y))return{facingMode:y}}else if(typeof y=="object")if(h in y){if(m(y["".concat(h)]))return{facingMode:{exact:y["".concat(h)]}}}else throw"'facingMode' should be string or object with"+" ".concat(h," as key.");else{var S=typeof y;throw"Invalid type of 'facingMode' = ".concat(S)}}else{var R=r.deviceId;if(typeof R=="string")return{deviceId:R};if(typeof R=="object"){if(h in R)return{deviceId:{exact:R["".concat(h)]}};throw"'deviceId' should be string or object with"+" ".concat(h," as key.")}else{var B=typeof R;throw"Invalid type of 'deviceId' = ".concat(B)}}}var N=typeof r;throw"Invalid type of 'cameraIdOrConfig' = ".concat(N)},e.prototype.computeCanvasDrawConfig=function(r,a,o,c){if(r<=o&&a<=c){var h=(o-r)/2,m=(c-a)/2;return{x:h,y:m,width:r,height:a}}else{var x=r,_=a;return r>o&&(a=o/r*a,r=o),a>c&&(r=c/a*r,a=c),this.logger.log("Image downsampled from "+"".concat(x,"X").concat(_)+" to ".concat(r,"X").concat(a,".")),this.computeCanvasDrawConfig(r,a,o,c)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var r=document.getElementById(this.elementId);r&&(r.innerHTML="")},e.prototype.possiblyUpdateShaders=function(r){this.qrMatch!==r&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(a){a.style.backgroundColor=r?sa.BORDER_SHADER_MATCH_COLOR:sa.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=r)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(r,a,o){var c=r,h=a,m=document.createElement("canvas");return m.style.width="".concat(c,"px"),m.style.height="".concat(h,"px"),m.style.display="none",m.id=Es(o)?"qr-canvas":o,m},e.prototype.getShadedRegionBounds=function(r,a,o){if(o.width>r||o.height>a)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(r-o.width)/2,y:(a-o.height)/2,width:o.width,height:o.height}},e.prototype.possiblyInsertShadingElement=function(r,a,o,c){if(!(a-c.width<1||o-c.height<1)){var h=document.createElement("div");h.style.position="absolute";var m=(a-c.width)/2,x=(o-c.height)/2;if(h.style.borderLeft="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),h.style.borderRight="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),h.style.borderTop="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),h.style.borderBottom="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),h.style.boxSizing="border-box",h.style.top="0px",h.style.bottom="0px",h.style.left="0px",h.style.right="0px",h.id="".concat(sa.SHADED_REGION_ELEMENT_ID),a-c.width<11||o-c.height<11)this.hasBorderShaders=!1;else{var _=5,y=40;this.insertShaderBorders(h,y,_,-_,null,0,!0),this.insertShaderBorders(h,y,_,-_,null,0,!1),this.insertShaderBorders(h,y,_,null,-_,0,!0),this.insertShaderBorders(h,y,_,null,-_,0,!1),this.insertShaderBorders(h,_,y+_,-_,null,-_,!0),this.insertShaderBorders(h,_,y+_,null,-_,-_,!0),this.insertShaderBorders(h,_,y+_,-_,null,-_,!1),this.insertShaderBorders(h,_,y+_,null,-_,-_,!1),this.hasBorderShaders=!0}r.append(h)}},e.prototype.insertShaderBorders=function(r,a,o,c,h,m,x){var _=document.createElement("div");_.style.position="absolute",_.style.backgroundColor=sa.BORDER_SHADER_DEFAULT_COLOR,_.style.width="".concat(a,"px"),_.style.height="".concat(o,"px"),c!==null&&(_.style.top="".concat(c,"px")),h!==null&&(_.style.bottom="".concat(h,"px")),x?_.style.left="".concat(m,"px"):_.style.right="".concat(m,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(_),r.appendChild(_)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(r){return 1e3/r},e})(),Xm;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Xm||(Xm={}));const k4=/DINA-[A-Z0-9]{13}/,$4=/OTP-[A-Z0-9]{8}/;function L4(e){return e.status==="invalid"}function Zm(e){return e.status==="missing"}function z4(e){if(!e||e===""||e==="NO_QR")return{status:"missing",dina_code:null,otp:null};if(typeof e!="string")return{status:"invalid",error:"INVALID_INPUT"};const r=e.trim(),a=r.match(k4);if(!a)return{status:"invalid",error:"DINA_NOT_FOUND"};const o=a[0],c=r.match($4),h=c?c[0]:void 0;return{status:"found",dina_code:o,otp:h}}function xh(e){if(e==null)return e;if(Array.isArray(e))return e.map(xh);if(typeof e=="object"){const r={},a=Object.keys(e).sort();for(const o of a){const c=e[o];c!==void 0&&(r[o]=xh(c))}return r}return e}function U4(e){const r=xh(e);return JSON.stringify(r)}function P4(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var o0={exports:{}};const F4={},G4=Object.freeze(Object.defineProperty({__proto__:null,default:F4},Symbol.toStringTag,{value:"Module"})),V4=FA(G4);var Jm;function q4(){return Jm||(Jm=1,(function(e){(function(r){var a=function(P){var W,K=new Float64Array(16);if(P)for(W=0;W<P.length;W++)K[W]=P[W];return K},o=function(){throw new Error("no PRNG")},c=new Uint8Array(16),h=new Uint8Array(32);h[0]=9;var m=a(),x=a([1]),_=a([56129,1]),y=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),S=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),R=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),B=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function k(P,W,K,M){P[W]=K>>24&255,P[W+1]=K>>16&255,P[W+2]=K>>8&255,P[W+3]=K&255,P[W+4]=M>>24&255,P[W+5]=M>>16&255,P[W+6]=M>>8&255,P[W+7]=M&255}function z(P,W,K,M,H){var Ee,Ae=0;for(Ee=0;Ee<H;Ee++)Ae|=P[W+Ee]^K[M+Ee];return(1&Ae-1>>>8)-1}function X(P,W,K,M){return z(P,W,K,M,16)}function j(P,W,K,M){return z(P,W,K,M,32)}function F(P,W,K,M){for(var H=M[0]&255|(M[1]&255)<<8|(M[2]&255)<<16|(M[3]&255)<<24,Ee=K[0]&255|(K[1]&255)<<8|(K[2]&255)<<16|(K[3]&255)<<24,Ae=K[4]&255|(K[5]&255)<<8|(K[6]&255)<<16|(K[7]&255)<<24,Fe=K[8]&255|(K[9]&255)<<8|(K[10]&255)<<16|(K[11]&255)<<24,ut=K[12]&255|(K[13]&255)<<8|(K[14]&255)<<16|(K[15]&255)<<24,Tt=M[4]&255|(M[5]&255)<<8|(M[6]&255)<<16|(M[7]&255)<<24,xt=W[0]&255|(W[1]&255)<<8|(W[2]&255)<<16|(W[3]&255)<<24,dn=W[4]&255|(W[5]&255)<<8|(W[6]&255)<<16|(W[7]&255)<<24,Mt=W[8]&255|(W[9]&255)<<8|(W[10]&255)<<16|(W[11]&255)<<24,Gt=W[12]&255|(W[13]&255)<<8|(W[14]&255)<<16|(W[15]&255)<<24,jt=M[8]&255|(M[9]&255)<<8|(M[10]&255)<<16|(M[11]&255)<<24,kt=K[16]&255|(K[17]&255)<<8|(K[18]&255)<<16|(K[19]&255)<<24,bt=K[20]&255|(K[21]&255)<<8|(K[22]&255)<<16|(K[23]&255)<<24,Zt=K[24]&255|(K[25]&255)<<8|(K[26]&255)<<16|(K[27]&255)<<24,St=K[28]&255|(K[29]&255)<<8|(K[30]&255)<<16|(K[31]&255)<<24,vt=M[12]&255|(M[13]&255)<<8|(M[14]&255)<<16|(M[15]&255)<<24,Se=H,Vt=Ee,ct=Ae,_t=Fe,Ot=ut,st=Tt,Ie=xt,ye=dn,rt=Mt,Xe=Gt,He=jt,We=kt,zt=bt,hn=Zt,$t=St,en=vt,he,un=0;un<20;un+=2)he=Se+zt|0,Ot^=he<<7|he>>>25,he=Ot+Se|0,rt^=he<<9|he>>>23,he=rt+Ot|0,zt^=he<<13|he>>>19,he=zt+rt|0,Se^=he<<18|he>>>14,he=st+Vt|0,Xe^=he<<7|he>>>25,he=Xe+st|0,hn^=he<<9|he>>>23,he=hn+Xe|0,Vt^=he<<13|he>>>19,he=Vt+hn|0,st^=he<<18|he>>>14,he=He+Ie|0,$t^=he<<7|he>>>25,he=$t+He|0,ct^=he<<9|he>>>23,he=ct+$t|0,Ie^=he<<13|he>>>19,he=Ie+ct|0,He^=he<<18|he>>>14,he=en+We|0,_t^=he<<7|he>>>25,he=_t+en|0,ye^=he<<9|he>>>23,he=ye+_t|0,We^=he<<13|he>>>19,he=We+ye|0,en^=he<<18|he>>>14,he=Se+_t|0,Vt^=he<<7|he>>>25,he=Vt+Se|0,ct^=he<<9|he>>>23,he=ct+Vt|0,_t^=he<<13|he>>>19,he=_t+ct|0,Se^=he<<18|he>>>14,he=st+Ot|0,Ie^=he<<7|he>>>25,he=Ie+st|0,ye^=he<<9|he>>>23,he=ye+Ie|0,Ot^=he<<13|he>>>19,he=Ot+ye|0,st^=he<<18|he>>>14,he=He+Xe|0,We^=he<<7|he>>>25,he=We+He|0,rt^=he<<9|he>>>23,he=rt+We|0,Xe^=he<<13|he>>>19,he=Xe+rt|0,He^=he<<18|he>>>14,he=en+$t|0,zt^=he<<7|he>>>25,he=zt+en|0,hn^=he<<9|he>>>23,he=hn+zt|0,$t^=he<<13|he>>>19,he=$t+hn|0,en^=he<<18|he>>>14;Se=Se+H|0,Vt=Vt+Ee|0,ct=ct+Ae|0,_t=_t+Fe|0,Ot=Ot+ut|0,st=st+Tt|0,Ie=Ie+xt|0,ye=ye+dn|0,rt=rt+Mt|0,Xe=Xe+Gt|0,He=He+jt|0,We=We+kt|0,zt=zt+bt|0,hn=hn+Zt|0,$t=$t+St|0,en=en+vt|0,P[0]=Se>>>0&255,P[1]=Se>>>8&255,P[2]=Se>>>16&255,P[3]=Se>>>24&255,P[4]=Vt>>>0&255,P[5]=Vt>>>8&255,P[6]=Vt>>>16&255,P[7]=Vt>>>24&255,P[8]=ct>>>0&255,P[9]=ct>>>8&255,P[10]=ct>>>16&255,P[11]=ct>>>24&255,P[12]=_t>>>0&255,P[13]=_t>>>8&255,P[14]=_t>>>16&255,P[15]=_t>>>24&255,P[16]=Ot>>>0&255,P[17]=Ot>>>8&255,P[18]=Ot>>>16&255,P[19]=Ot>>>24&255,P[20]=st>>>0&255,P[21]=st>>>8&255,P[22]=st>>>16&255,P[23]=st>>>24&255,P[24]=Ie>>>0&255,P[25]=Ie>>>8&255,P[26]=Ie>>>16&255,P[27]=Ie>>>24&255,P[28]=ye>>>0&255,P[29]=ye>>>8&255,P[30]=ye>>>16&255,P[31]=ye>>>24&255,P[32]=rt>>>0&255,P[33]=rt>>>8&255,P[34]=rt>>>16&255,P[35]=rt>>>24&255,P[36]=Xe>>>0&255,P[37]=Xe>>>8&255,P[38]=Xe>>>16&255,P[39]=Xe>>>24&255,P[40]=He>>>0&255,P[41]=He>>>8&255,P[42]=He>>>16&255,P[43]=He>>>24&255,P[44]=We>>>0&255,P[45]=We>>>8&255,P[46]=We>>>16&255,P[47]=We>>>24&255,P[48]=zt>>>0&255,P[49]=zt>>>8&255,P[50]=zt>>>16&255,P[51]=zt>>>24&255,P[52]=hn>>>0&255,P[53]=hn>>>8&255,P[54]=hn>>>16&255,P[55]=hn>>>24&255,P[56]=$t>>>0&255,P[57]=$t>>>8&255,P[58]=$t>>>16&255,P[59]=$t>>>24&255,P[60]=en>>>0&255,P[61]=en>>>8&255,P[62]=en>>>16&255,P[63]=en>>>24&255}function te(P,W,K,M){for(var H=M[0]&255|(M[1]&255)<<8|(M[2]&255)<<16|(M[3]&255)<<24,Ee=K[0]&255|(K[1]&255)<<8|(K[2]&255)<<16|(K[3]&255)<<24,Ae=K[4]&255|(K[5]&255)<<8|(K[6]&255)<<16|(K[7]&255)<<24,Fe=K[8]&255|(K[9]&255)<<8|(K[10]&255)<<16|(K[11]&255)<<24,ut=K[12]&255|(K[13]&255)<<8|(K[14]&255)<<16|(K[15]&255)<<24,Tt=M[4]&255|(M[5]&255)<<8|(M[6]&255)<<16|(M[7]&255)<<24,xt=W[0]&255|(W[1]&255)<<8|(W[2]&255)<<16|(W[3]&255)<<24,dn=W[4]&255|(W[5]&255)<<8|(W[6]&255)<<16|(W[7]&255)<<24,Mt=W[8]&255|(W[9]&255)<<8|(W[10]&255)<<16|(W[11]&255)<<24,Gt=W[12]&255|(W[13]&255)<<8|(W[14]&255)<<16|(W[15]&255)<<24,jt=M[8]&255|(M[9]&255)<<8|(M[10]&255)<<16|(M[11]&255)<<24,kt=K[16]&255|(K[17]&255)<<8|(K[18]&255)<<16|(K[19]&255)<<24,bt=K[20]&255|(K[21]&255)<<8|(K[22]&255)<<16|(K[23]&255)<<24,Zt=K[24]&255|(K[25]&255)<<8|(K[26]&255)<<16|(K[27]&255)<<24,St=K[28]&255|(K[29]&255)<<8|(K[30]&255)<<16|(K[31]&255)<<24,vt=M[12]&255|(M[13]&255)<<8|(M[14]&255)<<16|(M[15]&255)<<24,Se=H,Vt=Ee,ct=Ae,_t=Fe,Ot=ut,st=Tt,Ie=xt,ye=dn,rt=Mt,Xe=Gt,He=jt,We=kt,zt=bt,hn=Zt,$t=St,en=vt,he,un=0;un<20;un+=2)he=Se+zt|0,Ot^=he<<7|he>>>25,he=Ot+Se|0,rt^=he<<9|he>>>23,he=rt+Ot|0,zt^=he<<13|he>>>19,he=zt+rt|0,Se^=he<<18|he>>>14,he=st+Vt|0,Xe^=he<<7|he>>>25,he=Xe+st|0,hn^=he<<9|he>>>23,he=hn+Xe|0,Vt^=he<<13|he>>>19,he=Vt+hn|0,st^=he<<18|he>>>14,he=He+Ie|0,$t^=he<<7|he>>>25,he=$t+He|0,ct^=he<<9|he>>>23,he=ct+$t|0,Ie^=he<<13|he>>>19,he=Ie+ct|0,He^=he<<18|he>>>14,he=en+We|0,_t^=he<<7|he>>>25,he=_t+en|0,ye^=he<<9|he>>>23,he=ye+_t|0,We^=he<<13|he>>>19,he=We+ye|0,en^=he<<18|he>>>14,he=Se+_t|0,Vt^=he<<7|he>>>25,he=Vt+Se|0,ct^=he<<9|he>>>23,he=ct+Vt|0,_t^=he<<13|he>>>19,he=_t+ct|0,Se^=he<<18|he>>>14,he=st+Ot|0,Ie^=he<<7|he>>>25,he=Ie+st|0,ye^=he<<9|he>>>23,he=ye+Ie|0,Ot^=he<<13|he>>>19,he=Ot+ye|0,st^=he<<18|he>>>14,he=He+Xe|0,We^=he<<7|he>>>25,he=We+He|0,rt^=he<<9|he>>>23,he=rt+We|0,Xe^=he<<13|he>>>19,he=Xe+rt|0,He^=he<<18|he>>>14,he=en+$t|0,zt^=he<<7|he>>>25,he=zt+en|0,hn^=he<<9|he>>>23,he=hn+zt|0,$t^=he<<13|he>>>19,he=$t+hn|0,en^=he<<18|he>>>14;P[0]=Se>>>0&255,P[1]=Se>>>8&255,P[2]=Se>>>16&255,P[3]=Se>>>24&255,P[4]=st>>>0&255,P[5]=st>>>8&255,P[6]=st>>>16&255,P[7]=st>>>24&255,P[8]=He>>>0&255,P[9]=He>>>8&255,P[10]=He>>>16&255,P[11]=He>>>24&255,P[12]=en>>>0&255,P[13]=en>>>8&255,P[14]=en>>>16&255,P[15]=en>>>24&255,P[16]=Ie>>>0&255,P[17]=Ie>>>8&255,P[18]=Ie>>>16&255,P[19]=Ie>>>24&255,P[20]=ye>>>0&255,P[21]=ye>>>8&255,P[22]=ye>>>16&255,P[23]=ye>>>24&255,P[24]=rt>>>0&255,P[25]=rt>>>8&255,P[26]=rt>>>16&255,P[27]=rt>>>24&255,P[28]=Xe>>>0&255,P[29]=Xe>>>8&255,P[30]=Xe>>>16&255,P[31]=Xe>>>24&255}function Q(P,W,K,M){F(P,W,K,M)}function oe(P,W,K,M){te(P,W,K,M)}var ue=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function ee(P,W,K,M,H,Ee,Ae){var Fe=new Uint8Array(16),ut=new Uint8Array(64),Tt,xt;for(xt=0;xt<16;xt++)Fe[xt]=0;for(xt=0;xt<8;xt++)Fe[xt]=Ee[xt];for(;H>=64;){for(Q(ut,Fe,Ae,ue),xt=0;xt<64;xt++)P[W+xt]=K[M+xt]^ut[xt];for(Tt=1,xt=8;xt<16;xt++)Tt=Tt+(Fe[xt]&255)|0,Fe[xt]=Tt&255,Tt>>>=8;H-=64,W+=64,M+=64}if(H>0)for(Q(ut,Fe,Ae,ue),xt=0;xt<H;xt++)P[W+xt]=K[M+xt]^ut[xt];return 0}function ce(P,W,K,M,H){var Ee=new Uint8Array(16),Ae=new Uint8Array(64),Fe,ut;for(ut=0;ut<16;ut++)Ee[ut]=0;for(ut=0;ut<8;ut++)Ee[ut]=M[ut];for(;K>=64;){for(Q(Ae,Ee,H,ue),ut=0;ut<64;ut++)P[W+ut]=Ae[ut];for(Fe=1,ut=8;ut<16;ut++)Fe=Fe+(Ee[ut]&255)|0,Ee[ut]=Fe&255,Fe>>>=8;K-=64,W+=64}if(K>0)for(Q(Ae,Ee,H,ue),ut=0;ut<K;ut++)P[W+ut]=Ae[ut];return 0}function le(P,W,K,M,H){var Ee=new Uint8Array(32);oe(Ee,M,H,ue);for(var Ae=new Uint8Array(8),Fe=0;Fe<8;Fe++)Ae[Fe]=M[Fe+16];return ce(P,W,K,Ae,Ee)}function Qe(P,W,K,M,H,Ee,Ae){var Fe=new Uint8Array(32);oe(Fe,Ee,Ae,ue);for(var ut=new Uint8Array(8),Tt=0;Tt<8;Tt++)ut[Tt]=Ee[Tt+16];return ee(P,W,K,M,H,ut,Fe)}var Je=function(P){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var W,K,M,H,Ee,Ae,Fe,ut;W=P[0]&255|(P[1]&255)<<8,this.r[0]=W&8191,K=P[2]&255|(P[3]&255)<<8,this.r[1]=(W>>>13|K<<3)&8191,M=P[4]&255|(P[5]&255)<<8,this.r[2]=(K>>>10|M<<6)&7939,H=P[6]&255|(P[7]&255)<<8,this.r[3]=(M>>>7|H<<9)&8191,Ee=P[8]&255|(P[9]&255)<<8,this.r[4]=(H>>>4|Ee<<12)&255,this.r[5]=Ee>>>1&8190,Ae=P[10]&255|(P[11]&255)<<8,this.r[6]=(Ee>>>14|Ae<<2)&8191,Fe=P[12]&255|(P[13]&255)<<8,this.r[7]=(Ae>>>11|Fe<<5)&8065,ut=P[14]&255|(P[15]&255)<<8,this.r[8]=(Fe>>>8|ut<<8)&8191,this.r[9]=ut>>>5&127,this.pad[0]=P[16]&255|(P[17]&255)<<8,this.pad[1]=P[18]&255|(P[19]&255)<<8,this.pad[2]=P[20]&255|(P[21]&255)<<8,this.pad[3]=P[22]&255|(P[23]&255)<<8,this.pad[4]=P[24]&255|(P[25]&255)<<8,this.pad[5]=P[26]&255|(P[27]&255)<<8,this.pad[6]=P[28]&255|(P[29]&255)<<8,this.pad[7]=P[30]&255|(P[31]&255)<<8};Je.prototype.blocks=function(P,W,K){for(var M=this.fin?0:2048,H,Ee,Ae,Fe,ut,Tt,xt,dn,Mt,Gt,jt,kt,bt,Zt,St,vt,Se,Vt,ct,_t=this.h[0],Ot=this.h[1],st=this.h[2],Ie=this.h[3],ye=this.h[4],rt=this.h[5],Xe=this.h[6],He=this.h[7],We=this.h[8],zt=this.h[9],hn=this.r[0],$t=this.r[1],en=this.r[2],he=this.r[3],un=this.r[4],Dt=this.r[5],nn=this.r[6],be=this.r[7],re=this.r[8],ot=this.r[9];K>=16;)H=P[W+0]&255|(P[W+1]&255)<<8,_t+=H&8191,Ee=P[W+2]&255|(P[W+3]&255)<<8,Ot+=(H>>>13|Ee<<3)&8191,Ae=P[W+4]&255|(P[W+5]&255)<<8,st+=(Ee>>>10|Ae<<6)&8191,Fe=P[W+6]&255|(P[W+7]&255)<<8,Ie+=(Ae>>>7|Fe<<9)&8191,ut=P[W+8]&255|(P[W+9]&255)<<8,ye+=(Fe>>>4|ut<<12)&8191,rt+=ut>>>1&8191,Tt=P[W+10]&255|(P[W+11]&255)<<8,Xe+=(ut>>>14|Tt<<2)&8191,xt=P[W+12]&255|(P[W+13]&255)<<8,He+=(Tt>>>11|xt<<5)&8191,dn=P[W+14]&255|(P[W+15]&255)<<8,We+=(xt>>>8|dn<<8)&8191,zt+=dn>>>5|M,Mt=0,Gt=Mt,Gt+=_t*hn,Gt+=Ot*(5*ot),Gt+=st*(5*re),Gt+=Ie*(5*be),Gt+=ye*(5*nn),Mt=Gt>>>13,Gt&=8191,Gt+=rt*(5*Dt),Gt+=Xe*(5*un),Gt+=He*(5*he),Gt+=We*(5*en),Gt+=zt*(5*$t),Mt+=Gt>>>13,Gt&=8191,jt=Mt,jt+=_t*$t,jt+=Ot*hn,jt+=st*(5*ot),jt+=Ie*(5*re),jt+=ye*(5*be),Mt=jt>>>13,jt&=8191,jt+=rt*(5*nn),jt+=Xe*(5*Dt),jt+=He*(5*un),jt+=We*(5*he),jt+=zt*(5*en),Mt+=jt>>>13,jt&=8191,kt=Mt,kt+=_t*en,kt+=Ot*$t,kt+=st*hn,kt+=Ie*(5*ot),kt+=ye*(5*re),Mt=kt>>>13,kt&=8191,kt+=rt*(5*be),kt+=Xe*(5*nn),kt+=He*(5*Dt),kt+=We*(5*un),kt+=zt*(5*he),Mt+=kt>>>13,kt&=8191,bt=Mt,bt+=_t*he,bt+=Ot*en,bt+=st*$t,bt+=Ie*hn,bt+=ye*(5*ot),Mt=bt>>>13,bt&=8191,bt+=rt*(5*re),bt+=Xe*(5*be),bt+=He*(5*nn),bt+=We*(5*Dt),bt+=zt*(5*un),Mt+=bt>>>13,bt&=8191,Zt=Mt,Zt+=_t*un,Zt+=Ot*he,Zt+=st*en,Zt+=Ie*$t,Zt+=ye*hn,Mt=Zt>>>13,Zt&=8191,Zt+=rt*(5*ot),Zt+=Xe*(5*re),Zt+=He*(5*be),Zt+=We*(5*nn),Zt+=zt*(5*Dt),Mt+=Zt>>>13,Zt&=8191,St=Mt,St+=_t*Dt,St+=Ot*un,St+=st*he,St+=Ie*en,St+=ye*$t,Mt=St>>>13,St&=8191,St+=rt*hn,St+=Xe*(5*ot),St+=He*(5*re),St+=We*(5*be),St+=zt*(5*nn),Mt+=St>>>13,St&=8191,vt=Mt,vt+=_t*nn,vt+=Ot*Dt,vt+=st*un,vt+=Ie*he,vt+=ye*en,Mt=vt>>>13,vt&=8191,vt+=rt*$t,vt+=Xe*hn,vt+=He*(5*ot),vt+=We*(5*re),vt+=zt*(5*be),Mt+=vt>>>13,vt&=8191,Se=Mt,Se+=_t*be,Se+=Ot*nn,Se+=st*Dt,Se+=Ie*un,Se+=ye*he,Mt=Se>>>13,Se&=8191,Se+=rt*en,Se+=Xe*$t,Se+=He*hn,Se+=We*(5*ot),Se+=zt*(5*re),Mt+=Se>>>13,Se&=8191,Vt=Mt,Vt+=_t*re,Vt+=Ot*be,Vt+=st*nn,Vt+=Ie*Dt,Vt+=ye*un,Mt=Vt>>>13,Vt&=8191,Vt+=rt*he,Vt+=Xe*en,Vt+=He*$t,Vt+=We*hn,Vt+=zt*(5*ot),Mt+=Vt>>>13,Vt&=8191,ct=Mt,ct+=_t*ot,ct+=Ot*re,ct+=st*be,ct+=Ie*nn,ct+=ye*Dt,Mt=ct>>>13,ct&=8191,ct+=rt*un,ct+=Xe*he,ct+=He*en,ct+=We*$t,ct+=zt*hn,Mt+=ct>>>13,ct&=8191,Mt=(Mt<<2)+Mt|0,Mt=Mt+Gt|0,Gt=Mt&8191,Mt=Mt>>>13,jt+=Mt,_t=Gt,Ot=jt,st=kt,Ie=bt,ye=Zt,rt=St,Xe=vt,He=Se,We=Vt,zt=ct,W+=16,K-=16;this.h[0]=_t,this.h[1]=Ot,this.h[2]=st,this.h[3]=Ie,this.h[4]=ye,this.h[5]=rt,this.h[6]=Xe,this.h[7]=He,this.h[8]=We,this.h[9]=zt},Je.prototype.finish=function(P,W){var K=new Uint16Array(10),M,H,Ee,Ae;if(this.leftover){for(Ae=this.leftover,this.buffer[Ae++]=1;Ae<16;Ae++)this.buffer[Ae]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(M=this.h[1]>>>13,this.h[1]&=8191,Ae=2;Ae<10;Ae++)this.h[Ae]+=M,M=this.h[Ae]>>>13,this.h[Ae]&=8191;for(this.h[0]+=M*5,M=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=M,M=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=M,K[0]=this.h[0]+5,M=K[0]>>>13,K[0]&=8191,Ae=1;Ae<10;Ae++)K[Ae]=this.h[Ae]+M,M=K[Ae]>>>13,K[Ae]&=8191;for(K[9]-=8192,H=(M^1)-1,Ae=0;Ae<10;Ae++)K[Ae]&=H;for(H=~H,Ae=0;Ae<10;Ae++)this.h[Ae]=this.h[Ae]&H|K[Ae];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Ee=this.h[0]+this.pad[0],this.h[0]=Ee&65535,Ae=1;Ae<8;Ae++)Ee=(this.h[Ae]+this.pad[Ae]|0)+(Ee>>>16)|0,this.h[Ae]=Ee&65535;P[W+0]=this.h[0]>>>0&255,P[W+1]=this.h[0]>>>8&255,P[W+2]=this.h[1]>>>0&255,P[W+3]=this.h[1]>>>8&255,P[W+4]=this.h[2]>>>0&255,P[W+5]=this.h[2]>>>8&255,P[W+6]=this.h[3]>>>0&255,P[W+7]=this.h[3]>>>8&255,P[W+8]=this.h[4]>>>0&255,P[W+9]=this.h[4]>>>8&255,P[W+10]=this.h[5]>>>0&255,P[W+11]=this.h[5]>>>8&255,P[W+12]=this.h[6]>>>0&255,P[W+13]=this.h[6]>>>8&255,P[W+14]=this.h[7]>>>0&255,P[W+15]=this.h[7]>>>8&255},Je.prototype.update=function(P,W,K){var M,H;if(this.leftover){for(H=16-this.leftover,H>K&&(H=K),M=0;M<H;M++)this.buffer[this.leftover+M]=P[W+M];if(K-=H,W+=H,this.leftover+=H,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(K>=16&&(H=K-K%16,this.blocks(P,W,H),W+=H,K-=H),K){for(M=0;M<K;M++)this.buffer[this.leftover+M]=P[W+M];this.leftover+=K}};function ke(P,W,K,M,H,Ee){var Ae=new Je(Ee);return Ae.update(K,M,H),Ae.finish(P,W),0}function at(P,W,K,M,H,Ee){var Ae=new Uint8Array(16);return ke(Ae,0,K,M,H,Ee),X(P,W,Ae,0)}function et(P,W,K,M,H){var Ee;if(K<32)return-1;for(Qe(P,0,W,0,K,M,H),ke(P,16,P,32,K-32,P),Ee=0;Ee<16;Ee++)P[Ee]=0;return 0}function ve(P,W,K,M,H){var Ee,Ae=new Uint8Array(32);if(K<32||(le(Ae,0,32,M,H),at(W,16,W,32,K-32,Ae)!==0))return-1;for(Qe(P,0,W,0,K,M,H),Ee=0;Ee<32;Ee++)P[Ee]=0;return 0}function xe(P,W){var K;for(K=0;K<16;K++)P[K]=W[K]|0}function _e(P){var W,K,M=1;for(W=0;W<16;W++)K=P[W]+M+65535,M=Math.floor(K/65536),P[W]=K-M*65536;P[0]+=M-1+37*(M-1)}function Ge(P,W,K){for(var M,H=~(K-1),Ee=0;Ee<16;Ee++)M=H&(P[Ee]^W[Ee]),P[Ee]^=M,W[Ee]^=M}function qe(P,W){var K,M,H,Ee=a(),Ae=a();for(K=0;K<16;K++)Ae[K]=W[K];for(_e(Ae),_e(Ae),_e(Ae),M=0;M<2;M++){for(Ee[0]=Ae[0]-65517,K=1;K<15;K++)Ee[K]=Ae[K]-65535-(Ee[K-1]>>16&1),Ee[K-1]&=65535;Ee[15]=Ae[15]-32767-(Ee[14]>>16&1),H=Ee[15]>>16&1,Ee[14]&=65535,Ge(Ae,Ee,1-H)}for(K=0;K<16;K++)P[2*K]=Ae[K]&255,P[2*K+1]=Ae[K]>>8}function ft(P,W){var K=new Uint8Array(32),M=new Uint8Array(32);return qe(K,P),qe(M,W),j(K,0,M,0)}function ne(P){var W=new Uint8Array(32);return qe(W,P),W[0]&1}function fe(P,W){var K;for(K=0;K<16;K++)P[K]=W[2*K]+(W[2*K+1]<<8);P[15]&=32767}function De(P,W,K){for(var M=0;M<16;M++)P[M]=W[M]+K[M]}function Le(P,W,K){for(var M=0;M<16;M++)P[M]=W[M]-K[M]}function pe(P,W,K){var M,H,Ee=0,Ae=0,Fe=0,ut=0,Tt=0,xt=0,dn=0,Mt=0,Gt=0,jt=0,kt=0,bt=0,Zt=0,St=0,vt=0,Se=0,Vt=0,ct=0,_t=0,Ot=0,st=0,Ie=0,ye=0,rt=0,Xe=0,He=0,We=0,zt=0,hn=0,$t=0,en=0,he=K[0],un=K[1],Dt=K[2],nn=K[3],be=K[4],re=K[5],ot=K[6],bn=K[7],tn=K[8],Vn=K[9],rr=K[10],On=K[11],Et=K[12],yn=K[13],Cr=K[14],Mr=K[15];M=W[0],Ee+=M*he,Ae+=M*un,Fe+=M*Dt,ut+=M*nn,Tt+=M*be,xt+=M*re,dn+=M*ot,Mt+=M*bn,Gt+=M*tn,jt+=M*Vn,kt+=M*rr,bt+=M*On,Zt+=M*Et,St+=M*yn,vt+=M*Cr,Se+=M*Mr,M=W[1],Ae+=M*he,Fe+=M*un,ut+=M*Dt,Tt+=M*nn,xt+=M*be,dn+=M*re,Mt+=M*ot,Gt+=M*bn,jt+=M*tn,kt+=M*Vn,bt+=M*rr,Zt+=M*On,St+=M*Et,vt+=M*yn,Se+=M*Cr,Vt+=M*Mr,M=W[2],Fe+=M*he,ut+=M*un,Tt+=M*Dt,xt+=M*nn,dn+=M*be,Mt+=M*re,Gt+=M*ot,jt+=M*bn,kt+=M*tn,bt+=M*Vn,Zt+=M*rr,St+=M*On,vt+=M*Et,Se+=M*yn,Vt+=M*Cr,ct+=M*Mr,M=W[3],ut+=M*he,Tt+=M*un,xt+=M*Dt,dn+=M*nn,Mt+=M*be,Gt+=M*re,jt+=M*ot,kt+=M*bn,bt+=M*tn,Zt+=M*Vn,St+=M*rr,vt+=M*On,Se+=M*Et,Vt+=M*yn,ct+=M*Cr,_t+=M*Mr,M=W[4],Tt+=M*he,xt+=M*un,dn+=M*Dt,Mt+=M*nn,Gt+=M*be,jt+=M*re,kt+=M*ot,bt+=M*bn,Zt+=M*tn,St+=M*Vn,vt+=M*rr,Se+=M*On,Vt+=M*Et,ct+=M*yn,_t+=M*Cr,Ot+=M*Mr,M=W[5],xt+=M*he,dn+=M*un,Mt+=M*Dt,Gt+=M*nn,jt+=M*be,kt+=M*re,bt+=M*ot,Zt+=M*bn,St+=M*tn,vt+=M*Vn,Se+=M*rr,Vt+=M*On,ct+=M*Et,_t+=M*yn,Ot+=M*Cr,st+=M*Mr,M=W[6],dn+=M*he,Mt+=M*un,Gt+=M*Dt,jt+=M*nn,kt+=M*be,bt+=M*re,Zt+=M*ot,St+=M*bn,vt+=M*tn,Se+=M*Vn,Vt+=M*rr,ct+=M*On,_t+=M*Et,Ot+=M*yn,st+=M*Cr,Ie+=M*Mr,M=W[7],Mt+=M*he,Gt+=M*un,jt+=M*Dt,kt+=M*nn,bt+=M*be,Zt+=M*re,St+=M*ot,vt+=M*bn,Se+=M*tn,Vt+=M*Vn,ct+=M*rr,_t+=M*On,Ot+=M*Et,st+=M*yn,Ie+=M*Cr,ye+=M*Mr,M=W[8],Gt+=M*he,jt+=M*un,kt+=M*Dt,bt+=M*nn,Zt+=M*be,St+=M*re,vt+=M*ot,Se+=M*bn,Vt+=M*tn,ct+=M*Vn,_t+=M*rr,Ot+=M*On,st+=M*Et,Ie+=M*yn,ye+=M*Cr,rt+=M*Mr,M=W[9],jt+=M*he,kt+=M*un,bt+=M*Dt,Zt+=M*nn,St+=M*be,vt+=M*re,Se+=M*ot,Vt+=M*bn,ct+=M*tn,_t+=M*Vn,Ot+=M*rr,st+=M*On,Ie+=M*Et,ye+=M*yn,rt+=M*Cr,Xe+=M*Mr,M=W[10],kt+=M*he,bt+=M*un,Zt+=M*Dt,St+=M*nn,vt+=M*be,Se+=M*re,Vt+=M*ot,ct+=M*bn,_t+=M*tn,Ot+=M*Vn,st+=M*rr,Ie+=M*On,ye+=M*Et,rt+=M*yn,Xe+=M*Cr,He+=M*Mr,M=W[11],bt+=M*he,Zt+=M*un,St+=M*Dt,vt+=M*nn,Se+=M*be,Vt+=M*re,ct+=M*ot,_t+=M*bn,Ot+=M*tn,st+=M*Vn,Ie+=M*rr,ye+=M*On,rt+=M*Et,Xe+=M*yn,He+=M*Cr,We+=M*Mr,M=W[12],Zt+=M*he,St+=M*un,vt+=M*Dt,Se+=M*nn,Vt+=M*be,ct+=M*re,_t+=M*ot,Ot+=M*bn,st+=M*tn,Ie+=M*Vn,ye+=M*rr,rt+=M*On,Xe+=M*Et,He+=M*yn,We+=M*Cr,zt+=M*Mr,M=W[13],St+=M*he,vt+=M*un,Se+=M*Dt,Vt+=M*nn,ct+=M*be,_t+=M*re,Ot+=M*ot,st+=M*bn,Ie+=M*tn,ye+=M*Vn,rt+=M*rr,Xe+=M*On,He+=M*Et,We+=M*yn,zt+=M*Cr,hn+=M*Mr,M=W[14],vt+=M*he,Se+=M*un,Vt+=M*Dt,ct+=M*nn,_t+=M*be,Ot+=M*re,st+=M*ot,Ie+=M*bn,ye+=M*tn,rt+=M*Vn,Xe+=M*rr,He+=M*On,We+=M*Et,zt+=M*yn,hn+=M*Cr,$t+=M*Mr,M=W[15],Se+=M*he,Vt+=M*un,ct+=M*Dt,_t+=M*nn,Ot+=M*be,st+=M*re,Ie+=M*ot,ye+=M*bn,rt+=M*tn,Xe+=M*Vn,He+=M*rr,We+=M*On,zt+=M*Et,hn+=M*yn,$t+=M*Cr,en+=M*Mr,Ee+=38*Vt,Ae+=38*ct,Fe+=38*_t,ut+=38*Ot,Tt+=38*st,xt+=38*Ie,dn+=38*ye,Mt+=38*rt,Gt+=38*Xe,jt+=38*He,kt+=38*We,bt+=38*zt,Zt+=38*hn,St+=38*$t,vt+=38*en,H=1,M=Ee+H+65535,H=Math.floor(M/65536),Ee=M-H*65536,M=Ae+H+65535,H=Math.floor(M/65536),Ae=M-H*65536,M=Fe+H+65535,H=Math.floor(M/65536),Fe=M-H*65536,M=ut+H+65535,H=Math.floor(M/65536),ut=M-H*65536,M=Tt+H+65535,H=Math.floor(M/65536),Tt=M-H*65536,M=xt+H+65535,H=Math.floor(M/65536),xt=M-H*65536,M=dn+H+65535,H=Math.floor(M/65536),dn=M-H*65536,M=Mt+H+65535,H=Math.floor(M/65536),Mt=M-H*65536,M=Gt+H+65535,H=Math.floor(M/65536),Gt=M-H*65536,M=jt+H+65535,H=Math.floor(M/65536),jt=M-H*65536,M=kt+H+65535,H=Math.floor(M/65536),kt=M-H*65536,M=bt+H+65535,H=Math.floor(M/65536),bt=M-H*65536,M=Zt+H+65535,H=Math.floor(M/65536),Zt=M-H*65536,M=St+H+65535,H=Math.floor(M/65536),St=M-H*65536,M=vt+H+65535,H=Math.floor(M/65536),vt=M-H*65536,M=Se+H+65535,H=Math.floor(M/65536),Se=M-H*65536,Ee+=H-1+37*(H-1),H=1,M=Ee+H+65535,H=Math.floor(M/65536),Ee=M-H*65536,M=Ae+H+65535,H=Math.floor(M/65536),Ae=M-H*65536,M=Fe+H+65535,H=Math.floor(M/65536),Fe=M-H*65536,M=ut+H+65535,H=Math.floor(M/65536),ut=M-H*65536,M=Tt+H+65535,H=Math.floor(M/65536),Tt=M-H*65536,M=xt+H+65535,H=Math.floor(M/65536),xt=M-H*65536,M=dn+H+65535,H=Math.floor(M/65536),dn=M-H*65536,M=Mt+H+65535,H=Math.floor(M/65536),Mt=M-H*65536,M=Gt+H+65535,H=Math.floor(M/65536),Gt=M-H*65536,M=jt+H+65535,H=Math.floor(M/65536),jt=M-H*65536,M=kt+H+65535,H=Math.floor(M/65536),kt=M-H*65536,M=bt+H+65535,H=Math.floor(M/65536),bt=M-H*65536,M=Zt+H+65535,H=Math.floor(M/65536),Zt=M-H*65536,M=St+H+65535,H=Math.floor(M/65536),St=M-H*65536,M=vt+H+65535,H=Math.floor(M/65536),vt=M-H*65536,M=Se+H+65535,H=Math.floor(M/65536),Se=M-H*65536,Ee+=H-1+37*(H-1),P[0]=Ee,P[1]=Ae,P[2]=Fe,P[3]=ut,P[4]=Tt,P[5]=xt,P[6]=dn,P[7]=Mt,P[8]=Gt,P[9]=jt,P[10]=kt,P[11]=bt,P[12]=Zt,P[13]=St,P[14]=vt,P[15]=Se}function Me(P,W){pe(P,W,W)}function Bt(P,W){var K=a(),M;for(M=0;M<16;M++)K[M]=W[M];for(M=253;M>=0;M--)Me(K,K),M!==2&&M!==4&&pe(K,K,W);for(M=0;M<16;M++)P[M]=K[M]}function At(P,W){var K=a(),M;for(M=0;M<16;M++)K[M]=W[M];for(M=250;M>=0;M--)Me(K,K),M!==1&&pe(K,K,W);for(M=0;M<16;M++)P[M]=K[M]}function It(P,W,K){var M=new Uint8Array(32),H=new Float64Array(80),Ee,Ae,Fe=a(),ut=a(),Tt=a(),xt=a(),dn=a(),Mt=a();for(Ae=0;Ae<31;Ae++)M[Ae]=W[Ae];for(M[31]=W[31]&127|64,M[0]&=248,fe(H,K),Ae=0;Ae<16;Ae++)ut[Ae]=H[Ae],xt[Ae]=Fe[Ae]=Tt[Ae]=0;for(Fe[0]=xt[0]=1,Ae=254;Ae>=0;--Ae)Ee=M[Ae>>>3]>>>(Ae&7)&1,Ge(Fe,ut,Ee),Ge(Tt,xt,Ee),De(dn,Fe,Tt),Le(Fe,Fe,Tt),De(Tt,ut,xt),Le(ut,ut,xt),Me(xt,dn),Me(Mt,Fe),pe(Fe,Tt,Fe),pe(Tt,ut,dn),De(dn,Fe,Tt),Le(Fe,Fe,Tt),Me(ut,Fe),Le(Tt,xt,Mt),pe(Fe,Tt,_),De(Fe,Fe,xt),pe(Tt,Tt,Fe),pe(Fe,xt,Mt),pe(xt,ut,H),Me(ut,dn),Ge(Fe,ut,Ee),Ge(Tt,xt,Ee);for(Ae=0;Ae<16;Ae++)H[Ae+16]=Fe[Ae],H[Ae+32]=Tt[Ae],H[Ae+48]=ut[Ae],H[Ae+64]=xt[Ae];var Gt=H.subarray(32),jt=H.subarray(16);return Bt(Gt,Gt),pe(jt,jt,Gt),qe(P,jt),0}function Rt(P,W){return It(P,W,h)}function ht(P,W){return o(W,32),Rt(P,W)}function mt(P,W,K){var M=new Uint8Array(32);return It(M,K,W),oe(P,c,M,ue)}var qt=et,Sn=ve;function Zn(P,W,K,M,H,Ee){var Ae=new Uint8Array(32);return mt(Ae,H,Ee),qt(P,W,K,M,Ae)}function _n(P,W,K,M,H,Ee){var Ae=new Uint8Array(32);return mt(Ae,H,Ee),Sn(P,W,K,M,Ae)}var zn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function mn(P,W,K,M){for(var H=new Int32Array(16),Ee=new Int32Array(16),Ae,Fe,ut,Tt,xt,dn,Mt,Gt,jt,kt,bt,Zt,St,vt,Se,Vt,ct,_t,Ot,st,Ie,ye,rt,Xe,He,We,zt=P[0],hn=P[1],$t=P[2],en=P[3],he=P[4],un=P[5],Dt=P[6],nn=P[7],be=W[0],re=W[1],ot=W[2],bn=W[3],tn=W[4],Vn=W[5],rr=W[6],On=W[7],Et=0;M>=128;){for(Ot=0;Ot<16;Ot++)st=8*Ot+Et,H[Ot]=K[st+0]<<24|K[st+1]<<16|K[st+2]<<8|K[st+3],Ee[Ot]=K[st+4]<<24|K[st+5]<<16|K[st+6]<<8|K[st+7];for(Ot=0;Ot<80;Ot++)if(Ae=zt,Fe=hn,ut=$t,Tt=en,xt=he,dn=un,Mt=Dt,Gt=nn,jt=be,kt=re,bt=ot,Zt=bn,St=tn,vt=Vn,Se=rr,Vt=On,Ie=nn,ye=On,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=(he>>>14|tn<<18)^(he>>>18|tn<<14)^(tn>>>9|he<<23),ye=(tn>>>14|he<<18)^(tn>>>18|he<<14)^(he>>>9|tn<<23),rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Ie=he&un^~he&Dt,ye=tn&Vn^~tn&rr,rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Ie=zn[Ot*2],ye=zn[Ot*2+1],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Ie=H[Ot%16],ye=Ee[Ot%16],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,ct=He&65535|We<<16,_t=rt&65535|Xe<<16,Ie=ct,ye=_t,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=(zt>>>28|be<<4)^(be>>>2|zt<<30)^(be>>>7|zt<<25),ye=(be>>>28|zt<<4)^(zt>>>2|be<<30)^(zt>>>7|be<<25),rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Ie=zt&hn^zt&$t^hn&$t,ye=be&re^be&ot^re&ot,rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,Gt=He&65535|We<<16,Vt=rt&65535|Xe<<16,Ie=Tt,ye=Zt,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=ct,ye=_t,rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,Tt=He&65535|We<<16,Zt=rt&65535|Xe<<16,hn=Ae,$t=Fe,en=ut,he=Tt,un=xt,Dt=dn,nn=Mt,zt=Gt,re=jt,ot=kt,bn=bt,tn=Zt,Vn=St,rr=vt,On=Se,be=Vt,Ot%16===15)for(st=0;st<16;st++)Ie=H[st],ye=Ee[st],rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=H[(st+9)%16],ye=Ee[(st+9)%16],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,ct=H[(st+1)%16],_t=Ee[(st+1)%16],Ie=(ct>>>1|_t<<31)^(ct>>>8|_t<<24)^ct>>>7,ye=(_t>>>1|ct<<31)^(_t>>>8|ct<<24)^(_t>>>7|ct<<25),rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,ct=H[(st+14)%16],_t=Ee[(st+14)%16],Ie=(ct>>>19|_t<<13)^(_t>>>29|ct<<3)^ct>>>6,ye=(_t>>>19|ct<<13)^(ct>>>29|_t<<3)^(_t>>>6|ct<<26),rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,H[st]=He&65535|We<<16,Ee[st]=rt&65535|Xe<<16;Ie=zt,ye=be,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[0],ye=W[0],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[0]=zt=He&65535|We<<16,W[0]=be=rt&65535|Xe<<16,Ie=hn,ye=re,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[1],ye=W[1],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[1]=hn=He&65535|We<<16,W[1]=re=rt&65535|Xe<<16,Ie=$t,ye=ot,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[2],ye=W[2],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[2]=$t=He&65535|We<<16,W[2]=ot=rt&65535|Xe<<16,Ie=en,ye=bn,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[3],ye=W[3],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[3]=en=He&65535|We<<16,W[3]=bn=rt&65535|Xe<<16,Ie=he,ye=tn,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[4],ye=W[4],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[4]=he=He&65535|We<<16,W[4]=tn=rt&65535|Xe<<16,Ie=un,ye=Vn,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[5],ye=W[5],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[5]=un=He&65535|We<<16,W[5]=Vn=rt&65535|Xe<<16,Ie=Dt,ye=rr,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[6],ye=W[6],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[6]=Dt=He&65535|We<<16,W[6]=rr=rt&65535|Xe<<16,Ie=nn,ye=On,rt=ye&65535,Xe=ye>>>16,He=Ie&65535,We=Ie>>>16,Ie=P[7],ye=W[7],rt+=ye&65535,Xe+=ye>>>16,He+=Ie&65535,We+=Ie>>>16,Xe+=rt>>>16,He+=Xe>>>16,We+=He>>>16,P[7]=nn=He&65535|We<<16,W[7]=On=rt&65535|Xe<<16,Et+=128,M-=128}return M}function Qt(P,W,K){var M=new Int32Array(8),H=new Int32Array(8),Ee=new Uint8Array(256),Ae,Fe=K;for(M[0]=1779033703,M[1]=3144134277,M[2]=1013904242,M[3]=2773480762,M[4]=1359893119,M[5]=2600822924,M[6]=528734635,M[7]=1541459225,H[0]=4089235720,H[1]=2227873595,H[2]=4271175723,H[3]=1595750129,H[4]=2917565137,H[5]=725511199,H[6]=4215389547,H[7]=327033209,mn(M,H,W,K),K%=128,Ae=0;Ae<K;Ae++)Ee[Ae]=W[Fe-K+Ae];for(Ee[K]=128,K=256-128*(K<112?1:0),Ee[K-9]=0,k(Ee,K-8,Fe/536870912|0,Fe<<3),mn(M,H,Ee,K),Ae=0;Ae<8;Ae++)k(P,8*Ae,M[Ae],H[Ae]);return 0}function nr(P,W){var K=a(),M=a(),H=a(),Ee=a(),Ae=a(),Fe=a(),ut=a(),Tt=a(),xt=a();Le(K,P[1],P[0]),Le(xt,W[1],W[0]),pe(K,K,xt),De(M,P[0],P[1]),De(xt,W[0],W[1]),pe(M,M,xt),pe(H,P[3],W[3]),pe(H,H,S),pe(Ee,P[2],W[2]),De(Ee,Ee,Ee),Le(Ae,M,K),Le(Fe,Ee,H),De(ut,Ee,H),De(Tt,M,K),pe(P[0],Ae,Fe),pe(P[1],Tt,ut),pe(P[2],ut,Fe),pe(P[3],Ae,Tt)}function wt(P,W,K){var M;for(M=0;M<4;M++)Ge(P[M],W[M],K)}function Er(P,W){var K=a(),M=a(),H=a();Bt(H,W[2]),pe(K,W[0],H),pe(M,W[1],H),qe(P,M),P[31]^=ne(K)<<7}function Bn(P,W,K){var M,H;for(xe(P[0],m),xe(P[1],x),xe(P[2],x),xe(P[3],m),H=255;H>=0;--H)M=K[H/8|0]>>(H&7)&1,wt(P,W,M),nr(W,P),nr(P,P),wt(P,W,M)}function kn(P,W){var K=[a(),a(),a(),a()];xe(K[0],R),xe(K[1],B),xe(K[2],x),pe(K[3],R,B),Bn(P,K,W)}function ai(P,W,K){var M=new Uint8Array(64),H=[a(),a(),a(),a()],Ee;for(K||o(W,32),Qt(M,W,32),M[0]&=248,M[31]&=127,M[31]|=64,kn(H,M),Er(P,H),Ee=0;Ee<32;Ee++)W[Ee+32]=P[Ee];return 0}var hr=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Or(P,W){var K,M,H,Ee;for(M=63;M>=32;--M){for(K=0,H=M-32,Ee=M-12;H<Ee;++H)W[H]+=K-16*W[M]*hr[H-(M-32)],K=Math.floor((W[H]+128)/256),W[H]-=K*256;W[H]+=K,W[M]=0}for(K=0,H=0;H<32;H++)W[H]+=K-(W[31]>>4)*hr[H],K=W[H]>>8,W[H]&=255;for(H=0;H<32;H++)W[H]-=K*hr[H];for(M=0;M<32;M++)W[M+1]+=W[M]>>8,P[M]=W[M]&255}function vr(P){var W=new Float64Array(64),K;for(K=0;K<64;K++)W[K]=P[K];for(K=0;K<64;K++)P[K]=0;Or(P,W)}function cr(P,W,K,M){var H=new Uint8Array(64),Ee=new Uint8Array(64),Ae=new Uint8Array(64),Fe,ut,Tt=new Float64Array(64),xt=[a(),a(),a(),a()];Qt(H,M,32),H[0]&=248,H[31]&=127,H[31]|=64;var dn=K+64;for(Fe=0;Fe<K;Fe++)P[64+Fe]=W[Fe];for(Fe=0;Fe<32;Fe++)P[32+Fe]=H[32+Fe];for(Qt(Ae,P.subarray(32),K+32),vr(Ae),kn(xt,Ae),Er(P,xt),Fe=32;Fe<64;Fe++)P[Fe]=M[Fe];for(Qt(Ee,P,K+64),vr(Ee),Fe=0;Fe<64;Fe++)Tt[Fe]=0;for(Fe=0;Fe<32;Fe++)Tt[Fe]=Ae[Fe];for(Fe=0;Fe<32;Fe++)for(ut=0;ut<32;ut++)Tt[Fe+ut]+=Ee[Fe]*H[ut];return Or(P.subarray(32),Tt),dn}function Nt(P,W){var K=a(),M=a(),H=a(),Ee=a(),Ae=a(),Fe=a(),ut=a();return xe(P[2],x),fe(P[1],W),Me(H,P[1]),pe(Ee,H,y),Le(H,H,P[2]),De(Ee,P[2],Ee),Me(Ae,Ee),Me(Fe,Ae),pe(ut,Fe,Ae),pe(K,ut,H),pe(K,K,Ee),At(K,K),pe(K,K,H),pe(K,K,Ee),pe(K,K,Ee),pe(P[0],K,Ee),Me(M,P[0]),pe(M,M,Ee),ft(M,H)&&pe(P[0],P[0],N),Me(M,P[0]),pe(M,M,Ee),ft(M,H)?-1:(ne(P[0])===W[31]>>7&&Le(P[0],m,P[0]),pe(P[3],P[0],P[1]),0)}function Wt(P,W,K,M){var H,Ee=new Uint8Array(32),Ae=new Uint8Array(64),Fe=[a(),a(),a(),a()],ut=[a(),a(),a(),a()];if(K<64||Nt(ut,M))return-1;for(H=0;H<K;H++)P[H]=W[H];for(H=0;H<32;H++)P[H+32]=M[H];if(Qt(Ae,P,K),vr(Ae),Bn(Fe,ut,Ae),kn(ut,W.subarray(32)),nr(Fe,ut),Er(Ee,Fe),K-=64,j(W,0,Ee,0)){for(H=0;H<K;H++)P[H]=0;return-1}for(H=0;H<K;H++)P[H]=W[H+64];return K}var Lt=32,an=24,tt=32,xn=16,Xt=32,En=32,Nn=32,Jr=32,In=32,on=an,Ft=tt,Gn=xn,sr=64,fr=32,hi=64,dr=32,qr=64;r.lowlevel={crypto_core_hsalsa20:oe,crypto_stream_xor:Qe,crypto_stream:le,crypto_stream_salsa20_xor:ee,crypto_stream_salsa20:ce,crypto_onetimeauth:ke,crypto_onetimeauth_verify:at,crypto_verify_16:X,crypto_verify_32:j,crypto_secretbox:et,crypto_secretbox_open:ve,crypto_scalarmult:It,crypto_scalarmult_base:Rt,crypto_box_beforenm:mt,crypto_box_afternm:qt,crypto_box:Zn,crypto_box_open:_n,crypto_box_keypair:ht,crypto_hash:Qt,crypto_sign:cr,crypto_sign_keypair:ai,crypto_sign_open:Wt,crypto_secretbox_KEYBYTES:Lt,crypto_secretbox_NONCEBYTES:an,crypto_secretbox_ZEROBYTES:tt,crypto_secretbox_BOXZEROBYTES:xn,crypto_scalarmult_BYTES:Xt,crypto_scalarmult_SCALARBYTES:En,crypto_box_PUBLICKEYBYTES:Nn,crypto_box_SECRETKEYBYTES:Jr,crypto_box_BEFORENMBYTES:In,crypto_box_NONCEBYTES:on,crypto_box_ZEROBYTES:Ft,crypto_box_BOXZEROBYTES:Gn,crypto_sign_BYTES:sr,crypto_sign_PUBLICKEYBYTES:fr,crypto_sign_SECRETKEYBYTES:hi,crypto_sign_SEEDBYTES:dr,crypto_hash_BYTES:qr,gf:a,D:y,L:hr,pack25519:qe,unpack25519:fe,M:pe,A:De,S:Me,Z:Le,pow2523:At,add:nr,set25519:xe,modL:Or,scalarmult:Bn,scalarbase:kn};function ei(P,W){if(P.length!==Lt)throw new Error("bad key size");if(W.length!==an)throw new Error("bad nonce size")}function ti(P,W){if(P.length!==Nn)throw new Error("bad public key size");if(W.length!==Jr)throw new Error("bad secret key size")}function Dr(){for(var P=0;P<arguments.length;P++)if(!(arguments[P]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Pr(P){for(var W=0;W<P.length;W++)P[W]=0}r.randomBytes=function(P){var W=new Uint8Array(P);return o(W,P),W},r.secretbox=function(P,W,K){Dr(P,W,K),ei(K,W);for(var M=new Uint8Array(tt+P.length),H=new Uint8Array(M.length),Ee=0;Ee<P.length;Ee++)M[Ee+tt]=P[Ee];return et(H,M,M.length,W,K),H.subarray(xn)},r.secretbox.open=function(P,W,K){Dr(P,W,K),ei(K,W);for(var M=new Uint8Array(xn+P.length),H=new Uint8Array(M.length),Ee=0;Ee<P.length;Ee++)M[Ee+xn]=P[Ee];return M.length<32||ve(H,M,M.length,W,K)!==0?null:H.subarray(tt)},r.secretbox.keyLength=Lt,r.secretbox.nonceLength=an,r.secretbox.overheadLength=xn,r.scalarMult=function(P,W){if(Dr(P,W),P.length!==En)throw new Error("bad n size");if(W.length!==Xt)throw new Error("bad p size");var K=new Uint8Array(Xt);return It(K,P,W),K},r.scalarMult.base=function(P){if(Dr(P),P.length!==En)throw new Error("bad n size");var W=new Uint8Array(Xt);return Rt(W,P),W},r.scalarMult.scalarLength=En,r.scalarMult.groupElementLength=Xt,r.box=function(P,W,K,M){var H=r.box.before(K,M);return r.secretbox(P,W,H)},r.box.before=function(P,W){Dr(P,W),ti(P,W);var K=new Uint8Array(In);return mt(K,P,W),K},r.box.after=r.secretbox,r.box.open=function(P,W,K,M){var H=r.box.before(K,M);return r.secretbox.open(P,W,H)},r.box.open.after=r.secretbox.open,r.box.keyPair=function(){var P=new Uint8Array(Nn),W=new Uint8Array(Jr);return ht(P,W),{publicKey:P,secretKey:W}},r.box.keyPair.fromSecretKey=function(P){if(Dr(P),P.length!==Jr)throw new Error("bad secret key size");var W=new Uint8Array(Nn);return Rt(W,P),{publicKey:W,secretKey:new Uint8Array(P)}},r.box.publicKeyLength=Nn,r.box.secretKeyLength=Jr,r.box.sharedKeyLength=In,r.box.nonceLength=on,r.box.overheadLength=r.secretbox.overheadLength,r.sign=function(P,W){if(Dr(P,W),W.length!==hi)throw new Error("bad secret key size");var K=new Uint8Array(sr+P.length);return cr(K,P,P.length,W),K},r.sign.open=function(P,W){if(Dr(P,W),W.length!==fr)throw new Error("bad public key size");var K=new Uint8Array(P.length),M=Wt(K,P,P.length,W);if(M<0)return null;for(var H=new Uint8Array(M),Ee=0;Ee<H.length;Ee++)H[Ee]=K[Ee];return H},r.sign.detached=function(P,W){for(var K=r.sign(P,W),M=new Uint8Array(sr),H=0;H<M.length;H++)M[H]=K[H];return M},r.sign.detached.verify=function(P,W,K){if(Dr(P,W,K),W.length!==sr)throw new Error("bad signature size");if(K.length!==fr)throw new Error("bad public key size");var M=new Uint8Array(sr+P.length),H=new Uint8Array(sr+P.length),Ee;for(Ee=0;Ee<sr;Ee++)M[Ee]=W[Ee];for(Ee=0;Ee<P.length;Ee++)M[Ee+sr]=P[Ee];return Wt(H,M,M.length,K)>=0},r.sign.keyPair=function(){var P=new Uint8Array(fr),W=new Uint8Array(hi);return ai(P,W),{publicKey:P,secretKey:W}},r.sign.keyPair.fromSecretKey=function(P){if(Dr(P),P.length!==hi)throw new Error("bad secret key size");for(var W=new Uint8Array(fr),K=0;K<W.length;K++)W[K]=P[32+K];return{publicKey:W,secretKey:new Uint8Array(P)}},r.sign.keyPair.fromSeed=function(P){if(Dr(P),P.length!==dr)throw new Error("bad seed size");for(var W=new Uint8Array(fr),K=new Uint8Array(hi),M=0;M<32;M++)K[M]=P[M];return ai(W,K,!0),{publicKey:W,secretKey:K}},r.sign.publicKeyLength=fr,r.sign.secretKeyLength=hi,r.sign.seedLength=dr,r.sign.signatureLength=sr,r.hash=function(P){Dr(P);var W=new Uint8Array(qr);return Qt(W,P,P.length),W},r.hash.hashLength=qr,r.verify=function(P,W){return Dr(P,W),P.length===0||W.length===0||P.length!==W.length?!1:z(P,0,W,0,P.length)===0},r.setPRNG=function(P){o=P},(function(){var P=typeof self<"u"?self.crypto||self.msCrypto:null;if(P&&P.getRandomValues){var W=65536;r.setPRNG(function(K,M){var H,Ee=new Uint8Array(M);for(H=0;H<M;H+=W)P.getRandomValues(Ee.subarray(H,H+Math.min(M-H,W)));for(H=0;H<M;H++)K[H]=Ee[H];Pr(Ee)})}else typeof P4<"u"&&(P=V4,P&&P.randomBytes&&r.setPRNG(function(K,M){var H,Ee=P.randomBytes(M);for(H=0;H<M;H++)K[H]=Ee[H];Pr(Ee)}))})()})(e.exports?e.exports:self.nacl=self.nacl||{})})(o0)),o0.exports}var j4=q4();const pf=zh(j4),Zc="geocam_device_keypair_v2",H4="302a300506032b6570032100";function yh(e){return Array.from(e).map(r=>r.toString(16).padStart(2,"0")).join("")}function Fh(e){const r=new Uint8Array(e.length/2);for(let a=0;a<e.length;a+=2)r[a/2]=parseInt(e.substring(a,a+2),16);return r}function Y4(e){let r="";for(let a=0;a<e.length;a++)r+=String.fromCharCode(e[a]);return btoa(r)}function W4(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let r="KEY-";for(let a=0;a<12;a++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}async function Lb(){const e=localStorage.getItem(Zc);if(e)try{const o=JSON.parse(e);if(o.publicKeyHex&&o.secretKeyHex)return{keyId:o.keyId,publicKeyHex:o.publicKeyHex}}catch{}const r=pf.sign.keyPair(),a={keyId:W4(),publicKeyHex:yh(r.publicKey),secretKeyHex:yh(r.secretKey)};return localStorage.setItem(Zc,JSON.stringify(a)),console.log("[Ed25519] New keypair generated:",a.keyId),{keyId:a.keyId,publicKeyHex:a.publicKeyHex}}function K4(){const e=localStorage.getItem(Zc);if(!e)throw new Error("KEYPAIR_NOT_FOUND");const r=JSON.parse(e);return Fh(r.secretKeyHex)}async function zb(e,r){const a=await Lb(),o=K4(),c=Date.now(),h=e+r+c,m=new TextEncoder().encode(h),x=pf.sign.detached(m,o),_=H4+a.publicKeyHex;return console.log("[Ed25519] Gate A signature created | keyId:",a.keyId,"| ts:",c),{signature:yh(x),public_key:_,client_timestamp:c}}async function Q4(e){const r=localStorage.getItem(Zc);if(!r)throw new Error("KEYPAIR_NOT_FOUND");const a=JSON.parse(r),o=Fh(a.secretKeyHex),c=new TextEncoder().encode(e),h=pf.sign.detached(c,o);return{signatureBase64:Y4(h),keyId:a.keyId}}function X4(e,r,a){try{const o=new TextEncoder().encode(e),c=atob(r),h=new Uint8Array(c.length);for(let x=0;x<c.length;x++)h[x]=c.charCodeAt(x);const m=Fh(a);return pf.sign.detached.verify(o,h,m)}catch{return!1}}const Z4="modulepreload",J4=function(e,r){return new URL(e,r).href},e2={},Jc=function(r,a,o){let c=Promise.resolve();if(a&&a.length>0){let y=function(S){return Promise.all(S.map(R=>Promise.resolve(R).then(B=>({status:"fulfilled",value:B}),B=>({status:"rejected",reason:B}))))};const m=document.getElementsByTagName("link"),x=document.querySelector("meta[property=csp-nonce]"),_=x?.nonce||x?.getAttribute("nonce");c=y(a.map(S=>{if(S=J4(S,o),S in e2)return;e2[S]=!0;const R=S.endsWith(".css"),B=R?'[rel="stylesheet"]':"";if(o)for(let k=m.length-1;k>=0;k--){const z=m[k];if(z.href===S&&(!R||z.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${S}"]${B}`))return;const N=document.createElement("link");if(N.rel=R?"stylesheet":Z4,R||(N.as="script"),N.crossOrigin="",N.href=S,_&&N.setAttribute("nonce",_),document.head.appendChild(N),R)return new Promise((k,z)=>{N.addEventListener("load",k),N.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${S}`)))})}))}function h(m){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=m,window.dispatchEvent(x),!x.defaultPrevented)throw m}return c.then(m=>{for(const x of m||[])x.status==="rejected"&&h(x.reason);return r().catch(h)})};var ml;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(ml||(ml={}));let l0=class extends Error{constructor(r,a,o){super(r),this.message=r,this.code=a,this.data=o}};const e8=e=>{var r,a;return e?.androidBridge?"android":!((a=(r=e?.webkit)===null||r===void 0?void 0:r.messageHandlers)===null||a===void 0)&&a.bridge?"ios":"web"},t8=e=>{const r=e.CapacitorCustomPlatform||null,a=e.Capacitor||{},o=a.Plugins=a.Plugins||{},c=()=>r!==null?r.name:e8(e),h=()=>c()!=="web",m=R=>{const B=y.get(R);return!!(B?.platforms.has(c())||x(R))},x=R=>{var B;return(B=a.PluginHeaders)===null||B===void 0?void 0:B.find(N=>N.name===R)},_=R=>e.console.error(R),y=new Map,S=(R,B={})=>{const N=y.get(R);if(N)return console.warn(`Capacitor plugin "${R}" already registered. Cannot register plugins twice.`),N.proxy;const k=c(),z=x(R);let X;const j=async()=>(!X&&k in B?X=typeof B[k]=="function"?X=await B[k]():X=B[k]:r!==null&&!X&&"web"in B&&(X=typeof B.web=="function"?X=await B.web():X=B.web),X),F=(ce,le)=>{var Qe,Je;if(z){const ke=z?.methods.find(at=>le===at.name);if(ke)return ke.rtype==="promise"?at=>a.nativePromise(R,le.toString(),at):(at,et)=>a.nativeCallback(R,le.toString(),at,et);if(ce)return(Qe=ce[le])===null||Qe===void 0?void 0:Qe.bind(ce)}else{if(ce)return(Je=ce[le])===null||Je===void 0?void 0:Je.bind(ce);throw new l0(`"${R}" plugin is not implemented on ${k}`,ml.Unimplemented)}},te=ce=>{let le;const Qe=(...Je)=>{const ke=j().then(at=>{const et=F(at,ce);if(et){const ve=et(...Je);return le=ve?.remove,ve}else throw new l0(`"${R}.${ce}()" is not implemented on ${k}`,ml.Unimplemented)});return ce==="addListener"&&(ke.remove=async()=>le()),ke};return Qe.toString=()=>`${ce.toString()}() { [capacitor code] }`,Object.defineProperty(Qe,"name",{value:ce,writable:!1,configurable:!1}),Qe},Q=te("addListener"),oe=te("removeListener"),ue=(ce,le)=>{const Qe=Q({eventName:ce},le),Je=async()=>{const at=await Qe;oe({eventName:ce,callbackId:at},le)},ke=new Promise(at=>Qe.then(()=>at({remove:Je})));return ke.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Je()},ke},ee=new Proxy({},{get(ce,le){switch(le){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return z?ue:Q;case"removeListener":return oe;default:return te(le)}}});return o[R]=ee,y.set(R,{name:R,proxy:ee,platforms:new Set([...Object.keys(B),...z?[k]:[]])}),ee};return a.convertFileSrc||(a.convertFileSrc=R=>R),a.getPlatform=c,a.handleError=_,a.isNativePlatform=h,a.isPluginAvailable=m,a.registerPlugin=S,a.Exception=l0,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a},n8=e=>e.Capacitor=t8(e),wh=n8(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Au=wh.registerPlugin;let Gh=class{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(r,a){let o=!1;this.listeners[r]||(this.listeners[r]=[],o=!0),this.listeners[r].push(a);const h=this.windowListeners[r];h&&!h.registered&&this.addWindowListener(h),o&&this.sendRetainedArgumentsForEvent(r);const m=async()=>this.removeListener(r,a);return Promise.resolve({remove:m})}async removeAllListeners(){this.listeners={};for(const r in this.windowListeners)this.removeWindowListener(this.windowListeners[r]);this.windowListeners={}}notifyListeners(r,a,o){const c=this.listeners[r];if(!c){if(o){let h=this.retainedEventArguments[r];h||(h=[]),h.push(a),this.retainedEventArguments[r]=h}return}c.forEach(h=>h(a))}hasListeners(r){var a;return!!(!((a=this.listeners[r])===null||a===void 0)&&a.length)}registerWindowListener(r,a){this.windowListeners[a]={registered:!1,windowEventName:r,pluginEventName:a,handler:o=>{this.notifyListeners(a,o)}}}unimplemented(r="not implemented"){return new wh.Exception(r,ml.Unimplemented)}unavailable(r="not available"){return new wh.Exception(r,ml.Unavailable)}async removeListener(r,a){const o=this.listeners[r];if(!o)return;const c=o.indexOf(a);this.listeners[r].splice(c,1),this.listeners[r].length||this.removeWindowListener(this.windowListeners[r])}addWindowListener(r){window.addEventListener(r.windowEventName,r.handler),r.registered=!0}removeWindowListener(r){r&&(window.removeEventListener(r.windowEventName,r.handler),r.registered=!1)}sendRetainedArgumentsForEvent(r){const a=this.retainedEventArguments[r];a&&(delete this.retainedEventArguments[r],a.forEach(o=>{this.notifyListeners(r,o)}))}};const t2=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),n2=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class r8 extends Gh{async getCookies(){const r=document.cookie,a={};return r.split(";").forEach(o=>{if(o.length<=0)return;let[c,h]=o.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=n2(c).trim(),h=n2(h).trim(),a[c]=h}),a}async setCookie(r){try{const a=t2(r.key),o=t2(r.value),c=`; expires=${(r.expires||"").replace("expires=","")}`,h=(r.path||"/").replace("path=",""),m=r.url!=null&&r.url.length>0?`domain=${r.url}`:"";document.cookie=`${a}=${o||""}${c}; path=${h}; ${m};`}catch(a){return Promise.reject(a)}}async deleteCookie(r){try{document.cookie=`${r.key}=; Max-Age=0`}catch(a){return Promise.reject(a)}}async clearCookies(){try{const r=document.cookie.split(";")||[];for(const a of r)document.cookie=a.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(r){return Promise.reject(r)}}async clearAllCookies(){try{await this.clearCookies()}catch(r){return Promise.reject(r)}}}Au("CapacitorCookies",{web:()=>new r8});const i8=async e=>new Promise((r,a)=>{const o=new FileReader;o.onload=()=>{const c=o.result;r(c.indexOf(",")>=0?c.split(",")[1]:c)},o.onerror=c=>a(c),o.readAsDataURL(e)}),a8=(e={})=>{const r=Object.keys(e);return Object.keys(e).map(c=>c.toLocaleLowerCase()).reduce((c,h,m)=>(c[h]=e[r[m]],c),{})},s8=(e,r=!0)=>e?Object.entries(e).reduce((o,c)=>{const[h,m]=c;let x,_;return Array.isArray(m)?(_="",m.forEach(y=>{x=r?encodeURIComponent(y):y,_+=`${h}=${x}&`}),_.slice(0,-1)):(x=r?encodeURIComponent(m):m,_=`${h}=${x}`),`${o}&${_}`},"").substr(1):null,o8=(e,r={})=>{const a=Object.assign({method:e.method||"GET",headers:e.headers},r),c=a8(e.headers)["content-type"]||"";if(typeof e.data=="string")a.body=e.data;else if(c.includes("application/x-www-form-urlencoded")){const h=new URLSearchParams;for(const[m,x]of Object.entries(e.data||{}))h.set(m,x);a.body=h.toString()}else if(c.includes("multipart/form-data")||e.data instanceof FormData){const h=new FormData;if(e.data instanceof FormData)e.data.forEach((x,_)=>{h.append(_,x)});else for(const x of Object.keys(e.data))h.append(x,e.data[x]);a.body=h;const m=new Headers(a.headers);m.delete("content-type"),a.headers=m}else(c.includes("application/json")||typeof e.data=="object")&&(a.body=JSON.stringify(e.data));return a};class l8 extends Gh{async request(r){const a=o8(r,r.webFetchExtra),o=s8(r.params,r.shouldEncodeUrlParams),c=o?`${r.url}?${o}`:r.url,h=await fetch(c,a),m=h.headers.get("content-type")||"";let{responseType:x="text"}=h.ok?r:{};m.includes("application/json")&&(x="json");let _,y;switch(x){case"arraybuffer":case"blob":y=await h.blob(),_=await i8(y);break;case"json":_=await h.json();break;default:_=await h.text()}const S={};return h.headers.forEach((R,B)=>{S[B]=R}),{data:_,headers:S,status:h.status,url:h.url}}async get(r){return this.request(Object.assign(Object.assign({},r),{method:"GET"}))}async post(r){return this.request(Object.assign(Object.assign({},r),{method:"POST"}))}async put(r){return this.request(Object.assign(Object.assign({},r),{method:"PUT"}))}async patch(r){return this.request(Object.assign(Object.assign({},r),{method:"PATCH"}))}async delete(r){return this.request(Object.assign(Object.assign({},r),{method:"DELETE"}))}}Au("CapacitorHttp",{web:()=>new l8});var r2;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(r2||(r2={}));var i2;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(i2||(i2={}));class u8 extends Gh{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Au("SystemBars",{web:()=>new u8});const a2=Au("Device",{web:()=>Jc(()=>import("./web-DQ9aax68.js"),[],import.meta.url).then(e=>new e.DeviceWeb)}),c8="2.0.0";async function f8(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(a)).map(o=>o.toString(16).padStart(2,"0")).join("")}function d8(){let e=localStorage.getItem("geocam_device_id");return e||(e="DEV-"+crypto.randomUUID().substring(0,12).toUpperCase(),localStorage.setItem("geocam_device_id",e)),e}let Ao=null,s2=null;async function h8(){if(Ao)return{...Ao,native_id:s2};try{const e=await a2.getInfo();let r=null;try{r=(await a2.getId()).identifier||null}catch{}return Ao={platform:e.platform||"web",model:e.model||e.name||"Unknown",os_version:e.osVersion||"Unknown"},s2=r,console.log("[GateB] Capacitor Device:",Ao.platform,Ao.model,Ao.os_version),{...Ao,native_id:r}}catch{return console.warn("[GateB] Capacitor Device API unavailable, using UA fallback"),p8()}}function p8(){const e=navigator.userAgent;let r="web";return/iPhone|iPad/.test(e)?r="ios":/Android/.test(e)&&(r="android"),{platform:r,model:navigator.platform||"Unknown",os_version:e.substring(0,50),native_id:null}}async function Ub(){const e=await h8(),r=d8(),a=Date.now(),o=[r,e.native_id||"web",c8,e.platform,e.model,String(a)].join(":"),c=await f8(o);return console.log("[GateB] attestation generated | platform:",e.platform,"| len:",c.length),{device_info:{platform:e.platform,model:e.model,os_version:e.os_version},app_attestation:c}}function g8(e){e.CapacitorUtils.Synapse=new Proxy({},{get(r,a){return new Proxy({},{get(o,c){return(h,m,x)=>{const _=e.Capacitor.Plugins[a];if(_===void 0){x(new Error(`Capacitor plugin ${a} not found`));return}if(typeof _[c]!="function"){x(new Error(`Method ${c} not found in Capacitor plugin ${a}`));return}(async()=>{try{const y=await _[c](h);m(y)}catch(y){x(y)}})()}}})}})}function m8(e){e.CapacitorUtils.Synapse=new Proxy({},{get(r,a){return e.cordova.plugins[a]}})}function x8(e=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!e?g8(window):window.cordova!==void 0&&m8(window))}const y8=Au("Geolocation",{web:()=>Jc(()=>import("./web-Ds97b7JG.js"),[],import.meta.url).then(e=>new e.GeolocationWeb)});x8();async function w8(){const e=await y8.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4});return{gps:{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy??void 0},client_timestamp:e.timestamp}}function b8(){return new Promise((e,r)=>{if(!navigator.geolocation){r(new Error("Geolocation API not supported"));return}navigator.geolocation.getCurrentPosition(a=>{e({gps:{latitude:a.coords.latitude,longitude:a.coords.longitude,accuracy:a.coords.accuracy??void 0},client_timestamp:a.timestamp})},a=>{r(new Error("WEB_GEO_"+a.code+": "+a.message))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4})})}async function Pb(){try{const e=await w8();return console.log("[GateC] Capacitor GPS:",e.gps.latitude,e.gps.longitude,"",e.gps.accuracy),e}catch(e){console.warn("[GateC] Capacitor Geolocation failed, trying web fallback:",e)}try{const e=await b8();return console.log("[GateC] Web GPS:",e.gps.latitude,e.gps.longitude,"",e.gps.accuracy),e}catch(e){console.warn("[GateC] GPS unavailable (permission denied or unsupported):",e)}return null}var Vh=Object.defineProperty,v8=Object.getOwnPropertyDescriptor,_8=Object.getOwnPropertyNames,C8=Object.prototype.hasOwnProperty,A8=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,a)=>(typeof require<"u"?require:r)[a]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),gt=(e,r)=>()=>(e&&(r=e(e=0)),r),bl=(e,r)=>{for(var a in r)Vh(e,a,{get:r[a],enumerable:!0})},E8=(e,r,a,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let c of _8(r))!C8.call(e,c)&&c!==a&&Vh(e,c,{get:()=>r[c],enumerable:!(o=v8(r,c))||o.enumerable});return e},_u=e=>E8(Vh({},"__esModule",{value:!0}),e),tu,io,hl,o2,Fb,Gb=gt(()=>{tu=new Map,io=[],hl=(e,r,a)=>{if(r&&typeof r.init=="function"&&typeof r.createInferenceSessionHandler=="function"){let o=tu.get(e);if(o===void 0)tu.set(e,{backend:r,priority:a});else{if(o.priority>a)return;if(o.priority===a&&o.backend!==r)throw new Error(`cannot register backend "${e}" using priority ${a}`)}if(a>=0){let c=io.indexOf(e);c!==-1&&io.splice(c,1);for(let h=0;h<io.length;h++)if(tu.get(io[h]).priority<=a){io.splice(h,0,e);return}io.push(e)}return}throw new TypeError("not a valid backend")},o2=async e=>{let r=tu.get(e);if(!r)return"backend not found.";if(r.initialized)return r.backend;if(r.aborted)return r.error;{let a=!!r.initPromise;try{return a||(r.initPromise=r.backend.init(e)),await r.initPromise,r.initialized=!0,r.backend}catch(o){return a||(r.error=`${o}`,r.aborted=!0),r.error}finally{delete r.initPromise}}},Fb=async e=>{let r=e.executionProviders||[],a=r.map(_=>typeof _=="string"?_:_.name),o=a.length===0?io:a,c,h=[],m=new Set;for(let _ of o){let y=await o2(_);typeof y=="string"?h.push({name:_,err:y}):(c||(c=y),c===y&&m.add(_))}if(!c)throw new Error(`no available backend found. ERR: ${h.map(_=>`[${_.name}] ${_.err}`).join(", ")}`);for(let{name:_,err:y}of h)a.includes(_)&&console.warn(`removing requested execution provider "${_}" from session options because it is not available: ${y}`);let x=r.filter(_=>m.has(typeof _=="string"?_:_.name));return[c,new Proxy(e,{get:(_,y)=>y==="executionProviders"?x:Reflect.get(_,y)})]}}),T8=gt(()=>{Gb()}),Vb,S8=gt(()=>{Vb="1.23.2"}),u0,fi,qb=gt(()=>{S8(),u0="warning",fi={wasm:{},webgl:{},webgpu:{},versions:{common:Vb},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);u0=e}},get logLevel(){return u0}},Object.defineProperty(fi,"logLevel",{enumerable:!0})}),Ar,I8=gt(()=>{qb(),Ar=fi}),jb,Hb,R8=gt(()=>{jb=(e,r)=>{let a=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);a.width=e.dims[3],a.height=e.dims[2];let o=a.getContext("2d");if(o!=null){let c,h;r?.tensorLayout!==void 0&&r.tensorLayout==="NHWC"?(c=e.dims[2],h=e.dims[3]):(c=e.dims[3],h=e.dims[2]);let m=r?.format!==void 0?r.format:"RGB",x=r?.norm,_,y;x===void 0||x.mean===void 0?_=[255,255,255,255]:typeof x.mean=="number"?_=[x.mean,x.mean,x.mean,x.mean]:(_=[x.mean[0],x.mean[1],x.mean[2],0],x.mean[3]!==void 0&&(_[3]=x.mean[3])),x===void 0||x.bias===void 0?y=[0,0,0,0]:typeof x.bias=="number"?y=[x.bias,x.bias,x.bias,x.bias]:(y=[x.bias[0],x.bias[1],x.bias[2],0],x.bias[3]!==void 0&&(y[3]=x.bias[3]));let S=h*c,R=0,B=S,N=S*2,k=-1;m==="RGBA"?(R=0,B=S,N=S*2,k=S*3):m==="RGB"?(R=0,B=S,N=S*2):m==="RBG"&&(R=0,N=S,B=S*2);for(let z=0;z<h;z++)for(let X=0;X<c;X++){let j=(e.data[R++]-y[0])*_[0],F=(e.data[B++]-y[1])*_[1],te=(e.data[N++]-y[2])*_[2],Q=k===-1?255:(e.data[k++]-y[3])*_[3];o.fillStyle="rgba("+j+","+F+","+te+","+Q+")",o.fillRect(X,z,1,1)}if("toDataURL"in a)return a.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Hb=(e,r)=>{let a=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),o;if(a!=null){let c,h,m;r?.tensorLayout!==void 0&&r.tensorLayout==="NHWC"?(c=e.dims[2],h=e.dims[1],m=e.dims[3]):(c=e.dims[3],h=e.dims[2],m=e.dims[1]);let x=r!==void 0&&r.format!==void 0?r.format:"RGB",_=r?.norm,y,S;_===void 0||_.mean===void 0?y=[255,255,255,255]:typeof _.mean=="number"?y=[_.mean,_.mean,_.mean,_.mean]:(y=[_.mean[0],_.mean[1],_.mean[2],255],_.mean[3]!==void 0&&(y[3]=_.mean[3])),_===void 0||_.bias===void 0?S=[0,0,0,0]:typeof _.bias=="number"?S=[_.bias,_.bias,_.bias,_.bias]:(S=[_.bias[0],_.bias[1],_.bias[2],0],_.bias[3]!==void 0&&(S[3]=_.bias[3]));let R=h*c;if(r!==void 0&&(r.format!==void 0&&m===4&&r.format!=="RGBA"||m===3&&r.format!=="RGB"&&r.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let B=4,N=0,k=1,z=2,X=3,j=0,F=R,te=R*2,Q=-1;x==="RGBA"?(j=0,F=R,te=R*2,Q=R*3):x==="RGB"?(j=0,F=R,te=R*2):x==="RBG"&&(j=0,te=R,F=R*2),o=a.createImageData(c,h);for(let oe=0;oe<h*c;N+=B,k+=B,z+=B,X+=B,oe++)o.data[N]=(e.data[j++]-S[0])*y[0],o.data[k]=(e.data[F++]-S[1])*y[1],o.data[z]=(e.data[te++]-S[2])*y[2],o.data[X]=Q===-1?255:(e.data[Q++]-S[3])*y[3]}else throw new Error("Can not access image data");return o}}),Ec,Yb,Wb,Kb,Qb,Xb,O8=gt(()=>{qh(),Ec=(e,r)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(r.height===void 0||r.width===void 0)throw new Error("Image height and width must be defined");if(r.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:a,width:o}=r,c=r.norm??{mean:255,bias:0},h,m;typeof c.mean=="number"?h=[c.mean,c.mean,c.mean,c.mean]:h=[c.mean[0],c.mean[1],c.mean[2],c.mean[3]??255],typeof c.bias=="number"?m=[c.bias,c.bias,c.bias,c.bias]:m=[c.bias[0],c.bias[1],c.bias[2],c.bias[3]??0];let x=r.format!==void 0?r.format:"RGBA",_=r.tensorFormat!==void 0&&r.tensorFormat!==void 0?r.tensorFormat:"RGB",y=a*o,S=_==="RGBA"?new Float32Array(y*4):new Float32Array(y*3),R=4,B=0,N=1,k=2,z=3,X=0,j=y,F=y*2,te=-1;x==="RGB"&&(R=3,B=0,N=1,k=2,z=-1),_==="RGBA"?te=y*3:_==="RBG"?(X=0,F=y,j=y*2):_==="BGR"&&(F=0,j=y,X=y*2);for(let Q=0;Q<y;Q++,B+=R,k+=R,N+=R,z+=R)S[X++]=(e[B]+m[0])/h[0],S[j++]=(e[N]+m[1])/h[1],S[F++]=(e[k]+m[2])/h[2],te!==-1&&z!==-1&&(S[te++]=(e[z]+m[3])/h[3]);return _==="RGBA"?new oa("float32",S,[1,4,a,o]):new oa("float32",S,[1,3,a,o])},Yb=async(e,r)=>{let a=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,o=typeof ImageData<"u"&&e instanceof ImageData,c=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,h=typeof e=="string",m,x=r??{},_=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},y=S=>typeof HTMLCanvasElement<"u"&&S instanceof HTMLCanvasElement||S instanceof OffscreenCanvas?S.getContext("2d"):null;if(a){let S=_();S.width=e.width,S.height=e.height;let R=y(S);if(R!=null){let B=e.height,N=e.width;if(r!==void 0&&r.resizedHeight!==void 0&&r.resizedWidth!==void 0&&(B=r.resizedHeight,N=r.resizedWidth),r!==void 0){if(x=r,r.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");x.tensorFormat="RGBA",x.height=B,x.width=N}else x.tensorFormat="RGBA",x.height=B,x.width=N;R.drawImage(e,0,0),m=R.getImageData(0,0,N,B).data}else throw new Error("Can not access image data")}else if(o){let S,R;if(r!==void 0&&r.resizedWidth!==void 0&&r.resizedHeight!==void 0?(S=r.resizedHeight,R=r.resizedWidth):(S=e.height,R=e.width),r!==void 0&&(x=r),x.format="RGBA",x.height=S,x.width=R,r!==void 0){let B=_();B.width=R,B.height=S;let N=y(B);if(N!=null)N.putImageData(e,0,0),m=N.getImageData(0,0,R,S).data;else throw new Error("Can not access image data")}else m=e.data}else if(c){if(r===void 0)throw new Error("Please provide image config with format for Imagebitmap");let S=_();S.width=e.width,S.height=e.height;let R=y(S);if(R!=null){let B=e.height,N=e.width;return R.drawImage(e,0,0,N,B),m=R.getImageData(0,0,N,B).data,x.height=B,x.width=N,Ec(m,x)}else throw new Error("Can not access image data")}else{if(h)return new Promise((S,R)=>{let B=_(),N=y(B);if(!e||!N)return R();let k=new Image;k.crossOrigin="Anonymous",k.src=e,k.onload=()=>{B.width=k.width,B.height=k.height,N.drawImage(k,0,0,B.width,B.height);let z=N.getImageData(0,0,B.width,B.height);x.height=B.height,x.width=B.width,S(Ec(z.data,x))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(m!==void 0)return Ec(m,x);throw new Error("Input data provided is not supported - aborted tensor creation")},Wb=(e,r)=>{let{width:a,height:o,download:c,dispose:h}=r,m=[1,o,a,4];return new oa({location:"texture",type:"float32",texture:e,dims:m,download:c,dispose:h})},Kb=(e,r)=>{let{dataType:a,dims:o,download:c,dispose:h}=r;return new oa({location:"gpu-buffer",type:a??"float32",gpuBuffer:e,dims:o,download:c,dispose:h})},Qb=(e,r)=>{let{dataType:a,dims:o,download:c,dispose:h}=r;return new oa({location:"ml-tensor",type:a??"float32",mlTensor:e,dims:o,download:c,dispose:h})},Xb=(e,r,a)=>new oa({location:"cpu-pinned",type:e,data:r,dims:a??[r.length]})}),Ro,xu,c0,Zb,D8=gt(()=>{Ro=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),xu=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),c0=!1,Zb=()=>{if(!c0){c0=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,r=typeof BigUint64Array<"u"&&BigUint64Array.from,a=globalThis.Float16Array,o=typeof a<"u"&&a.from;e&&(Ro.set("int64",BigInt64Array),xu.set(BigInt64Array,"int64")),r&&(Ro.set("uint64",BigUint64Array),xu.set(BigUint64Array,"uint64")),o?(Ro.set("float16",a),xu.set(a,"float16")):Ro.set("float16",Uint16Array)}}}),Jb,e3,M8=gt(()=>{qh(),Jb=e=>{let r=1;for(let a=0;a<e.length;a++){let o=e[a];if(typeof o!="number"||!Number.isSafeInteger(o))throw new TypeError(`dims[${a}] must be an integer, got: ${o}`);if(o<0)throw new RangeError(`dims[${a}] must be a non-negative integer, got: ${o}`);r*=o}return r},e3=(e,r)=>{switch(e.location){case"cpu":return new oa(e.type,e.data,r);case"cpu-pinned":return new oa({location:"cpu-pinned",data:e.data,type:e.type,dims:r});case"texture":return new oa({location:"texture",texture:e.texture,type:e.type,dims:r});case"gpu-buffer":return new oa({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:r});case"ml-tensor":return new oa({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:r});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),oa,qh=gt(()=>{R8(),O8(),D8(),M8(),oa=class{constructor(e,r,a){Zb();let o,c;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,o=e.type,c=e.dims,e.location){case"cpu-pinned":{let m=Ro.get(o);if(!m)throw new TypeError(`unsupported type "${o}" to create tensor from pinned buffer`);if(!(e.data instanceof m))throw new TypeError(`buffer should be of type ${m.name}`);this.cpuData=e.data;break}case"texture":{if(o!=="float32")throw new TypeError(`unsupported type "${o}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(o!=="float32"&&o!=="float16"&&o!=="int32"&&o!=="int64"&&o!=="uint32"&&o!=="uint8"&&o!=="bool"&&o!=="uint4"&&o!=="int4")throw new TypeError(`unsupported type "${o}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(o!=="float32"&&o!=="float16"&&o!=="int32"&&o!=="int64"&&o!=="uint32"&&o!=="uint64"&&o!=="int8"&&o!=="uint8"&&o!=="bool"&&o!=="uint4"&&o!=="int4")throw new TypeError(`unsupported type "${o}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let m,x;if(typeof e=="string")if(o=e,x=a,e==="string"){if(!Array.isArray(r))throw new TypeError("A string tensor's data must be a string array.");m=r}else{let _=Ro.get(e);if(_===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(r)){if(e==="float16"&&_===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${_.name} as data.`);e==="uint64"||e==="int64"?m=_.from(r,BigInt):m=_.from(r)}else if(r instanceof _)m=r;else if(r instanceof Uint8ClampedArray)if(e==="uint8")m=Uint8Array.from(r);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&r instanceof Uint16Array&&_!==Uint16Array)m=new globalThis.Float16Array(r.buffer,r.byteOffset,r.length);else throw new TypeError(`A ${o} tensor's data must be type of ${_}`)}else if(x=r,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let _=typeof e[0];if(_==="string")o="string",m=e;else if(_==="boolean")o="bool",m=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${_}.`)}else if(e instanceof Uint8ClampedArray)o="uint8",m=Uint8Array.from(e);else{let _=xu.get(e.constructor);if(_===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);o=_,m=e}if(x===void 0)x=[m.length];else if(!Array.isArray(x))throw new TypeError("A tensor's dims must be a number array");c=x,this.cpuData=m,this.dataLocation="cpu"}let h=Jb(c);if(this.cpuData&&h!==this.cpuData.length&&!((o==="uint4"||o==="int4")&&Math.ceil(h/2)===this.cpuData.length))throw new Error(`Tensor's size(${h}) does not match data length(${this.cpuData.length}).`);this.type=o,this.dims=c,this.size=h}static async fromImage(e,r){return Yb(e,r)}static fromTexture(e,r){return Wb(e,r)}static fromGpuBuffer(e,r){return Kb(e,r)}static fromMLTensor(e,r){return Qb(e,r)}static fromPinnedBuffer(e,r,a){return Xb(e,r,a)}toDataURL(e){return jb(this,e)}toImageData(e){return Hb(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let r=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=r,e&&this.disposer&&(this.disposer(),this.disposer=void 0),r}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return e3(this,e)}}}),Fa,t3=gt(()=>{qh(),Fa=oa}),ef,f0,is,Ga,Mo,Bo,n3=gt(()=>{qb(),ef=(e,r)=>{(typeof fi.trace>"u"?!fi.wasm.trace:!fi.trace)||console.timeStamp(`${e}::ORT::${r}`)},f0=(e,r)=>{let a=new Error().stack?.split(/\r\n|\r|\n/g)||[],o=!1;for(let c=0;c<a.length;c++){if(o&&!a[c].includes("TRACE_FUNC")){let h=`FUNC_${e}::${a[c].trim().split(" ")[1]}`;r&&(h+=`::${r}`),ef("CPU",h);return}a[c].includes("TRACE_FUNC")&&(o=!0)}},is=e=>{(typeof fi.trace>"u"?!fi.wasm.trace:!fi.trace)||f0("BEGIN",e)},Ga=e=>{(typeof fi.trace>"u"?!fi.wasm.trace:!fi.trace)||f0("END",e)},Mo=e=>{(typeof fi.trace>"u"?!fi.wasm.trace:!fi.trace)||console.time(`ORT::${e}`)},Bo=e=>{(typeof fi.trace>"u"?!fi.wasm.trace:!fi.trace)||console.timeEnd(`ORT::${e}`)}}),r3,B8=gt(()=>{Gb(),t3(),n3(),r3=class i3{constructor(r){this.handler=r}async run(r,a,o){is(),Mo("InferenceSession.run");let c={},h={};if(typeof r!="object"||r===null||r instanceof Fa||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let m=!0;if(typeof a=="object"){if(a===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(a instanceof Fa)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(a)){if(a.length===0)throw new TypeError("'fetches' cannot be an empty array.");m=!1;for(let y of a){if(typeof y!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(y)===-1)throw new RangeError(`'fetches' contains invalid output name: ${y}.`);c[y]=null}if(typeof o=="object"&&o!==null)h=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else{let y=!1,S=Object.getOwnPropertyNames(a);for(let R of this.outputNames)if(S.indexOf(R)!==-1){let B=a[R];(B===null||B instanceof Fa)&&(y=!0,m=!1,c[R]=B)}if(y){if(typeof o=="object"&&o!==null)h=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else h=a}}else if(typeof a<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let y of this.inputNames)if(typeof r[y]>"u")throw new Error(`input '${y}' is missing in 'feeds'.`);if(m)for(let y of this.outputNames)c[y]=null;let x=await this.handler.run(r,c,h),_={};for(let y in x)if(Object.hasOwnProperty.call(x,y)){let S=x[y];S instanceof Fa?_[y]=S:_[y]=new Fa(S.type,S.data,S.dims)}return Bo("InferenceSession.run"),Ga(),_}async release(){return this.handler.dispose()}static async create(r,a,o,c){is(),Mo("InferenceSession.create");let h,m={};if(typeof r=="string"){if(h=r,typeof a=="object"&&a!==null)m=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(r instanceof Uint8Array){if(h=r,typeof a=="object"&&a!==null)m=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer){let S=r,R=0,B=r.byteLength;if(typeof a=="object"&&a!==null)m=a;else if(typeof a=="number"){if(R=a,!Number.isSafeInteger(R))throw new RangeError("'byteOffset' must be an integer.");if(R<0||R>=S.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${S.byteLength}).`);if(B=r.byteLength-R,typeof o=="number"){if(B=o,!Number.isSafeInteger(B))throw new RangeError("'byteLength' must be an integer.");if(B<=0||R+B>S.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${S.byteLength-R}].`);if(typeof c=="object"&&c!==null)m=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else if(typeof o<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof a<"u")throw new TypeError("'options' must be an object.");h=new Uint8Array(S,R,B)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[x,_]=await Fb(m),y=await x.createInferenceSessionHandler(h,_);return Bo("InferenceSession.create"),Ga(),new i3(y)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),jh,N8=gt(()=>{B8(),jh=r3}),k8=gt(()=>{}),$8=gt(()=>{}),L8=gt(()=>{}),z8=gt(()=>{}),U8={};bl(U8,{InferenceSession:()=>jh,TRACE:()=>ef,TRACE_EVENT_BEGIN:()=>Mo,TRACE_EVENT_END:()=>Bo,TRACE_FUNC_BEGIN:()=>is,TRACE_FUNC_END:()=>Ga,Tensor:()=>Fa,env:()=>Ar,registerBackend:()=>hl});var Aa=gt(()=>{T8(),I8(),N8(),t3(),k8(),$8(),n3(),L8(),z8()}),Hh=gt(()=>{}),a3={};bl(a3,{default:()=>s3});var d0,h0,s3,P8=gt(()=>{fC(),zo(),Yh(),d0="ort-wasm-proxy-worker",h0=globalThis.self?.name===d0,h0&&(self.onmessage=e=>{let{type:r,in:a}=e.data;try{switch(r){case"init-wasm":Wh(a.wasm).then(()=>{f1(a).then(()=>{postMessage({type:r})},o=>{postMessage({type:r,err:o})})},o=>{postMessage({type:r,err:o})});break;case"init-ep":{let{epName:o,env:c}=a;d1(c,o).then(()=>{postMessage({type:r})},h=>{postMessage({type:r,err:h})});break}case"copy-from":{let{buffer:o}=a,c=lf(o);postMessage({type:r,out:c});break}case"create":{let{model:o,options:c}=a;h1(o,c).then(h=>{postMessage({type:r,out:h})},h=>{postMessage({type:r,err:h})});break}case"release":p1(a),postMessage({type:r});break;case"run":{let{sessionId:o,inputIndices:c,inputs:h,outputIndices:m,options:x}=a;g1(o,c,h,m,new Array(m.length).fill(null),x).then(_=>{_.some(y=>y[3]!=="cpu")?postMessage({type:r,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:r,out:_},x1([...h,..._]))},_=>{postMessage({type:r,err:_})});break}case"end-profiling":m1(a),postMessage({type:r});break;default:}}catch(o){postMessage({type:r,err:o})}}),s3=h0?null:e=>new Worker(e??aa,{type:"module",name:d0})}),o3={};bl(o3,{default:()=>l3});var p0,l3,l2,F8=gt(()=>{p0=async function(e={}){var r,a,o=e,c=new Promise((v,I)=>{r=v,a=I}),h=typeof window=="object",m=typeof WorkerGlobalScope<"u",x=m&&self.name?.startsWith("em-pthread");o.mountExternalData=(v,I)=>{v.startsWith("./")&&(v=v.substring(2)),(o.Fb||(o.Fb=new Map)).set(v,I)},o.unmountExternalData=()=>{delete o.Fb};var _=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,qc:!0}).buffer.constructor;let y=v=>async(...I)=>{try{if(o.Gb)throw Error("Session already started");let b=o.Gb={ec:I[0],errors:[]},A=await v(...I);if(o.Gb!==b)throw Error("Session mismatch");o.Kb?.flush();let D=b.errors;if(0<D.length){let $=await Promise.all(D);if($=$.filter(q=>q),0<$.length)throw Error($.join(`
`))}return A}finally{o.Gb=null}};o.jsepInit=(v,I)=>{if(v==="webgpu"){[o.Kb,o.Vb,o.Zb,o.Lb,o.Yb,o.Ab,o.$b,o.bc,o.Wb,o.Xb,o.ac]=I;let b=o.Kb;o.jsepRegisterBuffer=(A,D,$,q)=>b.registerBuffer(A,D,$,q),o.jsepGetBuffer=A=>b.getBuffer(A),o.jsepCreateDownloader=(A,D,$)=>b.createDownloader(A,D,$),o.jsepOnCreateSession=A=>{b.onCreateSession(A)},o.jsepOnReleaseSession=A=>{b.onReleaseSession(A)},o.jsepOnRunStart=A=>b.onRunStart(A),o.cc=(A,D)=>{b.upload(A,D)}}else if(v==="webnn"){let b=I[0];[o.oc,o.Ob,o.webnnEnsureTensor,o.Pb,o.webnnDownloadTensor,o.nc,o.webnnEnableTraceEvent]=I.slice(1),o.webnnReleaseTensorId=o.Ob,o.webnnUploadTensor=o.Pb,o.webnnRegisterMLContext=o.nc,o.webnnOnRunStart=A=>b.onRunStart(A),o.webnnOnRunEnd=b.onRunEnd.bind(b),o.webnnOnReleaseSession=A=>{b.onReleaseSession(A)},o.webnnCreateMLTensorDownloader=(A,D)=>b.createMLTensorDownloader(A,D),o.webnnRegisterMLTensor=(A,D,$,q)=>b.registerMLTensor(A,D,$,q),o.webnnCreateMLContext=A=>b.createMLContext(A),o.webnnRegisterMLConstant=(A,D,$,q,Z,se)=>b.registerMLConstant(A,D,$,q,Z,o.Fb,se),o.webnnRegisterGraphInput=b.registerGraphInput.bind(b),o.webnnIsGraphInput=b.isGraphInput.bind(b),o.webnnRegisterGraphOutput=b.registerGraphOutput.bind(b),o.webnnIsGraphOutput=b.isGraphOutput.bind(b),o.webnnCreateTemporaryTensor=b.createTemporaryTensor.bind(b),o.webnnIsGraphInputOutputTypeSupported=b.isGraphInputOutputTypeSupported.bind(b)}};let S=()=>{let v=(I,b,A)=>(...D)=>{let $=oi,q=b?.();D=I(...D);let Z=b?.();return q!==Z&&(I=Z,A(q),b=A=null),oi!=$?new Promise((se,de)=>{pn={resolve:se,reject:de}}):D};(()=>{for(let I of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])o[I]=v(o[I],()=>o[I],b=>o[I]=b)})(),y!==void 0&&(o._OrtRun=y(o._OrtRun),o._OrtRunWithBinding=y(o._OrtRunWithBinding)),S=void 0};o.asyncInit=()=>{S?.()};var R,B,N=(v,I)=>{throw I},k=import.meta.url,z="";if(h||m){try{z=new URL(".",k).href}catch{}m&&(B=v=>{var I=new XMLHttpRequest;return I.open("GET",v,!1),I.responseType="arraybuffer",I.send(null),new Uint8Array(I.response)}),R=async v=>{if(ft(v))return new Promise((b,A)=>{var D=new XMLHttpRequest;D.open("GET",v,!0),D.responseType="arraybuffer",D.onload=()=>{D.status==200||D.status==0&&D.response?b(D.response):A(D.status)},D.onerror=A,D.send(null)});var I=await fetch(v,{credentials:"same-origin"});if(I.ok)return I.arrayBuffer();throw Error(I.status+" : "+I.url)}}var X,j,F,te,Q,oe,ue,ee,ce,le,Qe,Je,ke,at,et,ve=console.log.bind(console),xe=console.error.bind(console),_e=ve,Ge=xe,qe=!1,ft=v=>v.startsWith("file://");function ne(){return j.buffer!=Q.buffer&&Rt(),Q}function fe(){return j.buffer!=Q.buffer&&Rt(),oe}function De(){return j.buffer!=Q.buffer&&Rt(),ue}function Le(){return j.buffer!=Q.buffer&&Rt(),ee}function pe(){return j.buffer!=Q.buffer&&Rt(),ce}function Me(){return j.buffer!=Q.buffer&&Rt(),le}function Bt(){return j.buffer!=Q.buffer&&Rt(),Qe}function At(){return j.buffer!=Q.buffer&&Rt(),at}if(x){let v=function(I){try{var b=I.data,A=b.Db;if(A==="load"){let D=[];self.onmessage=$=>D.push($),self.startWorker=()=>{postMessage({Db:"loaded"});for(let $ of D)v($);self.onmessage=v};for(let $ of b.Sb)o[$]&&!o[$].proxy||(o[$]=(...q)=>{postMessage({Db:"callHandler",Rb:$,args:q})},$=="print"&&(_e=o[$]),$=="printErr"&&(Ge=o[$]));j=b.kc,Rt(),et(b.lc)}else if(A==="run"){xn(b.Bb),f(b.Bb,0,0,1,0,0),Lt(),re(b.Bb),It||(G(),It=!0);try{Xt(b.hc,b.Jb)}catch(D){if(D!="unwind")throw D}}else b.target!=="setimmediate"&&(A==="checkMailbox"?It&&ot():A&&(Ge(`worker: received unknown command ${A}`),Ge(b)))}catch(D){throw d(),D}};var It=!1;self.onunhandledrejection=I=>{throw I.reason||I},self.onmessage=v}function Rt(){var v=j.buffer;o.HEAP8=Q=new Int8Array(v),ue=new Int16Array(v),o.HEAPU8=oe=new Uint8Array(v),ee=new Uint16Array(v),o.HEAP32=ce=new Int32Array(v),o.HEAPU32=le=new Uint32Array(v),Qe=new Float32Array(v),at=new Float64Array(v),Je=new BigInt64Array(v),ke=new BigUint64Array(v)}function ht(){x?startWorker(o):Be.Da()}var mt,qt=0,Sn=null;function Zn(){if(--qt==0&&Sn){var v=Sn;Sn=null,v()}}function _n(v){throw Ge(v="Aborted("+v+")"),qe=!0,v=new WebAssembly.RuntimeError(v+". Build with -sASSERTIONS for more info."),a(v),v}function zn(){return{a:{L:Zi,Aa:Ma,b:Nn,$:In,A:sr,pa:fr,X:hi,Z:dr,qa:qr,na:ei,ga:ti,ma:Dr,J:Pr,Y:P,V:W,oa:K,W:M,va:Ee,E:Mt,Q:jt,O:ct,D:Ot,v:st,s:Ie,P:Xe,z:un,R:Dt,ja:nn,T:bn,aa:Vn,M:rr,F:On,ia:re,sa:Et,r:Mr,Ca:ua,w:ji,o:Ti,m:Mi,c:Zt,Ba:Bi,n:Br,j:ca,u:Is,p:ja,f:ss,t:Ta,l:Sa,e:Kn,k:Rs,h:Ha,g:Ni,d:os,da:Pe,ea:Os,fa:Ya,ba:Ds,ca:fa,N:da,xa:mr,ua:Yi,i:Ms,C:$n,G:Ii,ta:Wa,x:Wi,ra:Rn,U:mi,q:Sr,y:Ka,K:ls,S:ha,za:ki,ya:Qi,ka:Ri,la:Oa,_:hr,B:ni,I:Xa,ha:ui,H:Li,a:j,wa:kn}}}class mn{name="ExitStatus";constructor(I){this.message=`Program terminated with exit(${I})`,this.status=I}}var Qt=v=>{v.terminate(),v.onmessage=()=>{}},nr=[],wt=v=>{Or.length==0&&(tt(),an(Or[0]));var I=Or.pop();if(!I)return 6;vr.push(I),Nt[v.Bb]=I,I.Bb=v.Bb;var b={Db:"run",hc:v.fc,Jb:v.Jb,Bb:v.Bb};return I.postMessage(b,v.Nb),0},Er=0,Bn=(v,I,...b)=>{for(var A=2*b.length,D=ge(),$=ae(8*A),q=$>>>3,Z=0;Z<b.length;Z++){var se=b[Z];typeof se=="bigint"?(Je[q+2*Z]=1n,Je[q+2*Z+1]=se):(Je[q+2*Z]=0n,At()[q+2*Z+1>>>0]=se)}return v=g(v,0,A,$,I),Y(D),v};function kn(v){if(x)return Bn(0,1,v);if(te=v,!(0<Er)){for(var I of vr)Qt(I);for(I of Or)Qt(I);Or=[],vr=[],Nt={},qe=!0}N(0,new mn(v))}function ai(v){if(x)return Bn(1,0,v);hr(v)}var hr=v=>{if(te=v,x)throw ai(v),"unwind";kn(v)},Or=[],vr=[],cr=[],Nt={},Wt=v=>{var I=v.Bb;delete Nt[I],Or.push(v),vr.splice(vr.indexOf(v),1),v.Bb=0,w(I)};function Lt(){cr.forEach(v=>v())}var an=v=>new Promise(I=>{v.onmessage=D=>{var $=(D=D.data).Db;if(D.Hb&&D.Hb!=n()){var q=Nt[D.Hb];q?q.postMessage(D,D.Nb):Ge(`Internal error! Worker sent a message "${$}" to target pthread ${D.Hb}, but that thread no longer exists!`)}else $==="checkMailbox"?ot():$==="spawnThread"?wt(D):$==="cleanupThread"?Wt(Nt[D.ic]):$==="loaded"?(v.loaded=!0,I(v)):D.target==="setimmediate"?v.postMessage(D):$==="callHandler"?o[D.Rb](...D.args):$&&Ge(`worker sent an unknown command ${$}`)},v.onerror=D=>{throw Ge(`worker sent an error! ${D.filename}:${D.lineno}: ${D.message}`),D};var b,A=[];for(b of[])o.propertyIsEnumerable(b)&&A.push(b);v.postMessage({Db:"load",Sb:A,kc:j,lc:F})});function tt(){var v=new Worker((()=>{let I=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new I("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});Or.push(v)}var xn=v=>{Rt();var I=Me()[v+52>>>2>>>0];v=Me()[v+56>>>2>>>0],V(I,I-v),Y(I)},Xt=(v,I)=>{Er=0,v=we(v,I),0<Er?te=v:E(v)};class En{constructor(I){this.Ib=I-24}}function Nn(v,I,b){var A=new En(v>>>=0);throw I>>>=0,b>>>=0,Me()[A.Ib+16>>>2>>>0]=0,Me()[A.Ib+4>>>2>>>0]=I,Me()[A.Ib+8>>>2>>>0]=b,v}function Jr(v,I,b,A){return x?Bn(2,1,v,I,b,A):In(v,I,b,A)}function In(v,I,b,A){if(v>>>=0,b>>>=0,A>>>=0,_===void 0)return 6;var D=[];return x&&D.length===0?Jr(v,I>>>=0,b,A):(v={fc:b,Bb:v,Jb:A,Nb:D},x?(v.Db="spawnThread",postMessage(v,D),0):wt(v))}var on=typeof TextDecoder<"u"?new TextDecoder:void 0,Ft=(v,I=0,b=NaN)=>{var A=(I>>>=0)+b;for(b=I;v[b]&&!(b>=A);)++b;if(16<b-I&&v.buffer&&on)return on.decode(v.buffer instanceof ArrayBuffer?v.subarray(I,b):v.slice(I,b));for(A="";I<b;){var D=v[I++];if(128&D){var $=63&v[I++];if((224&D)==192)A+=String.fromCharCode((31&D)<<6|$);else{var q=63&v[I++];65536>(D=(240&D)==224?(15&D)<<12|$<<6|q:(7&D)<<18|$<<12|q<<6|63&v[I++])?A+=String.fromCharCode(D):(D-=65536,A+=String.fromCharCode(55296|D>>10,56320|1023&D))}}else A+=String.fromCharCode(D)}return A},Gn=(v,I)=>(v>>>=0)?Ft(fe(),v,I):"";function sr(v,I,b){return x?Bn(3,1,v,I,b):0}function fr(v,I){if(x)return Bn(4,1,v,I)}function hi(v,I){if(x)return Bn(5,1,v,I)}function dr(v,I,b){if(x)return Bn(6,1,v,I,b)}function qr(v,I,b){return x?Bn(7,1,v,I,b):0}function ei(v,I){if(x)return Bn(8,1,v,I)}function ti(v,I,b){if(x)return Bn(9,1,v,I,b)}function Dr(v,I,b,A){if(x)return Bn(10,1,v,I,b,A)}function Pr(v,I,b,A){if(x)return Bn(11,1,v,I,b,A)}function P(v,I,b,A){if(x)return Bn(12,1,v,I,b,A)}function W(v){if(x)return Bn(13,1,v)}function K(v,I){if(x)return Bn(14,1,v,I)}function M(v,I,b){if(x)return Bn(15,1,v,I,b)}var H,Ee=()=>_n(""),Ae=v=>{for(var I="";fe()[v>>>0];)I+=H[fe()[v++>>>0]];return I},Fe={},ut={},Tt=o.BindingError=class extends Error{constructor(v){super(v),this.name="BindingError"}};function xt(v,I,b={}){return(function(A,D,$={}){var q=D.name;if(!A)throw new Tt(`type "${q}" must have a positive integer typeid pointer`);if(ut.hasOwnProperty(A)){if($.Tb)return;throw new Tt(`Cannot register type '${q}' twice`)}ut[A]=D,Fe.hasOwnProperty(A)&&(D=Fe[A],delete Fe[A],D.forEach(Z=>Z()))})(v,I,b)}var dn=(v,I,b)=>{switch(I){case 1:return b?A=>ne()[A>>>0]:A=>fe()[A>>>0];case 2:return b?A=>De()[A>>>1>>>0]:A=>Le()[A>>>1>>>0];case 4:return b?A=>pe()[A>>>2>>>0]:A=>Me()[A>>>2>>>0];case 8:return b?A=>Je[A>>>3]:A=>ke[A>>>3];default:throw new TypeError(`invalid integer width (${I}): ${v}`)}};function Mt(v,I,b){b>>>=0,xt(v>>>=0,{name:I=Ae(I>>>0),fromWireType:A=>A,toWireType:function(A,D){if(typeof D!="bigint"&&typeof D!="number")throw D=D===null?"null":(A=typeof D)=="object"||A==="array"||A==="function"?D.toString():""+D,new TypeError(`Cannot convert "${D}" to ${this.name}`);return typeof D=="number"&&(D=BigInt(D)),D},Cb:Gt,readValueFromPointer:dn(I,b,I.indexOf("u")==-1),Eb:null})}var Gt=8;function jt(v,I,b,A){xt(v>>>=0,{name:I=Ae(I>>>0),fromWireType:function(D){return!!D},toWireType:function(D,$){return $?b:A},Cb:Gt,readValueFromPointer:function(D){return this.fromWireType(fe()[D>>>0])},Eb:null})}var kt=[],bt=[];function Zt(v){9<(v>>>=0)&&--bt[v+1]==0&&(bt[v]=void 0,kt.push(v))}var St=v=>{if(!v)throw new Tt(`Cannot use deleted val. handle = ${v}`);return bt[v]},vt=v=>{switch(v){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let I=kt.pop()||bt.length;return bt[I]=v,bt[I+1]=1,I}};function Se(v){return this.fromWireType(Me()[v>>>2>>>0])}var Vt={name:"emscripten::val",fromWireType:v=>{var I=St(v);return Zt(v),I},toWireType:(v,I)=>vt(I),Cb:Gt,readValueFromPointer:Se,Eb:null};function ct(v){return xt(v>>>0,Vt)}var _t=(v,I)=>{switch(I){case 4:return function(b){return this.fromWireType(Bt()[b>>>2>>>0])};case 8:return function(b){return this.fromWireType(At()[b>>>3>>>0])};default:throw new TypeError(`invalid float width (${I}): ${v}`)}};function Ot(v,I,b){b>>>=0,xt(v>>>=0,{name:I=Ae(I>>>0),fromWireType:A=>A,toWireType:(A,D)=>D,Cb:Gt,readValueFromPointer:_t(I,b),Eb:null})}function st(v,I,b,A,D){if(v>>>=0,b>>>=0,I=Ae(I>>>0),D===-1&&(D=4294967295),D=Z=>Z,A===0){var $=32-8*b;D=Z=>Z<<$>>>$}var q=I.includes("unsigned")?function(Z,se){return se>>>0}:function(Z,se){return se};xt(v,{name:I,fromWireType:D,toWireType:q,Cb:Gt,readValueFromPointer:dn(I,b,A!==0),Eb:null})}function Ie(v,I,b){function A($){var q=Me()[$>>>2>>>0];return $=Me()[$+4>>>2>>>0],new D(ne().buffer,$,q)}var D=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][I];xt(v>>>=0,{name:b=Ae(b>>>0),fromWireType:A,Cb:Gt,readValueFromPointer:A},{Tb:!0})}var ye=(v,I,b)=>{var A=fe();if(I>>>=0,0<b){var D=I;b=I+b-1;for(var $=0;$<v.length;++$){var q=v.charCodeAt($);if(55296<=q&&57343>=q&&(q=65536+((1023&q)<<10)|1023&v.charCodeAt(++$)),127>=q){if(I>=b)break;A[I++>>>0]=q}else{if(2047>=q){if(I+1>=b)break;A[I++>>>0]=192|q>>6}else{if(65535>=q){if(I+2>=b)break;A[I++>>>0]=224|q>>12}else{if(I+3>=b)break;A[I++>>>0]=240|q>>18,A[I++>>>0]=128|q>>12&63}A[I++>>>0]=128|q>>6&63}A[I++>>>0]=128|63&q}}A[I>>>0]=0,v=I-D}else v=0;return v},rt=v=>{for(var I=0,b=0;b<v.length;++b){var A=v.charCodeAt(b);127>=A?I++:2047>=A?I+=2:55296<=A&&57343>=A?(I+=4,++b):I+=3}return I};function Xe(v,I){xt(v>>>=0,{name:I=Ae(I>>>0),fromWireType:function(b){for(var A,D=Me()[b>>>2>>>0],$=b+4,q=$,Z=0;Z<=D;++Z){var se=$+Z;Z!=D&&fe()[se>>>0]!=0||(q=Gn(q,se-q),A===void 0?A=q:(A+="\0",A+=q),q=se+1)}return s(b),A},toWireType:function(b,A){A instanceof ArrayBuffer&&(A=new Uint8Array(A));var D=typeof A=="string";if(!(D||ArrayBuffer.isView(A)&&A.BYTES_PER_ELEMENT==1))throw new Tt("Cannot pass non-string to std::string");var $=D?rt(A):A.length,q=l(4+$+1),Z=q+4;return Me()[q>>>2>>>0]=$,D?ye(A,Z,$+1):fe().set(A,Z>>>0),b!==null&&b.push(s,q),q},Cb:Gt,readValueFromPointer:Se,Eb(b){s(b)}})}var He=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,We=(v,I)=>{for(var b=v>>1,A=b+I/2;!(b>=A)&&Le()[b>>>0];)++b;if(32<(b<<=1)-v&&He)return He.decode(fe().slice(v,b));for(b="",A=0;!(A>=I/2);++A){var D=De()[v+2*A>>>1>>>0];if(D==0)break;b+=String.fromCharCode(D)}return b},zt=(v,I,b)=>{if(b??=2147483647,2>b)return 0;var A=I;b=(b-=2)<2*v.length?b/2:v.length;for(var D=0;D<b;++D){var $=v.charCodeAt(D);De()[I>>>1>>>0]=$,I+=2}return De()[I>>>1>>>0]=0,I-A},hn=v=>2*v.length,$t=(v,I)=>{for(var b=0,A="";!(b>=I/4);){var D=pe()[v+4*b>>>2>>>0];if(D==0)break;++b,65536<=D?(D-=65536,A+=String.fromCharCode(55296|D>>10,56320|1023&D)):A+=String.fromCharCode(D)}return A},en=(v,I,b)=>{if(I>>>=0,b??=2147483647,4>b)return 0;var A=I;b=A+b-4;for(var D=0;D<v.length;++D){var $=v.charCodeAt(D);if(55296<=$&&57343>=$&&($=65536+((1023&$)<<10)|1023&v.charCodeAt(++D)),pe()[I>>>2>>>0]=$,(I+=4)+4>b)break}return pe()[I>>>2>>>0]=0,I-A},he=v=>{for(var I=0,b=0;b<v.length;++b){var A=v.charCodeAt(b);55296<=A&&57343>=A&&++b,I+=4}return I};function un(v,I,b){if(v>>>=0,I>>>=0,b=Ae(b>>>=0),I===2)var A=We,D=zt,$=hn,q=Z=>Le()[Z>>>1>>>0];else I===4&&(A=$t,D=en,$=he,q=Z=>Me()[Z>>>2>>>0]);xt(v,{name:b,fromWireType:Z=>{for(var se,de=Me()[Z>>>2>>>0],Te=Z+4,je=0;je<=de;++je){var lt=Z+4+je*I;je!=de&&q(lt)!=0||(Te=A(Te,lt-Te),se===void 0?se=Te:(se+="\0",se+=Te),Te=lt+I)}return s(Z),se},toWireType:(Z,se)=>{if(typeof se!="string")throw new Tt(`Cannot pass non-string to C++ string type ${b}`);var de=$(se),Te=l(4+de+I);return Me()[Te>>>2>>>0]=de/I,D(se,Te+4,de+I),Z!==null&&Z.push(s,Te),Te},Cb:Gt,readValueFromPointer:Se,Eb(Z){s(Z)}})}function Dt(v,I){xt(v>>>=0,{Ub:!0,name:I=Ae(I>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function nn(v){f(v>>>0,!m,1,!h,131072,!1),Lt()}var be=v=>{if(!qe)try{if(v(),!(0<Er))try{x?E(te):hr(te)}catch(I){I instanceof mn||I=="unwind"||N(0,I)}}catch(I){I instanceof mn||I=="unwind"||N(0,I)}};function re(v){v>>>=0,typeof Atomics.jc=="function"&&(Atomics.jc(pe(),v>>>2,v).value.then(ot),v+=128,Atomics.store(pe(),v>>>2,1))}var ot=()=>{var v=n();v&&(re(v),be(L))};function bn(v,I){(v>>>=0)==I>>>0?setTimeout(ot):x?postMessage({Hb:v,Db:"checkMailbox"}):(v=Nt[v])&&v.postMessage({Db:"checkMailbox"})}var tn=[];function Vn(v,I,b,A,D){for(I>>>=0,A/=2,tn.length=A,b=D>>>0>>>3,D=0;D<A;D++)tn[D]=Je[b+2*D]?Je[b+2*D+1]:At()[b+2*D+1>>>0];return(I?Za[I]:xi[v])(...tn)}var rr=()=>{Er=0};function On(v){v>>>=0,x?postMessage({Db:"cleanupThread",ic:v}):Wt(Nt[v])}function Et(v){}var yn=(v,I)=>{var b=ut[v];if(b===void 0)throw v=pa(v),b=Ae(v),s(v),new Tt(`${I} has unknown type ${b}`);return b},Cr=(v,I,b)=>{var A=[];return v=v.toWireType(A,b),A.length&&(Me()[I>>>2>>>0]=vt(A)),v};function Mr(v,I,b){return I>>>=0,b>>>=0,v=St(v>>>0),I=yn(I,"emval::as"),Cr(I,b,v)}function ua(v,I){return I>>>=0,v=St(v>>>0),(I=yn(I,"emval::as")).toWireType(null,v)}var jr=v=>{try{v()}catch(I){_n(I)}},si=0,oi=null,Wn=0,Wr=[],pi={},rn={},as=0,pn=null,or=[];function Ea(v){return(function(I){if(!qe){if(si===0){var b=!1,A=!1;I((D=0)=>{if(!qe&&(Wn=D,b=!0,A)){si=2,jr(()=>pt(oi)),typeof MainLoop<"u"&&MainLoop.Qb&&MainLoop.resume(),D=!1;try{var $=(function(){var se=pe()[oi+8>>>2>>>0];return se=Be[rn[se]],--Er,se()})()}catch(se){$=se,D=!0}var q=!1;if(!oi){var Z=pn;Z&&(pn=null,(D?Z.reject:Z.resolve)($),q=!0)}if(D&&!q)throw $}}),A=!0,b||(si=1,oi=(function(){var D=l(65548),$=D+12;Me()[D>>>2>>>0]=$,Me()[D+4>>>2>>>0]=$+65536,$=Wr[0];var q=pi[$];return q===void 0&&(q=as++,pi[$]=q,rn[q]=$),$=q,pe()[D+8>>>2>>>0]=$,D})(),typeof MainLoop<"u"&&MainLoop.Qb&&MainLoop.pause(),jr(()=>Oe(oi)))}else si===2?(si=0,jr(dt),s(oi),oi=null,or.forEach(be)):_n(`invalid state: ${si}`);return Wn}})(I=>{v().then(I)})}function ji(v){return v>>>=0,Ea(async()=>{var I=await St(v);return vt(I)})}var li=[];function Ti(v,I,b,A){return b>>>=0,A>>>=0,(v=li[v>>>0])(null,I=St(I>>>0),b,A)}var Va={},Si=v=>{var I=Va[v];return I===void 0?Ae(v):I};function Mi(v,I,b,A,D){return b>>>=0,A>>>=0,D>>>=0,(v=li[v>>>0])(I=St(I>>>0),I[b=Si(b)],A,D)}function Bi(v,I){return I>>>=0,(v=St(v>>>0))==St(I)}var qa=()=>typeof globalThis=="object"?globalThis:Function("return this")();function Br(v){return(v>>>=0)==0?vt(qa()):(v=Si(v),vt(qa()[v]))}var gi=v=>{var I=li.length;return li.push(v),I},Tr=(v,I)=>{for(var b=Array(v),A=0;A<v;++A)b[A]=yn(Me()[I+4*A>>>2>>>0],`parameter ${A}`);return b};function ca(v,I,b){var A=(I=Tr(v,I>>>0)).shift();v--;var D=`return function (obj, func, destructorsRef, args) {
`,$=0,q=[];b===0&&q.push("obj");for(var Z=["retType"],se=[A],de=0;de<v;++de)q.push(`arg${de}`),Z.push(`argType${de}`),se.push(I[de]),D+=`  var arg${de} = argType${de}.readValueFromPointer(args${$?"+"+$:""});
`,$+=I[de].Cb;return D+=`  var rv = ${b===1?"new func":"func.call"}(${q.join(", ")});
`,A.Ub||(Z.push("emval_returnValue"),se.push(Cr),D+=`  return emval_returnValue(retType, destructorsRef, rv);
`),v=new Function(...Z,D+`};
`)(...se),b=`methodCaller<(${I.map(Te=>Te.name).join(", ")}) => ${A.name}>`,gi(Object.defineProperty(v,"name",{value:b}))}function Is(v){return v=Si(v>>>0),vt(o[v])}function ja(v,I){return I>>>=0,v=St(v>>>0),I=St(I),vt(v[I])}function ss(v){9<(v>>>=0)&&(bt[v+1]+=1)}function Ta(){return vt([])}function Sa(v){v=St(v>>>0);for(var I=Array(v.length),b=0;b<v.length;b++)I[b]=v[b];return vt(I)}function Kn(v){return vt(Si(v>>>0))}function Rs(){return vt({})}function Ha(v){for(var I=St(v>>>=0);I.length;){var b=I.pop();I.pop()(b)}Zt(v)}function Ni(v,I,b){I>>>=0,b>>>=0,v=St(v>>>0),I=St(I),b=St(b),v[I]=b}function os(v,I){return I>>>=0,v=(v=yn(v>>>0,"_emval_take_value")).readValueFromPointer(I),vt(v)}function Pe(v,I){v=-9007199254740992>v||9007199254740992<v?NaN:Number(v),I>>>=0,v=new Date(1e3*v),pe()[I>>>2>>>0]=v.getUTCSeconds(),pe()[I+4>>>2>>>0]=v.getUTCMinutes(),pe()[I+8>>>2>>>0]=v.getUTCHours(),pe()[I+12>>>2>>>0]=v.getUTCDate(),pe()[I+16>>>2>>>0]=v.getUTCMonth(),pe()[I+20>>>2>>>0]=v.getUTCFullYear()-1900,pe()[I+24>>>2>>>0]=v.getUTCDay(),v=(v.getTime()-Date.UTC(v.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,pe()[I+28>>>2>>>0]=v}var Cn=v=>v%4==0&&(v%100!=0||v%400==0),Nr=[0,31,60,91,121,152,182,213,244,274,305,335],Ia=[0,31,59,90,120,151,181,212,243,273,304,334];function Os(v,I){v=-9007199254740992>v||9007199254740992<v?NaN:Number(v),I>>>=0,v=new Date(1e3*v),pe()[I>>>2>>>0]=v.getSeconds(),pe()[I+4>>>2>>>0]=v.getMinutes(),pe()[I+8>>>2>>>0]=v.getHours(),pe()[I+12>>>2>>>0]=v.getDate(),pe()[I+16>>>2>>>0]=v.getMonth(),pe()[I+20>>>2>>>0]=v.getFullYear()-1900,pe()[I+24>>>2>>>0]=v.getDay();var b=(Cn(v.getFullYear())?Nr:Ia)[v.getMonth()]+v.getDate()-1|0;pe()[I+28>>>2>>>0]=b,pe()[I+36>>>2>>>0]=-60*v.getTimezoneOffset(),b=new Date(v.getFullYear(),6,1).getTimezoneOffset();var A=new Date(v.getFullYear(),0,1).getTimezoneOffset();v=0|(b!=A&&v.getTimezoneOffset()==Math.min(A,b)),pe()[I+32>>>2>>>0]=v}function Ya(v){v>>>=0;var I=new Date(pe()[v+20>>>2>>>0]+1900,pe()[v+16>>>2>>>0],pe()[v+12>>>2>>>0],pe()[v+8>>>2>>>0],pe()[v+4>>>2>>>0],pe()[v>>>2>>>0],0),b=pe()[v+32>>>2>>>0],A=I.getTimezoneOffset(),D=new Date(I.getFullYear(),6,1).getTimezoneOffset(),$=new Date(I.getFullYear(),0,1).getTimezoneOffset(),q=Math.min($,D);return 0>b?pe()[v+32>>>2>>>0]=+(D!=$&&q==A):0<b!=(q==A)&&(D=Math.max($,D),I.setTime(I.getTime()+6e4*((0<b?q:D)-A))),pe()[v+24>>>2>>>0]=I.getDay(),b=(Cn(I.getFullYear())?Nr:Ia)[I.getMonth()]+I.getDate()-1|0,pe()[v+28>>>2>>>0]=b,pe()[v>>>2>>>0]=I.getSeconds(),pe()[v+4>>>2>>>0]=I.getMinutes(),pe()[v+8>>>2>>>0]=I.getHours(),pe()[v+12>>>2>>>0]=I.getDate(),pe()[v+16>>>2>>>0]=I.getMonth(),pe()[v+20>>>2>>>0]=I.getYear(),v=I.getTime(),BigInt(isNaN(v)?-1:v/1e3)}function Ds(v,I,b,A,D,$,q){return x?Bn(16,1,v,I,b,A,D,$,q):-52}function fa(v,I,b,A,D,$){if(x)return Bn(17,1,v,I,b,A,D,$)}var Hi={},Sr=()=>performance.timeOrigin+performance.now();function da(v,I){if(x)return Bn(18,1,v,I);if(Hi[v]&&(clearTimeout(Hi[v].id),delete Hi[v]),!I)return 0;var b=setTimeout(()=>{delete Hi[v],be(()=>O(v,performance.timeOrigin+performance.now()))},I);return Hi[v]={id:b,rc:I},0}function mr(v,I,b,A){v>>>=0,I>>>=0,b>>>=0,A>>>=0;var D=new Date().getFullYear(),$=new Date(D,0,1).getTimezoneOffset();D=new Date(D,6,1).getTimezoneOffset();var q=Math.max($,D);Me()[v>>>2>>>0]=60*q,pe()[I>>>2>>>0]=+($!=D),v=(I=Z=>{var se=Math.abs(Z);return`UTC${0<=Z?"-":"+"}${String(Math.floor(se/60)).padStart(2,"0")}${String(se%60).padStart(2,"0")}`})($),I=I(D),D<$?(ye(v,b,17),ye(I,A,17)):(ye(v,A,17),ye(I,b,17))}var Wa=()=>Date.now();function Yi(v,I,b){return 0<=v&&3>=v?(v===0?v=Date.now():v=performance.timeOrigin+performance.now(),Je[b>>>0>>>3]=BigInt(Math.round(1e6*v)),0):28}var qn=[],sn=(v,I)=>{qn.length=0;for(var b;b=fe()[v++>>>0];){var A=b!=105;I+=(A&=b!=112)&&I%8?4:0,qn.push(b==112?Me()[I>>>2>>>0]:b==106?Je[I>>>3]:b==105?pe()[I>>>2>>>0]:At()[I>>>3>>>0]),I+=A?8:4}return qn};function Ms(v,I,b){return v>>>=0,I=sn(I>>>0,b>>>0),Za[v](...I)}function $n(v,I,b){return v>>>=0,I=sn(I>>>0,b>>>0),Za[v](...I)}var Ii=()=>{};function Wi(v,I){return Ge(Gn(v>>>0,I>>>0))}var Rn=()=>{throw Er+=1,"unwind"};function mi(){return 4294901760}var Ka=()=>navigator.hardwareConcurrency;function ls(){return _n("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function ha(v){v>>>=0;var I=fe().length;if(v<=I||4294901760<v)return!1;for(var b=1;4>=b;b*=2){var A=I*(1+.2/b);A=Math.min(A,v+100663296);e:{A=(Math.min(4294901760,65536*Math.ceil(Math.max(v,A)/65536))-j.buffer.byteLength+65535)/65536|0;try{j.grow(A),Rt();var D=1;break e}catch{}D=void 0}if(D)return!0}return!1}var _i=()=>(_n("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),Ki={},Qa=v=>{v.forEach(I=>{_i()})};function ki(){var v=Error().stack.toString().split(`
`);return v[0]=="Error"&&v.shift(),Qa(v),Ki.Mb=_i(),Ki.dc=v,Ki.Mb}function Qi(v,I,b){if(v>>>=0,I>>>=0,Ki.Mb==v)var A=Ki.dc;else(A=Error().stack.toString().split(`
`))[0]=="Error"&&A.shift(),Qa(A);for(var D=3;A[D]&&_i()!=v;)++D;for(v=0;v<b&&A[v+D];++v)pe()[I+4*v>>>2>>>0]=_i();return v}var Ra,$i={},Xi=()=>{if(!Ra){var v,I={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(v in $i)$i[v]===void 0?delete I[v]:I[v]=$i[v];var b=[];for(v in I)b.push(`${v}=${I[v]}`);Ra=b}return Ra};function Ri(v,I){if(x)return Bn(19,1,v,I);v>>>=0,I>>>=0;var b,A=0,D=0;for(b of Xi()){var $=I+A;Me()[v+D>>>2>>>0]=$,A+=ye(b,$,1/0)+1,D+=4}return 0}function Oa(v,I){if(x)return Bn(20,1,v,I);v>>>=0,I>>>=0;var b=Xi();for(var A of(Me()[v>>>2>>>0]=b.length,v=0,b))v+=rt(A)+1;return Me()[I>>>2>>>0]=v,0}function ni(v){return x?Bn(21,1,v):52}function Xa(v,I,b,A){return x?Bn(22,1,v,I,b,A):52}function ui(v,I,b,A){return x?Bn(23,1,v,I,b,A):70}var Da=[null,[],[]];function Li(v,I,b,A){if(x)return Bn(24,1,v,I,b,A);I>>>=0,b>>>=0,A>>>=0;for(var D=0,$=0;$<b;$++){var q=Me()[I>>>2>>>0],Z=Me()[I+4>>>2>>>0];I+=8;for(var se=0;se<Z;se++){var de=v,Te=fe()[q+se>>>0],je=Da[de];Te===0||Te===10?((de===1?_e:Ge)(Ft(je)),je.length=0):je.push(Te)}D+=Z}return Me()[A>>>2>>>0]=D,0}x||(function(){for(var v=o.numThreads-1;v--;)tt();nr.push(()=>{qt++,(function(I){x?I():Promise.all(Or.map(an)).then(I)})(()=>Zn())})})();for(var Bs=Array(256),zi=0;256>zi;++zi)Bs[zi]=String.fromCharCode(zi);H=Bs,bt.push(0,1,void 0,1,null,1,!0,1,!1,1),o.count_emval_handles=()=>bt.length/2-5-kt.length,x||(j=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),Rt()),o.wasmBinary&&(X=o.wasmBinary),o.stackSave=()=>ge(),o.stackRestore=v=>Y(v),o.stackAlloc=v=>ae(v),o.setValue=function(v,I,b="i8"){switch(b.endsWith("*")&&(b="*"),b){case"i1":case"i8":ne()[v>>>0]=I;break;case"i16":De()[v>>>1>>>0]=I;break;case"i32":pe()[v>>>2>>>0]=I;break;case"i64":Je[v>>>3]=BigInt(I);break;case"float":Bt()[v>>>2>>>0]=I;break;case"double":At()[v>>>3>>>0]=I;break;case"*":Me()[v>>>2>>>0]=I;break;default:_n(`invalid type for setValue: ${b}`)}},o.getValue=function(v,I="i8"){switch(I.endsWith("*")&&(I="*"),I){case"i1":case"i8":return ne()[v>>>0];case"i16":return De()[v>>>1>>>0];case"i32":return pe()[v>>>2>>>0];case"i64":return Je[v>>>3];case"float":return Bt()[v>>>2>>>0];case"double":return At()[v>>>3>>>0];case"*":return Me()[v>>>2>>>0];default:_n(`invalid type for getValue: ${I}`)}},o.UTF8ToString=Gn,o.stringToUTF8=ye,o.lengthBytesUTF8=rt;var xi=[kn,ai,Jr,sr,fr,hi,dr,qr,ei,ti,Dr,Pr,P,W,K,M,Ds,fa,da,Ri,Oa,ni,Xa,ui,Li],Za={893836:(v,I,b,A,D)=>{if(o===void 0||!o.Fb)return 1;if((v=Gn(Number(v>>>0))).startsWith("./")&&(v=v.substring(2)),!(v=o.Fb.get(v)))return 2;if(I=Number(I>>>0),b=Number(b>>>0),A=Number(A>>>0),I+b>v.byteLength)return 3;try{let $=v.subarray(I,I+b);switch(D){case 0:fe().set($,A>>>0);break;case 1:o.mc?o.mc(A,$):o.cc(A,$);break;default:return 4}return 0}catch{return 4}},894660:(v,I,b)=>{o.Pb(v,fe().subarray(I>>>0,I+b>>>0))},894724:()=>o.oc(),894766:v=>{o.Ob(v)},894803:()=>{o.Wb()},894834:()=>{o.Xb()},894863:()=>{o.ac()},894888:v=>o.Vb(v),894921:v=>o.Zb(v),894953:(v,I,b)=>{o.Lb(Number(v),Number(I),Number(b),!0)},895016:(v,I,b)=>{o.Lb(Number(v),Number(I),Number(b))},895073:()=>typeof wasmOffsetConverter<"u",895130:v=>{o.Ab("Abs",v,void 0)},895181:v=>{o.Ab("Neg",v,void 0)},895232:v=>{o.Ab("Floor",v,void 0)},895285:v=>{o.Ab("Ceil",v,void 0)},895337:v=>{o.Ab("Reciprocal",v,void 0)},895395:v=>{o.Ab("Sqrt",v,void 0)},895447:v=>{o.Ab("Exp",v,void 0)},895498:v=>{o.Ab("Erf",v,void 0)},895549:v=>{o.Ab("Sigmoid",v,void 0)},895604:(v,I,b)=>{o.Ab("HardSigmoid",v,{alpha:I,beta:b})},895683:v=>{o.Ab("Log",v,void 0)},895734:v=>{o.Ab("Sin",v,void 0)},895785:v=>{o.Ab("Cos",v,void 0)},895836:v=>{o.Ab("Tan",v,void 0)},895887:v=>{o.Ab("Asin",v,void 0)},895939:v=>{o.Ab("Acos",v,void 0)},895991:v=>{o.Ab("Atan",v,void 0)},896043:v=>{o.Ab("Sinh",v,void 0)},896095:v=>{o.Ab("Cosh",v,void 0)},896147:v=>{o.Ab("Asinh",v,void 0)},896200:v=>{o.Ab("Acosh",v,void 0)},896253:v=>{o.Ab("Atanh",v,void 0)},896306:v=>{o.Ab("Tanh",v,void 0)},896358:v=>{o.Ab("Not",v,void 0)},896409:(v,I,b)=>{o.Ab("Clip",v,{min:I,max:b})},896478:v=>{o.Ab("Clip",v,void 0)},896530:(v,I)=>{o.Ab("Elu",v,{alpha:I})},896588:v=>{o.Ab("Gelu",v,void 0)},896640:v=>{o.Ab("Relu",v,void 0)},896692:(v,I)=>{o.Ab("LeakyRelu",v,{alpha:I})},896756:(v,I)=>{o.Ab("ThresholdedRelu",v,{alpha:I})},896826:(v,I)=>{o.Ab("Cast",v,{to:I})},896884:v=>{o.Ab("Add",v,void 0)},896935:v=>{o.Ab("Sub",v,void 0)},896986:v=>{o.Ab("Mul",v,void 0)},897037:v=>{o.Ab("Div",v,void 0)},897088:v=>{o.Ab("Pow",v,void 0)},897139:v=>{o.Ab("Equal",v,void 0)},897192:v=>{o.Ab("Greater",v,void 0)},897247:v=>{o.Ab("GreaterOrEqual",v,void 0)},897309:v=>{o.Ab("Less",v,void 0)},897361:v=>{o.Ab("LessOrEqual",v,void 0)},897420:(v,I,b,A,D)=>{o.Ab("ReduceMean",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},897595:(v,I,b,A,D)=>{o.Ab("ReduceMax",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},897769:(v,I,b,A,D)=>{o.Ab("ReduceMin",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},897943:(v,I,b,A,D)=>{o.Ab("ReduceProd",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},898118:(v,I,b,A,D)=>{o.Ab("ReduceSum",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},898292:(v,I,b,A,D)=>{o.Ab("ReduceL1",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},898465:(v,I,b,A,D)=>{o.Ab("ReduceL2",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},898638:(v,I,b,A,D)=>{o.Ab("ReduceLogSum",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},898815:(v,I,b,A,D)=>{o.Ab("ReduceSumSquare",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},898995:(v,I,b,A,D)=>{o.Ab("ReduceLogSumExp",v,{keepDims:!!I,noopWithEmptyAxes:!!b,axes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},899175:v=>{o.Ab("Where",v,void 0)},899228:(v,I,b)=>{o.Ab("Transpose",v,{perm:I?Array.from(pe().subarray(Number(I)>>>0,Number(b)>>>0)):[]})},899352:(v,I,b,A)=>{o.Ab("DepthToSpace",v,{blocksize:I,mode:Gn(b),format:A?"NHWC":"NCHW"})},899485:(v,I,b,A)=>{o.Ab("DepthToSpace",v,{blocksize:I,mode:Gn(b),format:A?"NHWC":"NCHW"})},899618:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn)=>{o.Ab("ConvTranspose",v,{format:se?"NHWC":"NCHW",autoPad:I,dilations:[b],group:A,kernelShape:[D],pads:[$,q],strides:[Z],wIsConst:()=>!!ne()[de>>>0],outputPadding:Te?Array.from(pe().subarray(Number(Te)>>>0,Number(je)>>>0)):[],outputShape:lt?Array.from(pe().subarray(Number(lt)>>>0,Number(yt)>>>0)):[],activation:Gn(cn)})},900051:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt)=>{o.Ab("ConvTranspose",v,{format:Z?"NHWC":"NCHW",autoPad:I,dilations:Array.from(pe().subarray(Number(b)>>>0,2+(Number(b)>>>0)>>>0)),group:A,kernelShape:Array.from(pe().subarray(Number(D)>>>0,2+(Number(D)>>>0)>>>0)),pads:Array.from(pe().subarray(Number($)>>>0,4+(Number($)>>>0)>>>0)),strides:Array.from(pe().subarray(Number(q)>>>0,2+(Number(q)>>>0)>>>0)),wIsConst:()=>!!ne()[se>>>0],outputPadding:de?Array.from(pe().subarray(Number(de)>>>0,Number(Te)>>>0)):[],outputShape:je?Array.from(pe().subarray(Number(je)>>>0,Number(lt)>>>0)):[],activation:Gn(yt)})},900712:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn)=>{o.Ab("ConvTranspose",v,{format:se?"NHWC":"NCHW",autoPad:I,dilations:[b],group:A,kernelShape:[D],pads:[$,q],strides:[Z],wIsConst:()=>!!ne()[de>>>0],outputPadding:Te?Array.from(pe().subarray(Number(Te)>>>0,Number(je)>>>0)):[],outputShape:lt?Array.from(pe().subarray(Number(lt)>>>0,Number(yt)>>>0)):[],activation:Gn(cn)})},901145:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt)=>{o.Ab("ConvTranspose",v,{format:Z?"NHWC":"NCHW",autoPad:I,dilations:Array.from(pe().subarray(Number(b)>>>0,2+(Number(b)>>>0)>>>0)),group:A,kernelShape:Array.from(pe().subarray(Number(D)>>>0,2+(Number(D)>>>0)>>>0)),pads:Array.from(pe().subarray(Number($)>>>0,4+(Number($)>>>0)>>>0)),strides:Array.from(pe().subarray(Number(q)>>>0,2+(Number(q)>>>0)>>>0)),wIsConst:()=>!!ne()[se>>>0],outputPadding:de?Array.from(pe().subarray(Number(de)>>>0,Number(Te)>>>0)):[],outputShape:je?Array.from(pe().subarray(Number(je)>>>0,Number(lt)>>>0)):[],activation:Gn(yt)})},901806:(v,I)=>{o.Ab("GlobalAveragePool",v,{format:I?"NHWC":"NCHW"})},901897:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt)=>{o.Ab("AveragePool",v,{format:yt?"NHWC":"NCHW",auto_pad:I,ceil_mode:b,count_include_pad:A,storage_order:D,dilations:$?Array.from(pe().subarray(Number($)>>>0,Number(q)>>>0)):[],kernel_shape:Z?Array.from(pe().subarray(Number(Z)>>>0,Number(se)>>>0)):[],pads:de?Array.from(pe().subarray(Number(de)>>>0,Number(Te)>>>0)):[],strides:je?Array.from(pe().subarray(Number(je)>>>0,Number(lt)>>>0)):[]})},902376:(v,I)=>{o.Ab("GlobalAveragePool",v,{format:I?"NHWC":"NCHW"})},902467:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt)=>{o.Ab("AveragePool",v,{format:yt?"NHWC":"NCHW",auto_pad:I,ceil_mode:b,count_include_pad:A,storage_order:D,dilations:$?Array.from(pe().subarray(Number($)>>>0,Number(q)>>>0)):[],kernel_shape:Z?Array.from(pe().subarray(Number(Z)>>>0,Number(se)>>>0)):[],pads:de?Array.from(pe().subarray(Number(de)>>>0,Number(Te)>>>0)):[],strides:je?Array.from(pe().subarray(Number(je)>>>0,Number(lt)>>>0)):[]})},902946:(v,I)=>{o.Ab("GlobalMaxPool",v,{format:I?"NHWC":"NCHW"})},903033:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt)=>{o.Ab("MaxPool",v,{format:yt?"NHWC":"NCHW",auto_pad:I,ceil_mode:b,count_include_pad:A,storage_order:D,dilations:$?Array.from(pe().subarray(Number($)>>>0,Number(q)>>>0)):[],kernel_shape:Z?Array.from(pe().subarray(Number(Z)>>>0,Number(se)>>>0)):[],pads:de?Array.from(pe().subarray(Number(de)>>>0,Number(Te)>>>0)):[],strides:je?Array.from(pe().subarray(Number(je)>>>0,Number(lt)>>>0)):[]})},903508:(v,I)=>{o.Ab("GlobalMaxPool",v,{format:I?"NHWC":"NCHW"})},903595:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt)=>{o.Ab("MaxPool",v,{format:yt?"NHWC":"NCHW",auto_pad:I,ceil_mode:b,count_include_pad:A,storage_order:D,dilations:$?Array.from(pe().subarray(Number($)>>>0,Number(q)>>>0)):[],kernel_shape:Z?Array.from(pe().subarray(Number(Z)>>>0,Number(se)>>>0)):[],pads:de?Array.from(pe().subarray(Number(de)>>>0,Number(Te)>>>0)):[],strides:je?Array.from(pe().subarray(Number(je)>>>0,Number(lt)>>>0)):[]})},904070:(v,I,b,A,D)=>{o.Ab("Gemm",v,{alpha:I,beta:b,transA:A,transB:D})},904174:v=>{o.Ab("MatMul",v,void 0)},904228:(v,I,b,A)=>{o.Ab("ArgMax",v,{keepDims:!!I,selectLastIndex:!!b,axis:A})},904336:(v,I,b,A)=>{o.Ab("ArgMin",v,{keepDims:!!I,selectLastIndex:!!b,axis:A})},904444:(v,I)=>{o.Ab("Softmax",v,{axis:I})},904507:(v,I)=>{o.Ab("Concat",v,{axis:I})},904567:(v,I,b,A,D)=>{o.Ab("Split",v,{axis:I,numOutputs:b,splitSizes:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},904723:v=>{o.Ab("Expand",v,void 0)},904777:(v,I)=>{o.Ab("Gather",v,{axis:Number(I)})},904848:(v,I)=>{o.Ab("GatherElements",v,{axis:Number(I)})},904927:(v,I)=>{o.Ab("GatherND",v,{batch_dims:Number(I)})},905006:(v,I,b,A,D,$,q,Z,se,de,Te)=>{o.Ab("Resize",v,{antialias:I,axes:b?Array.from(pe().subarray(Number(b)>>>0,Number(A)>>>0)):[],coordinateTransformMode:Gn(D),cubicCoeffA:$,excludeOutside:q,extrapolationValue:Z,keepAspectRatioPolicy:Gn(se),mode:Gn(de),nearestMode:Gn(Te)})},905368:(v,I,b,A,D,$,q)=>{o.Ab("Slice",v,{starts:I?Array.from(pe().subarray(Number(I)>>>0,Number(b)>>>0)):[],ends:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[],axes:$?Array.from(pe().subarray(Number($)>>>0,Number(q)>>>0)):[]})},905632:v=>{o.Ab("Tile",v,void 0)},905684:(v,I,b)=>{o.Ab("InstanceNormalization",v,{epsilon:I,format:b?"NHWC":"NCHW"})},905798:(v,I,b)=>{o.Ab("InstanceNormalization",v,{epsilon:I,format:b?"NHWC":"NCHW"})},905912:v=>{o.Ab("Range",v,void 0)},905965:(v,I)=>{o.Ab("Einsum",v,{equation:Gn(I)})},906046:(v,I,b,A,D)=>{o.Ab("Pad",v,{mode:I,value:b,pads:A?Array.from(pe().subarray(Number(A)>>>0,Number(D)>>>0)):[]})},906189:(v,I,b,A,D,$)=>{o.Ab("BatchNormalization",v,{epsilon:I,momentum:b,spatial:!!D,trainingMode:!!A,format:$?"NHWC":"NCHW"})},906358:(v,I,b,A,D,$)=>{o.Ab("BatchNormalization",v,{epsilon:I,momentum:b,spatial:!!D,trainingMode:!!A,format:$?"NHWC":"NCHW"})},906527:(v,I,b)=>{o.Ab("CumSum",v,{exclusive:Number(I),reverse:Number(b)})},906624:(v,I,b)=>{o.Ab("DequantizeLinear",v,{axis:I,blockSize:b})},906714:(v,I,b,A,D)=>{o.Ab("GridSample",v,{align_corners:I,mode:Gn(b),padding_mode:Gn(A),format:D?"NHWC":"NCHW"})},906884:(v,I,b,A,D)=>{o.Ab("GridSample",v,{align_corners:I,mode:Gn(b),padding_mode:Gn(A),format:D?"NHWC":"NCHW"})},907054:(v,I)=>{o.Ab("ScatterND",v,{reduction:Gn(I)})},907139:(v,I,b,A,D,$,q,Z,se)=>{o.Ab("Attention",v,{numHeads:I,isUnidirectional:b,maskFilterValue:A,scale:D,doRotary:$,qkvHiddenSizes:q?Array.from(pe().subarray(Number(Z)>>>0,Number(Z)+q>>>0)):[],pastPresentShareBuffer:!!se})},907411:v=>{o.Ab("BiasAdd",v,void 0)},907466:v=>{o.Ab("BiasSplitGelu",v,void 0)},907527:v=>{o.Ab("FastGelu",v,void 0)},907583:(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn)=>{o.Ab("Conv",v,{format:je?"NHWC":"NCHW",auto_pad:I,dilations:b?Array.from(pe().subarray(Number(b)>>>0,Number(A)>>>0)):[],group:D,kernel_shape:$?Array.from(pe().subarray(Number($)>>>0,Number(q)>>>0)):[],pads:Z?Array.from(pe().subarray(Number(Z)>>>0,Number(se)>>>0)):[],strides:de?Array.from(pe().subarray(Number(de)>>>0,Number(Te)>>>0)):[],w_is_const:()=>!!ne()[Number(lt)>>>0],activation:Gn(yt),activation_params:cn?Array.from(Bt().subarray(Number(cn)>>>0,Number(gn)>>>0)):[]})},908167:v=>{o.Ab("Gelu",v,void 0)},908219:(v,I,b,A,D,$,q,Z,se)=>{o.Ab("GroupQueryAttention",v,{numHeads:I,kvNumHeads:b,scale:A,softcap:D,doRotary:$,rotaryInterleaved:q,smoothSoftmax:Z,localWindowSize:se})},908436:(v,I,b,A)=>{o.Ab("LayerNormalization",v,{axis:I,epsilon:b,simplified:!!A})},908547:(v,I,b,A)=>{o.Ab("LayerNormalization",v,{axis:I,epsilon:b,simplified:!!A})},908658:(v,I,b,A,D,$)=>{o.Ab("MatMulNBits",v,{k:I,n:b,accuracyLevel:A,bits:D,blockSize:$})},908785:(v,I,b,A,D,$)=>{o.Ab("MultiHeadAttention",v,{numHeads:I,isUnidirectional:b,maskFilterValue:A,scale:D,doRotary:$})},908944:(v,I)=>{o.Ab("QuickGelu",v,{alpha:I})},909008:(v,I,b,A,D)=>{o.Ab("RotaryEmbedding",v,{interleaved:!!I,numHeads:b,rotaryEmbeddingDim:A,scale:D})},909147:(v,I,b)=>{o.Ab("SkipLayerNormalization",v,{epsilon:I,simplified:!!b})},909249:(v,I,b)=>{o.Ab("SkipLayerNormalization",v,{epsilon:I,simplified:!!b})},909351:(v,I,b,A)=>{o.Ab("GatherBlockQuantized",v,{gatherAxis:I,quantizeAxis:b,blockSize:A})},909472:v=>{o.$b(v)},909506:(v,I)=>o.bc(Number(v),Number(I),o.Gb.ec,o.Gb.errors)};function Ma(v,I,b){return Ea(async()=>{await o.Yb(Number(v),Number(I),Number(b))})}function Zi(){return typeof wasmOffsetConverter<"u"}var Be=await(async function(){function v(A,D){return Be=A.exports,Be=(function(){var $=Be,q={};for(let[Z,se]of Object.entries($))q[Z]=typeof se=="function"?(...de)=>{Wr.push(Z);try{return se(...de)}finally{qe||(Wr.pop(),oi&&si===1&&Wr.length===0&&(si=0,Er+=1,jr(Ue),typeof Fibers<"u"&&Fibers.sc()))}}:se;return q})(),Be=(function(){var $=Be,q=se=>de=>se(de)>>>0,Z=se=>()=>se()>>>0;return($=Object.assign({},$)).Ea=q($.Ea),$.gb=Z($.gb),$.ib=q($.ib),$.tb=q($.tb),$.ub=Z($.ub),$.__cxa_get_exception_ptr=q($.__cxa_get_exception_ptr),$})(),cr.push(Be.jb),F=D,Zn(),Be}qt++;var I=zn();if(o.instantiateWasm)return new Promise(A=>{o.instantiateWasm(I,(D,$)=>{A(v(D,$))})});if(x)return new Promise(A=>{et=D=>{var $=new WebAssembly.Instance(D,zn());A(v($,D))}});mt??=o.locateFile?o.locateFile?o.locateFile("ort-wasm-simd-threaded.jsep.wasm",z):z+"ort-wasm-simd-threaded.jsep.wasm":new URL(""+new URL("ort-wasm-simd-threaded.jsep-BGTZ4Y7F.wasm",import.meta.url).href,import.meta.url).href;try{var b=await(async function(A){var D=mt;if(!X&&typeof WebAssembly.instantiateStreaming=="function"&&!ft(D))try{var $=fetch(D,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming($,A)}catch(q){Ge(`wasm streaming compile failed: ${q}`),Ge("falling back to ArrayBuffer instantiation")}return(async function(q,Z){try{var se=await(async function(de){if(!X)try{var Te=await R(de);return new Uint8Array(Te)}catch{}if(de==mt&&X)de=new Uint8Array(X);else{if(!B)throw"both async and sync fetching of the wasm failed";de=B(de)}return de})(q);return await WebAssembly.instantiate(se,Z)}catch(de){Ge(`failed to asynchronously prepare wasm: ${de}`),_n(de)}})(D,A)})(I);return v(b.instance,b.module)}catch(A){return a(A),Promise.reject(A)}})(),pa=v=>(pa=Be.Ea)(v),G=()=>(G=Be.Fa)();o._OrtInit=(v,I)=>(o._OrtInit=Be.Ga)(v,I),o._OrtGetLastError=(v,I)=>(o._OrtGetLastError=Be.Ha)(v,I),o._OrtCreateSessionOptions=(v,I,b,A,D,$,q,Z,se,de)=>(o._OrtCreateSessionOptions=Be.Ia)(v,I,b,A,D,$,q,Z,se,de),o._OrtAppendExecutionProvider=(v,I,b,A,D)=>(o._OrtAppendExecutionProvider=Be.Ja)(v,I,b,A,D),o._OrtAddFreeDimensionOverride=(v,I,b)=>(o._OrtAddFreeDimensionOverride=Be.Ka)(v,I,b),o._OrtAddSessionConfigEntry=(v,I,b)=>(o._OrtAddSessionConfigEntry=Be.La)(v,I,b),o._OrtReleaseSessionOptions=v=>(o._OrtReleaseSessionOptions=Be.Ma)(v),o._OrtCreateSession=(v,I,b)=>(o._OrtCreateSession=Be.Na)(v,I,b),o._OrtReleaseSession=v=>(o._OrtReleaseSession=Be.Oa)(v),o._OrtGetInputOutputCount=(v,I,b)=>(o._OrtGetInputOutputCount=Be.Pa)(v,I,b),o._OrtGetInputOutputMetadata=(v,I,b,A)=>(o._OrtGetInputOutputMetadata=Be.Qa)(v,I,b,A),o._OrtFree=v=>(o._OrtFree=Be.Ra)(v),o._OrtCreateTensor=(v,I,b,A,D,$)=>(o._OrtCreateTensor=Be.Sa)(v,I,b,A,D,$),o._OrtGetTensorData=(v,I,b,A,D)=>(o._OrtGetTensorData=Be.Ta)(v,I,b,A,D),o._OrtReleaseTensor=v=>(o._OrtReleaseTensor=Be.Ua)(v),o._OrtCreateRunOptions=(v,I,b,A)=>(o._OrtCreateRunOptions=Be.Va)(v,I,b,A),o._OrtAddRunConfigEntry=(v,I,b)=>(o._OrtAddRunConfigEntry=Be.Wa)(v,I,b),o._OrtReleaseRunOptions=v=>(o._OrtReleaseRunOptions=Be.Xa)(v),o._OrtCreateBinding=v=>(o._OrtCreateBinding=Be.Ya)(v),o._OrtBindInput=(v,I,b)=>(o._OrtBindInput=Be.Za)(v,I,b),o._OrtBindOutput=(v,I,b,A)=>(o._OrtBindOutput=Be._a)(v,I,b,A),o._OrtClearBoundOutputs=v=>(o._OrtClearBoundOutputs=Be.$a)(v),o._OrtReleaseBinding=v=>(o._OrtReleaseBinding=Be.ab)(v),o._OrtRunWithBinding=(v,I,b,A,D)=>(o._OrtRunWithBinding=Be.bb)(v,I,b,A,D),o._OrtRun=(v,I,b,A,D,$,q,Z)=>(o._OrtRun=Be.cb)(v,I,b,A,D,$,q,Z),o._OrtEndProfiling=v=>(o._OrtEndProfiling=Be.db)(v),o._JsepOutput=(v,I,b)=>(o._JsepOutput=Be.eb)(v,I,b),o._JsepGetNodeName=v=>(o._JsepGetNodeName=Be.fb)(v);var n=()=>(n=Be.gb)(),s=o._free=v=>(s=o._free=Be.hb)(v),l=o._malloc=v=>(l=o._malloc=Be.ib)(v),f=(v,I,b,A,D,$)=>(f=Be.kb)(v,I,b,A,D,$),d=()=>(d=Be.lb)(),g=(v,I,b,A,D)=>(g=Be.mb)(v,I,b,A,D),w=v=>(w=Be.nb)(v),E=v=>(E=Be.ob)(v),O=(v,I)=>(O=Be.pb)(v,I),L=()=>(L=Be.qb)(),V=(v,I)=>(V=Be.rb)(v,I),Y=v=>(Y=Be.sb)(v),ae=v=>(ae=Be.tb)(v),ge=()=>(ge=Be.ub)(),we=o.dynCall_ii=(v,I)=>(we=o.dynCall_ii=Be.vb)(v,I);o.dynCall_vii=(v,I,b)=>(o.dynCall_vii=Be.dynCall_vii)(v,I,b),o.dynCall_iiiii=(v,I,b,A,D)=>(o.dynCall_iiiii=Be.dynCall_iiiii)(v,I,b,A,D),o.dynCall_iii=(v,I,b)=>(o.dynCall_iii=Be.dynCall_iii)(v,I,b),o.dynCall_iiiiii=(v,I,b,A,D,$)=>(o.dynCall_iiiiii=Be.dynCall_iiiiii)(v,I,b,A,D,$),o.dynCall_iiiiiiii=(v,I,b,A,D,$,q,Z)=>(o.dynCall_iiiiiiii=Be.dynCall_iiiiiiii)(v,I,b,A,D,$,q,Z),o.dynCall_iiiiiii=(v,I,b,A,D,$,q)=>(o.dynCall_iiiiiii=Be.dynCall_iiiiiii)(v,I,b,A,D,$,q),o.dynCall_vi=(v,I)=>(o.dynCall_vi=Be.dynCall_vi)(v,I),o.dynCall_iiii=(v,I,b,A)=>(o.dynCall_iiii=Be.dynCall_iiii)(v,I,b,A),o.dynCall_i=v=>(o.dynCall_i=Be.dynCall_i)(v),o.dynCall_viiiiiiii=(v,I,b,A,D,$,q,Z,se)=>(o.dynCall_viiiiiiii=Be.dynCall_viiiiiiii)(v,I,b,A,D,$,q,Z,se),o.dynCall_viii=(v,I,b,A)=>(o.dynCall_viii=Be.dynCall_viii)(v,I,b,A),o.dynCall_viijj=(v,I,b,A,D)=>(o.dynCall_viijj=Be.dynCall_viijj)(v,I,b,A,D),o.dynCall_viiiiii=(v,I,b,A,D,$,q)=>(o.dynCall_viiiiii=Be.dynCall_viiiiii)(v,I,b,A,D,$,q),o.dynCall_viiii=(v,I,b,A,D)=>(o.dynCall_viiii=Be.dynCall_viiii)(v,I,b,A,D),o.dynCall_viiiii=(v,I,b,A,D,$)=>(o.dynCall_viiiii=Be.dynCall_viiiii)(v,I,b,A,D,$),o.dynCall_vfiii=(v,I,b,A,D)=>(o.dynCall_vfiii=Be.dynCall_vfiii)(v,I,b,A,D),o.dynCall_viiiiff=(v,I,b,A,D,$,q)=>(o.dynCall_viiiiff=Be.dynCall_viiiiff)(v,I,b,A,D,$,q),o.dynCall_viiiiiff=(v,I,b,A,D,$,q,Z)=>(o.dynCall_viiiiiff=Be.dynCall_viiiiiff)(v,I,b,A,D,$,q,Z),o.dynCall_ffff=(v,I,b,A)=>(o.dynCall_ffff=Be.dynCall_ffff)(v,I,b,A),o.dynCall_viiff=(v,I,b,A,D)=>(o.dynCall_viiff=Be.dynCall_viiff)(v,I,b,A,D),o.dynCall_fffffff=(v,I,b,A,D,$,q)=>(o.dynCall_fffffff=Be.dynCall_fffffff)(v,I,b,A,D,$,q),o.dynCall_jjjjjjj=(v,I,b,A,D,$,q)=>(o.dynCall_jjjjjjj=Be.dynCall_jjjjjjj)(v,I,b,A,D,$,q),o.dynCall_jjjjjj=(v,I,b,A,D,$)=>(o.dynCall_jjjjjj=Be.dynCall_jjjjjj)(v,I,b,A,D,$),o.dynCall_iijjii=(v,I,b,A,D,$)=>(o.dynCall_iijjii=Be.dynCall_iijjii)(v,I,b,A,D,$),o.dynCall_viiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt)=>(o.dynCall_viiiiiiiiiiiii=Be.dynCall_viiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt),o.dynCall_viiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te)=>(o.dynCall_viiiiiiiiii=Be.dynCall_viiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te),o.dynCall_viiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je)=>(o.dynCall_viiiiiiiiiii=Be.dynCall_viiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je),o.dynCall_viiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt)=>(o.dynCall_viiiiiiiiiiii=Be.dynCall_viiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt),o.dynCall_viiiiiiiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn,jn)=>(o.dynCall_viiiiiiiiiiiiiiiiii=Be.dynCall_viiiiiiiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn,jn),o.dynCall_viiiiiiiii=(v,I,b,A,D,$,q,Z,se,de)=>(o.dynCall_viiiiiiiii=Be.dynCall_viiiiiiiii)(v,I,b,A,D,$,q,Z,se,de),o.dynCall_viiiiiiiiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn,jn,Qn)=>(o.dynCall_viiiiiiiiiiiiiiiiiii=Be.dynCall_viiiiiiiiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn,jn,Qn),o.dynCall_viiiiiii=(v,I,b,A,D,$,q,Z)=>(o.dynCall_viiiiiii=Be.dynCall_viiiiiii)(v,I,b,A,D,$,q,Z),o.dynCall_viiiiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn)=>(o.dynCall_viiiiiiiiiiiiiii=Be.dynCall_viiiiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn),o.dynCall_jiji=(v,I,b,A)=>(o.dynCall_jiji=Be.dynCall_jiji)(v,I,b,A),o.dynCall_v=v=>(o.dynCall_v=Be.dynCall_v)(v),o.dynCall_iidiiii=(v,I,b,A,D,$,q)=>(o.dynCall_iidiiii=Be.dynCall_iidiiii)(v,I,b,A,D,$,q),o.dynCall_iiiiiiiii=(v,I,b,A,D,$,q,Z,se)=>(o.dynCall_iiiiiiiii=Be.dynCall_iiiiiiiii)(v,I,b,A,D,$,q,Z,se),o.dynCall_iiij=(v,I,b,A)=>(o.dynCall_iiij=Be.dynCall_iiij)(v,I,b,A),o.dynCall_iiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de)=>(o.dynCall_iiiiiiiiii=Be.dynCall_iiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de),o.dynCall_iiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt)=>(o.dynCall_iiiiiiiiiiiii=Be.dynCall_iiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt),o.dynCall_iiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te)=>(o.dynCall_iiiiiiiiiii=Be.dynCall_iiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te),o.dynCall_ji=(v,I)=>(o.dynCall_ji=Be.dynCall_ji)(v,I),o.dynCall_iijii=(v,I,b,A,D)=>(o.dynCall_iijii=Be.dynCall_iijii)(v,I,b,A,D),o.dynCall_vij=(v,I,b)=>(o.dynCall_vij=Be.dynCall_vij)(v,I,b),o.dynCall_viiijii=(v,I,b,A,D,$,q)=>(o.dynCall_viiijii=Be.dynCall_viiijii)(v,I,b,A,D,$,q),o.dynCall_viijiiiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn)=>(o.dynCall_viijiiiiiiiiiiiiii=Be.dynCall_viijiiiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn),o.dynCall_viiiji=(v,I,b,A,D,$)=>(o.dynCall_viiiji=Be.dynCall_viiiji)(v,I,b,A,D,$),o.dynCall_fiii=(v,I,b,A)=>(o.dynCall_fiii=Be.dynCall_fiii)(v,I,b,A),o.dynCall_viijii=(v,I,b,A,D,$)=>(o.dynCall_viijii=Be.dynCall_viijii)(v,I,b,A,D,$),o.dynCall_viij=(v,I,b,A)=>(o.dynCall_viij=Be.dynCall_viij)(v,I,b,A),o.dynCall_jiij=(v,I,b,A)=>(o.dynCall_jiij=Be.dynCall_jiij)(v,I,b,A),o.dynCall_fi=(v,I)=>(o.dynCall_fi=Be.dynCall_fi)(v,I),o.dynCall_fii=(v,I,b)=>(o.dynCall_fii=Be.dynCall_fii)(v,I,b),o.dynCall_jii=(v,I,b)=>(o.dynCall_jii=Be.dynCall_jii)(v,I,b),o.dynCall_dii=(v,I,b)=>(o.dynCall_dii=Be.dynCall_dii)(v,I,b),o.dynCall_fiiii=(v,I,b,A,D)=>(o.dynCall_fiiii=Be.dynCall_fiiii)(v,I,b,A,D),o.dynCall_fif=(v,I,b)=>(o.dynCall_fif=Be.dynCall_fif)(v,I,b),o.dynCall_jfi=(v,I,b)=>(o.dynCall_jfi=Be.dynCall_jfi)(v,I,b),o.dynCall_viiiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn)=>(o.dynCall_viiiiiiiiiiiiii=Be.dynCall_viiiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn),o.dynCall_viiiiiiiiiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn,jn,Qn,Ji)=>(o.dynCall_viiiiiiiiiiiiiiiiiiii=Be.dynCall_viiiiiiiiiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln,Jn,jn,Qn,Ji),o.dynCall_viiiiiiiiiiiiiiii=(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln)=>(o.dynCall_viiiiiiiiiiiiiiii=Be.dynCall_viiiiiiiiiiiiiiii)(v,I,b,A,D,$,q,Z,se,de,Te,je,lt,yt,cn,gn,Ln),o.dynCall_iif=(v,I,b)=>(o.dynCall_iif=Be.dynCall_iif)(v,I,b),o.dynCall_jiiii=(v,I,b,A,D)=>(o.dynCall_jiiii=Be.dynCall_jiiii)(v,I,b,A,D),o.dynCall_jiii=(v,I,b,A)=>(o.dynCall_jiii=Be.dynCall_jiii)(v,I,b,A),o.dynCall_viif=(v,I,b,A)=>(o.dynCall_viif=Be.dynCall_viif)(v,I,b,A),o.dynCall_viiij=(v,I,b,A,D)=>(o.dynCall_viiij=Be.dynCall_viiij)(v,I,b,A,D),o.dynCall_viiiijii=(v,I,b,A,D,$,q,Z)=>(o.dynCall_viiiijii=Be.dynCall_viiiijii)(v,I,b,A,D,$,q,Z),o.dynCall_iiiiij=(v,I,b,A,D,$)=>(o.dynCall_iiiiij=Be.dynCall_iiiiij)(v,I,b,A,D,$),o.dynCall_iiiiid=(v,I,b,A,D,$)=>(o.dynCall_iiiiid=Be.dynCall_iiiiid)(v,I,b,A,D,$),o.dynCall_iiiiijj=(v,I,b,A,D,$,q)=>(o.dynCall_iiiiijj=Be.dynCall_iiiiijj)(v,I,b,A,D,$,q),o.dynCall_iiiiiijj=(v,I,b,A,D,$,q,Z)=>(o.dynCall_iiiiiijj=Be.dynCall_iiiiiijj)(v,I,b,A,D,$,q,Z);var Oe=v=>(Oe=Be.wb)(v),Ue=()=>(Ue=Be.xb)(),pt=v=>(pt=Be.yb)(v),dt=()=>(dt=Be.zb)();return(function v(){if(0<qt)Sn=v;else if(x)r(o),ht();else{for(;0<nr.length;)nr.shift()(o);0<qt?Sn=v:(o.calledRun=!0,qe||(ht(),r(o)))}})(),o.PTR_SIZE=4,c},l3=p0,l2=globalThis.self?.name?.startsWith("em-pthread"),l2&&p0()}),g0,bh,u2,aa,u3,Tc,c2,f2,m0,d2,x0,c3,y0,f3,Yh=gt(()=>{Hh(),g0=typeof location>"u"?void 0:location.origin,bh=import.meta.url>"file:"&&import.meta.url<"file;",u2=()=>{{if(bh){let e=URL;return new URL(new e("ort.bundle.min.mjs",import.meta.url).href,g0).href}return import.meta.url}},aa=u2(),u3=()=>{if(aa&&!aa.startsWith("blob:"))return aa.substring(0,aa.lastIndexOf("/")+1)},Tc=(e,r)=>{try{let a=r??aa;return(a?new URL(e,a):new URL(e)).origin===g0}catch{return!1}},c2=(e,r)=>{let a=r??aa;try{return(a?new URL(e,a):new URL(e)).href}catch{return}},f2=(e,r)=>`${r??"./"}${e}`,m0=async e=>{let r=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(r)},d2=async e=>(await import(e)).default,x0=(P8(),_u(a3)).default,c3=async()=>{if(!aa)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(Tc(aa))return[void 0,x0()];let e=await m0(aa);return[e,x0(e)]},y0=(F8(),_u(o3)).default,f3=async(e,r,a,o)=>{let c=y0&&!(e||r);if(c)if(aa)c=Tc(aa);else if(o&&!a)c=!0;else throw new Error("cannot determine the script source URL.");if(c)return[void 0,y0];{let h="ort-wasm-simd-threaded.jsep.mjs",m=e??c2(h,r),x=a&&m&&!Tc(m,r),_=x?await m0(m):m??f2(h,r);return[x?_:void 0,await d2(_)]}}}),w0,Sc,nu,b0,h2,p2,g2,Wh,br,zo=gt(()=>{Yh(),Sc=!1,nu=!1,b0=!1,h2=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},p2=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},g2=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},Wh=async e=>{if(Sc)return Promise.resolve();if(nu)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(b0)throw new Error("previous call to 'initializeWebAssembly()' failed.");nu=!0;let r=e.initTimeout,a=e.numThreads;if(e.simd!==!1){if(e.simd==="relaxed"){if(!g2())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!p2())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let o=h2();a>1&&!o&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+a+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=a=1);let c=e.wasmPaths,h=typeof c=="string"?c:void 0,m=c?.mjs,x=m?.href??m,_=c?.wasm,y=_?.href??_,S=e.wasmBinary,[R,B]=await f3(x,h,a>1,!!S||!!y),N=!1,k=[];if(r>0&&k.push(new Promise(z=>{setTimeout(()=>{N=!0,z()},r)})),k.push(new Promise((z,X)=>{let j={numThreads:a};if(S)j.wasmBinary=S;else if(y||h)j.locateFile=F=>y??h+F;else if(x&&x.indexOf("blob:")!==0)j.locateFile=F=>new URL(F,x).href;else if(R){let F=u3();F&&(j.locateFile=te=>F+te)}B(j).then(F=>{nu=!1,Sc=!0,w0=F,z(),R&&URL.revokeObjectURL(R)},F=>{nu=!1,b0=!0,X(F)})})),await Promise.race(k),N)throw new Error(`WebAssembly backend initializing failed due to timeout: ${r}ms`)},br=()=>{if(Sc&&w0)return w0;throw new Error("WebAssembly is not initialized yet.")}}),Pa,tf,ur,Kh=gt(()=>{zo(),Pa=(e,r)=>{let a=br(),o=a.lengthBytesUTF8(e)+1,c=a._malloc(o);return a.stringToUTF8(e,c,o),r.push(c),c},tf=(e,r,a,o)=>{if(typeof e=="object"&&e!==null){if(a.has(e))throw new Error("Circular reference in options");a.add(e)}Object.entries(e).forEach(([c,h])=>{let m=r?r+c:c;if(typeof h=="object")tf(h,m+".",a,o);else if(typeof h=="string"||typeof h=="number")o(m,h.toString());else if(typeof h=="boolean")o(m,h?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof h}`)})},ur=e=>{let r=br(),a=r.stackSave();try{let o=r.PTR_SIZE,c=r.stackAlloc(2*o);r._OrtGetLastError(c,c+o);let h=Number(r.getValue(c,o===4?"i32":"i64")),m=r.getValue(c+o,"*"),x=m?r.UTF8ToString(m):"";throw new Error(`${e} ERROR_CODE: ${h}, ERROR_MESSAGE: ${x}`)}finally{r.stackRestore(a)}}}),d3,G8=gt(()=>{zo(),Kh(),d3=e=>{let r=br(),a=0,o=[],c=e||{};try{if(e?.logSeverityLevel===void 0)c.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log severity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)c.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(c.terminate=!1);let h=0;return e?.tag!==void 0&&(h=Pa(e.tag,o)),a=r._OrtCreateRunOptions(c.logSeverityLevel,c.logVerbosityLevel,!!c.terminate,h),a===0&&ur("Can't create run options."),e?.extra!==void 0&&tf(e.extra,"",new WeakSet,(m,x)=>{let _=Pa(m,o),y=Pa(x,o);r._OrtAddRunConfigEntry(a,_,y)!==0&&ur(`Can't set a run config entry: ${m} - ${x}.`)}),[a,o]}catch(h){throw a!==0&&r._OrtReleaseRunOptions(a),o.forEach(m=>r._free(m)),h}}}),m2,x2,y2,ru,w2,h3,V8=gt(()=>{zo(),Kh(),m2=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"layout":return 3;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},x2=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},y2=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let r=e.extra.session;r.use_ort_model_bytes_directly||(r.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(a=>(typeof a=="string"?a:a.name)==="webgpu")&&(e.enableMemPattern=!1)},ru=(e,r,a,o)=>{let c=Pa(r,o),h=Pa(a,o);br()._OrtAddSessionConfigEntry(e,c,h)!==0&&ur(`Can't set a session config entry: ${r} - ${a}.`)},w2=async(e,r,a)=>{for(let o of r){let c=typeof o=="string"?o:o.name,h=[];switch(c){case"webnn":if(c="WEBNN",typeof o!="string"){let S=o?.deviceType;S&&ru(e,"deviceType",S,a)}break;case"webgpu":if(c="JS",typeof o!="string"){let S=o;if(S?.preferredLayout){if(S.preferredLayout!=="NCHW"&&S.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${S.preferredLayout}`);ru(e,"preferredLayout",S.preferredLayout,a)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${c}`)}let m=Pa(c,a),x=h.length,_=0,y=0;if(x>0){_=br()._malloc(x*br().PTR_SIZE),a.push(_),y=br()._malloc(x*br().PTR_SIZE),a.push(y);for(let S=0;S<x;S++)br().setValue(_+S*br().PTR_SIZE,h[S][0],"*"),br().setValue(y+S*br().PTR_SIZE,h[S][1],"*")}await br()._OrtAppendExecutionProvider(e,m,_,y,x)!==0&&ur(`Can't append execution provider: ${c}.`)}},h3=async e=>{let r=br(),a=0,o=[],c=e||{};y2(c);try{let h=m2(c.graphOptimizationLevel??"all"),m=x2(c.executionMode??"sequential"),x=typeof c.logId=="string"?Pa(c.logId,o):0,_=c.logSeverityLevel??2;if(!Number.isInteger(_)||_<0||_>4)throw new Error(`log severity level is not valid: ${_}`);let y=c.logVerbosityLevel??0;if(!Number.isInteger(y)||y<0||y>4)throw new Error(`log verbosity level is not valid: ${y}`);let S=typeof c.optimizedModelFilePath=="string"?Pa(c.optimizedModelFilePath,o):0;if(a=r._OrtCreateSessionOptions(h,!!c.enableCpuMemArena,!!c.enableMemPattern,m,!!c.enableProfiling,0,x,_,y,S),a===0&&ur("Can't create session options."),c.executionProviders&&await w2(a,c.executionProviders,o),c.enableGraphCapture!==void 0){if(typeof c.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${c.enableGraphCapture}`);ru(a,"enableGraphCapture",c.enableGraphCapture.toString(),o)}if(c.freeDimensionOverrides)for(let[R,B]of Object.entries(c.freeDimensionOverrides)){if(typeof R!="string")throw new Error(`free dimension override name must be a string: ${R}`);if(typeof B!="number"||!Number.isInteger(B)||B<0)throw new Error(`free dimension override value must be a non-negative integer: ${B}`);let N=Pa(R,o);r._OrtAddFreeDimensionOverride(a,N,B)!==0&&ur(`Can't set a free dimension override: ${R} - ${B}.`)}return c.extra!==void 0&&tf(c.extra,"",new WeakSet,(R,B)=>{ru(a,R,B,o)}),[a,o]}catch(h){throw a!==0&&r._OrtReleaseSessionOptions(a)!==0&&ur("Can't release session options."),o.forEach(m=>r._free(m)),h}}}),Oo,Ts,Do,gf,nf,Qh,Xh,vh,fn=gt(()=>{Oo=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${e}`)}},Ts=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${e}`)}},Do=(e,r)=>{let a=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],o=typeof r=="number"?r:r.reduce((c,h)=>c*h,1);return a>0?Math.ceil(o*a):void 0},gf=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},nf=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Qh=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",Xh=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint64"||e==="int8"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",vh=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${e}`)}}}),Zh,p3=gt(()=>{Hh(),Zh=async e=>{if(typeof e=="string"){let r=await fetch(e);if(!r.ok)throw new Error(`failed to load external data file: ${e}`);let a=r.headers.get("Content-Length"),o=a?parseInt(a,10):0;if(o<1073741824)return new Uint8Array(await r.arrayBuffer());{if(!r.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let c=r.body.getReader(),h;try{h=new ArrayBuffer(o)}catch(x){if(x instanceof RangeError){let _=Math.ceil(o/65536);h=new WebAssembly.Memory({initial:_,maximum:_}).buffer}else throw x}let m=0;for(;;){let{done:x,value:_}=await c.read();if(x)break;let y=_.byteLength;new Uint8Array(h,m,y).set(_),m+=y}return new Uint8Array(h,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),b2,v2,_2,C2,Jh,A2,Fn,Ss=gt(()=>{fn(),b2=["V","I","W","E","F"],v2=(e,r)=>{console.log(`[${b2[e]},${new Date().toISOString()}]${r}`)},Jh=(e,r)=>{_2=e,C2=r},A2=(e,r)=>{let a=nf(e),o=nf(_2);a>=o&&v2(a,typeof r=="function"?r():r)},Fn=(...e)=>{C2&&A2(...e)}}),E2,xl,Ve,rf,g3,m3,x3,vn=gt(()=>{E2=class{static calcMatMulShape(e,r){return e[1]!==r[0]?void 0:[e[0],r[1]]}},xl=class{static calcShape(e,r,a=!1){let o=e.length,c=r.length;if(o===0)return r;if(c===0)return e;let h=Math.max(e.length,r.length),m=new Array(h);if(a){if(o<2||c<2)return;let x=E2.calcMatMulShape([e[o-2],e[o-1]],[r[c-2],r[c-1]]);if(x===void 0)return;[m[h-2],m[h-1]]=x}for(let x=a?3:1;x<=h;x++){let _=o-x<0?1:e[o-x],y=c-x<0?1:r[c-x];if(_!==y&&_>1&&y>1)return;let S=Math.max(_,y);if(_&&y)m[h-x]=Math.max(_,y);else{if(S>1)return;m[h-x]=0}}return m}static isValidBroadcast(e,r){let a=e.length,o=r.length;if(a>o)return!1;for(let c=1;c<=a;c++)if(e[a-c]!==1&&e[a-c]!==r[o-c])return!1;return!0}},Ve=class jc{static size(r){return jc.getSizeFromDimensionRange(r,0,r.length)}static convertShape(r,a=4){let o=r.length;if(o===0)return[];let c=new Array(o),h=o-1;for(;h>=0;){if(r[h]%a===0){c[h]=r[h]/a;break}if(a%r[h]!==0)throw new Error("cannot convert shape");c[h]=1,a/=r[h],h--}for(h--;h>=0;h--)c[h]=r[h];return c}static sizeFromDimension(r,a){if(a<0||a>r.length)throw new Error(`invalid dimension of ${a} for sizeFromDimension as Tensor has ${r.length} dimensions.`);return jc.getSizeFromDimensionRange(r,a,r.length)}static sizeToDimension(r,a){if(a<0||a>r.length)throw new Error(`invalid dimension of ${a} for sizeToDimension as Tensor has ${r.length} dimensions.`);return jc.getSizeFromDimensionRange(r,0,a)}static getSizeFromDimensionRange(r,a,o){let c=1;for(let h=a;h<o;h++){if(r[h]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");c*=Number(r[h])}return c}static computeStrides(r){let a=r.length;if(a===0)return[];if(a===1)return[1];let o=new Array(a);o[a-1]=1,o[a-2]=r[a-1];for(let c=a-3;c>=0;--c)o[c]=o[c+1]*r[c+1];return o}static normalizeAxis(r,a){if(r<-a&&r>=a)throw new Error("unsupported axis for this operation.");return r<0?r+a:r}static normalizeAxes(r,a){return r.map(o=>this.normalizeAxis(o,a??r.length))}static sortBasedOnPerm(r,a){return a?a.map(o=>r[o]):r.slice().reverse()}static padShape(r,a){let o=r.length;return r.map((c,h)=>c+a[h]+a[h+o])}static areEqual(r,a){return r.length!==a.length?!1:r.every((o,c)=>o===a[c])}},rf=class yu{static adjustPoolAttributes(r,a,o,c,h,m){if(!r&&o.length!==a.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(r)for(let x=0;x<a.length-2;x++)x>=o.length?o.push(a[x+2]):o[x]=a[x+2];for(let x=0;x<o.length;x++)if(x<c.length){if(c[x]<0)throw new Error("strides should be greater than or equal to 1")}else c.push(1);for(let x=0;x<o.length;x++)if(x<h.length){if(h[x]<0)throw new Error("dilations should be greater than or equal to 1")}else h.push(1);for(let x=0;x<o.length*2;x++)if(x<m.length){if(m[x]<0)throw new Error("pad should be greater than or equal to 1")}else m.push(0);for(let x=0;x<o.length;x++){if(o[x]<=0)throw new Error("kernel shapes need to be greater than 0");if(m[x]>=o[x]||m[x+o.length]>=o[x])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(r,a,o,c,h,m,x){if(x){if(h.length!==2*(r.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(a.length!==r.length-2)throw new Error("length of strides should be the length of data dimensions");if(c.length!==r.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let _=0;_<r.length-2;_++)yu.adjustPadAndReturnShape(r[_+(m?1:2)],a[_],o[_],c[_],h,_,_+r.length-2,x)}}static computePoolOutputShape(r,a,o,c,h,m,x){if(a.length<=0)throw new Error("input shape must be of size greater than 0");let _=[a[0],a[1]];return yu.computeShapeHelper(r,a,_,o,c,h,m,x),_}static computeConvOutputShape(r,a,o,c,h,m,x){if(r.length<=0||a.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let _=[r[0],a[0]];return yu.computeShapeHelper(!1,r,_,o,c,h,m,x),_}static computeShapeHelper(r,a,o,c,h,m,x,_){if(r)for(let y=0;y<a.length-2;y++)o.push(1);else for(let y=0;y<a.length-2;y++)o.push(yu.adjustPadAndReturnShape(a[y+2],c[y],h[y],m[y],x,y,y+a.length-2,_))}static adjustPadAndReturnShape(r,a,o,c,h,m,x,_){let y=o*(c-1)+1;if(_&&_!=="NOTSET")switch(_){case"VALID":return h[m]=0,h[x]=0,Math.floor((r-y)/a+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let S=((r+a-1)/a-1)*a+c-r;return h[m]=Math.floor(_==="SAME_LOWER"?(S+1)/2:S/2),h[x]=S-h[m],Math.floor((r+S-c)/a+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((r+h[m]+h[x]-y)/a+1)}},g3=class{static getShapeOfGemmResult(e,r,a,o,c){if(e.length!==2||a.length!==2)throw new Error("shape need to be of size 2");let h,m,x;r?(h=e[1],m=e[0]):(h=e[0],m=e[1]);let _=-1;if(o?(x=a[0],_=1):(x=a[1],_=0),a[_]!==m)throw new Error("dimension mismatch");if(h<=0||x<=0||m<=0)throw new Error("invalid shape specified");if(c&&!xl.isValidBroadcast(c,[h,x]))throw new Error("gemm: invalid bias shape for broadcast");return[h,x,m]}},m3=-34028234663852886e22,x3=34028234663852886e22}),e1,y3=gt(()=>{fn(),e1=(e,r)=>new(gf(r))(e)}),v0,_h,_0,T2,C0,S2,A0,E0,T0,I2,w3,q8=gt(()=>{fn(),Ss(),v0=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),_h=(e,r)=>{if(r==="int32")return e;let a=v0.get(r);if(!a)throw new Error(`WebNN backend does not support data type: ${r}`);let o=a/8;if(e.byteLength%o!==0)throw new Error(`Invalid Uint8Array length - must be a multiple of ${o}.`);let c=e.byteLength/o,h=new(gf(r))(e.buffer,e.byteOffset,c);switch(r){case"int64":case"uint64":{let m=new Int32Array(c);for(let x=0;x<c;x++){let _=h[x];if(_>2147483647n||_<-2147483648n)throw new Error("Can not convert int64 data to int32 - value out of range.");m[x]=Number(_)}return new Uint8Array(m.buffer)}case"int8":case"uint8":case"uint32":{if(r==="uint32"&&h.some(x=>x>2147483647))throw new Error("Can not convert uint32 data to int32 - value out of range.");let m=Int32Array.from(h,Number);return new Uint8Array(m.buffer)}default:throw new Error(`Unsupported data conversion from ${r} to 'int32'`)}},_0=(e,r)=>{if(r==="int32")return e;if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (int32).");let a=e.byteLength/4,o=new Int32Array(e.buffer,e.byteOffset,a);switch(r){case"int64":{let c=BigInt64Array.from(o,BigInt);return new Uint8Array(c.buffer)}case"uint64":{if(o.some(h=>h<0))throw new Error("Can not convert int32 data to uin64 - negative value found.");let c=BigUint64Array.from(o,BigInt);return new Uint8Array(c.buffer)}case"int8":{if(o.some(h=>h<-128||h>127))throw new Error("Can not convert int32 data to int8 - value out of range.");let c=Int8Array.from(o,Number);return new Uint8Array(c.buffer)}case"uint8":{if(o.some(c=>c<0||c>255))throw new Error("Can not convert int32 data to uint8 - value out of range.");return Uint8Array.from(o,Number)}case"uint32":{if(o.some(h=>h<0))throw new Error("Can not convert int32 data to uint32 - negative value found.");let c=Uint32Array.from(o,Number);return new Uint8Array(c.buffer)}default:throw new Error(`Unsupported data conversion from 'int32' to ${r}`)}},T2=1,C0=()=>T2++,S2=new Map([["int8","int32"],["uint8","int32"],["uint32","int32"],["int64","int32"]]),A0=(e,r)=>{let a=v0.get(e);if(!a)throw new Error(`WebNN backend does not support data type: ${e}`);return r.length>0?Math.ceil(r.reduce((o,c)=>o*c)*a/8):0},E0=class{constructor(e){this.isDataConverted=!1;let{sessionId:r,context:a,tensor:o,dataType:c,shape:h,fallbackDataType:m}=e;this.sessionId=r,this.mlContext=a,this.mlTensor=o,this.dataType=c,this.tensorShape=h,this.fallbackDataType=m}get tensor(){return this.mlTensor}get type(){return this.dataType}get fallbackType(){return this.fallbackDataType}get shape(){return this.tensorShape}get byteLength(){return A0(this.dataType,this.tensorShape)}destroy(){Fn("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e){if(this.fallbackDataType){let r=await this.mlContext.readTensor(this.mlTensor),a=_0(new Uint8Array(r),this.dataType);if(e){(e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).set(a);return}else return a.buffer}else return e?this.mlContext.readTensor(this.mlTensor,e):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,r,a){return this.mlContext===e&&this.dataType===r&&this.tensorShape.length===a.length&&this.tensorShape.every((o,c)=>o===a[c])}setIsDataConverted(e){this.isDataConverted=e}},T0=class{constructor(e,r){this.tensorManager=e,this.wrapper=r}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,r,a,o){let c=this.tensorManager.getMLContext(e),h;if(!c.opSupportLimits().input.dataTypes.includes(r)){if(h=S2.get(r),!h||!c.opSupportLimits().input.dataTypes.includes(h))throw new Error(`WebNN backend does not support data type: ${r}`);Fn("verbose",()=>`[WebNN] TensorIdTracker.ensureTensor: fallback dataType from ${r} to ${h}`)}if(this.wrapper){if(this.wrapper.canReuseTensor(c,r,a))return this.wrapper.tensor;if(o){if(this.wrapper.byteLength!==A0(r,a))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let m=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,r,a,m,!0,!0,h),o&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let r=e;if(this.wrapper){if(this.wrapper.fallbackType)if(this.wrapper.fallbackType==="int32")r=_h(e,this.wrapper.type),this.wrapper.setIsDataConverted(!0);else throw new Error(`Unsupported fallback data type: ${this.wrapper.fallbackType}`);if(e.byteLength===this.wrapper.byteLength){this.wrapper.write(r);return}else Fn("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor()}this.activeUpload?this.activeUpload.set(r):this.activeUpload=new Uint8Array(r)}async download(e){if(this.activeUpload){let r=this.wrapper?.isDataConverted?_0(this.activeUpload,this.wrapper?.type):this.activeUpload;if(e){e instanceof ArrayBuffer?new Uint8Array(e).set(r):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(r);return}else return r.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read(e):this.wrapper.read()}},I2=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let r=this.backend.getMLContext(e);if(!r)throw new Error("MLContext not found for session.");return r}reserveTensorId(){let e=C0();return this.tensorTrackersById.set(e,new T0(this)),e}releaseTensorId(e){let r=this.tensorTrackersById.get(e);r&&(this.tensorTrackersById.delete(e),r.tensorWrapper&&this.releaseTensor(r.tensorWrapper))}async ensureTensor(e,r,a,o,c){Fn("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${r}, dataType: ${a}, shape: ${o}, copyOld: ${c}}`);let h=this.tensorTrackersById.get(r);if(!h)throw new Error("Tensor not found.");return h.ensureTensor(e,a,o,c)}upload(e,r){let a=this.tensorTrackersById.get(e);if(!a)throw new Error("Tensor not found.");a.upload(r)}async download(e,r){Fn("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${r?.byteLength}}`);let a=this.tensorTrackersById.get(e);if(!a)throw new Error("Tensor not found.");return a.download(r)}releaseTensorsForSession(e){for(let r of this.freeTensors)r.sessionId===e&&r.destroy();this.freeTensors=this.freeTensors.filter(r=>r.sessionId!==e)}registerTensor(e,r,a,o){let c=this.getMLContext(e),h=C0(),m=new E0({sessionId:e,context:c,tensor:r,dataType:a,shape:o});return this.tensorTrackersById.set(h,new T0(this,m)),this.externalTensors.add(m),h}async getCachedTensor(e,r,a,o,c,h,m){let x=this.getMLContext(e);for(let[y,S]of this.freeTensors.entries())if(S.canReuseTensor(x,r,a)){Fn("verbose",()=>`[WebNN] Reusing tensor {dataType: ${r}, ${m?`fallbackDataType: ${m},`:""} shape: ${a}`);let R=this.freeTensors.splice(y,1)[0];return R.sessionId=e,R}Fn("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${r}, ${m?`fallbackDataType: ${m},`:""} shape: ${a}}`);let _=await x.createTensor({dataType:m??r,shape:a,dimensions:a,usage:o,writable:c,readable:h});return new E0({sessionId:e,context:x,tensor:_,dataType:r,shape:a,fallbackDataType:m})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},w3=(...e)=>new I2(...e)}),iu,R2,b3,j8=gt(()=>{fn(),zo(),y3(),q8(),Ss(),iu=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),R2=(e,r)=>{if(e===r)return!0;if(e===void 0||r===void 0)return!1;let a=Object.keys(e).sort(),o=Object.keys(r).sort();return a.length===o.length&&a.every((c,h)=>c===o[h]&&e[c]===r[c])},b3=class{constructor(e){this.tensorManager=w3(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.sessionGraphOutputs=new Map,this.temporaryGraphInputs=[],this.temporaryGraphOutputs=[],this.temporarySessionTensorIds=new Map,Jh(e.logLevel,!!e.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(e){Fn("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){Fn("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let r=this.temporarySessionTensorIds.get(e);if(r){for(let a of r)Fn("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${a}}`),this.tensorManager.releaseTensorId(a);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let a=this.mlContextCache.findIndex(o=>o.gpuDevice===e);if(a!==-1)return this.mlContextCache[a].mlContext;{let o=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:o}),o}}else if(e===void 0){let a=this.mlContextCache.findIndex(o=>o.options===void 0&&o.gpuDevice===void 0);if(a!==-1)return this.mlContextCache[a].mlContext;{let o=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:o}),o}}let r=this.mlContextCache.findIndex(a=>R2(a.options,e));if(r!==-1)return this.mlContextCache[r].mlContext;{let a=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:a}),a}}registerMLContext(e,r){this.mlContextBySessionId.set(e,r);let a=this.sessionIdsByMLContext.get(r);a||(a=new Set,this.sessionIdsByMLContext.set(r,a)),a.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[]),this.temporaryGraphOutputs.length>0&&(this.sessionGraphOutputs.set(e,this.temporaryGraphOutputs),this.temporaryGraphOutputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e),this.sessionGraphOutputs.delete(e);let r=this.mlContextBySessionId.get(e);if(!r)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let a=this.sessionIdsByMLContext.get(r);if(a.delete(e),a.size===0){this.sessionIdsByMLContext.delete(r);let o=this.mlContextCache.findIndex(c=>c.mlContext===r);o!==-1&&this.mlContextCache.splice(o,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){Fn("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,r,a,o,c){let h=iu.get(a);if(!h)throw new Error(`Unsupported ONNX data type: ${a}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,r,h,o,c)}async createTemporaryTensor(e,r,a){Fn("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${r}, shape: ${a}}`);let o=iu.get(r);if(!o)throw new Error(`Unsupported ONNX data type: ${r}`);let c=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,c,o,a,!1);let h=this.temporarySessionTensorIds.get(e);return h?h.push(c):this.temporarySessionTensorIds.set(e,[c]),c}uploadTensor(e,r){if(!br().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");Fn("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${r.byteLength}}`),this.tensorManager.upload(e,r)}async downloadTensor(e,r){return this.tensorManager.download(e,r)}createMLTensorDownloader(e,r){return async()=>{let a=await this.tensorManager.download(e);return e1(a,r)}}registerMLTensor(e,r,a,o){let c=iu.get(a);if(!c)throw new Error(`Unsupported ONNX data type: ${a}`);let h=this.tensorManager.registerTensor(e,r,c,o);return Fn("verbose",()=>`[WebNN] registerMLTensor {tensor: ${r}, dataType: ${c}, dimensions: ${o}} -> {tensorId: ${h}}`),h}registerMLConstant(e,r,a,o,c,h,m=!1){if(!h)throw new Error("External mounted files are not available.");let x=e;e.startsWith("./")&&(x=e.substring(2));let _=h.get(x);if(!_)throw new Error(`File with name ${x} not found in preloaded files.`);if(r+a>_.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let y=_.slice(r,r+a).buffer,S;switch(c.dataType){case"float32":S=new Float32Array(y);break;case"float16":S=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(y):new Uint16Array(y);break;case"int32":S=new Int32Array(y);break;case"uint32":S=new Uint32Array(y);break;case"int64":if(m){let R=_h(new Uint8Array(y),"int64");S=new Int32Array(R.buffer),c.dataType="int32"}else S=new BigInt64Array(y);break;case"uint64":S=new BigUint64Array(y);break;case"int8":S=new Int8Array(y);break;case"int4":case"uint4":case"uint8":S=new Uint8Array(y);break;default:throw new Error(`Unsupported data type: ${c.dataType} in creating WebNN Constant from external data.`)}return Fn("verbose",()=>`[WebNN] registerMLConstant {dataType: ${c.dataType}, shape: ${c.shape}}} ${m?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),o.constant(c,S)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}registerGraphOutput(e){this.temporaryGraphOutputs.push(e)}isGraphInput(e,r){let a=this.sessionGraphInputs.get(e);return a?a.includes(r):!1}isGraphOutput(e,r){let a=this.sessionGraphOutputs.get(e);return a?a.includes(r):!1}isGraphInputOutputTypeSupported(e,r,a=!0){let o=this.mlContextBySessionId.get(e),c=iu.get(Oo(r));return typeof c>"u"?!1:a?!!o?.opSupportLimits().input.dataTypes.includes(c):!!o?.opSupportLimits().output.dataTypes.includes(c)}flush(){}}}),t1=gt(()=>{}),S0,Ic,Rc,O2,D2,I0,Ch,M2,v3,H8=gt(()=>{Ss(),t1(),S0=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),Ic=[],Rc=e=>Math.ceil(Number(e)/16)*16,O2=e=>{for(let r=0;r<Ic.length;r++){let a=Ic[r];if(e<=a)return a}return Math.ceil(e/16)*16},D2=1,I0=()=>D2++,Ch=async(e,r,a,o)=>{let c=Rc(a),h=e.device.createBuffer({size:c,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let m=e.getCommandEncoder();e.endComputePass(),m.copyBufferToBuffer(r,0,h,0,c),e.flush(),await h.mapAsync(GPUMapMode.READ);let x=h.getMappedRange();if(o){let _=o();return _.set(new Uint8Array(x,0,a)),_}else return new Uint8Array(x.slice(0,a))}finally{h.destroy()}},M2=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[r]of S0)Ic.push(r),this.freeBuffers.set(r,[]),this.freeUniformBuffers.set(r,[]);this.sessionCount=0}upload(e,r){let a=r.buffer,o=r.byteOffset,c=r.byteLength,h=Rc(c),m=this.storageCache.get(e);if(!m)throw new Error("gpu data for uploading does not exist");if(Number(m.originalSize)!==c)throw new Error(`inconsistent data size. gpu data size=${m.originalSize}, data size=${c}`);let x=this.backend.device.createBuffer({mappedAtCreation:!0,size:h,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),_=x.getMappedRange();new Uint8Array(_).set(new Uint8Array(a,o,c)),x.unmap();let y=this.backend.device.createCommandEncoder();y.copyBufferToBuffer(x,0,m.gpuData.buffer,0,h),this.backend.device.queue.submit([y.finish()]),x.destroy(),Fn("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,r){let a=this.storageCache.get(e);if(!a)throw new Error("source gpu data for memcpy does not exist");let o=this.storageCache.get(r);if(!o)throw new Error("destination gpu data for memcpy does not exist");if(a.originalSize!==o.originalSize)throw new Error("inconsistent source and destination gpu data size");let c=Rc(a.originalSize),h=this.backend.getCommandEncoder();this.backend.endComputePass(),h.copyBufferToBuffer(a.gpuData.buffer,0,o.gpuData.buffer,0,c)}registerExternalBuffer(e,r,a){let o;if(a){if(o=a[0],e===a[1])return Fn("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${o}, buffer is the same, skip.`),o;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else o=I0();return this.storageCache.set(o,{gpuData:{id:o,type:0,buffer:e},originalSize:r}),Fn("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${o}, registered.`),o}unregisterExternalBuffer(e){e!==void 0&&(this.storageCache.delete(e),Fn("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let a=O2(e),o,c=(r&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,h=(r&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(c||h){let x=(c?this.freeBuffers:this.freeUniformBuffers).get(a);x?x.length>0?o=x.pop():o=this.backend.device.createBuffer({size:a,usage:r}):o=this.backend.device.createBuffer({size:a,usage:r})}else o=this.backend.device.createBuffer({size:a,usage:r});let m={id:I0(),type:0,buffer:o};return this.storageCache.set(m.id,{gpuData:m,originalSize:Number(e)}),Fn("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${m.id}`),m}get(e){return this.storageCache.get(e)?.gpuData}release(e){let r=typeof e=="bigint"?Number(e):e,a=this.storageCache.get(r);if(!a){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return Fn("verbose",()=>`[WebGPU] GpuDataManager.release(id=${r}), gpuDataId=${a.gpuData.id}`),this.storageCache.delete(r),this.buffersPending.push(a.gpuData.buffer),a.originalSize}async download(e,r){let a=this.storageCache.get(Number(e));if(!a)throw new Error("data does not exist");await Ch(this.backend,a.gpuData.buffer,a.originalSize,r)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let r=S0.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let a=this.freeBuffers.get(e.size)||[];r===void 0||a.length>=r?e.destroy():a.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let a=this.freeUniformBuffers.get(e.size)||[];r===void 0||a.length>=r?e.destroy():a.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let r of this.buffersPending)e.push(r);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(r=>{r.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(r=>{r.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(r=>{r.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let r=this.capturedPendingBuffers.get(e);r&&(r.forEach(a=>{a.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,this.sessionCount===0&&(Fn("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(a=>{a.gpuData.buffer.destroy()}),this.storageCache=new Map)}},v3=(...e)=>new M2(...e)}),B2,tr,Ur=gt(()=>{B2=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},tr=e=>new B2(e)}),yl,Oc,ii,Ei,Kt,$r,Ah,pl,oo,Yt,au,Ke,Pt,_3,n1,N2,C3,An=gt(()=>{fn(),vn(),yl=64,Oc=(e,r)=>{if(r===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return r>1?`vec${r}<f16>`:"f16";case 1:return r>1?`vec${r}<f32>`:"f32";case 6:return r>1?`vec${r}<i32>`:"i32";case 12:return r>1?`vec${r}<u32>`:"u32";case 7:if(r>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(r>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(r!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${e}`)}},ii=(e,r=1)=>{let a=Oc(e,r);return typeof a=="string"?a:a[0]},Ei=(e,r=1)=>{let a=Oc(e,r);return typeof a=="string"?a:a[1]},Kt=(...e)=>{let r=[];return e.forEach(a=>{a.length!==0&&r.push({type:12,data:a},{type:12,data:Ve.computeStrides(a)})}),r},$r=e=>e%4===0?4:e%2===0?2:1,Ah=(e="f32",r,a="0")=>!r||r===1?`${e}(${a})`:`vec${r}<${e}>(${a})`,pl=(e,r,a)=>e==="f32"?a:r===1?`f32(${a})`:`vec${r}<f32>(${a})`,oo=(e,r)=>r===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:r===2?`(${e}.x + ${e}.y)`:r===3?`(${e}.x + ${e}.y + ${e}.z)`:e,Yt=(e,r,a,o)=>e.startsWith("uniforms.")&&a>4?typeof r=="string"?o==="f16"?`${e}[(${r}) / 8][(${r}) % 8 / 4][(${r}) % 8 % 4]`:`${e}[(${r}) / 4][(${r}) % 4]`:o==="f16"?`${e}[${Math.floor(r/8)}][${Math.floor(r%8/4)}][${r%8%4}]`:`${e}[${Math.floor(r/4)}][${r%4}]`:a>1?`${e}[${r}]`:e,au=(e,r,a,o,c)=>{let h=typeof a=="number",m=h?a:a.length,x=[...new Array(m).keys()],_=m<2?"u32":m<=4?`vec${m}<u32>`:`array<u32, ${m}>`,y=Oc(r,c),S=typeof y=="string"?y:y[1],R=typeof y=="string"?y:y[0],B={indices:_,value:S,storage:R,tensor:r},N=ne=>typeof ne=="string"?ne:`${ne}u`,k={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},z=h?"uniforms.":"",X=`${z}${e}_shape`,j=`${z}${e}_strides`,F="";for(let ne=0;ne<m-1;ne++)F+=`
    let dim${ne} = current / ${Yt(j,ne,m)};
    let rest${ne} = current % ${Yt(j,ne,m)};
    indices[${ne}] = dim${ne};
    current = rest${ne};
    `;F+=`indices[${m-1}] = current;`;let te=m<2?"":`
  fn o2i_${e}(offset: u32) -> ${B.indices} {
    var indices: ${B.indices};
    var current = offset;
    ${F}
    return indices;
  }`,Q=ne=>(k.offsetToIndices=!0,m<2?ne:`o2i_${e}(${ne})`),oe=[];if(m>=2)for(let ne=m-1;ne>=0;ne--)oe.push(`${Yt(j,ne,m)} * (indices[${ne}])`);let ue=m<2?"":`
  fn i2o_${e}(indices: ${B.indices}) -> u32 {
    return ${oe.join("+")};
  }`,ee=ne=>(k.indicesToOffset=!0,m<2?ne:`i2o_${e}(${ne})`),ce=(...ne)=>m===0?"0u":`${B.indices}(${ne.map(N).join(",")})`,le=(ne,fe)=>m<2?`${ne}`:`${Yt(ne,fe,m)}`,Qe=(ne,fe,De)=>m<2?`${ne}=${De};`:`${Yt(ne,fe,m)}=${De};`,Je={},ke=(ne,fe)=>{k.broadcastedIndicesToOffset=!0;let De=`${fe.name}broadcastedIndicesTo${e}Offset`;if(De in Je)return`${De}(${ne})`;let Le=[];for(let pe=m-1;pe>=0;pe--){let Me=fe.indicesGet("outputIndices",pe+fe.rank-m);Le.push(`${le(j,pe)} * (${Me} % ${le(X,pe)})`)}return Je[De]=`fn ${De}(outputIndices: ${fe.type.indices}) -> u32 {
             return ${Le.length>0?Le.join("+"):"0u"};
           }`,`${De}(${ne})`},at=(ne,fe)=>(()=>{if(B.storage===B.value)return`${e}[${ne}]=${fe};`;if(B.storage==="vec2<u32>"&&B.value==="i32")return`${e}[${ne}]=vec2<u32>(u32(${fe}), select(0u, 0xFFFFFFFFu, ${fe} < 0));`;if(B.storage==="vec2<u32>"&&B.value==="u32")return`${e}[${ne}]=vec2<u32>(u32(${fe}), 0u);`;if(B.storage==="u32"&&B.value==="vec4<bool>")return`${e}[${ne}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${fe}));`;throw new Error(`not supported combination of storage type ${B.storage} and value type ${B.value} yet`)})(),et=ne=>(()=>{if(B.storage===B.value)return`${e}[${ne}]`;if(B.storage==="vec2<u32>"&&B.value==="i32")return`i32(${e}[${ne}].x)`;if(B.storage==="vec2<u32>"&&B.value==="u32")return`u32(${e}[${ne}].x)`;if(B.storage==="u32"&&B.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${ne}] & 0xFFu), bool(${e}[${ne}] & 0xFF00u), bool(${e}[${ne}] & 0xFF0000u), bool(${e}[${ne}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${B.storage} and value type ${B.value} yet`)})(),ve=m<2?"":`
  fn get_${e}ByIndices(indices: ${B.indices}) -> ${S} {
    return ${et(`i2o_${e}(indices)`)};
  }`,xe=m<2?"":(()=>{let ne=x.map(De=>`d${De}: u32`).join(", "),fe=x.map(De=>`d${De}`).join(", ");return`
  fn get_${e}(${ne}) -> ${S} {
    return get_${e}ByIndices(${ce(fe)});
  }`})(),_e=(...ne)=>{if(ne.length!==m)throw new Error(`indices length must be ${m}`);let fe=ne.map(N).join(",");return m===0?et("0u"):m===1?et(fe[0]):(k.get=!0,k.getByIndices=!0,k.indicesToOffset=!0,`get_${e}(${fe})`)},Ge=ne=>m<2?et(ne):(k.getByIndices=!0,k.indicesToOffset=!0,`get_${e}ByIndices(${ne})`),qe=m<2?"":`
  fn set_${e}ByIndices(indices: ${B.indices}, value: ${S}) {
    ${at(`i2o_${e}(indices)`,"value")}
  }`,ft=m<2?"":(()=>{let ne=x.map(De=>`d${De}: u32`).join(", "),fe=x.map(De=>`d${De}`).join(", ");return`
  fn set_${e}(${ne}, value: ${S}) {
    set_${e}ByIndices(${ce(fe)}, value);
  }`})();return{impl:()=>{let ne=[],fe=!1;return k.offsetToIndices&&(ne.push(te),fe=!0),k.indicesToOffset&&(ne.push(ue),fe=!0),k.broadcastedIndicesToOffset&&(Object.values(Je).forEach(De=>ne.push(De)),fe=!0),k.set&&(ne.push(ft),fe=!0),k.setByIndices&&(ne.push(qe),fe=!0),k.get&&(ne.push(xe),fe=!0),k.getByIndices&&(ne.push(ve),fe=!0),!h&&fe&&ne.unshift(`const ${X} = ${B.indices}(${a.join(",")});`,`const ${j} = ${B.indices}(${Ve.computeStrides(a).join(",")});`),ne.join(`
`)},type:B,offsetToIndices:Q,indicesToOffset:ee,broadcastedIndicesToOffset:ke,indices:ce,indicesGet:le,indicesSet:Qe,set:(...ne)=>{if(ne.length!==m+1)throw new Error(`indices length must be ${m}`);let fe=ne[m];if(typeof fe!="string")throw new Error("value must be string");let De=ne.slice(0,m).map(N).join(",");return m===0?at("0u",fe):m===1?at(De[0],fe):(k.set=!0,k.setByIndices=!0,k.indicesToOffset=!0,`set_${e}(${De}, ${fe})`)},setByOffset:at,setByIndices:(ne,fe)=>m<2?at(ne,fe):(k.setByIndices=!0,k.indicesToOffset=!0,`set_${e}ByIndices(${ne}, ${fe});`),get:_e,getByOffset:et,getByIndices:Ge,usage:o,name:e,strides:j,shape:X,rank:m}},Ke=(e,r,a,o=1)=>au(e,r,a,"input",o),Pt=(e,r,a,o=1)=>au(e,r,a,"output",o),_3=(e,r,a)=>au(e,r,a,"atomicOutput",1),n1=(e,r,a,o=1)=>au(e,r,a,"internal",o),N2=class{constructor(e,r){this.normalizedDispatchGroup=e,this.limits=r,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=yl){let r=typeof e=="number"?e:e[0],a=typeof e=="number"?1:e[1],o=typeof e=="number"?1:e[2];if(r>this.limits.maxComputeWorkgroupSizeX||a>this.limits.maxComputeWorkgroupSizeY||o>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${r}, ${a}, ${o}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(r*a*o>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${r}, ${a}, ${o}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let c=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,h=c?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,m=c?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${r*a*o}u + local_idx;`;return`@compute @workgroup_size(${r}, ${a}, ${o})
  fn main(${h}) {
    ${m}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,r){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let a=e.usage==="input"?"read":"read_write",o=e.usage==="atomicOutput"?"atomic<i32>":e.type.storage;return`@group(0) @binding(${r}) var<storage, ${a}> ${e.name}: array<${o}>;`}declareVariables(...e){return e.map(r=>this.declareVariable(r,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(r=>this.registerInternalVariable(r)),this}registerUniform(e,r,a=1){return this.uniforms.push({name:e,type:r,length:a}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:r,type:a,length:o}of this.uniforms)if(o&&o>4)a==="f16"?e.push(`@align(16) ${r}:array<mat2x4<${a}>, ${Math.ceil(o/8)}>`):e.push(`${r}:array<vec4<${a}>, ${Math.ceil(o/4)}>`);else{let c=o==null||o===1?a:`vec${o}<${a}>`;e.push(`${r}:${c}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=r=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(r)];return this.uniforms.map(r=>[e(r.type),r.length??1])}},C3=(e,r)=>new N2(e,r)}),k2,R0,$2,L2,z2,U2,la,A3,E3,lo=gt(()=>{fn(),vn(),Ur(),An(),k2=(e,r)=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(r.length!==0&&r.length!==e[0].dims.length)throw new Error(`perm size ${r.length} does not match input rank ${e[0].dims.length}`)},R0=(e,r)=>r.length!==0?r:[...new Array(e).keys()].reverse(),$2=(e,r)=>Ve.sortBasedOnPerm(e,R0(e.length,r)),L2=(e,r,a,o)=>{let c=`fn perm(i: ${o.type.indices}) -> ${a.type.indices} {
    var a: ${a.type.indices};`;for(let h=0;h<r;++h)c+=`a[${e[h]}]=i[${h}];`;return c+="return a;}"},z2=(e,r)=>{let a=[],o=[];for(let c=0;c<e.length;++c)e[c]!==1&&a.push(e[c]),e[r[c]]!==1&&o.push(r[c]);return{newShape:a,newPerm:o}},U2=(e,r)=>{let a=0;for(let o=0;o<e.length;++o)if(r[e[o]]!==1){if(e[o]<a)return!1;a=e[o]}return!0},la=(e,r)=>{let a=e.dataType,o=e.dims.length,c=R0(o,r),h=$2(e.dims,c),m=e.dims,x=h,_=o<2||U2(c,e.dims),y;if(_)return y=k=>{let z=Ke("input",a,m,4),X=Pt("output",a,x,4);return`
  ${k.registerUniform("output_size","u32").declareVariables(z,X)}
  ${k.mainStart()}
    ${k.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let k=Ve.size(h);return{outputs:[{dims:h,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(k/64/4)},programUniforms:[{type:12,data:Math.ceil(k/4)}]}},getShaderSource:y};let{newShape:S,newPerm:R}=z2(e.dims,c),B=Ve.areEqual(R,[2,3,1]),N=Ve.areEqual(R,[3,1,2]);if(S.length===2||B||N){m=B?[S[0],S[1]*S[2]]:N?[S[0]*S[1],S[2]]:S,x=[m[1],m[0]];let k=16;return y=z=>{let X=Ke("a",a,m.length),j=Pt("output",a,x.length);return`
  ${z.registerUniform("output_size","u32").declareVariables(X,j)}
  var<workgroup> tile : array<array<${j.type.value}, ${k+1}>, ${k}>;
  ${z.mainStart([k,k,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${k} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${k}u + local_id.x;
    let input_row = workgroup_id_x * ${k}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${X.getByIndices(`${X.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${k}u + local_id.x;
    let output_row = workgroup_id_y * ${k}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${j.setByIndices(`${j.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let z=Ve.size(h);return{outputs:[{dims:h,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(x[1]/k),y:Math.ceil(x[0]/k)},programUniforms:[{type:12,data:z},...Kt(m,x)]}},getShaderSource:y}}return y=k=>{let z=Ke("a",a,m.length),X=Pt("output",a,x.length);return`
  ${k.registerUniform("output_size","u32").declareVariables(z,X)}

  ${L2(c,o,z,X)}

  ${k.mainStart()}
    ${k.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${X.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${X.setByOffset("global_idx",z.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>{let k=Ve.size(h);return{outputs:[{dims:h,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(k/64)},programUniforms:[{type:12,data:k},...Kt(m,x)]}},getShaderSource:y}},A3=(e,r)=>{k2(e.inputs,r.perm),e.compute(la(e.inputs[0],r.perm))},E3=e=>tr({perm:e.perm})}),P2,F2,G2,V2,q2,j2,H2,Y2,W2,K2,ka,T3,S3,I3,R3,O3,D3,M3,B3,N3,k3,Y8=gt(()=>{fn(),vn(),An(),r1(),lo(),P2={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},F2={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},G2={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},V2={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},q2=(e,r)=>{let a=[];for(let o=r-e;o<r;++o)a.push(o);return a},j2=(e,r)=>{let a=[],o=e.length;for(let h=0;h<o;h++)r.indexOf(h)===-1&&a.push(e[h]);let c=r.map(h=>e[h]);return[a,c]},H2=(e,r)=>{let a=e.length+r.length,o=[],c=0;for(let h=0;h<a;h++)r.indexOf(h)===-1?o.push(e[c++]):o.push(1);return o},Y2=(e,r)=>{for(let a=0;a<e.length;++a)if(e[e.length-a-1]!==r-1-a)return!1;return!0},W2=(e,r)=>{let a=[];if(!Y2(e,r)){for(let o=0;o<r;++o)e.indexOf(o)===-1&&a.push(o);e.forEach(o=>a.push(o))}return a},K2=(e,r,a,o,c,h,m)=>{let x=a[0].dims,_=Ve.size(h),y=Ve.size(m),S=Ke("_A",a[0].dataType,x),R=Pt("output",c,h),B=64;_===1&&(B=256);let N=`
          var<workgroup> aBestValues : array<f32, ${B}>;
       `,k=z=>`
        ${z.registerUniform("reduceSize","u32").declareVariables(S,R)}
        ${N}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${z.mainStart(B)}

          let outputIndex = global_idx / ${B};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${G2[o]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${B}) {
           let candidate = f32(${S.getByOffset("offset + k")});
           bestValue = ${P2[o]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${B}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${F2[o]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${R.setByOffset("outputIndex",`${o==="mean"?`${R.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${R.type.storage}(${V2[o]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${r};${B}`,inputDependencies:["type"]},getShaderSource:k,getRunData:()=>({outputs:[{dims:h,dataType:c}],dispatchGroup:{x:_},programUniforms:[{type:12,data:y}]})}},ka=(e,r,a,o)=>{let c=e.inputs.length===1?a:Eh(e.inputs,a),h=c.axes;h.length===0&&!c.noopWithEmptyAxes&&(h=e.inputs[0].dims.map((N,k)=>k));let m=Ve.normalizeAxes(h,e.inputs[0].dims.length),x=m,_=e.inputs[0],y=W2(x,e.inputs[0].dims.length);y.length>0&&(_=e.compute(la(e.inputs[0],y),{inputs:[0],outputs:[-1]})[0],x=q2(x.length,_.dims.length));let[S,R]=j2(_.dims,x),B=S;c.keepDims&&(B=H2(S,m)),e.compute(K2(r,c.cacheKey,[_],o,e.inputs[0].dataType,B,R),{inputs:[_]})},T3=(e,r)=>{ka(e,"ReduceMeanShared",r,"mean")},S3=(e,r)=>{ka(e,"ReduceL1Shared",r,"l1")},I3=(e,r)=>{ka(e,"ReduceL2Shared",r,"l2")},R3=(e,r)=>{ka(e,"ReduceLogSumExpShared",r,"logSumExp")},O3=(e,r)=>{ka(e,"ReduceMaxShared",r,"max")},D3=(e,r)=>{ka(e,"ReduceMinShared",r,"min")},M3=(e,r)=>{ka(e,"ReduceProdShared",r,"prod")},B3=(e,r)=>{ka(e,"ReduceSumShared",r,"sum")},N3=(e,r)=>{ka(e,"ReduceSumSquareShared",r,"sumSquare")},k3=(e,r)=>{ka(e,"ReduceLogSumShared",r,"logSum")}}),$a,Q2,af,Eh,La,X2,Z2,J2,ex,tx,nx,rx,ix,ax,sx,za,$3,L3,z3,U3,P3,F3,G3,V3,q3,j3,r1=gt(()=>{fn(),vn(),Ur(),An(),Y8(),$a=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Q2=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],af=(e,r,a,o,c,h,m=!1,x=!1)=>{let _=[],y=a[0].dims,S=y.length,R=Ve.normalizeAxes(c,S),B=!x&&R.length===0;y.forEach((z,X)=>{B||R.indexOf(X)>=0?m&&_.push(1):_.push(z)});let N=_.length,k=Ve.size(_);return{name:e,shaderCache:r,getShaderSource:z=>{let X=[],j=Ke("_A",a[0].dataType,S),F=Pt("output",h,N),te=o(j,F,R),Q=te[2];for(let oe=0,ue=0;oe<S;oe++)B||R.indexOf(oe)>=0?(m&&ue++,Q=`for(var j${oe}: u32 = 0; j${oe} < ${y[oe]}; j${oe}++) {
                  ${te[2].includes("last_index")?`let last_index = j${oe};`:""}
                  ${j.indicesSet("input_indices",oe,`j${oe}`)}
                  ${Q}
                }`):(X.push(`${j.indicesSet("input_indices",oe,F.indicesGet("output_indices",ue))};`),ue++);return`

        ${z.registerUniform("output_size","u32").declareVariables(j,F)}

        ${z.mainStart()}
          ${z.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${j.type.indices};
          let output_indices = ${F.offsetToIndices("global_idx")};

          ${X.join(`
`)}
          ${te[0]}       // init ops for reduce max/min
          ${te[1]}
          ${Q}
          ${te[3]}
          ${te.length===4?F.setByOffset("global_idx","value"):te.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:_,dataType:h}],dispatchGroup:{x:Math.ceil(k/64)},programUniforms:[{type:12,data:k},...Kt(y,_)]})}},Eh=(e,r)=>{let a=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>a.push(Number(o))),tr({axes:a,keepDims:r.keepDims,noopWithEmptyAxes:r.noopWithEmptyAxes})},La=(e,r,a,o)=>{let c=e.inputs,h=c.length===1?a:Eh(c,a);e.compute(af(r,{hint:h.cacheKey,inputDependencies:["rank"]},[c[0]],h.noopWithEmptyAxes&&h.axes.length===0?Q2:o,h.axes,c[0].dataType,h.keepDims,h.noopWithEmptyAxes),{inputs:[0]})},X2=(e,r)=>{$a(e.inputs),La(e,"ReduceLogSum",r,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += ${a.getByIndices("input_indices")};`,"value = log(value);"])},Z2=(e,r)=>{$a(e.inputs),La(e,"ReduceL1",r,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += abs(${a.getByIndices("input_indices")});`,""])},J2=(e,r)=>{$a(e.inputs),La(e,"ReduceL2",r,(a,o)=>[`var t = ${o.type.value}(0); var value = ${o.type.value}(0);`,"",`t = ${a.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},ex=(e,r)=>{$a(e.inputs),La(e,"ReduceLogSumExp",r,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += exp(${a.getByIndices("input_indices")});`,"value = log(value);"])},tx=(e,r)=>{$a(e.inputs),La(e,"ReduceMax",r,(a,o,c)=>{let h=[];for(let m=0;m<a.rank;m++)(c.indexOf(m)>=0||c.length===0)&&h.push(a.indicesSet("input_indices",m,0));return[`${h.join(`
`)}`,`var value = ${a.getByIndices("input_indices")};`,`value = max(value, ${a.getByIndices("input_indices")});`,""]})},nx=(e,r)=>{$a(e.inputs),La(e,"ReduceMean",r,(a,o,c)=>{let h=1;for(let m=0;m<a.rank;m++)(c.indexOf(m)>=0||c.length===0)&&(h*=e.inputs[0].dims[m]);return["var sum = f32(0);","",`sum += f32(${a.getByIndices("input_indices")});`,`let value = ${o.type.value}(sum / ${h});`]})},rx=(e,r)=>{$a(e.inputs),La(e,"ReduceMin",r,(a,o,c)=>{let h=[];for(let m=0;m<a.rank;m++)(c.indexOf(m)>=0||c.length===0)&&h.push(`input_indices[${m}] = 0;`);return[`${h.join(`
`)}`,`var value = ${a.getByIndices("input_indices")};`,`value = min(value, ${a.getByIndices("input_indices")});`,""]})},ix=(e,r)=>{$a(e.inputs),La(e,"ReduceProd",r,(a,o)=>[`var value = ${o.type.storage}(1);`,"",`value *= ${a.getByIndices("input_indices")};`,""])},ax=(e,r)=>{$a(e.inputs),La(e,"ReduceSum",r,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += ${a.getByIndices("input_indices")};`,""])},sx=(e,r)=>{$a(e.inputs),La(e,"ReduceSumSquare",r,(a,o)=>[`var t = ${o.type.value}(0); var value = ${o.type.value}(0);`,"",`t = ${a.getByIndices("input_indices")}; value += t * t;`,""])},za=(e,r,a)=>{if(r.length===0)return a;let o=1,c=1;for(let h=0;h<r.length;h++)r.indexOf(h)===-1?o*=e[h]:c*=e[h];return c<32&&o>1024},$3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?nx(e,r):T3(e,r)},L3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?Z2(e,r):S3(e,r)},z3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?J2(e,r):I3(e,r)},U3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?ex(e,r):R3(e,r)},P3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?tx(e,r):O3(e,r)},F3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?rx(e,r):D3(e,r)},G3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?ix(e,r):M3(e,r)},V3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?ax(e,r):B3(e,r)},q3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?sx(e,r):N3(e,r)},j3=(e,r)=>{za(e.inputs[0].dims,r.axes,r.noopWithEmptyAxes)?X2(e,r):k3(e,r)}}),O0,H3,Y3,Th,W8=gt(()=>{fn(),Ur(),r1(),O0=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},H3=(e,r)=>{O0(e.inputs);let a=(o,c,h)=>{let m=[];for(let x=0;x<o.rank;x++)(h.indexOf(x)>=0||h.length===0)&&m.push(`input_indices[${x}] = 0;`);return[`${m.join(`
`)}`,`var value = ${o.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${r.selectLastIndex>0?"<=":"<"} value) {
         value = ${o.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",c.setByOffset("global_idx","best_index")]};e.compute(af("ArgMin",{hint:r.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],a,[r.axis],7,r.keepDims),{inputs:[0]})},Y3=(e,r)=>{O0(e.inputs);let a=(o,c,h)=>{let m=[];for(let x=0;x<o.rank;x++)(h.indexOf(x)>=0||h.length===0)&&m.push(`input_indices[${x}] = 0;`);return[`${m.join(`
`)}`,`var value = ${o.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${r.selectLastIndex>0?">=":">"} value) {
         value = ${o.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",c.setByOffset("global_idx","best_index")]};e.compute(af("argMax",{hint:r.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],a,[r.axis],7,r.keepDims),{inputs:[0]})},Th=e=>tr(e)}),ox,Dc,lx,ux,cx,Cu,fx,W3,i1=gt(()=>{fn(),vn(),t1(),An(),ox=(e,r)=>{let a=e[0],o=e[1],c=e[2],h=e[3],m=e[4],x=e[5];if(m&&x)throw new Error("Attention cannot have both past and attention_bias");if(a.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let _=a.dims[0],y=a.dims[1],S=a.dims[2];if(c.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(o.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(o.dims[0]!==S)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(c.dims[0]!==o.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let R=c.dims[0]/3,B=R,N=B;if(r.qkvHiddenSizes.length>0){if(r.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let te of r.qkvHiddenSizes)if(te%r.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");R=r.qkvHiddenSizes[0],B=r.qkvHiddenSizes[1],N=r.qkvHiddenSizes[2]}let k=y;if(R!==B)throw new Error("qkv_hidden_sizes first element should be same as the second");if(c.dims[0]!==R+B+N)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let z=0;if(m){if(B!==N)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(m.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(m.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(m.dims[1]!==_)throw new Error('Input "past" second dimension must be batch_size');if(m.dims[2]!==r.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(m.dims[4]!==B/r.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');r.pastPresentShareBuffer||(z=m.dims[3])}let X=k+z,j=-1,F=0;if(h)throw new Error("Mask not supported");if(m)throw new Error("past is not supported");if(x){if(x.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(x.dims[0]!==_||x.dims[1]!==r.numHeads||x.dims[2]!==y||x.dims[3]!==X)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:_,sequenceLength:y,pastSequenceLength:z,kvSequenceLength:k,totalSequenceLength:X,maxSequenceLength:j,inputHiddenSize:S,hiddenSize:R,vHiddenSize:N,headSize:Math.floor(R/r.numHeads),vHeadSize:Math.floor(N/r.numHeads),numHeads:r.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:r.maskFilterValue,maskType:F,scale:r.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Dc=(e,r,a)=>r&&e?`
      let total_sequence_length_input = u32(${r.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e?.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${a?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,lx=(e,r,a,o,c,h,m,x)=>{let _=$r(m?1:h),y=64,S=h/_;S<y&&(y=32);let R=Math.ceil(h/_/y),B=[{type:12,data:r},{type:12,data:a},{type:12,data:o},{type:12,data:c},{type:12,data:S},{type:12,data:R}],N=ii(e.dataType,_),k=Ei(1,_),z=["type"];m&&z.push("type"),x&&z.push("type");let X=j=>{let F=Pt("x",e.dataType,e.dims,_),te=[F],Q=m?Ke("seq_lens",m.dataType,m.dims):void 0;Q&&te.push(Q);let oe=x?Ke("total_sequence_length_input",x.dataType,x.dims):void 0;oe&&te.push(oe);let ue=Ei(e.dataType),ee=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${y}>;
  var<workgroup> thread_sum: array<f32, ${y}>;
  ${j.registerUniforms(ee).declareVariables(...te)}
  ${j.mainStart([y,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${Dc(Q,oe,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${y}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${m?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${k}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${k}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(_){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${_}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${y}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${k}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${k}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(_){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${_}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${y}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${F.type.value}(${ue}(1.0) / ${ue}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${k}(x[offset + i]);
        x[offset + i] = ${F.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${m?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${F.type.value}(${ue}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${y};${N};${_}`,inputDependencies:z},getShaderSource:X,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:c,z:r*a},programUniforms:B})}},ux=(e,r,a,o,c,h,m,x,_)=>{let y=m+h.kvSequenceLength,S=[h.batchSize,h.numHeads,h.sequenceLength,y],R=e>1&&o,B=h.kvNumHeads?h.kvNumHeads:h.numHeads,N=R?[h.batchSize,B,y,h.headSize]:void 0,k=h.nReps?h.nReps:1,z=h.scale===0?1/Math.sqrt(h.headSize):h.scale,X=$r(h.headSize),j=h.headSize/X,F=12,te={x:Math.ceil(y/F),y:Math.ceil(h.sequenceLength/F),z:h.batchSize*h.numHeads},Q=[{type:12,data:h.sequenceLength},{type:12,data:j},{type:12,data:y},{type:12,data:h.numHeads},{type:12,data:h.headSize},{type:1,data:z},{type:12,data:m},{type:12,data:h.kvSequenceLength},{type:12,data:k}],oe=R&&o&&Ve.size(o.dims)>0,ue=["type","type"];oe&&ue.push("type"),c&&ue.push("type"),x&&ue.push("type"),_&&ue.push("type");let ee=[{dims:S,dataType:r.dataType,gpuDataType:0}];R&&ee.push({dims:N,dataType:r.dataType,gpuDataType:0});let ce=le=>{let Qe=Ke("q",r.dataType,r.dims,X),Je=Ke("key",a.dataType,a.dims,X),ke=[Qe,Je];if(oe){let qe=Ke("past_key",o.dataType,o.dims,X);ke.push(qe)}c&&ke.push(Ke("attention_bias",c.dataType,c.dims));let at=x?Ke("seq_lens",x.dataType,x.dims):void 0;at&&ke.push(at);let et=_?Ke("total_sequence_length_input",_.dataType,_.dims):void 0;et&&ke.push(et);let ve=Pt("output",r.dataType,S),xe=[ve];R&&xe.push(Pt("present_key",r.dataType,N,X));let _e=Ei(1,X),Ge=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${F}u;

  var<workgroup> tileQ: array<${Qe.type.storage}, ${F*F}>;
  var<workgroup> tileK: array<${Qe.type.storage}, ${F*F}>;
  ${le.registerUniforms(Ge).declareVariables(...ke,...xe)}
  ${le.mainStart([F,F,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${k===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${k===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${Dc(at,et,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${oe&&R?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${R?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${_e}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${oe&&R?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${R?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${_e}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(X){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${X}`)}})()};
        output[outputIdx] = ${ve.type.value} (sum * uniforms.alpha) + ${c?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${X};${c!==void 0};${o!==void 0};${e}`,inputDependencies:ue},getRunData:()=>({outputs:ee,dispatchGroup:te,programUniforms:Q}),getShaderSource:ce}},cx=(e,r,a,o,c,h,m=void 0,x=void 0)=>{let _=h+c.kvSequenceLength,y=c.nReps?c.nReps:1,S=c.vHiddenSize*y,R=e>1&&o,B=c.kvNumHeads?c.kvNumHeads:c.numHeads,N=R?[c.batchSize,B,_,c.headSize]:void 0,k=[c.batchSize,c.sequenceLength,S],z=12,X={x:Math.ceil(c.vHeadSize/z),y:Math.ceil(c.sequenceLength/z),z:c.batchSize*c.numHeads},j=[{type:12,data:c.sequenceLength},{type:12,data:_},{type:12,data:c.vHeadSize},{type:12,data:c.numHeads},{type:12,data:c.headSize},{type:12,data:S},{type:12,data:h},{type:12,data:c.kvSequenceLength},{type:12,data:y}],F=R&&o&&Ve.size(o.dims)>0,te=["type","type"];F&&te.push("type"),m&&te.push("type"),x&&te.push("type");let Q=[{dims:k,dataType:r.dataType,gpuDataType:0}];R&&Q.push({dims:N,dataType:r.dataType,gpuDataType:0});let oe=ue=>{let ee=Ke("probs",r.dataType,r.dims),ce=Ke("v",a.dataType,a.dims),le=[ee,ce];F&&le.push(Ke("past_value",o.dataType,o.dims));let Qe=m?Ke("seq_lens",m.dataType,m.dims):void 0;m&&le.push(Qe);let Je=x?Ke("total_sequence_length_input",x.dataType,x.dims):void 0;x&&le.push(Je);let ke=[Pt("output",r.dataType,k)];R&&ke.push(Pt("present_value",r.dataType,N));let at=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${z}u;
  var<workgroup> tileQ: array<${ee.type.value}, ${z*z}>;
  var<workgroup> tileV: array<${ee.type.value}, ${z*z}>;
  ${ue.registerUniforms(at).declareVariables(...le,...ke)}
  ${ue.mainStart([z,z,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${y===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${y===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${Dc(Qe,Je,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${F&&R?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${R?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${ee.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${F&&R?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${R?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${o!==void 0};${e}`,inputDependencies:te},getRunData:()=>({outputs:Q,dispatchGroup:X,programUniforms:j}),getShaderSource:oe}},Cu=(e,r,a,o,c,h,m,x,_,y,S=void 0,R=void 0)=>{let B=Math.min(e.outputCount,1+(m?1:0)+(x?1:0)),N=B>1?y.pastSequenceLength:0,k=N+y.kvSequenceLength,z=_&&Ve.size(_.dims)>0?_:void 0,X=[r,a];B>1&&m&&Ve.size(m.dims)>0&&X.push(m),z&&X.push(z),S&&X.push(S),R&&X.push(R);let j=e.compute(ux(B,r,a,m,z,y,N,S,R),{inputs:X,outputs:B>1?[-1,1]:[-1]})[0];e.compute(lx(j,y.batchSize,y.numHeads,N,y.sequenceLength,k,S,R),{inputs:S&&R?[j,S,R]:[j],outputs:[]});let F=[j,o];B>1&&x&&Ve.size(x.dims)>0&&F.push(x),S&&F.push(S),R&&F.push(R),e.compute(cx(B,j,o,x,y,N,S,R),{inputs:F,outputs:B>1?[0,2]:[0]})},fx=(e,r)=>{let a=[r.batchSize,r.numHeads,r.sequenceLength,r.headSize],o=r.sequenceLength,c=r.inputHiddenSize,h=r.headSize,m=12,x={x:Math.ceil(r.headSize/m),y:Math.ceil(r.sequenceLength/m),z:r.batchSize*r.numHeads},_=[e.inputs[0],e.inputs[1],e.inputs[2]],y=[{type:12,data:o},{type:12,data:c},{type:12,data:h},{type:12,data:r.numHeads},{type:12,data:r.headSize},{type:12,data:r.hiddenSize},{type:12,data:r.hiddenSize+r.hiddenSize+r.vHiddenSize}],S=R=>{let B=Pt("output_q",_[0].dataType,a),N=Pt("output_k",_[0].dataType,a),k=Pt("output_v",_[0].dataType,a),z=Ke("input",_[0].dataType,_[0].dims),X=Ke("weight",_[1].dataType,_[1].dims),j=Ke("bias",_[2].dataType,_[2].dims),F=z.type.storage,te=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${m}u;
  var<workgroup> tileInput: array<${F}, ${m*m}>;
  var<workgroup> tileWeightQ: array<${F}, ${m*m}>;
  var<workgroup> tileWeightK: array<${F}, ${m*m}>;
  var<workgroup> tileWeightV: array<${F}, ${m*m}>;
  ${R.registerUniforms(te).declareVariables(z,X,j,B,N,k)}
  ${R.mainStart([m,m,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${F}(0);
    var valueK = ${F}(0);
    var valueV = ${F}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:a,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:a,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:x,programUniforms:y}),getShaderSource:S},{inputs:_,outputs:[-1,-1,-1]})},W3=(e,r)=>{let a=ox(e.inputs,r),[o,c,h]=fx(e,a);return Cu(e,o,c,h,e.inputs[4],void 0,void 0,void 0,e.inputs[5],a)}}),dx,hx,px,K3,K8=gt(()=>{Aa(),fn(),vn(),Ur(),An(),dx=(e,r)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let a=(o,c,h)=>{let m=c.length;if(m!==o.length)throw new Error(`${h}: num dimensions != ${m}`);c.forEach((x,_)=>{if(x!==o[_])throw new Error(`${h}: dim[${_}] do not match`)})};if(e[0].dims.length>1){let o=r.format==="NHWC"?r.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,r.spatial?2:void 0);a(e[1].dims,o,"Invalid input scale"),a(e[2].dims,o,"Invalid input B"),a(e[3].dims,o,"Invalid input mean"),a(e[4].dims,o,"Invalid input var")}else a(e[1].dims,[1],"Invalid input scale"),a(e[2].dims,[1],"Invalid input B"),a(e[3].dims,[1],"Invalid input mean"),a(e[4].dims,[1],"Invalid input var")},hx=(e,r)=>{let{epsilon:a,spatial:o,format:c}=r,h=e[0].dims,m=o?$r(h[h.length-1]):1,x=c==="NHWC"&&h.length>1?m:1,_=Ve.size(h)/m,y=o,S=y?h.length:h,R=Ke("x",e[0].dataType,e[0].dims,m),B=Ke("scale",e[1].dataType,e[1].dims,x),N=Ke("bias",e[2].dataType,e[2].dims,x),k=Ke("inputMean",e[3].dataType,e[3].dims,x),z=Ke("inputVar",e[4].dataType,e[4].dims,x),X=Pt("y",e[0].dataType,S,m),j=()=>{let te="";if(o)te=`let cOffset = ${h.length===1?"0u":c==="NHWC"?`outputIndices[${h.length-1}] / ${m}`:"outputIndices[1]"};`;else if(c==="NCHW")te=`
            ${X.indicesSet("outputIndices","0","0")}
            let cOffset = ${X.indicesToOffset("outputIndices")};`;else{te=`var cIndices = ${B.type.indices}(0);
                       cIndices[0] = outputIndices[${h.length-1}];`;for(let Q=1;Q<B.rank;Q++)te+=`cIndices[${Q}] = outputIndices[${Q}];`;te+=`let cOffset = ${B.indicesToOffset("cIndices")};`}return te},F=te=>`
  const epsilon = ${a};
  ${te.registerUniform("outputSize","u32").declareVariables(R,B,N,k,z,X)}
  ${te.mainStart()}
  ${te.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${X.offsetToIndices(`global_idx * ${m}`)};
    ${j()}
    let scale = ${B.getByOffset("cOffset")};
    let bias = ${N.getByOffset("cOffset")};
    let inputMean = ${k.getByOffset("cOffset")};
    let inputVar = ${z.getByOffset("cOffset")};
    let x = ${R.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${X.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${r.epsilon}_${r.format}_${o}_${m}`,inputDependencies:y?["rank","type","type","type","type"]:void 0},getShaderSource:F,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:y?[{type:12,data:_},...Kt(h)]:[{type:12,data:_}]})}},px=e=>tr(e),K3=(e,r)=>{let{inputs:a,outputCount:o}=e,c=px({...r,outputCount:o});if(Ar.webgpu.validateInputContent&&dx(a,c),r.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(hx(a,c))}}),gx,mx,Q3,Q8=gt(()=>{vn(),An(),gx=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},mx=e=>{let r=e[0].dims,a=e[0].dims[2],o=Ve.size(r)/4,c=e[0].dataType,h=Ke("input",c,r,4),m=Ke("bias",c,[a],4),x=Ke("residual",c,r,4),_=Pt("output",c,r,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:y=>`
  const channels = ${a}u / 4;
  ${y.declareVariables(h,m,x,_)}

  ${y.mainStart()}
    ${y.guardAgainstOutOfBoundsWorkgroupSizes(o)}
    let value = ${h.getByOffset("global_idx")}
      + ${m.getByOffset("global_idx % channels")} + ${x.getByOffset("global_idx")};
    ${_.setByOffset("global_idx","value")}
  }`}},Q3=e=>{gx(e.inputs),e.compute(mx(e.inputs))}}),xx,er,X3,Z3,J3,ev,tv,nv,rv,iv,av,yx,sv,ov,lv,uv,wu,cv,Hc,fv,dv,hv,pv,gv,mv,xv,yv,wv,bv,vv,_v,Cv,Av,Ev,Tv,D0,Sv,Sh,Ih,Iv,Rv,Ov,wx,bx,Dv,a1=gt(()=>{fn(),vn(),Ur(),An(),xx=(e,r,a,o,c,h,m)=>{let x=Math.ceil(r/4),_="";typeof c=="string"?_=`${c}(a)`:_=c("a");let y=Ke("inputData",a,[x],4),S=Pt("outputData",o,[x],4),R=[{name:"vec_size",type:"u32"}];return m&&R.push(...m),`
      ${e.registerUniforms(R).declareVariables(y,S)}

  ${h??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${y.getByOffset("global_idx")};
    ${S.setByOffset("global_idx",_)}
  }`},er=(e,r,a,o,c,h=e.dataType,m,x)=>{let _=[{type:12,data:Math.ceil(Ve.size(e.dims)/4)}];return m&&_.push(...m),{name:r,shaderCache:{hint:c,inputDependencies:["type"]},getShaderSource:y=>xx(y,Ve.size(e.dims),e.dataType,h,a,o,x),getRunData:y=>({outputs:[{dims:e.dims,dataType:h}],dispatchGroup:{x:Math.ceil(Ve.size(y[0].dims)/64/4)},programUniforms:_})}},X3=e=>{e.compute(er(e.inputs[0],"Abs","abs"))},Z3=e=>{e.compute(er(e.inputs[0],"Acos","acos"))},J3=e=>{e.compute(er(e.inputs[0],"Acosh","acosh"))},ev=e=>{e.compute(er(e.inputs[0],"Asin","asin"))},tv=e=>{e.compute(er(e.inputs[0],"Asinh","asinh"))},nv=e=>{e.compute(er(e.inputs[0],"Atan","atan"))},rv=e=>{e.compute(er(e.inputs[0],"Atanh","atanh"))},iv=e=>tr(e),av=(e,r)=>{let a;switch(r.to){case 10:a="vec4<f16>";break;case 1:a="vec4<f32>";break;case 12:a="vec4<u32>";break;case 6:a="vec4<i32>";break;case 9:a="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${r.to}`)}e.compute(er(e.inputs[0],"Cast",a,void 0,r.cacheKey,r.to))},yx=e=>{let r,a,o=e.length>=2&&e[1].data!==0,c=e.length>=3&&e[2].data!==0;switch(e[0].dataType){case 1:r=o?e[1].getFloat32Array()[0]:-34028234663852886e22,a=c?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:r=o?e[1].getUint16Array()[0]:64511,a=c?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return tr({min:r,max:a})},sv=(e,r)=>{let a=r||yx(e.inputs),o=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"Clip",c=>`clamp(${c}, vec4<${o}>(uniforms.min), vec4<${o}>(uniforms.max))`,void 0,a.cacheKey,void 0,[{type:e.inputs[0].dataType,data:a.min},{type:e.inputs[0].dataType,data:a.max}],[{name:"min",type:o},{name:"max",type:o}]),{inputs:[0]})},ov=e=>{e.compute(er(e.inputs[0],"Ceil","ceil"))},lv=e=>{e.compute(er(e.inputs[0],"Cos","cos"))},uv=e=>{e.compute(er(e.inputs[0],"Cosh","cosh"))},wu=e=>tr(e),cv=(e,r)=>{let a=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`
  const elu_alpha_ = ${a}(${r.alpha});

  fn elu_f32(a: ${a}) -> ${a} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${a}>) -> vec4<${a}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,r.cacheKey))},Hc=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,fv=e=>{let r=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"Erf",a=>`erf_vf32(${a})`,Hc(r)))},dv=e=>{e.compute(er(e.inputs[0],"Exp","exp"))},hv=e=>{e.compute(er(e.inputs[0],"Floor","floor"))},pv=e=>{let r=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"Gelu",a=>`0.5 * ${a} * (1.0 + erf_vf32(${a} * 0.7071067811865475))`,Hc(r)))},gv=(e,r)=>{let a=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${a}>(0.0))`,`const leaky_relu_alpha_ = ${a}(${r.alpha});`,r.cacheKey))},mv=e=>{e.compute(er(e.inputs[0],"Not",r=>`!${r}`))},xv=e=>{e.compute(er(e.inputs[0],"Neg",r=>`-${r}`))},yv=e=>{e.compute(er(e.inputs[0],"Reciprocal",r=>`1.0/${r}`))},wv=e=>{let r=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"Relu",a=>`select(vec4<${r}>(0.0), ${a}, ${a} > vec4<${r}>(0.0))`))},bv=e=>{e.compute(er(e.inputs[0],"Sigmoid",r=>`(1.0 / (1.0 + exp(-${r})))`))},vv=e=>tr(e),_v=(e,r)=>{let a=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"HardSigmoid",o=>`max(vec4<${a}>(0.0), min(vec4<${a}>(1.0), ${r.alpha} * ${o} + vec4<${a}>(${r.beta})))`,void 0,r.cacheKey))},Cv=e=>{e.compute(er(e.inputs[0],"Sin","sin"))},Av=e=>{e.compute(er(e.inputs[0],"Sinh","sinh"))},Ev=e=>{e.compute(er(e.inputs[0],"Sqrt","sqrt"))},Tv=e=>{e.compute(er(e.inputs[0],"Tan","tan"))},D0=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,Sv=e=>{e.compute(er(e.inputs[0],"Tanh",D0))},Sh=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${D0("v")};
}
`,Ih=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,Iv=e=>{let r=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"FastGelu",Ih,Sh(r),void 0,e.inputs[0].dataType))},Rv=(e,r)=>{let a=Ei(e.inputs[0].dataType);return e.compute(er(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${a}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${a}>(${r.alpha});`,r.cacheKey)),0},Ov=e=>{e.compute(er(e.inputs[0],"Log","log"))},wx=(e,r)=>`
const alpha = vec4<${e}>(${r});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,bx=e=>`quick_gelu_impl(${e})`,Dv=(e,r)=>{let a=Ei(e.inputs[0].dataType);e.compute(er(e.inputs[0],"QuickGelu",bx,wx(a,r.alpha),r.cacheKey,e.inputs[0].dataType))}}),vx,_x,Mv,X8=gt(()=>{vn(),An(),a1(),vx=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},_x=e=>{let r=e[0].dims.slice();r[2]=r[2]/2;let a=Ke("input",e[0].dataType,e[0].dims,4),o=Ke("bias",e[0].dataType,[e[0].dims[2]],4),c=Pt("output",e[0].dataType,r,4),h=Ve.size(r)/4,m=ii(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:x=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${x.declareVariables(a,o,c)}

  ${Hc(m)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes(h)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${c.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},Mv=e=>{vx(e.inputs),e.compute(_x(e.inputs))}}),Cx,Ax,Ua,Bv,Nv,kv,$v,Lv,zv,Uv,Pv,Fv,Gv,Z8=gt(()=>{fn(),vn(),An(),Cx=(e,r,a,o,c,h,m,x,_,y,S,R)=>{let B,N;typeof x=="string"?B=N=(F,te)=>`${x}((${F}),(${te}))`:typeof x=="function"?B=N=x:(B=x.scalar,N=x.vector);let k=Pt("outputData",S,o.length,4),z=Ke("aData",_,r.length,4),X=Ke("bData",y,a.length,4),j;if(c)if(h){let F=Ve.size(r)===1,te=Ve.size(a)===1,Q=r.length>0&&r[r.length-1]%4===0,oe=a.length>0&&a[a.length-1]%4===0;F||te?j=k.setByOffset("global_idx",N(F?`${z.type.value}(${z.getByOffset("0")}.x)`:z.getByOffset("global_idx"),te?`${X.type.value}(${X.getByOffset("0")}.x)`:X.getByOffset("global_idx"))):j=`
            let outputIndices = ${k.offsetToIndices("global_idx * 4u")};
            let offsetA = ${z.broadcastedIndicesToOffset("outputIndices",k)};
            let offsetB = ${X.broadcastedIndicesToOffset("outputIndices",k)};
            ${k.setByOffset("global_idx",N(m||Q?z.getByOffset("offsetA / 4u"):`${z.type.value}(${z.getByOffset("offsetA / 4u")}[offsetA % 4u])`,m||oe?X.getByOffset("offsetB / 4u"):`${X.type.value}(${X.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else j=k.setByOffset("global_idx",N(z.getByOffset("global_idx"),X.getByOffset("global_idx")));else{if(!h)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let F=(te,Q,oe="")=>{let ue=`aData[indexA${Q}][componentA${Q}]`,ee=`bData[indexB${Q}][componentB${Q}]`;return`
            let outputIndices${Q} = ${k.offsetToIndices(`global_idx * 4u + ${Q}u`)};
            let offsetA${Q} = ${z.broadcastedIndicesToOffset(`outputIndices${Q}`,k)};
            let offsetB${Q} = ${X.broadcastedIndicesToOffset(`outputIndices${Q}`,k)};
            let indexA${Q} = offsetA${Q} / 4u;
            let indexB${Q} = offsetB${Q} / 4u;
            let componentA${Q} = offsetA${Q} % 4u;
            let componentB${Q} = offsetB${Q} % 4u;
            ${te}[${Q}] = ${oe}(${B(ue,ee)});
          `};S===9?j=`
            var data = vec4<u32>(0);
            ${F("data",0,"u32")}
            ${F("data",1,"u32")}
            ${F("data",2,"u32")}
            ${F("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:j=`
            ${F("outputData[global_idx]",0)}
            ${F("outputData[global_idx]",1)}
            ${F("outputData[global_idx]",2)}
            ${F("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(z,X,k)}

        ${R??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${j}
      }`},Ax=(e,r,a,o,c,h,m=a.dataType)=>{let x=a.dims.map(z=>Number(z)??1),_=o.dims.map(z=>Number(z)??1),y=!Ve.areEqual(x,_),S=x,R=Ve.size(x),B=!1,N=!1,k=[y];if(y){let z=xl.calcShape(x,_,!1);if(!z)throw new Error("Can't perform binary op on the given tensors");S=z.slice(),R=Ve.size(S);let X=Ve.size(x)===1,j=Ve.size(_)===1,F=x.length>0&&x[x.length-1]%4===0,te=_.length>0&&_[_.length-1]%4===0;k.push(X),k.push(j),k.push(F),k.push(te);let Q=1;for(let oe=1;oe<S.length;oe++){let ue=x[x.length-oe],ee=_[_.length-oe];if(ue===ee)Q*=ue;else break}Q%4===0?(N=!0,B=!0):(X||j||F||te)&&(B=!0)}else B=!0;return k.push(B),{name:e,shaderCache:{hint:r+k.map(z=>z.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:z=>Cx(z,x,_,S,B,y,N,c,a.dataType,o.dataType,m,h),getRunData:()=>({outputs:[{dims:S,dataType:m}],dispatchGroup:{x:Math.ceil(R/64/4)},programUniforms:[{type:12,data:Math.ceil(Ve.size(S)/4)},...Kt(x,_,S)]})}},Ua=(e,r,a,o,c,h)=>{e.compute(Ax(r,c??"",e.inputs[0],e.inputs[1],a,o,h))},Bv=e=>{Ua(e,"Add",(r,a)=>`${r}+${a}`)},Nv=e=>{Ua(e,"Div",(r,a)=>`${r}/${a}`)},kv=e=>{Ua(e,"Equal",{scalar:(r,a)=>`u32(${r}==${a})`,vector:(r,a)=>`vec4<u32>(${r}==${a})`},void 0,void 0,9)},$v=e=>{Ua(e,"Mul",(r,a)=>`${r}*${a}`)},Lv=e=>{let r=Ke("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;Ua(e,"Pow",{scalar:(a,o)=>`pow_custom(${a},${o})`,vector:(a,o)=>`pow_vector_custom(${a},${o})`},`
    fn pow_custom(a : ${r}, b : ${r}) -> ${r} {
      if (b == ${r}(0.0)) {
        return ${r}(1.0);
      } else if (a < ${r}(0.0) && f32(b) != floor(f32(b))) {
        return ${r}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${r}(1.0), round(f32(abs(b) % ${r}(2.0))) != 1.0) * ${r}(${r==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${r}>, b : vec4<${r}>) -> vec4<${r}> {
      // TODO: implement vectorized pow
      return vec4<${r}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},zv=e=>{Ua(e,"Sub",(r,a)=>`${r}-${a}`)},Uv=e=>{Ua(e,"Greater",{scalar:(r,a)=>`u32(${r}>${a})`,vector:(r,a)=>`vec4<u32>(${r}>${a})`},void 0,void 0,9)},Pv=e=>{Ua(e,"Less",{scalar:(r,a)=>`u32(${r}<${a})`,vector:(r,a)=>`vec4<u32>(${r}<${a})`},void 0,void 0,9)},Fv=e=>{Ua(e,"GreaterOrEqual",{scalar:(r,a)=>`u32(${r}>=${a})`,vector:(r,a)=>`vec4<u32>(${r}>=${a})`},void 0,void 0,9)},Gv=e=>{Ua(e,"LessOrEqual",{scalar:(r,a)=>`u32(${r}<=${a})`,vector:(r,a)=>`vec4<u32>(${r}<=${a})`},void 0,void 0,9)}}),Ex,Tx,Sx,Ix,Vv,qv,J8=gt(()=>{fn(),vn(),Ur(),An(),Ex=(e,r)=>{if(!e||e.length<1)throw new Error("too few inputs");let a=0,o=e[a],c=o.dataType,h=o.dims.length;e.forEach((m,x)=>{if(x!==a){if(m.dataType!==c)throw new Error("input tensors should be one type");if(m.dims.length!==h)throw new Error("input tensors should have the same shape");m.dims.forEach((_,y)=>{if(y!==r&&_!==o.dims[y])throw new Error("non concat dimensions must match")})}})},Tx=(e,r)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${r});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,Sx=(e,r)=>{let a=e.length,o=[];for(let c=0;c<a;++c){let h=r.setByOffset("global_idx",e[c].getByIndices("indices"));a===1?o.push(h):c===0?o.push(`if (inputIndex == ${c}u) { ${h} }`):c===a-1?o.push(`else { ${h} }`):o.push(`else if (inputIndex == ${c}) { ${h} }`)}return o.join(`
`)},Ix=(e,r,a,o)=>{let c=Ve.size(a),h=new Array(e.length),m=new Array(e.length),x=0,_=[],y=[],S=[{type:12,data:c}];for(let z=0;z<e.length;++z)x+=e[z].dims[r],h[z]=x,y.push(e[z].dims.length),m[z]=Ke(`input${z}`,o,y[z]),_.push("rank"),S.push({type:12,data:h[z]});for(let z=0;z<e.length;++z)S.push(...Kt(e[z].dims));S.push(...Kt(a));let R=Pt("output",o,a.length),B=R.indicesGet("indices",r),N=Array.from(Array(h.length).keys()).map(z=>`uniforms.sizeInConcatAxis${z}`).join(","),k=z=>`

  ${(()=>{z.registerUniform("outputSize","u32");for(let X=0;X<e.length;X++)z.registerUniform(`sizeInConcatAxis${X}`,"u32");return z.declareVariables(...m,R)})()}

  ${Tx(h.length,N)}

  ${z.mainStart()}
    ${z.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${R.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${B});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${h.length}u>(${N});
      ${B} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${Sx(m,R)}
  }`;return{name:"Concat",shaderCache:{hint:`${r}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:a,dataType:o}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:S}),getShaderSource:k}},Vv=(e,r)=>{let a=e.inputs,o=a[0].dims,c=Ve.normalizeAxis(r.axis,o.length);Ex(a,c);let h=o.slice();h[c]=a.reduce((x,_)=>x+(_.dims.length>c?_.dims[c]:0),0);let m=a.filter(x=>Ve.size(x.dims)>0);e.compute(Ix(m,c,h,a[0].dataType),{inputs:m})},qv=e=>tr({axis:e.axis})}),No,ko,$o,s1,Uo=gt(()=>{fn(),vn(),No=(e,r,a="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${r}(0.0));`;case"Sigmoid":return`value = (${r}(1.0) / (${r}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${r}(${a}(uniforms.clip_min)), ${r}(${a}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${r}(0.0), min(${r}(1.0), ${a}(uniforms.alpha) * value + ${a}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${a}(uniforms.alpha) * value, value, value >= ${r}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},ko=(e,r)=>{e.activation==="Clip"?r.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?r.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&r.push({type:1,data:e.alpha})},$o=(e,r)=>{e.activation==="Clip"?r.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?r.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&r.push({name:"alpha",type:"f32"})},s1=e=>{let r=e?.activation||"";if(r==="HardSigmoid"){let[a,o]=e?.activation_params||[.2,.5];return{activation:r,alpha:a,beta:o}}else if(r==="Clip"){let[a,o]=e?.activation_params||[m3,x3];return{activation:r,clipMax:o,clipMin:a}}else if(r==="LeakyRelu"){let[a]=e?.activation_params||[.01];return{activation:r,alpha:a}}return{activation:r}}}),di,jv,o1=gt(()=>{di=(e,r)=>{switch(e){case 1:return r;case 2:return`vec2<${r}>`;case 3:return`vec3<${r}>`;case 4:return`vec4<${r}>`;default:throw new Error(`${e}-component is not supported.`)}},jv=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),Hv,eT=gt(()=>{Hv=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),vu,l1,u1=gt(()=>{fn(),vn(),An(),Uo(),vu=(e,r,a,o,c)=>{let h=o-a;return`
      ${Array.from({length:a}).map((m,x)=>`
      if (${Yt(r.shape,x,r.rank)} != 1) {
        ${r.indicesSet(e,x,Yt(c,x+h,o))}
      } else {
        ${r.indicesSet(e,x,0)}
      }`).join("")}
`},l1=(e,r,a,o,c=!1,h)=>{let m=e[0].dims,x=e[1].dims,_=m[m.length-2],y=x[x.length-1],S=m[m.length-1],R=$r(y),B=$r(S),N=$r(_),k=Ve.size(a)/R/N,z=e.length>2,X=o?o.slice(0,-2):a.slice(0,-2),j=[Ve.size(X),_,y],F=[{type:12,data:k},{type:12,data:_},{type:12,data:y},{type:12,data:S}];ko(r,F),F.push(...Kt(X,m,x)),z&&F.push(...Kt(e[2].dims)),F.push(...Kt(j));let te=Q=>{let oe=n1("batch_dims",e[0].dataType,X.length),ue=Ke("a",e[0].dataType,m.length,B),ee=Ke("b",e[1].dataType,x.length,R),ce=Pt("output",e[0].dataType,j.length,R),le=ii(ce.type.tensor),Qe=No(r,ce.type.value,le),Je=[ue,ee],ke="";if(z){let ve=c?R:1;Je.push(Ke("bias",e[2].dataType,e[2].dims.length,ve)),ke=`${c?`value += bias[col / ${ve}];`:`value += ${ce.type.value}(bias[row + i]);`}`}let at=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];$o(r,at);let et=()=>{let ve=`var a_data: ${ue.type.value};`;for(let xe=0;xe<B;xe++)ve+=`
              let b_data${xe} = b[(b_offset + (k + ${xe}) * uniforms.N + col) / ${R}];`;for(let xe=0;xe<N;xe++){ve+=`a_data = a[(a_offset + (row + ${xe}) * uniforms.K + k) / ${B}];`;for(let _e=0;_e<B;_e++)ve+=`
            values[${xe}] = fma(${ee.type.value}(a_data${B===1?"":`[${_e}]`}), b_data${_e}, values[${xe}]);
`}return ve};return`
  ${Q.registerUniforms(at).registerInternalVariables(oe).declareVariables(...Je,ce)}
  ${Q.mainStart()}
    ${Q.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${R})) * ${R};
    var index1 = global_idx / (uniforms.N / ${R});
    let stride1 = uniforms.M / ${N};
    let row = (index1 % stride1) * ${N};
    let batch = index1 / stride1;

    ${a.length===2?"":`let batch_indices = ${oe.offsetToIndices("batch")};`}

    var a_indices: ${ue.type.indices};
    ${vu("a_indices",ue,ue.rank-2,oe.rank,"batch_indices")}
    ${ue.indicesSet("a_indices",ue.rank-2,0)}
    ${ue.indicesSet("a_indices",ue.rank-1,0)}
    let a_offset = ${ue.indicesToOffset("a_indices")};

    var b_indices: ${ee.type.indices};
    ${vu("b_indices",ee,ee.rank-2,oe.rank,"batch_indices")}
    ${ee.indicesSet("b_indices",ee.rank-2,0)}
    ${ee.indicesSet("b_indices",ee.rank-1,0)}
    let b_offset = ${ee.indicesToOffset("b_indices")};
    var values: array<${ce.type.value}, ${N}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${B}) {
      ${et()}
    }
    for (var i = 0u; i < ${N}u; i++) {
      var value = values[i];
      ${ke}
      ${Qe}
      let cur_indices = ${ce.type.indices}(batch, row + i, col);
      let offset = ${ce.indicesToOffset("cur_indices")};
      ${ce.setByOffset(`offset / ${R}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${r.activation};${R};${B};${N};${c}`,inputDependencies:z?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:h?h(a):a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(k/64)},programUniforms:F}),getShaderSource:te}}}),Rx,Ox,Rh,M0,Dx,Oh,Mx,sf,c1=gt(()=>{fn(),vn(),An(),Uo(),u1(),o1(),Rx=(e,r)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${r?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${r?", batchIndices":""});
        `,Ox=(e,r)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${r===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${r===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${r===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,Rh=(e,r,a="f32",o,c=!1,h=32,m=!1,x=32)=>{let _=r[1]*e[1],y=r[0]*e[0],S=c?_:h,R=c?h:_,B=S/r[0],N=h/r[1];if(!((c&&B===4&&e[1]===4||!c&&(B===3||B===4))&&S%r[0]===0&&h%r[1]===0&&e[0]===4))throw new Error(`If transposeA ${c} is true, innerElementSize ${B} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${B} must be 3 or 4.
  tileAWidth ${S} must be divisible by workgroupSize[0]${r[0]}. tileInner ${h} must be divisible by workgroupSize[1] ${r[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${B}<${a}>, ${S/B}>, ${R}>;
var<workgroup> mm_Bsub: array<array<vec4<${a}>, ${y/e[0]}>, ${h}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${B};
const tileInner = ${h};

@compute @workgroup_size(${r[0]}, ${r[1]}, ${r[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${m?"0":"i32(globalId.z)"};
  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${_};

  let num_tiles = ${m?`${Math.ceil(x/h)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${m?`i32(globalId.z) * ${x}`:"0"};

  var acc: array<vec4<${a}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${N};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${Rx(c,o)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${N}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${B===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${Ox(c,B)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},M0=(e,r)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${r?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${r?", batchIndices":""});
            `,Dx=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Oh=(e,r,a="f32",o,c=!1,h=32,m=!1,x=32,_=!1)=>{let y=e[1]*r[1],S=e[0]*r[0],R=c?y:h,B=c?h:y;if(!(B%r[1]===0&&R%r[0]===0&&h%r[1]===0))throw new Error(`tileAHight ${B} must be divisible by workgroupSize[1]${r[1]}, tileAWidth ${R} must be divisible by workgroupSize[0]${r[0]}, tileInner ${h} must be divisible by workgroupSize[1]${r[1]}`);let N=B/r[1],k=R/r[0],z=h/r[1],X=_?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${y};
    let globalColStart = i32(workgroupId.x) * ${S};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${B}; inputRow = inputRow + ${r[1]}) {
        for (var inputCol = localCol; inputCol < ${R}; inputCol = inputCol + ${r[0]}) {
          ${M0(c,o)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${h}; inputRow = inputRow + ${r[1]}) {
            for (var inputCol = localCol; inputCol < ${S}; inputCol = inputCol + ${r[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${o?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${a}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${r[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${c?`mm_Asub[k][localRow + innerRow * ${r[1]}];`:`mm_Asub[localRow + innerRow * ${r[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${r[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${r[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${y};

let tileRowA = i32(localId.y) * ${N};
let tileColA = i32(localId.x) * ${k};
let tileRowB = i32(localId.y) * ${z};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${N}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${k}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${M0(c,o)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${z}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${o?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${a}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${Dx(c)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${a}, ${R}>, ${B}>;
  var<workgroup> mm_Bsub : array<array<${a}, ${S}>, ${h}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${h};

@compute @workgroup_size(${r[0]}, ${r[1]}, ${r[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${m?"0":"i32(globalId.z)"};
    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${m?`${Math.ceil(x/h)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${m?`i32(globalId.z) * ${x}`:"0"};

    var acc : array<array<${a}, colPerThread>, rowPerThread>;
    ${X}
  }
`},Mx=(e,r,a,o,c=!1)=>{let[h,m,x,_]=o,y=ii(o[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${di(e,y)} {
      var value = ${di(e,y)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${m.type.indices};
        ${vu("aIndices",m,m.rank-2,h.rank,"batchIndices")}
        ${m.indicesSet("aIndices",m.rank-2,"u32(row)")}
        ${m.indicesSet("aIndices",m.rank-1,"u32(colIn)")}
        value = ${m.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${di(e,y)} {
      var value = ${di(e,y)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${x.type.indices};
        ${vu("bIndices",x,x.rank-2,h.rank,"batchIndices")}
        ${x.indicesSet("bIndices",x.rank-2,"u32(row)")}
        ${x.indicesSet("bIndices",x.rank-1,"u32(colIn)")}
        value = ${x.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${di(e,y)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${r?`value = value + ${c?"bias[colIn]":`${di(e,y)}(bias[row])`};`:""}
        ${a}
        ${_.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},sf=(e,r,a,o,c=!1,h)=>{let m=e[0].dims,x=e[1].dims,_=m.slice(0,-2),y=x.slice(0,-2),S=o?o.slice(0,-2):a.slice(0,-2),R=Ve.size(S),B=m[m.length-2],N=m[m.length-1],k=x[x.length-1],z=N%4===0&&k%4===0,X=B<=8?[4,1,1]:[4,4,1],j=[8,8,1],F=[Math.ceil(k/j[0]/X[0]),Math.ceil(B/j[1]/X[1]),Math.ceil(R/j[2]/X[2])],te=z?4:1,Q=[..._,B,N/te],oe=Q.length,ue=[...y,N,k/te],ee=ue.length,ce=[R,B,k/te],le=[{type:6,data:B},{type:6,data:k},{type:6,data:N}];ko(r,le),le.push(...Kt(S,Q,ue));let Qe=["rank","rank"],Je=e.length>2;Je&&(le.push(...Kt(e[2].dims)),Qe.push("rank")),le.push(...Kt(ce));let ke=at=>{let et=S.length,ve=n1("batchDims",e[0].dataType,et,1),xe=ii(e[0].dataType),_e=Ke("a",e[0].dataType,oe,te),Ge=Ke("b",e[1].dataType,ee,te),qe=Pt("result",e[0].dataType,ce.length,te),ft=[_e,Ge];if(Je){let pe=c?te:1;ft.push(Ke("bias",e[2].dataType,e[2].dims.length,pe))}let ne=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];$o(r,ne);let fe=ii(qe.type.tensor),De=No(r,qe.type.value,fe),Le=Mx(te,Je,De,[ve,_e,Ge,qe],c);return`
  ${at.registerUniforms(ne).registerInternalVariables(ve).declareVariables(...ft,qe)}
  ${Le}
  ${z?Rh(X,j,xe,ve):Oh(X,j,xe,ve)}
                   `};return{name:"MatMul",shaderCache:{hint:`${X};${r.activation};${z};${c}`,inputDependencies:Qe},getRunData:()=>({outputs:[{dims:h?h(a):a,dataType:e[0].dataType}],dispatchGroup:{x:F[0],y:F[1],z:F[2]},programUniforms:le}),getShaderSource:ke}}}),Bx,Yv,tT=gt(()=>{fn(),Ss(),An(),Uo(),o1(),eT(),c1(),Bx=(e,r,a,o,c=!1,h,m=4,x=4,_=4,y="f32")=>{let S=le=>{switch(le){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${y}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${le} is not supported.`)}},R=le=>{switch(le){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${le} is not supported.`)}},B=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,N=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,k=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",z=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",X=e?"row":"col",j=e?"col":"row",F=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${X} / outWidth;
    let outCol = ${X} % outWidth;

    let WRow = ${j} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${j} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${j} % inChannels;
    var resData = ${di(m,y)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${k} && xCol >= 0 && xCol < ${z}) {
      ${B}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${S(m)}
    }
    return resData;`,te=e?r&&o?`
    let col = colIn * ${m};
    ${F}`:`
    let col = colIn * ${m};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${F}
    }
    return ${di(m,y)}(0.0);`:o&&a?`
    let col = colIn * ${m};
    ${F}`:`
    let col = colIn * ${m};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${F}
    }
    return ${di(m,y)}(0.0);`,Q=e?o&&a?R(x):`
    let col = colIn * ${x};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${R(x)}
    }
    return ${di(x,y)}(0.0);`:`
    let col = colIn * ${x};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${R(x)}
    }
    return ${di(x,y)}(0.0);`,oe=di(_,y),ue=di(e?m:x,y),ee=di(e?x:m,y),ce=No(h,oe,y);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${ue} {
      ${e?te:Q}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${ee} {
      ${e?Q:te}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${oe}) {
      let col = colIn * ${_};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${N}
      ${jv(c)}
      ${ce}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Yv=(e,r,a,o,c,h,m,x,_)=>{let y=r.format==="NHWC",S=y?e[0].dims[3]:e[0].dims[1],R=a[0],B=y?a[2]:a[3],N=y?a[1]:a[2],k=y?a[3]:a[1],z=y&&(S%4===0||S%3===0)&&k%4===0,X=y?k:B*N,j=y?B*N:k,F=[8,8,1],te=o<=8?[4,1,1]:[4,4,1],Q=[Math.ceil(X/F[0]/te[0]),Math.ceil(j/F[1]/te[1]),Math.ceil(R/F[2]/te[2])];Fn("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${Q}`);let oe=z?y&&S%4!==0?3:4:1,ue=F[1]*te[1],ee=F[0]*te[0],ce=Math.max(F[0]*oe,F[1]),le=o%ue===0,Qe=c%ee===0,Je=h%ce===0,ke=z?[oe,4,4]:[1,1,1],at=[{type:6,data:o},{type:6,data:c},{type:6,data:h},{type:6,data:[r.pads[0],r.pads[1]]},{type:6,data:r.strides},{type:6,data:r.dilations}];ko(r,at),at.push(...Kt(e[0].dims,e[1].dims));let et=["rank","rank"];m&&(at.push(...Kt(e[2].dims)),et.push("rank")),at.push(...Kt(a));let ve=xe=>{let _e=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];$o(r,_e);let Ge=z?4:1,qe=ii(e[0].dataType),ft=`
      fn setOutputAtIndex(flatIndex : i32, value : ${z?`vec4<${qe}>`:qe}) {
        result[flatIndex] = ${z?`vec4<${qe}>`:qe}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${z?`vec4<${qe}>`:qe}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${z?"/ 4":""}, value);
      }`,ne=Ke("x",e[0].dataType,e[0].dims.length,oe===3?1:oe),fe=Ke("w",e[1].dataType,e[1].dims.length,Ge),De=[ne,fe],Le=Pt("result",e[0].dataType,a.length,Ge);if(m){let pe=Ke("bias",e[2].dataType,e[2].dims.length,Ge);De.push(pe),ft+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${z?`vec4<${qe}>`:qe} {
          return bias[coords.${y?"w":"y"}${z?"/ 4":""}];
        }`}return`
        ${Hv("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${xe.registerUniforms(_e).declareVariables(...De,Le)}
        ${ft}
        ${Bx(y,le,Qe,Je,m,r,ke[0],ke[1],ke[2],qe)}
        ${z?Rh(te,F,qe,void 0,!y,ce):Oh(te,F,qe,void 0,!y,ce,!1,void 0,x)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${r.cacheKey};${oe};${z};${le};${Qe};${Je};${ue};${ee};${ce}`,inputDependencies:et},getRunData:()=>({outputs:[{dims:_?_(a):a,dataType:e[0].dataType}],dispatchGroup:{x:Q[0],y:Q[1],z:Q[2]},programUniforms:at}),getShaderSource:ve}}}),Nx,B0,su,kx,N0,$x,Wv,Kv,nT=gt(()=>{fn(),Ss(),vn(),An(),Uo(),o1(),Nx=e=>{let r=1;for(let a=0;a<e.length;a++)r*=e[a];return r},B0=e=>typeof e=="number"?[e,e,e]:e,su=(e,r)=>r<=1?e:e+(e-1)*(r-1),kx=(e,r,a,o=1)=>{let c=su(r,o);return Math.floor((e[0]*(a-1)-a+c)/2)},N0=(e,r,a,o,c)=>{c==null&&(c=kx(e,r[0],o[0]));let h=[0,0,0,a];for(let m=0;m<3;m++)e[m]+2*c>=r[m]&&(h[m]=Math.trunc((e[m]-r[m]+2*c)/o[m]+1));return h},$x=(e,r,a,o,c,h,m,x,_,y)=>{let S,R,B,N;if(e==="VALID"&&(e=0),typeof e=="number"){S={top:e,bottom:e,left:e,right:e,front:e,back:e};let k=N0([r,a,o,1],[x,_,y],1,[c,h,m],e);R=k[0],B=k[1],N=k[2]}else if(Array.isArray(e)){if(!e.every((z,X,j)=>z===j[0]))throw Error(`Unsupported padding parameter: ${e}`);S={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let k=N0([r,a,o,1],[x,_,y],1,[c,h,m],e[0]);R=k[0],B=k[1],N=k[2]}else if(e==="SAME_UPPER"){R=Math.ceil(r/c),B=Math.ceil(a/h),N=Math.ceil(o/m);let k=(R-1)*c+x-r,z=(B-1)*h+_-a,X=(N-1)*m+y-o,j=Math.floor(k/2),F=k-j,te=Math.floor(z/2),Q=z-te,oe=Math.floor(X/2),ue=X-oe;S={top:te,bottom:Q,left:oe,right:ue,front:j,back:F}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:S,outDepth:R,outHeight:B,outWidth:N}},Wv=(e,r,a,o,c,h=!1,m="channelsLast")=>{let x,_,y,S,R;if(m==="channelsLast")[x,_,y,S,R]=e;else if(m==="channelsFirst")[x,R,_,y,S]=e;else throw new Error(`Unknown dataFormat ${m}`);let[B,,N,k,z]=r,[X,j,F]=B0(a),[te,Q,oe]=B0(o),ue=su(N,te),ee=su(k,Q),ce=su(z,oe),{padInfo:le,outDepth:Qe,outHeight:Je,outWidth:ke}=$x(c,_,y,S,X,j,F,ue,ee,ce),at=h?B*R:B,et=[0,0,0,0,0];return m==="channelsFirst"?et=[x,at,Qe,Je,ke]:m==="channelsLast"&&(et=[x,Qe,Je,ke,at]),{batchSize:x,dataFormat:m,inDepth:_,inHeight:y,inWidth:S,inChannels:R,outDepth:Qe,outHeight:Je,outWidth:ke,outChannels:at,padInfo:le,strideDepth:X,strideHeight:j,strideWidth:F,filterDepth:N,filterHeight:k,filterWidth:z,effectiveFilterDepth:ue,effectiveFilterHeight:ee,effectiveFilterWidth:ce,dilationDepth:te,dilationHeight:Q,dilationWidth:oe,inShape:e,outShape:et,filterShape:r}},Kv=(e,r,a,o,c,h)=>{let m=h==="channelsLast";m?e[0].dims[3]:e[0].dims[1];let x=[64,1,1],_={x:a.map((X,j)=>j)},y=[Math.ceil(Nx(_.x.map(X=>a[X]))/x[0]),1,1];Fn("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${y}`);let S=1,R=Ve.size(a),B=[{type:12,data:R},{type:12,data:o},{type:12,data:c},{type:12,data:r.strides},{type:12,data:r.dilations}];ko(r,B),B.push(...Kt(e[0].dims,e[1].dims));let N=["rank","rank"],k=e.length===3;k&&(B.push(...Kt(e[2].dims)),N.push("rank")),B.push(...Kt(a));let z=X=>{let j=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:o.length},{name:"pads",type:"u32",length:c.length},{name:"strides",type:"u32",length:r.strides.length},{name:"dilations",type:"u32",length:r.dilations.length}];$o(r,j);let F=1,te=ii(e[0].dataType),Q=Ke("x",e[0].dataType,e[0].dims.length,S),oe=Ke("W",e[1].dataType,e[1].dims.length,F),ue=[Q,oe],ee=Pt("result",e[0].dataType,a.length,F),ce="";if(k){let Je=Ke("bias",e[2].dataType,e[2].dims.length,F);ue.push(Je),ce+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${te} {
          return bias[${m?Yt("coords",4,5):Yt("coords",1,5)}];
        }`}let le=di(S,te),Qe=No(r,le,te);return`
            ${ce}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${Q.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${oe.getByIndices("aIndices")};
            }
          ${X.registerUniforms(j).declareVariables(...ue,ee)}
          ${X.mainStart()}
          ${X.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${ee.offsetToIndices("global_idx")};
              let batch = ${Yt("coords",0,Q.rank)};
              let d2 = ${m?Yt("coords",Q.rank-1,Q.rank):Yt("coords",1,Q.rank)};
              let xFRCCorner = vec3<u32>(${m?Yt("coords",1,Q.rank):Yt("coords",2,Q.rank)},
              ${m?Yt("coords",2,Q.rank):Yt("coords",3,Q.rank)},
              ${m?Yt("coords",3,Q.rank):Yt("coords",4,Q.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${m?Yt("uniforms.x_shape",1,Q.rank):Yt("uniforms.x_shape",2,Q.rank)};
              let xShapeZ = ${m?Yt("uniforms.x_shape",2,Q.rank):Yt("uniforms.x_shape",3,Q.rank)};
              let xShapeW = ${m?Yt("uniforms.x_shape",3,Q.rank):Yt("uniforms.x_shape",4,Q.rank)};
              let xShapeU = ${m?Yt("uniforms.x_shape",4,Q.rank):Yt("uniforms.x_shape",1,Q.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${m?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${m?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${m?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${m?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${k?"value = value + getBiasByOutputCoords(coords)":""};
              ${Qe}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${r.cacheKey};${m};${S};${k}`,inputDependencies:N},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:y[0],y:y[1],z:y[2]},programUniforms:B}),getShaderSource:z}}}),Qv,Xv,rT=gt(()=>{fn(),vn(),An(),Uo(),Qv=(e,r,a,o)=>{let c=e.length>2,h=c?"value += b[output_channel];":"",m=e[0].dims,x=e[1].dims,_=r.format==="NHWC",y=_?a[3]:a[1],S=y/r.group,R=_&&S>=4?$r(y):1,B=Ve.size(a)/R,N=[{type:12,data:B},{type:12,data:r.dilations},{type:12,data:[r.strides[0],r.strides[1]]},{type:12,data:[r.pads[0],r.pads[1]]},{type:12,data:S}];ko(r,N),N.push(...Kt(m,[x[0],x[1],x[2],x[3]/R]));let k=c?["rank","rank","rank"]:["rank","rank"];N.push(...Kt([a[0],a[1],a[2],a[3]/R]));let z=X=>{let j=Pt("output",e[0].dataType,a.length,R),F=ii(j.type.tensor),te=No(r,j.type.value,F),Q=Ke("x",e[0].dataType,m.length),oe=Ke("w",e[1].dataType,x.length,R),ue=[Q,oe];c&&ue.push(Ke("b",e[2].dataType,e[2].dims,R));let ee=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:r.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];$o(r,ee);let ce=_?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${Q.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${oe.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${Q.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${oe.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${X.registerUniforms(ee).declareVariables(...ue,j)}

  ${X.mainStart()}
    ${X.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${j.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${_?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${_?1:2}], outputIndices[${_?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${R} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${_?2:1}];

    var value: ${j.type.value} = ${j.type.value}(0);
    ${ce}
    ${h}
    ${te}
    ${j.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${r.cacheKey}_${R}`,inputDependencies:k},getRunData:()=>({outputs:[{dims:o?o(a):a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(B/64)},programUniforms:N}),getShaderSource:z}},Xv=(e,r,a,o)=>{let c=e.length>2,h=$r(a[3]),m=$r(a[2]),x=Ve.size(a)/h/m,_=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/h],y=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/h],S=[a[0],a[1],a[2],a[3]/h],R=[{type:12,data:x},{type:6,data:[r.strides[0],r.strides[1]]},{type:6,data:[r.pads[0],r.pads[1]]}];ko(r,R),R.push(...Kt(_,y,S));let B=(m-1)*r.strides[1]+y[1],N=k=>{let z=Pt("output",e[0].dataType,S.length,h),X=ii(z.type.tensor),j=No(r,z.type.value,X),F=Ke("x",e[0].dataType,_.length,h),te=Ke("w",e[1].dataType,y.length,h),Q=[F,te];c&&Q.push(Ke("b",e[2].dataType,e[2].dims,h));let oe=c?"value += b[output_channel];":"",ue=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return $o(r,ue),`
  ${k.registerUniforms(ue).declareVariables(...Q,z)}
  ${k.mainStart()}
    ${k.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${m}u;
    let col = (index1 % width1) * ${m}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${F.type.value}, ${B}>;
    var values: array<${z.type.value}, ${m}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${y[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${B}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${F.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${F.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${y[1]}; w_width++) {
          let w_val = ${te.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${m}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${m}u; i++) {
      var value = values[i];
      ${oe}
      ${j}
      ${z.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${r.cacheKey};${h};${m};${B};${y[0]};${y[1]}`,inputDependencies:c?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:o?o(a):a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:R}),getShaderSource:N}}}),Lx,Mc,zx,Bc,Dh,k0,Ux,Px,Mh,iT=gt(()=>{vn(),tT(),nT(),c1(),rT(),Uo(),u1(),lo(),Lx=(e,r,a,o,c,h)=>{let m=e[0],x=e.slice(h?1:2,h?3:4),_=x.length,y=r[0],S=r.slice(2).map((B,N)=>B+(B-1)*(a[N]-1)),R=x.map((B,N)=>B+o[N]+o[N+_]).map((B,N)=>Math.floor((B-S[N]+c[N])/c[N]));return R.splice(0,0,m),R.splice(h?3:1,0,y),R},Mc=[2,3,1,0],zx=(e,r)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let a=e[0].dims[r.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*r.group;if(a!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let c=e[0].dims.length-2;if(r.dilations.length!==c)throw new Error(`dilations should be ${c}D`);if(r.strides.length!==c)throw new Error(`strides should be ${c}D`);if(r.pads.length!==c*2)throw new Error(`pads should be ${c*2}D`);if(r.kernelShape.length!==0&&r.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},Bc=(e,r)=>{let a=e.kernelShape.slice();a.length<r[1].dims.length-2&&a.push(...Array(r[1].dims.length-2-a.length).fill(0));for(let h=2;h<r[1].dims.length;++h)a[h-2]===0&&(a[h-2]=r[1].dims[h]);let o=e.pads.slice();rf.adjustPadsBasedOnAutoPad(r[0].dims,e.strides,e.dilations,a,o,e.format==="NHWC",e.autoPad);let c=Object.assign({},e);return Object.assign(c,{kernelShape:a,pads:o}),c},Dh=e=>{let r=s1(e),a=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],c=e.dilations,h=e.group,m=e.kernel_shape,x=e.pads,_=e.strides,y=e.w_is_const();return{autoPad:o,format:a,dilations:c,group:h,kernelShape:m,pads:x,strides:_,wIsConst:y,...r,cacheKey:`${e.format};${r.activation};`}},k0=(e,r,a,o)=>{let c=a.format==="NHWC",h=Lx(r[0].dims,r[1].dims,a.dilations,a.pads,a.strides,c);if(a.group!==1){let ue=[r[0]];if(c){let ee=e.kernelCustomData.wT??e.compute(la(r[1],Mc),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=ee),ue.push(ee)}else ue.push(r[1]);r.length===3&&ue.push(r[2]),!e.adapterInfo.isArchitecture("ampere")&&c&&r[1].dims[0]===a.group&&r[1].dims[1]===1&&a.dilations[0]===1&&a.dilations[1]===1?e.compute(Xv(ue,a,h,o),{inputs:ue}):e.compute(Qv(ue,a,h,o),{inputs:ue});return}let m=r.length===3,x=r[0].dims[c?1:2],_=r[0].dims[c?2:3],y=r[0].dims[c?3:1],S=r[1].dims[2],R=r[1].dims[3],B=h[c?1:2],N=h[c?2:3],k=h[c?3:1],z=c&&S===x&&R===_&&a.pads[0]===0&&a.pads[1]===0;if(z||S===1&&R===1&&a.dilations[0]===1&&a.dilations[1]===1&&a.strides[0]===1&&a.strides[1]===1&&a.pads[0]===0&&a.pads[1]===0){let ue=h[0],ee,ce,le,Qe=[];if(c){let at=e.kernelCustomData.wT??e.compute(la(r[1],Mc),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];if(a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=at),z){let et=x*_*y;ee=r[0].reshape([1,ue,et]),ce=at.reshape([1,et,k]),le=[1,ue,k]}else ee=r[0].reshape([ue,x*_,y]),ce=at.reshape([1,y,k]),le=[ue,B*N,k];Qe.push(ee),Qe.push(ce)}else ee=r[0].reshape([ue,y,x*_]),ce=r[1].reshape([1,k,y]),le=[ue,k,B*N],Qe.push(ce),Qe.push(ee);m&&Qe.push(r[2]);let Je=le[2],ke=Qe[0].dims[Qe[0].dims.length-1];Je<8&&ke<8?e.compute(l1(Qe,a,h,le,c,o),{inputs:Qe}):e.compute(sf(Qe,a,h,le,c,o),{inputs:Qe});return}let X=!0,j=e.kernelCustomData.wT??e.compute(la(r[1],Mc),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=j);let F=[r[0],j];m&&F.push(r[2]);let te=c?B*N:k,Q=c?k:B*N,oe=S*R*y;e.compute(Yv(F,a,h,te,Q,oe,m,X,o),{inputs:F})},Ux=(e,r)=>{let a=r.format==="NHWC",o=[e.inputs[0].reshape(a?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let c=[0,r.pads[0],0,r.pads[1]],h=[1].concat(r.strides),m=[1].concat(r.dilations),x=[1].concat(r.kernelShape),_=Bc({...r,pads:c,strides:h,dilations:m,kernelShape:x},o);k0(e,o,_,y=>a?[y[0],y[2],y[3]]:[y[0],y[1],y[3]])},Px=(e,r,a)=>{let o=a.format==="NHWC"?"channelsLast":"channelsFirst",c=Bc(a,r),h=a.autoPad==="NOTSET"?a.pads:a.autoPad,m=Wv(r[0].dims,r[1].dims,a.strides,a.dilations,h,!1,o);e.compute(Kv(r,c,m.outShape,[m.filterDepth,m.filterHeight,m.filterWidth],[m.padInfo.front,m.padInfo.top,m.padInfo.left],o))},Mh=(e,r)=>{if(zx(e.inputs,r),e.inputs[0].dims.length===3)Ux(e,r);else if(e.inputs[0].dims.length===5)Px(e,e.inputs,r);else{let a=Bc(r,e.inputs);k0(e,e.inputs,a)}}}),Zv,aT=gt(()=>{fn(),Ss(),vn(),An(),Zv=(e,r,a)=>{let o=e.length>2,c=r.outputShape,h=r.format==="NHWC",m=r.group,x=e[1].dims,_=x[2]/m,y=x[3],S=h?$r(_):1,R=h&&y===1&&_>=4,B=R?Math.floor(_/4)*4:Math.floor(_/S)*S,N=_-B,k=h?$r(y):1,z=h?y===1?S:k:1,X=Ve.size(c)/k,j=[Math.ceil(X/64),1,1];Fn("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${j}`);let F=["rank","rank"],te=[r.strides[0],r.strides[1]],Q=[r.kernelShape[h?1:2],r.kernelShape[h?2:3]],oe=[r.dilations[0],r.dilations[1]],ue=[Q[0]+(r.dilations[0]<=1?0:(r.kernelShape[h?1:2]-1)*(r.dilations[0]-1)),Q[1]+(r.dilations[1]<=1?0:(r.kernelShape[h?2:3]-1)*(r.dilations[1]-1))],ee=[ue[0]-1-Math.floor((r.pads[0]+r.pads[2])/2),ue[1]-1-Math.floor((r.pads[1]+r.pads[3])/2)],ce=[{type:12,data:X},{type:12,data:te},{type:12,data:Q},{type:12,data:oe},{type:12,data:ue},{type:6,data:ee},{type:12,data:B},{type:12,data:_},{type:12,data:y},...Kt(e[0].dims,e[1].dims)];o&&(ce.push(...Kt(e[2].dims)),F.push("rank")),ce.push(...Kt(c));let le=Qe=>{let Je=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:te.length},{name:"filter_dims",type:"u32",length:Q.length},{name:"dilations",type:"u32",length:Q.length},{name:"effective_filter_dims",type:"u32",length:ue.length},{name:"pads",type:"i32",length:ee.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],ke=ii(e[0].dataType),at=h?1:2,et=h?2:3,ve=h?3:1,xe=Ke("W",e[1].dataType,e[1].dims.length,z),_e=Ke("Dy",e[0].dataType,e[0].dims.length,S),Ge=[_e,xe];o&&Ge.push(Ke("bias",e[2].dataType,[c[ve]].length,k));let qe=Pt("result",e[0].dataType,c.length,k),ft=()=>{let De="";if(R)S===4?De+=`
        let xValue = ${_e.getByOffset("x_offset")};
        let wValue = ${xe.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:S===2?De+=`
          dotProd = dotProd + dot(vec4<${ke}>(${_e.getByOffset("x_offset")}, ${_e.getByOffset("x_offset + 1u")}), vec4<${ke}>(${xe.getByOffset("w_offset")}, ${xe.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:S===1&&(De+=`
          dotProd = dotProd + dot(vec4<${ke}>(${_e.getByOffset("x_offset")}, ${_e.getByOffset("x_offset + 1u")}, ${_e.getByOffset("x_offset + 2u")}, ${_e.getByOffset("x_offset + 3u")}), vec4<${ke}>(${xe.getByOffset("w_offset")}, ${xe.getByOffset("w_offset + 1u")}, ${xe.getByOffset("w_offset + 2u")}, ${xe.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(De+=`
                  let xValue = ${h?_e.getByOffset(`${_e.indicesToOffset(`${_e.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${S}`):_e.get("batch","inputChannel","idyR","idyC")};
        `,S===1)De+=`
          let w_offset = ${xe.indicesToOffset(`${xe.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${xe.getByOffset(`w_offset / ${z}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let Le=0;Le<S;Le++)De+=`
            let wValue${Le} = ${xe.getByOffset(`${xe.indicesToOffset(`${xe.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${Le}, wOutChannel)`)} / ${z}`)};
            dotProd = dotProd + xValue[${Le}] * wValue${Le};`;return De},ne=()=>{if(N===0)return"";if(!R)throw new Error(`packInputAs4 ${R} is not true.`);let De="";if(S===1){De+="dotProd = dotProd";for(let Le=0;Le<N;Le++)De+=`
            + ${_e.getByOffset(`x_offset + ${Le}`)} * ${xe.getByOffset(`w_offset + ${Le}`)}`;De+=";"}else if(S===2){if(N!==2)throw new Error(`Invalid inputChannelsRemainder ${N}.`);De+=`
          let xValue = ${_e.getByOffset("x_offset")};
          let wValue = ${xe.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return De},fe=`
            let outputIndices = ${qe.offsetToIndices(`global_idx * ${k}`)};
            let batch = ${qe.indicesGet("outputIndices",0)};
            let d1 = ${qe.indicesGet("outputIndices",ve)};
            let r = ${qe.indicesGet("outputIndices",at)};
            let c = ${qe.indicesGet("outputIndices",et)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${qe.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${ke}(dyRCorner) + ${ke}(wR)) / ${ke}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${ke}(uniforms.Dy_shape[${at}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${ke}(dyCCorner) + ${ke}(wC)) / ${ke}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${ke}(uniforms.Dy_shape[${et}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${R?`
                var x_offset = ${_e.indicesToOffset(`${_e.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${S};
                var w_offset = ${xe.indicesToOffset(`${xe.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${z};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${R?4:S}) {
                  ${ft()}
                  inputChannel = inputChannel + ${R?4:S};
                }
                ${ne()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${o?` + bias[d1 / ${k}]`:""};
            ${qe.setByOffset("global_idx","value")};
          `;return`
    ${Qe.registerUniforms(Je).declareVariables(...Ge,qe)}
      ${Qe.mainStart()}
      ${Qe.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${fe}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${r.cacheKey};${S}${z}${k}${R}${N}`,inputDependencies:F},getRunData:()=>({dispatchGroup:{x:j[0],y:j[1],z:j[2]},outputs:[{dims:a?a(c):c,dataType:e[0].dataType}],programUniforms:ce}),getShaderSource:le}}}),Fx,Gx,Vx,$0,Jv,qx,L0,jx,e_,sT=gt(()=>{aT(),Uo(),lo(),Fx=(e,r,a,o,c,h)=>(e-1)*r+a+(o-1)*c+1-h,Gx=(e,r,a,o,c)=>{let h=Math.floor(e/2);r==="SAME_UPPER"?(a[o]=h,a[c]=e-h):r==="SAME_LOWER"&&(a[o]=e-h,a[c]=h)},Vx=(e,r,a,o,c,h,m,x,_,y)=>{let S=e.length-2,R=y.length===0;_.length<S&&_.push(...Array(S-_.length).fill(0));let B=e[0],N=r[x?3:1]*c;for(let k=0,z=e.length-S-(x?1:0);k<S;++k,++z){let X=e[z],j=R?X*m[k]:y[k],F=Fx(X,m[k],h[k],r[z],a[k],j);Gx(F,o,h,k,k+S),R&&y.push(m[k]*(X-1)+_[k]+(r[z]-1)*a[k]+1-h[k]-h[k+S])}y.splice(0,0,B),y.splice(x?3:1,0,N)},$0=(e,r)=>{let a=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((R,B)=>R*B,1)===0){a.length=0;for(let R=2;R<r[1].dims.length;++R)a.push(r[1].dims[R])}let o=e.format==="NHWC";a.splice(0,0,r[1].dims[0]),a.splice(o?3:1,0,r[1].dims[1]);let c=e.pads.slice(),h=e.outputShape.slice(),m=e.outputPadding.slice(),x=r[0].dims,_=e.dilations.slice();if(_.reduce((R,B)=>R+B,0)===0){let R=r[0].dims.length-2;_=new Array(R).fill(1)}let y=e.strides.slice();if(y.reduce((R,B)=>R+B,0)===0){let R=r[0].dims.length-2;y=new Array(R).fill(1)}Vx(x,a,_,e.autoPad,e.group,c,y,o,m,h);let S=Object.assign({},e);return Object.assign(S,{kernelShape:a,pads:c,outputPadding:m,outputShape:h,dilations:_,strides:y}),S},Jv=e=>{let r=s1(e),a=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],c=e.dilations,h=e.group,m=e.kernelShape,x=e.pads,_=e.strides,y=e.wIsConst(),S=e.outputPadding,R=e.outputShape;return{autoPad:o,format:a,dilations:c,group:h,kernelShape:m,outputPadding:S,outputShape:R,pads:x,strides:_,wIsConst:y,...r,cacheKey:`${e.format};${r.activation};`}},qx=(e,r)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let a=e[0].dims[r.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(a!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let c=e[1].dims[1]*r.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==c))throw new Error("invalid bias");let h=e[0].dims.length-2;if(r.dilations.reduce((m,x)=>m+x,0)>0&&r.dilations.length!==h)throw new Error(`dilations should be ${h}D`);if(r.strides.reduce((m,x)=>m+x,0)>0&&r.strides.length!==h)throw new Error(`strides should be ${h}D`);if(r.pads.reduce((m,x)=>m+x,0)>0&&r.pads.length!==h*2)throw new Error(`pads should be ${h*2}D`);if(r.outputPadding.length!==h&&r.outputPadding.length!==0)throw new Error(`output_padding should be ${h}D`);if(r.kernelShape.reduce((m,x)=>m+x,0)>0&&r.kernelShape.length!==0&&r.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(r.outputShape.length!==0&&r.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},L0=(e,r,a,o)=>{let c=e.kernelCustomData.wT??e.compute(la(r[1],[2,3,0,1]),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=c);let h=[r[0],c];r.length===3&&h.push(r[2]),e.compute(Zv(h,a,o),{inputs:h})},jx=(e,r)=>{let a=r.format==="NHWC",o=[e.inputs[0].reshape(a?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let c=r.kernelShape;(c.length===0||c[0]===0)&&(c=[e.inputs[1].dims[2]]);let h=r.dilations;(h.length===0||h[0]===0)&&(h=[1]);let m=r.strides;(m.length===0||m[0]===0)&&(m=[1]);let x=r.pads;x.length===0&&(x=[0,0]),x=[0,x[0],0,x[1]],m=[1].concat(m),h=[1].concat(h),c=[1].concat(c);let _=r.outputPadding;_=[0].concat(_);let y=$0({...r,pads:x,strides:m,dilations:h,kernelShape:c,outputPadding:_},o);L0(e,o,y,S=>a?[S[0],S[2],S[3]]:[S[0],S[1],S[3]])},e_=(e,r)=>{if(qx(e.inputs,r),e.inputs[0].dims.length===3)jx(e,r);else{let a=$0(r,e.inputs);L0(e,e.inputs,a)}}}),Hx,t_,n_,oT=gt(()=>{fn(),vn(),Ur(),An(),Hx=(e,r,a,o)=>{let c=Ve.size(r),h=r.length,m=Ke("input",e,h),x=Pt("output",e,h),_=a.dataType===6?a.getInt32Array()[0]:Number(a.getBigInt64Array()[0]),y=Ve.normalizeAxis(_,h),S=R=>{let B=` i32(${m.indicesGet("inputIndices","uniforms.axis")}) `,N=Yt("uniforms.input_shape","uniforms.axis",h),k=o.reverse?B+(o.exclusive?" + 1":""):"0",z=o.reverse?N:B+(o.exclusive?"":" + 1");return`
                ${R.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(m,x)}
                ${R.mainStart()}
                  ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${x.offsetToIndices("global_idx")};
                  var sum = ${x.type.value}(0);
                  let first : i32 = ${k};
                  let last : i32 = ${z};
                  for (var i : i32 = first; i < last; i++) {
                    ${m.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${m.getByIndices("inputIndices")};
                  }
                  ${x.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:[{type:12,data:c},{type:12,data:y},...Kt(r,r)]}),getShaderSource:S}},t_=(e,r)=>{let a=e.inputs[0].dims,o=e.inputs[0].dataType,c=e.inputs[1];e.compute(Hx(o,a,c,r),{inputs:[0]})},n_=e=>{let r=e.exclusive===1,a=e.reverse===1;return tr({exclusive:r,reverse:a})}}),Yx,Wx,Kx,r_,i_,lT=gt(()=>{fn(),vn(),Ur(),An(),Yx=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Wx=(e,r,a,o)=>{let c=[];c.push(`fn perm(i: ${o.type.indices}) -> ${a.type.indices} {
    var a: ${a.type.indices};`);for(let h=0;h<r;++h)c.push(a.indicesSet("a",e[h],`i[${h}]`));return c.push("return a;}"),c.join(`
`)},Kx=(e,r)=>{let a,o,c,h,m,x,_=r.format==="NHWC",y=r.blocksize,S=r.mode==="DCR";_?([a,o,c,h]=e.dims,m=S?[a,o,c,y,y,h/y**2]:[a,o,c,h/y**2,y,y],x=S?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([a,o,c,h]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],m=S?[a,y,y,h/y**2,o,c]:[a,h/y**2,y,y,o,c],x=S?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let R=e.reshape(m),B=R.dims.length,N=e.dataType,k=Ke("a",N,B),z=Pt("output",N,B),X=j=>`
  ${j.registerUniform("output_size","u32").declareVariables(k,z)}

  ${Wx(x,B,k,z)}

  ${j.mainStart()}
    ${j.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${z.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${z.setByOffset("global_idx",k.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${r.blocksize};${r.mode}`,inputDependencies:["rank"]},getRunData:j=>{let F=_?[a,o*y,c*y,h/y**2]:[a,h/y**2,o*y,c*y],te=Ve.size(F),Q=R.dims,oe=Ve.sortBasedOnPerm(Q,x);return{outputs:[{dims:F,dataType:j[0].dataType}],dispatchGroup:{x:Math.ceil(te/64)},programUniforms:[{type:12,data:te},...Kt(Q,oe)]}},getShaderSource:X}},r_=(e,r)=>{Yx(e.inputs),e.compute(Kx(e.inputs[0],r))},i_=e=>tr({blocksize:e.blocksize,mode:e.mode,format:e.format})}),Nc,ou,z0,Qx,Xx,Zx,Jx,U0,ey,a_,s_,uT=gt(()=>{fn(),vn(),Ur(),An(),Nc="[a-zA-Z]|\\.\\.\\.",ou="("+Nc+")+",z0="^"+ou+"$",Qx="("+ou+",)*"+ou,Xx="^"+Qx+"$",Zx=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,r){let a=this.symbolToIndices.get(e);a===void 0?a=[r]:a.push(r),this.symbolToIndices.set(e,a)}},Jx=class{constructor(e,r){this.equation=r,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[a,o]=r.includes("->")?r.split("->",2):[r,""];if(!a.match(RegExp(Xx)))throw new Error("Invalid LHS term");if(a.split(",").forEach((c,h)=>{let m=e[h].dims.slice();if(!c.match(RegExp(z0)))throw new Error("Invalid LHS term");let x=this.processTerm(c,!0,m,h);this.lhs.push(x)}),o==="")o+=[...this.symbolToInfo.entries()].filter(([c,h])=>h.count===1||c==="...").map(([c])=>c).join("");else if(!o.match(RegExp(ou)))throw new Error("Invalid RHS");o.match(RegExp(Nc,"g"))?.forEach(c=>{if(c==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let h=this.symbolToInfo.get(c);if(h===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(h.dimValue)}}),this.rhs=this.processTerm(o,!1,this.outputDims)}addSymbol(e,r,a){let o=this.symbolToInfo.get(e);if(o!==void 0){if(o.dimValue!==r&&o.count!==1)throw new Error("Dimension mismatch");o.count++,o.inputIndices.push(a)}else o={count:1,dimValue:r,inputIndices:[a]};this.symbolToInfo.set(e,o)}processTerm(e,r,a,o=-1){let c=a.length,h=!1,m=[],x=0;if(!e.match(RegExp(z0))&&!r&&e!=="")throw new Error("Invalid LHS term");let _=e.match(RegExp(Nc,"g")),y=new Zx(o);return _?.forEach((S,R)=>{if(S==="..."){if(h)throw new Error("Only one ellipsis is allowed per input term");h=!0;let B=c-_.length+1;if(B<0)throw new Error("Ellipsis out of bounds");if(m=a.slice(x,x+B),this.hasEllipsis){if(this.ellipsisDims.length!==m.length||this.ellipsisDims.toString()!==m.toString())throw new Error("Ellipsis dimensions mismatch")}else if(r)this.hasEllipsis=!0,this.ellipsisDims=m;else throw new Error("Ellipsis must be specified in the LHS");for(let N=0;N<m.length;N++){let k=String.fromCharCode(48+N);y.addSymbol(k,R+N),this.addSymbol(k,a[x++],o)}}else y.addSymbol(S,R+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(S,a[x++],o)}),y}},U0=e=>e+"_max",ey=(e,r,a,o)=>{let c=e.map(y=>y.length).map((y,S)=>Ke(`input${S}`,r,y)),h=Ve.size(o),m=Pt("output",r,o.length),x=[...a.symbolToInfo.keys()].filter(y=>!a.rhs.symbolToIndices.has(y)),_=y=>{let S=[],R="var prod = 1.0;",B="var sum = 0.0;",N="sum += prod;",k=[],z=[],X=[],j=[],F=a.symbolToInfo.size===a.rhs.symbolToIndices.size;a.symbolToInfo.forEach((Q,oe)=>{if(a.rhs.symbolToIndices.has(oe)){let ue=a.rhs.symbolToIndices.get(oe)?.[0];ue!==void 0&&a.lhs.forEach((ee,ce)=>{if(Q.inputIndices.includes(ce)){let le=ee.symbolToIndices.get(oe);if(le===void 0)throw new Error("Invalid symbol error");le.forEach(Qe=>{S.push(`${c[ce].indicesSet(`input${ce}Indices`,Qe,m.indicesGet("outputIndices",ue))}`)})}})}else a.lhs.forEach((ue,ee)=>{if(Q.inputIndices.includes(ee)){let ce=ue.symbolToIndices.get(oe);if(ce===void 0)throw new Error("Invalid symbol error");ce.forEach(le=>{k.push(`${c[ee].indicesSet(`input${ee}Indices`,le,`${oe}`)}`)}),j.push(`prod *= ${c[ee].getByIndices(`input${ee}Indices`)};`)}}),z.push(`for(var ${oe}: u32 = 0; ${oe} < uniforms.${U0(oe)}; ${oe}++) {`),X.push("}")});let te=F?[...S,`let sum = ${c.map((Q,oe)=>Q.getByIndices(`input${oe}Indices`)).join(" * ")};`]:[...S,B,...z,...k,R,...j,N,...X];return`
            ${y.registerUniforms(x.map(Q=>({name:`${U0(Q)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...c,m)}

            ${y.mainStart()}
            ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${m.offsetToIndices("global_idx")};
            ${c.map((Q,oe)=>`var input${oe}Indices: ${c[oe].type.indices};`).join(`
`)}
            ${te.join(`
`)};
            ${m.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:a.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let y=x.filter(R=>a.symbolToInfo.has(R)).map(R=>({type:12,data:a.symbolToInfo.get(R)?.dimValue||0}));y.push({type:12,data:h});let S=e.map((R,B)=>[...Kt(R)]).reduce((R,B)=>R.concat(B),y);return S.push(...Kt(o)),{outputs:[{dims:o,dataType:r}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:S}},getShaderSource:_}},a_=(e,r)=>{let a=new Jx(e.inputs,r.equation),o=a.outputDims,c=e.inputs.map((h,m)=>h.dims);e.compute(ey(c,e.inputs[0].dataType,a,o))},s_=e=>{let r=e.equation.replace(/\s+/g,"");return tr({equation:r})}}),ty,P0,ny,ry,o_,cT=gt(()=>{fn(),vn(),An(),ty=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let r=e[0].dims,a=Array.from(e[1].getBigInt64Array(),Number),o=a.length<r.length?0:a.length-r.length,c=r.length<a.length?0:r.length-a.length;for(;o<a.length&&c<r.length;++o,++c)if(a[o]!==r[c]&&a[o]!==1&&r[c]!==1)throw new Error("Expand requires shape to be broadcastable to input")},P0=(e,r)=>{let a=e.length-r.length,o=[];for(let c=0;c<a;++c)o.push(e[c]);for(let c=0;c<r.length;++c)o.push(r[c]===1?e[c+a]:r[c]);return o},ny=(e,r)=>e.length>r.length?P0(e,r):P0(r,e),ry=e=>{let r=e[0].dims,a=Array.from(e[1].getBigInt64Array(),Number),o=ny(r,a),c=e[0].dataType,h=c===9||Ve.size(r)===1,m=c===9||r.length>0&&r[r.length-1]%4===0?4:1,x=h||o.length>0&&o[o.length-1]%4===0?4:1,_=Math.ceil(Ve.size(o)/x),y=R=>{let B=Ke("input",c,r.length,m),N=Pt("output",c,o.length,x),k;if(c===9){let z=(X,j,F="")=>`
          let outputIndices${j} = ${N.offsetToIndices(`outputOffset + ${j}u`)};
          let offset${j} = ${B.broadcastedIndicesToOffset(`outputIndices${j}`,N)};
          let index${j} = offset${j} / 4u;
          let component${j} = offset${j} % 4u;
          ${X}[${j}] = ${F}(${B.getByOffset(`index${j}`)}[component${j}]);
        `;k=`
        let outputOffset = global_idx * ${x};
        var data = vec4<u32>(0);
        ${z("data",0,"u32")}
        ${z("data",1,"u32")}
        ${z("data",2,"u32")}
        ${z("data",3,"u32")}
        ${N.setByOffset("global_idx","data")}
      }`}else k=`
        let outputIndices = ${N.offsetToIndices(`global_idx * ${x}`)};
        let inputOffset = ${B.broadcastedIndicesToOffset("outputIndices",N)};
        let data = ${N.type.value}(${B.getByOffset(`inputOffset / ${m}`)});
        ${N.setByOffset("global_idx","data")}
      }`;return`
    ${R.registerUniform("vec_size","u32").declareVariables(B,N)}
    ${R.mainStart()}
    ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${k}`},S=[{type:12,data:_},...Kt(r,o)];return{name:"Expand",shaderCache:{hint:`${o.length};${m}${x}`,inputDependencies:["rank"]},getShaderSource:y,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:S})}},o_=e=>{ty(e.inputs),e.compute(ry(e.inputs),{inputs:[0]})}}),iy,l_,fT=gt(()=>{fn(),vn(),An(),a1(),iy=e=>{let r=e[0].dataType,a=Ve.size(e[0].dims),o=Ve.size(e[1].dims),c=o%4===0,h=m=>{let x=Ke("x",r,[1],4),_=Ke("bias",r,[1],4),y=Pt("y",r,[1],4),S=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],R=N=>`
      let bias${N}_offset: u32 = (global_idx * 4 + ${N}) % uniforms.bias_size;
      let bias${N} = ${_.getByOffset(`bias${N}_offset / 4`)}[bias${N}_offset % 4];`,B=c?`
      let bias = ${_.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${R(0)}${R(1)}${R(2)}${R(3)}
      let bias = ${x.type.value}(bias0, bias1, bias2, bias3);`;return`${m.registerUniforms(S).declareVariables(x,_,y)}

    ${Sh(Ei(r))}

    ${m.mainStart(yl)}
      ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${x.getByOffset("global_idx")};
      ${B}
      let x_in = x + bias;
      ${y.setByOffset("global_idx",Ih("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${c}`,inputDependencies:["type","type"]},getShaderSource:h,getRunData:m=>({outputs:[{dims:m[0].dims,dataType:m[0].dataType}],programUniforms:[{type:12,data:Math.ceil(a/4)},{type:12,data:o}],dispatchGroup:{x:Math.ceil(a/yl/4)}})}},l_=e=>{e.inputs.length<2||Ve.size(e.inputs[1].dims)===0?Iv(e):e.compute(iy(e.inputs))}}),ay,sy,u_,c_,dT=gt(()=>{fn(),vn(),Ur(),An(),ay=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},sy=(e,r)=>{let a=e[0].dims,o=e[1].dims,c=a.length,h=Ve.normalizeAxis(r.axis,c),m=a.slice(0);m.splice(h,1,...o);let x=a[h],_=e[0].dataType===9?4:1,y=Math.ceil(Ve.size(m)/_),S=[{type:12,data:y},{type:6,data:x},{type:12,data:h},...Kt(e[0].dims,e[1].dims,m)],R=B=>{let N=Ke("data",e[0].dataType,e[0].dims.length,_),k=Ke("inputIndices",e[1].dataType,e[1].dims.length),z=Pt("output",e[0].dataType,m.length,_),X=F=>{let te=o.length,Q=`var indicesIndices${F}  = ${k.type.indices}(0);`;for(let oe=0;oe<te;oe++)Q+=`${te>1?`indicesIndices${F}[${oe}]`:`indicesIndices${F}`} = ${m.length>1?`outputIndices${F}[uniforms.axis + ${oe}]`:`outputIndices${F}`};`;Q+=`
          var idx${F} = ${k.getByIndices(`indicesIndices${F}`)};
          if (idx${F} < 0) {
            idx${F} = idx${F} + uniforms.axisDimLimit;
          }
          var dataIndices${F} : ${N.type.indices};
        `;for(let oe=0,ue=0;oe<c;oe++)oe===h?(Q+=`${c>1?`dataIndices${F}[${oe}]`:`dataIndices${F}`} = u32(idx${F});`,ue+=te):(Q+=`${c>1?`dataIndices${F}[${oe}]`:`dataIndices${F}`} = ${m.length>1?`outputIndices${F}[${ue}]`:`outputIndices${F}`};`,ue++);return Q},j;if(e[0].dataType===9){let F=(te,Q,oe="")=>`
          let outputIndices${Q} = ${z.offsetToIndices(`outputOffset + ${Q}u`)};
          ${X(Q)};
          let offset${Q} = ${N.indicesToOffset(`dataIndices${Q}`)};
          let index${Q} = offset${Q} / 4u;
          let component${Q} = offset${Q} % 4u;
          ${te}[${Q}] = ${oe}(${N.getByOffset(`index${Q}`)}[component${Q}]);
        `;j=`
        let outputOffset = global_idx * ${_};
        var value = vec4<u32>(0);
        ${F("value",0,"u32")}
        ${F("value",1,"u32")}
        ${F("value",2,"u32")}
        ${F("value",3,"u32")}
        ${z.setByOffset("global_idx","value")}
      `}else j=`
      let outputIndices = ${z.offsetToIndices("global_idx")};
      ${X("")};
      let value = ${N.getByIndices("dataIndices")};
      ${z.setByOffset("global_idx","value")};
      `;return`
      ${B.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(N,k,z)}
      ${B.mainStart()}
        ${B.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${j}
      }`};return{name:"Gather",shaderCache:{hint:r.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:m,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:S}),getShaderSource:R}},u_=e=>tr({axis:e.axis}),c_=(e,r)=>{let a=e.inputs;ay(a),e.compute(sy(e.inputs,r))}}),oy,f_,d_,hT=gt(()=>{fn(),vn(),An(),oy=(e,r,a,o,c,h,m,x,_)=>{let y=[{type:12,data:h},{type:12,data:o},{type:12,data:c},{type:12,data:a},{type:12,data:m},{type:12,data:x},{type:12,data:_}],S=[h];y.push(...Kt(r.dims,S));let R=B=>{let N=Ke("indices_data",r.dataType,r.dims.length),k=Pt("input_slice_offsets_data",12,1,1),z=[N,k],X=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:c.length},{name:"sizes_from_slice_dims_data",type:"u32",length:a.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${B.registerUniforms(X).declareVariables(...z)}
  ${B.mainStart()}
    ${B.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${c.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${a.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${c.length}_${a.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:S,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:y}),getShaderSource:R},{inputs:[r],outputs:[-1]})[0]},f_=(e,r)=>{let a=e.inputs,o=a[0].dims,c=a[0].dataType,h=a[1].dims,m=h[h.length-1],x=Ve.sizeToDimension(h,h.length-1),_=Ve.sizeFromDimension(o,r.batchDims+m),y=Ve.sizeToDimension(o,r.batchDims),S=Ve.sizeFromDimension(o,r.batchDims),R=x/y,B=new Array(m),N=_;for(let Q=0;Q<m;++Q)B[m-1-Q]=N,N*=o[r.batchDims+m-1-Q];let k=oy(e,a[1],B,r.batchDims,o,x,R,S,m),z=r.batchDims+m;if(z>o.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let X=h.slice(0,-1).concat(o.slice(z)),j=Ve.size(X),F=[{type:12,data:j},{type:12,data:_},...Kt(a[0].dims,k.dims,X)],te=Q=>{let oe=Ke("data",a[0].dataType,a[0].dims.length),ue=Ke("slice_offsets",12,k.dims.length),ee=Pt("output",a[0].dataType,X.length);return`
          ${Q.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(oe,ue,ee)}
            ${Q.mainStart()}
            ${Q.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:r.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:X,dataType:c}],dispatchGroup:{x:Math.ceil(j/64)},programUniforms:F}),getShaderSource:te},{inputs:[a[0],k]})},d_=e=>({batchDims:e.batch_dims,cacheKey:""})}),ly,uy,h_,p_,pT=gt(()=>{fn(),vn(),Ur(),An(),ly=(e,r)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let a=Ve.normalizeAxis(r.quantizeAxis,e[0].dims.length),o=r.blockSize,c=e[0],h=e[2],m=e.length===4?e[3]:void 0;if(h.dims.length!==c.dims.length||!c.dims.map((x,_)=>_===a?Math.ceil(x/o)===h.dims[_]:x===h.dims[_]).reduce((x,_)=>x&&_,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(m){if(m.dataType!==c.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(m.dims.length!==h.dims.length||!m.dims.map((x,_)=>x===h.dims[_]).reduce((x,_)=>x&&_,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},uy=(e,r)=>{let a=e[0].dims,o=e[1].dims,c=a.length,h=Ve.normalizeAxis(r.gatherAxis,c),m=Ve.normalizeAxis(r.quantizeAxis,c),x=a.slice(0);x.splice(h,1,...o);let _=Ve.size(x),y=e[2].dataType,S=e[0].dataType===22,R=[{type:12,data:_},{type:12,data:m},{type:12,data:h},{type:12,data:r.blockSize},...Kt(...e.map((N,k)=>N.dims),x)],B=N=>{let k=Ke("data",e[0].dataType,e[0].dims.length),z=Ke("inputIndices",e[1].dataType,e[1].dims.length),X=Ke("scales",e[2].dataType,e[2].dims.length),j=e.length>3?Ke("zeroPoint",e[3].dataType,e[3].dims.length):void 0,F=Pt("output",y,x.length),te=[k,z,X];j&&te.push(j);let Q=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${N.registerUniforms(Q).declareVariables(...te,F)}
        ${N.mainStart()}
        let output_indices = ${F.offsetToIndices("global_idx")};
        var indices_indices = ${z.type.indices}(0);
        ${o.length>1?`
          for (var i: u32 = 0; i < ${o.length}; i++) {
            let index = ${F.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${z.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${F.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${k.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${F.indicesGet("output_indices","i")};
          ${k.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${z.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${a[h]};
        }
        ${k.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${x.length}; i++) {
          let index = ${F.indicesGet("output_indices",`i + ${o.length} - 1`)};
          ${k.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${k.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${k.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${S?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${X.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${X.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${X.getByIndices("scale_indices")};
        ${j?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${j.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${j.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${S?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${Ei(y)}(quantized_data - zero_point) * scale;
        ${F.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${r.cacheKey};${e.filter((N,k)=>k!==1).map(N=>N.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(N,k)=>"rank")},getRunData:()=>({outputs:[{dims:x,dataType:y}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:R}),getShaderSource:B}},h_=(e,r)=>{let a=e.inputs;ly(a,r),e.compute(uy(e.inputs,r))},p_=e=>tr({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),cy,fy,g_,m_,gT=gt(()=>{fn(),vn(),Ur(),An(),cy=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},fy=(e,r)=>{let a=e[0].dims,o=e[0].dataType,c=a.length,h=e[1].dims,m=e[1].dataType,x=Ve.normalizeAxis(r.axis,c),_=a[x],y=h.slice(0),S=Ve.size(y),R=Ke("input",o,c),B=Ke("indicesInput",m,h.length),N=Pt("output",o,y.length),k=[{type:12,data:S},{type:6,data:_},{type:12,data:x}];return k.push(...Kt(a,h,y)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:y,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(S/64)},programUniforms:k}),getShaderSource:z=>`
      ${z.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(R,B,N)}
      ${z.mainStart()}
      ${z.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${N.offsetToIndices("global_idx")};

      var idx = ${B.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${R.type.indices}(outputIndices);
      ${R.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${R.getByIndices("inputIndices")};

      ${N.setByOffset("global_idx","value")};
  }`}},g_=e=>tr({axis:e.axis}),m_=(e,r)=>{let a=e.inputs;cy(a),e.compute(fy(e.inputs,r))}}),dy,hy,x_,y_,mT=gt(()=>{fn(),vn(),An(),dy=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},hy=(e,r)=>{let a=e[0].dims.slice(),o=e[1].dims.slice(),[c,h,m]=g3.getShapeOfGemmResult(a,r.transA,o,r.transB,e.length===3?e[2].dims:void 0),x=[c,h];if(!x)throw new Error("Can't use gemm on the given tensors");let _=16,y=Math.ceil(h/_),S=Math.ceil(c/_),R=!0,B=Ve.size(x),N=[{type:12,data:R?y:B},{type:12,data:c},{type:12,data:h},{type:12,data:m},{type:1,data:r.alpha},{type:1,data:r.beta}],k=["type","type"];e.length===3&&(N.push(...Kt(e[2].dims)),k.push("rank")),N.push(...Kt(x));let z=j=>{let F="";r.transA&&r.transB?F="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":r.transA&&!r.transB?F="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!r.transA&&r.transB?F="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!r.transA&&!r.transB&&(F="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let te=r.alpha===1?"":"value *= uniforms.alpha;",Q=Ke("a",e[0].dataType,e[0].dims),oe=Ke("b",e[1].dataType,e[1].dims),ue=Q.type.value,ee=null,ce=[Q,oe];e.length===3&&(ee=Ke("c",e[2].dataType,e[2].dims.length),ce.push(ee));let le=Pt("output",e[0].dataType,x.length);ce.push(le);let Qe=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${j.registerUniforms(Qe).declareVariables(...ce)}

  ${j.mainStart()}
    ${j.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${ue}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${F}
    }

    ${te}
    ${ee!=null?`let cOffset = ${ee.broadcastedIndicesToOffset("vec2(m, n)",le)}; value += ${ue}(uniforms.beta) * ${ee.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},X=j=>{let F=Ke("a",e[0].dataType,e[0].dims),te=Ke("b",e[1].dataType,e[1].dims),Q=null,oe=[F,te];e.length===3&&(Q=Ke("c",e[2].dataType,e[2].dims.length),oe.push(Q));let ue=Pt("output",e[0].dataType,x.length);oe.push(ue);let ee=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],ce="",le="";r.transA&&r.transB?(le=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${F.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${te.type.value}(0);
      }
      `,ce="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):r.transA&&!r.transB?(le=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${F.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${te.type.value}(0);
      }
      `,ce="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!r.transA&&r.transB?(le=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${F.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${te.type.value}(0);
      }
      `,ce="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!r.transA&&!r.transB&&(le=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${F.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${te.type.value}(0);
      }
      `,ce="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let Qe=r.alpha===1?"":"value *= uniforms.alpha;";return`
  ${j.registerUniforms(ee).declareVariables(...oe)}
  var<workgroup> tile_a: array<array<${F.type.storage}, ${_}>, ${_}>;
  var<workgroup> tile_b: array<array<${te.type.storage}, ${_}>, ${_}>;
  ${j.mainStart([_,_,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${_};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${_};
    let num_tiles = (uniforms.K - 1) / ${_} + 1;
    var k_start = 0u;
    var value = ${ue.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${le}
      k_start = k_start + ${_};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${_}; k++) {
        ${ce}
      }
      workgroupBarrier();
    }

    ${Qe}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${Q!=null?`let cOffset = ${Q.broadcastedIndicesToOffset("vec2(m, n)",ue)}; value += ${ue.type.value}(uniforms.beta) * ${Q.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return R?{name:"GemmShared",shaderCache:{hint:`${r.cacheKey}`,inputDependencies:k},getRunData:()=>({outputs:[{dims:x,dataType:e[0].dataType}],dispatchGroup:{x:y*S},programUniforms:N}),getShaderSource:X}:{name:"Gemm",shaderCache:{hint:`${r.cacheKey}`,inputDependencies:k},getRunData:()=>({outputs:[{dims:x,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(B/64)},programUniforms:N}),getShaderSource:z}},x_=e=>{let r=e.transA,a=e.transB,o=e.alpha,c=e.beta;return{transA:r,transB:a,alpha:o,beta:c,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},y_=(e,r)=>{dy(e.inputs),e.compute(hy(e.inputs,r))}}),rs,As,Eo,To,py,gy,my,xy,yy,wy,by,vy,w_,b_,xT=gt(()=>{fn(),vn(),Ur(),An(),[rs,As,Eo,To]=[0,1,2,3],py=e=>{if(e[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},gy=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,my=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,xy=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${e.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,yy=e=>`
  ${e.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,wy=(e,r,a)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${r} {
     var pixel = ${r}(0);
     var indices = vec4<u32>(0);
     indices[${rs}] = batch;
     indices[${As}] = channel;`+(()=>{switch(a.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Eo}] = u32(r);
            indices[${To}] = u32(c);
          } else {
            return ${r}(0);
          }
        `;case"border":return`
          indices[${Eo}] = u32(clamp(r, 0, H - 1));
          indices[${To}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Eo}] = gs_reflect(r, border[1], border[3]);
          indices[${To}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${a.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,by=(e,r,a)=>(()=>{switch(a.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${rs}], indices[${As}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${rs}], indices[${As}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${rs}], indices[${As}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${rs}], indices[${As}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${rs}], indices[${As}], border);

          let dx2 = ${r}(f32(x2) - x);
          let dx1 = ${r}(x - f32(x1));
          let dy2 = ${r}(f32(y2) - y);
          let dy1 = ${r}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${r}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${rs}], indices[${As}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${a.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,vy=(e,r)=>{let a=Ke("x",e[0].dataType,e[0].dims.length),o=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],c=Ke("grid",e[1].dataType,o.length,2),h=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];r.format==="NHWC"&&(h=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[rs,As,Eo,To]=[0,3,1,2]);let m=Pt("output",e[0].dataType,h.length),x=a.type.value,_=Ve.size(h),y=[{type:12,data:_},...Kt(e[0].dims,o,h)],S=R=>`
  ${R.registerUniform("output_size","u32").declareVariables(a,c,m)}
  ${gy}
  ${my(x)}
  ${xy(r)}
  ${yy(r)}
  ${wy(a,x,r)}

  ${R.mainStart()}
    ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Eo}]);
      let W_in = i32(uniforms.x_shape[${To}]);

      ${r.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${m.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${rs}], indices[${Eo}], indices[${To}]);
      let nxy = ${c.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${by(m,x,r)}
  }`;return{name:"GridSample",shaderCache:{hint:`${r.cacheKey}`,inputDependencies:["type","type"]},getRunData:R=>{let B=Ve.size(h);return{outputs:[{dims:h,dataType:R[0].dataType}],dispatchGroup:{x:Math.ceil(B/64)},programUniforms:y}},getShaderSource:S}},w_=(e,r)=>{py(e.inputs),e.compute(vy(e.inputs,r))},b_=e=>tr({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),Di,_y,v_,F0,Cy,bu,__,C_=gt(()=>{fn(),vn(),Ur(),t1(),i1(),An(),lo(),Di=(e,r)=>e.length>r&&e[r].dims.length>0?e[r]:void 0,_y=(e,r)=>{let a=e[0],o=Di(e,1),c=Di(e,2),h=Di(e,3),m=Di(e,4),x=Di(e,5),_=Di(e,6),y=Di(e,7);if(a.dims.length!==3&&a.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let S=a.dims[0],R=a.dims[1],B=a.dims.length===3?a.dims[2]:r.numHeads*a.dims[4],N=R,k=0,z=0,X=Math.floor(B/r.numHeads);if(_&&y&&Ve.size(_.dims)&&Ve.size(y.dims)){if(_.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(_.dims[0]!==S||_.dims[1]!==r.numHeads||_.dims[3]!==X)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(y.dims[0]!==S||y.dims[1]!==r.numHeads||y.dims[3]!==X)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(_.dims[2]!==y.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(y.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');k=_.dims[2],z=_.dims[2]}else if(_&&Ve.size(_.dims)||y&&Ve.size(y.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let j;if(o&&Ve.size(o.dims)>0){if(a.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(o.dims.length<3||o.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(a.dims[0]!==o.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(o.dims.length===3){if(o.dims[2]!==a.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');j=2,N=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==r.numHeads||o.dims[3]!==2||o.dims[4]!==X)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(c)throw new Error('Expect "value" be none when "key" has packed kv format.');j=5,N=o.dims[1]}else{if(o.dims[1]!==r.numHeads||o.dims[3]!==X)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');j=0,N=o.dims[2]}}else{if(a.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(a.dims[2]!==r.numHeads||a.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');j=3}if(h&&Ve.size(h.dims)>0){if(h.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(o&&o.dims.length===5&&o.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let F=k+N,te=0;if(m&&Ve.size(m.dims)>0){te=8;let ee=m.dims;throw ee.length===1?ee[0]===S?te=1:ee[0]===3*S+2&&(te=3):ee.length===2&&ee[0]===S&&ee[1]===F&&(te=5),te===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let Q=!1,oe=B;if(c&&Ve.size(c.dims)>0){if(c.dims.length!==3&&c.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(a.dims[0]!==c.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(c.dims.length===3){if(N!==c.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');oe=c.dims[2]}else{if(N!==c.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');oe=c.dims[1]*c.dims[3],Q=!0}}let ue=!1;if(m&&Ve.size(m.dims)>0)throw new Error("Key padding mask is not supported");if(x&&Ve.size(x.dims)>0){if(x.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(x.dims[0]!==S||x.dims[1]!==r.numHeads||x.dims[2]!==R||x.dims[3]!==F)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:S,sequenceLength:R,pastSequenceLength:k,kvSequenceLength:N,totalSequenceLength:F,maxSequenceLength:z,inputHiddenSize:0,hiddenSize:B,vHiddenSize:oe,headSize:X,vHeadSize:Math.floor(oe/r.numHeads),numHeads:r.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:r.maskFilterValue,maskType:te,scale:r.scale,broadcastResPosBias:ue,passPastInKv:Q,qkvFormat:j}},v_=e=>tr({...e}),F0=tr({perm:[0,2,1,3]}),Cy=(e,r,a,o,c,h,m)=>{let x=[o,c,h],_=Ve.size(x),y=[{type:12,data:_},{type:12,data:m},{type:12,data:h}],S=R=>{let B=Pt("qkv_with_bias",r.dataType,x),N=Ke("qkv",r.dataType,x),k=Ke("bias",a.dataType,x),z=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${R.registerUniforms(z).declareVariables(N,k,B)}
  ${R.mainStart()}
    ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:x,dataType:r.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:y}),getShaderSource:S},{inputs:[r,a],outputs:[-1]})[0]},bu=(e,r,a,o,c,h,m,x)=>{let _=h;if(m&&Ve.size(m.dims)>0){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return _=Cy(e,h,m,r,o,a*c,x),_=_.reshape([r,o,a,c]),a===1||o===1?_:e.compute(la(_,F0.perm),{inputs:[_],outputs:[-1]})[0]}else return h.dims.length===3&&(_=h.reshape([r,o,a,c])),a===1||o===1?_:e.compute(la(_,F0.perm),{inputs:[_],outputs:[-1]})[0]},__=(e,r)=>{let a=_y(e.inputs,r),o=e.inputs[0],c=Di(e.inputs,1),h=Di(e.inputs,2),m=Di(e.inputs,3),x=Di(e.inputs,4),_=Di(e.inputs,5),y=Di(e.inputs,6),S=Di(e.inputs,7);if(o.dims.length===5)throw new Error("Packed QKV is not implemented");if(c?.dims.length===5)throw new Error("Packed KV is not implemented");let R=c&&h&&c.dims.length===4&&h.dims.length===4,B=bu(e,a.batchSize,a.numHeads,a.sequenceLength,a.headSize,o,m,0);if(R)return Cu(e,B,c,h,x,void 0,y,S,_,a);if(!c||!h)throw new Error("key and value must be provided");let N=bu(e,a.batchSize,a.numHeads,a.kvSequenceLength,a.headSize,c,m,a.hiddenSize),k=bu(e,a.batchSize,a.numHeads,a.kvSequenceLength,a.vHeadSize,h,m,2*a.hiddenSize);Cu(e,B,N,k,x,void 0,y,S,_,a)}}),Ay,Ey,Ty,Sy,Bh,A_,E_,T_=gt(()=>{fn(),vn(),Ur(),An(),Ay=e=>{if(!e||e.length<1)throw new Error("too few inputs")},Ey=(e,r)=>{let a=[],o=r.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(c=>a.push(Number(c))),o=a.length),tr({numOutputs:o,axis:r.axis,splitSizes:a})},Ty=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${Yt("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,Sy=e=>{let r=e.length,a=[];for(let o=0;o<r;++o){let c=e[o].setByIndices("indices","input[global_idx]");r===1?a.push(c):o===0?a.push(`if (output_number == ${o}u) { ${c} }`):o===r-1?a.push(`else { ${c} }`):a.push(`else if (output_number == ${o}) { ${c} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${a.join(`
`)}
      }`},Bh=(e,r)=>{let a=e[0].dims,o=Ve.size(a),c=e[0].dataType,h=Ve.normalizeAxis(r.axis,a.length),m=new Array(r.numOutputs),x=Ke("input",c,a.length),_=new Array(r.numOutputs),y=[],S=[],R=0,B=[{type:12,data:o}];for(let k=0;k<r.numOutputs;k++){R+=r.splitSizes[k],_[k]=R;let z=a.slice();z[h]=r.splitSizes[k],S.push(z),m[k]=Pt(`output${k}`,c,z.length),y.push({dims:S[k],dataType:e[0].dataType})}B.push({type:12,data:_},...Kt(a,...S));let N=k=>`
  ${k.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",_.length).declareVariables(x,...m)}
  ${Ty(_.length)}
  ${Sy(m)}

  ${k.mainStart()}
    ${k.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${x.offsetToIndices("global_idx")};
    var index = ${x.indicesGet("indices",h)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${Yt("uniforms.size_in_split_axis","output_number - 1u",_.length)};
      ${x.indicesSet("indices",h,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:r.cacheKey,inputDependencies:["rank"]},getShaderSource:N,getRunData:()=>({outputs:y,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:B})}},A_=(e,r)=>{Ay(e.inputs);let a=e.inputs.length===1?r:Ey(e.inputs,r);e.compute(Bh(e.inputs,a),{inputs:[0]})},E_=e=>{let r=e.axis,a=e.splitSizes,o=e.numOutputs<0?a.length:e.numOutputs;if(o!==a.length)throw new Error("numOutputs and splitSizes length must be equal");return tr({axis:r,numOutputs:o,splitSizes:a})}}),Iy,of,S_,I_=gt(()=>{fn(),vn(),Ur(),An(),Iy=(e,r)=>{let[a,o,c,h]=e,{numHeads:m,rotaryEmbeddingDim:x}=r;if(a.dims.length!==3&&a.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${a.dims.length}`);if(!Ve.areEqual(o.dims,[])&&!Ve.areEqual(o.dims,[1])&&o.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${o.dims.length}`);if(c.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${c.dims.length}`);if(h.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${h.dims.length}`);if(!Ve.areEqual(c.dims,h.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(x>0&&m===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let _=a.dims[0],y=a.dims[a.dims.length-2],S=c.dims[0],R=Ve.sizeFromDimension(a.dims,1)/y,B=x===0?c.dims[1]*2:R/m;if(x>B)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(o.dims.length===2){if(_!==o.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${o.dims[0]}`);if(y!==o.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${o.dims[1]}`)}if(B/2!==c.dims[1]&&x/2!==c.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${c.dims[1]}`);if(y>S)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},of=(e,r)=>{let{interleaved:a,numHeads:o,rotaryEmbeddingDim:c,scale:h}=r,m=e[0].dims[0],x=Ve.sizeFromDimension(e[0].dims,1),_=e[0].dims[e[0].dims.length-2],y=x/_,S=e[2].dims[1],R=c===0?S*2:y/o,B=new Array(m,_,y/R,R-S),N=Ve.computeStrides(B),k=[{type:1,data:h},{type:12,data:B},{type:12,data:N},...e[0].dims.length===3?new Array({type:12,data:[x,y,R,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[x,R,_*R,1]}):[],...Kt(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],z=X=>{let j=Ke("input",e[0].dataType,e[0].dims.length),F=Ke("position_ids",e[1].dataType,e[1].dims.length),te=Ke("cos_cache",e[2].dataType,e[2].dims.length),Q=Ke("sin_cache",e[3].dataType,e[3].dims.length),oe=Pt("output",e[0].dataType,e[0].dims.length);return X.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:B.length},{name:"global_strides",type:"u32",length:N.length},{name:"input_output_strides",type:"u32",length:N.length}]),`
        ${X.declareVariables(j,F,te,Q,oe)}

        ${X.mainStart(yl)}
          let half_rotary_emb_dim = uniforms.${te.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${X.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${F.broadcastedIndicesToOffset("bsnh.xy",Pt("",F.type.tensor,2))};
            let position_id =
                u32(${F.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${a});
            let j = i + select(half_rotary_emb_dim, 1, ${a});
            let re = ${j.getByOffset("i")} * ${te.get("position_id","bsnh[3]")} -
                ${j.getByOffset("j")} * ${Q.get("position_id","bsnh[3]")};
            ${oe.setByOffset("i","re")}
            let im = ${j.getByOffset("i")} * ${Q.get("position_id","bsnh[3]")} +
                ${j.getByOffset("j")} * ${te.get("position_id","bsnh[3]")};
            ${oe.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${oe.setByOffset("k",j.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:tr({interleaved:a}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:z,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(Ve.size(B)/yl)},programUniforms:k})}},S_=(e,r)=>{Iy(e.inputs,r),e.compute(of(e.inputs,r))}}),Ry,Oy,G0,Dy,R_,yT=gt(()=>{Ur(),fn(),i1(),C_(),T_(),lo(),I_(),An(),Ry=(e,r)=>{if(r.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let a=e[0],o=e[1],c=e[2],h=e[3],m=e[4];if(r.doRotary!==0&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(r.localWindowSize!==-1)throw new Error("Local attention is not supported");if(r.softcap!==0)throw new Error("Softcap is not supported");if(r.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(r.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(a.dims.length!==3&&a.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let x=!1,_=a.dims[0],y=a.dims[1],S=a.dims.length===3?x?a.dims[2]/3:a.dims[2]:r.numHeads*a.dims[4],R=y,B=0,N=!o||o.dims.length===0,k=Math.floor(N?S/(r.numHeads+2*r.kvNumHeads):S/r.numHeads);N&&(S=k*r.numHeads);let z=h&&h.dims.length!==0,X=m&&m.dims.length!==0;if(z&&h.dims.length===4&&h.dims[0]===_&&h.dims[1]!==r.kvNumHeads&&h.dims[2]===r.kvNumHeads&&h.dims[3]===k)throw new Error("BSNH pastKey/pastValue is not supported");if(z&&X){if(h.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(m.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');B=h.dims[2]}else if(z||X)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let j=1;if(o&&o.dims.length>0){if(a.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(o.dims.length<3||o.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(a.dims[0]!==o.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(o.dims.length===3){if(a.dims[2]%o.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');R=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==r.numHeads||o.dims[3]!==2||o.dims[4]!==k)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(c)throw new Error('Expect "value" be none when "key" has packed kv format.');R=o.dims[1]}else{if(o.dims[1]!==r.numHeads||o.dims[3]!==k)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');R=o.dims[2]}}else{if(a.dims.length!==3&&a.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(a.dims.length===5&&(a.dims[2]!==r.numHeads||a.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');j=3}let F=0,te=!1,Q=r.kvNumHeads?k*r.kvNumHeads:S;if(c&&c.dims.length>0){if(c.dims.length!==3&&c.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(a.dims[0]!==c.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(c.dims.length===3){if(R!==c.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');Q=c.dims[2]}else{if(R!==c.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');Q=c.dims[1]*c.dims[3],te=!0}}let oe=e.length>4?e[5]:void 0;if(oe&&oe.dims.length!==1&&oe.dims[0]!==_)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:_,sequenceLength:y,pastSequenceLength:B,kvSequenceLength:R,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:S,vHiddenSize:Q,headSize:k,vHeadSize:Math.floor(Q/r.kvNumHeads),numHeads:r.numHeads,kvNumHeads:r.kvNumHeads,nReps:r.numHeads/r.kvNumHeads,pastPresentShareBuffer:!1,maskType:F,scale:r.scale,broadcastResPosBias:!1,passPastInKv:te,qkvFormat:j}},Oy=tr({perm:[0,2,1,3]}),G0=(e,r,a)=>{let o=r,c=a.kvNumHeads;return r.dims.length===3&&a.kvSequenceLength!==0&&(o=r.reshape([a.batchSize,a.kvSequenceLength,c,a.headSize]),o=e.compute(la(o,Oy.perm),{inputs:[o],outputs:[-1]})[0]),o},Dy=(e,r,a,o)=>{let c=7,h=["type","type"],m=[e*r],x=e*r,_=[{type:12,data:x},{type:12,data:r},{type:12,data:e}],y=S=>{let R=Ke("seq_lens",a.dataType,a.dims),B=Ke("total_seq_lens",o.dataType,o.dims),N=Pt("pos_ids",c,m),k=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${S.registerUniforms(k).declareVariables(R,B,N)}
  ${S.mainStart()}
    ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${B.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${R.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${N.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${N.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${N.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${r}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:m,dataType:c}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:_}),getShaderSource:y}},R_=(e,r)=>{let a=Ry(e.inputs,r);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let o=e.inputs[0],c=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,h=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,m=e.inputs[3]&&e.inputs[3].dims.length!==0?e.inputs[3]:void 0,x=e.inputs[4]&&e.inputs[4].dims.length!==0?e.inputs[4]:void 0,_=e.inputs.length>4?e.inputs[5]:void 0,y=e.inputs.length>5?e.inputs[6]:void 0,S=a.kvNumHeads?a.kvNumHeads:a.numHeads,R=tr({axis:2,numOutputs:3,splitSizes:[a.numHeads*a.headSize,S*a.headSize,S*a.headSize]}),[B,N,k]=!c&&!h?e.compute(Bh([o],R),{inputs:[o],outputs:[-1,-1,-1]}):[o,c,h],z,X;if(r.doRotary){let Q=e.compute(Dy(a.batchSize,a.sequenceLength,_,y),{inputs:[_,y],outputs:[-1]})[0],oe=e.inputs[7],ue=e.inputs[8],ee=tr({interleaved:r.rotaryInterleaved!==0,numHeads:a.numHeads,rotaryEmbeddingDim:0,scale:r.scale}),ce=[B,Q,oe,ue],le=[-1];z=e.compute(of(ce,ee),{inputs:ce,outputs:le})[0],ce.splice(0,1,N);let Qe=tr({interleaved:r.rotaryInterleaved!==0,numHeads:a.kvNumHeads,rotaryEmbeddingDim:0,scale:r.scale});X=e.compute(of(ce,Qe),{inputs:ce,outputs:le})[0]}let j=bu(e,a.batchSize,a.numHeads,a.sequenceLength,a.headSize,r.doRotary?z:B,void 0,0),F=G0(e,r.doRotary?X:N,a),te=G0(e,k,a);Cu(e,j,F,te,void 0,void 0,m,x,void 0,a,_,y)}}),V0,My,By,O_,wT=gt(()=>{fn(),vn(),lo(),An(),V0=(e,r,a,o,c,h,m,x)=>{let _=$r(h),y=_===1?"f32":`vec${_}f`,S=_===1?"vec2f":`mat2x${_}f`,R=c*m,B=64;R===1&&(B=256);let N=[c,m,h/_],k=[c,m,2],z=["rank","type","type"],X=[];X.push(...Kt(N,k));let j=F=>{let te=Ke("x",r.dataType,3,_),Q=Ke("scale",a.dataType,a.dims),oe=Ke("bias",o.dataType,o.dims),ue=Pt("output",1,3,2),ee=[te,Q,oe,ue];return`
  var<workgroup> workgroup_shared : array<${S}, ${B}>;
  const workgroup_size = ${B}u;
  ${F.declareVariables(...ee)}
  ${F.mainStart(B)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${y}(0);
    var squared_sum = ${y}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${y}(${te.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${S}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${oo("workgroup_shared[0][0]",_)} / f32(hight * ${_});
      let squared_sum_final = ${oo("workgroup_shared[0][1]",_)} / f32(hight * ${_});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${x}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${_};${x};${B}`,inputDependencies:z},getRunData:()=>({outputs:[{dims:k,dataType:1}],dispatchGroup:{x:R},programUniforms:X}),getShaderSource:j},{inputs:[r,a,o],outputs:[-1]})[0]},My=(e,r,a)=>{let o=r[0].dims,c=o,h=2,m=o[0],x=o[1],_=Ve.sizeFromDimension(o,h),y=$r(_),S=Ve.size(c)/y,R=V0(e,r[0],r[1],r[2],m,_,x,a.epsilon),B=[m,x,_/y],N=[m,x],k=["type","none"],z=X=>{let j=Ke("x",r[0].dataType,B.length,y),F=Ke("scale_shift",1,N.length,2),te=Pt("output",r[0].dataType,B.length,y),Q=[j,F,te];return`
  ${X.registerUniform("output_size","u32").declareVariables(...Q)}
  ${X.mainStart()}
  ${X.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${te.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${F.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${j.getByOffset("global_idx")} * ${te.type.value}(scale_shift.x) + ${te.type.value}(scale_shift.y);
      ${te.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${y}`,inputDependencies:k},getRunData:()=>({outputs:[{dims:c,dataType:r[0].dataType}],dispatchGroup:{x:Math.ceil(S/64)},programUniforms:[{type:12,data:S},...Kt(B,N,B)]}),getShaderSource:z},{inputs:[r[0],R]})},By=(e,r,a)=>{let o=r[0].dims,c=o,h=o[0],m=o[o.length-1],x=Ve.sizeFromDimension(o,1)/m,_=$r(m),y=Ve.size(c)/_,S=[{type:12,data:x},{type:12,data:Math.floor(m/_)}],R=["type","type"],B=!1,N=[0,o.length-1];for(let j=0;j<o.length-2;j++)B=B||o[j+1]!==1,N.push(j+1);B=B&&o[o.length-1]!==1;let k=B?e.compute(la(e.inputs[0],N),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:o.length},(j,F)=>o[N[F]])),z=V0(e,k,r[1],r[2],h,x,m,a.epsilon),X=j=>{let F=ii(r[0].dataType),te=_===1?"vec2f":`mat${_}x2f`,Q=ee=>{let ce=ee===0?"x":"y",le=_===1?"f32":`vec${_}f`;switch(_){case 1:return`${F}(${le}(scale.${ce}))`;case 2:return`vec2<${F}>(${le}(scale[0].${ce}, scale[1].${ce}))`;case 4:return`vec4<${F}>(${le}(scale[0].${ce}, scale[1].${ce}, scale[2].${ce}, scale[3].${ce}))`;default:throw new Error(`Not supported compoents ${_}`)}},oe=Ke("input",r[0].dataType,r[0].dims,_),ue=Pt("output",r[0].dataType,c,_);return`
  @group(0) @binding(0) var<storage, read> input : array<${oe.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${te}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${ue.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${j.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${Q(0)}, ${Q(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${_}`,inputDependencies:R},getRunData:()=>({outputs:[{dims:c,dataType:r[0].dataType}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:S}),getShaderSource:X},{inputs:[r[0],z]})},O_=(e,r)=>{r.format==="NHWC"?By(e,e.inputs,r):My(e,e.inputs,r)}}),Ny,ky,D_,bT=gt(()=>{fn(),vn(),An(),Ny=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},ky=(e,r,a)=>{let o=r.simplified,c=e[0].dims,h=e[1],m=!o&&e[2],x=c,_=Ve.normalizeAxis(r.axis,c.length),y=Ve.sizeToDimension(c,_),S=Ve.sizeFromDimension(c,_),R=Ve.size(h.dims),B=m?Ve.size(m.dims):0;if(R!==S||m&&B!==S)throw new Error(`Size of X.shape()[axis:] == ${S}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${R} and bias size of ${B}`);let N=[];for(let oe=0;oe<c.length;++oe)oe<_?N.push(c[oe]):N.push(1);let k=$r(S),z=["type","type"],X=[{type:12,data:y},{type:1,data:S},{type:12,data:Math.floor(S/k)},{type:1,data:r.epsilon}];m&&z.push("type");let j=a>1,F=a>2,te=oe=>{let ue=ii(e[0].dataType),ee=[Ke("x",e[0].dataType,e[0].dims,k),Ke("scale",h.dataType,h.dims,k)];m&&ee.push(Ke("bias",m.dataType,m.dims,k)),ee.push(Pt("output",e[0].dataType,x,k)),j&&ee.push(Pt("mean_data_output",1,N)),F&&ee.push(Pt("inv_std_output",1,N));let ce=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${oe.registerUniforms(ce).declareVariables(...ee)}
  ${oe.mainStart()}
    ${oe.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${Ah("f32",k)};
    var mean_square_vector = ${Ah("f32",k)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${pl(ue,k,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${oo("mean_vector",k)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${oo("mean_square_vector",k)} / uniforms.norm_size ${o?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${pl(ue,k,"x[j + offset]")};
      let f32scale = ${pl(ue,k,"scale[j]")};
      output[j + offset] = ${ee[0].type.value}((f32input ${o?"":"- mean"}) * inv_std_dev * f32scale
        ${m?`+ ${pl(ue,k,"bias[j]")}`:""}
      );
    }

    ${j?"mean_data_output[global_idx] = mean":""};
    ${F?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},Q=[{dims:x,dataType:e[0].dataType}];return j&&Q.push({dims:N,dataType:1}),F&&Q.push({dims:N,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${k};${a};${o}`,inputDependencies:z},getRunData:()=>({outputs:Q,dispatchGroup:{x:Math.ceil(y/64)},programUniforms:X}),getShaderSource:te}},D_=(e,r)=>{Ny(e.inputs),e.compute(ky(e.inputs,r,e.outputCount))}}),$y,M_,vT=gt(()=>{vn(),u1(),c1(),$y=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},M_=e=>{$y(e.inputs);let r=xl.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!r)throw new Error("Can't use matmul on the given tensors");let a=r[r.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];if(a<8&&o<8)e.compute(l1(e.inputs,{activation:""},r));else{let c=r[r.length-2],h=Ve.size(e.inputs[0].dims.slice(0,-2)),m=Ve.size(e.inputs[1].dims.slice(0,-2));if(h!==1&&c===1&&m===1){let x=e.inputs[0].reshape([1,h,o]),_=e.inputs[1].reshape([1,o,a]),y=[1,h,a],S=[x,_];e.compute(sf(S,{activation:""},r,y),{inputs:S})}else e.compute(sf(e.inputs,{activation:""},r))}}}),Ly,zy,Uy,B_,N_,_T=gt(()=>{fn(),vn(),Ur(),An(),Ly=(e,r)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let a=e[0],o=a.dims.length;if(a.dims[o-1]!==r.k)throw new Error("The last dim of input shape does not match the k value");let c=Math.floor((r.k+r.blockSize-1)/r.blockSize),h=r.blockSize/8*r.bits,m=e[1];if(!Ve.areEqual(m.dims,[r.n,c,h]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let x=e[2].dims;if(Ve.size(x)!==r.n*c)throw new Error("scales input size error.");if(e.length===4){let _=e[3].dims,y=r.n*(r.bits===8?c:Math.floor((c*r.bits+7)/8));if(Ve.size(_)!==y)throw new Error("zeroPoints input size error.")}},zy=(e,r)=>{let a=e[0].dims,o=a.length,c=a[o-2],h=r.k,m=r.n,x=a.slice(0,o-2),_=Ve.size(x),y=e[1].dims[2]/4,S=e[0].dataType,R=$r(r.k),B=$r(y),N=$r(m),k=x.concat([c,m]),z=c>1&&m/N%2===0?2:1,X=Ve.size(k)/N/z,j=64,F=[],te=[_,c,h/R],Q=Ve.convertShape(e[1].dims).slice();Q.splice(-1,1,y/B),F.push(...Kt(te)),F.push(...Kt(Q)),F.push(...Kt(e[2].dims)),e.length===4&&F.push(...Kt(Ve.convertShape(e[3].dims)));let oe=[_,c,m/N];F.push(...Kt(oe));let ue=ee=>{let ce=te.length,le=Ke("a",e[0].dataType,ce,R),Qe=Ke("b",12,Q.length,B),Je=Ke("scales",e[2].dataType,e[2].dims.length),ke=[le,Qe,Je],at=e.length===4?Ke("zero_points",12,e[3].dims.length):void 0;at&&ke.push(at);let et=oe.length,ve=Pt("output",e[0].dataType,et,N),xe=ii(e[0].dataType),_e=(()=>{switch(R){case 1:return`array<${xe}, 8>`;case 2:return`mat4x2<${xe}>`;case 4:return`mat2x4<${xe}>`;default:throw new Error(`${R}-component is not supported.`)}})(),Ge=()=>{let ne=`
          // reuse a data
            var input_offset = ${le.indicesToOffset(`${le.type.indices}(batch, row, word_offset)`)};
            var a_data: ${_e};
            for (var j: u32 = 0; j < ${8/R}; j++) {
              a_data[j] = ${le.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let fe=0;fe<N*z;fe++)ne+=`
            b_value = ${B===1?`b${fe}_data`:`b${fe}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${_e}(${Array.from({length:4},(De,Le)=>`${xe}(b_value_lower[${Le}]), ${xe}(b_value_upper[${Le}])`).join(", ")});
            b_dequantized_values = ${R===1?`${_e}(${Array.from({length:8},(De,Le)=>`(b_quantized_values[${Le}] - ${at?`zero_point${fe}`:"zero_point"}) * scale${fe}`).join(", ")});`:`(b_quantized_values - ${_e}(${Array(8).fill(`${at?`zero_point${fe}`:"zero_point"}`).join(",")})) * scale${fe};`};
            workgroup_shared[local_id.x * ${z} + ${Math.floor(fe/N)}]${N>1?`[${fe%N}]`:""} += ${Array.from({length:8/R},(De,Le)=>`${R===1?`a_data[${Le}] * b_dequantized_values[${Le}]`:`dot(a_data[${Le}], b_dequantized_values[${Le}])`}`).join(" + ")};
          `;return ne},qe=()=>{let ne=`
            var col_index = col * ${N};
            ${at?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${xe}(8);`}
            `;for(let fe=0;fe<N*z;fe++)ne+=`
            let scale${fe} = ${Je.getByOffset("col_index * nBlocksPerCol + block")};
            ${at?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${at.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${fe} = ${xe}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return ne},ft=()=>{let ne=`col_index = col * ${N};`;for(let fe=0;fe<N*z;fe++)ne+=`
            let b${fe}_data = ${Qe.getByIndices(`${Qe.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return ne+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${_e};
            var b_dequantized_values: ${_e};`,ne};return`
        var<workgroup> workgroup_shared: array<${ve.type.value}, ${z*j}>;
        ${ee.declareVariables(...ke,ve)}
        ${ee.mainStart([j,1,1])}
          let output_indices = ${ve.offsetToIndices(`(global_idx / ${j}) * ${z}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${j}) {
            //process one block
            var word_offset: u32 = block * ${r.blockSize/R};
            ${qe()}
            for (var word: u32 = 0; word < ${y}; word += ${B}) {
              ${ft()}
              for (var i: u32 = 0; i < ${B}; i++) {
                ${Ge()}
                word_offset += ${8/R};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${z}) {
            var output_value: ${ve.type.value} = ${ve.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${j}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${z};
            }
            ${ve.setByIndices(`${ve.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${r.blockSize};${r.bits};${R};${B};${N};${z};${j}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:k,dataType:S}],dispatchGroup:{x:X},programUniforms:F}),getShaderSource:ue}},Uy=(e,r)=>{let a=e[0].dims,o=a.length,c=a[o-2],h=r.k,m=r.n,x=a.slice(0,o-2),_=Ve.size(x),y=e[1].dims[2]/4,S=e[0].dataType,R=$r(r.k),B=$r(y),N=x.concat([c,m]),k=128,z=m%8===0?8:m%4===0?4:1,X=k/z,j=X*B*8,F=j/R,te=j/r.blockSize,Q=Ve.size(N)/z,oe=[],ue=[_,c,h/R],ee=Ve.convertShape(e[1].dims).slice();ee.splice(-1,1,y/B),oe.push(...Kt(ue)),oe.push(...Kt(ee)),oe.push(...Kt(e[2].dims)),e.length===4&&oe.push(...Kt(Ve.convertShape(e[3].dims)));let ce=[_,c,m];oe.push(...Kt(ce));let le=Qe=>{let Je=ue.length,ke=Ke("a",e[0].dataType,Je,R),at=Ke("b",12,ee.length,B),et=Ke("scales",e[2].dataType,e[2].dims.length),ve=[ke,at,et],xe=e.length===4?Ke("zero_points",12,e[3].dims.length):void 0;xe&&ve.push(xe);let _e=ce.length,Ge=Pt("output",e[0].dataType,_e),qe=ii(e[0].dataType),ft=()=>{switch(R){case 1:return`
          let a_data0 = vec4<${qe}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${qe}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${qe}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${qe}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${R}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${ke.type.value}, ${F}>;
        var<workgroup> inter_results: array<array<${Ge.type.value}, ${X}>, ${z}>;
        ${Qe.declareVariables(...ve,Ge)}
        ${Qe.mainStart([X,z,1])}
          let output_indices = ${Ge.offsetToIndices(`workgroup_index * ${z}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${te} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${F};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${F}; a_offset += ${k})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${ke.getByIndices(`${ke.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${ke.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${te} + local_id.x;
            ${xe?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${xe.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${qe}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${qe}(8);`}
            let scale = ${et.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${at.getByIndices(`${at.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${r.blockSize/R};
            for (var i: u32 = 0; i < ${B}; i++) {
              ${ft()}
              let b_value = ${B===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${qe}>(${Array.from({length:4},(ne,fe)=>`${qe}(b_value_lower[${fe}]), ${qe}(b_value_upper[${fe}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${qe}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(ne,fe)=>`${`dot(a_data${fe}, b_dequantized_values[${fe}])`}`).join(" + ")};
              word_offset += ${8/R};
            }
            workgroupBarrier();
          }

          if (local_idx < ${z}) {
            var output_value: ${Ge.type.value} = ${Ge.type.value}(0);
            for (var b = 0u; b < ${X}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${Ge.setByIndices(`${Ge.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${r.blockSize};${R};${B};${X};${z}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:N,dataType:S}],dispatchGroup:{x:Q},programUniforms:oe}),getShaderSource:le}},B_=(e,r)=>{Ly(e.inputs,r),r.blockSize===32&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(Uy(e.inputs,r)):e.compute(zy(e.inputs,r))},N_=e=>tr(e)}),Py,Fy,Gy,Vy,qy,jy,Hy,Yy,k_,CT=gt(()=>{fn(),vn(),An(),Py=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let r=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(r=e[3].dims[0]*2===e[1].dims[0]),!r)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},Fy=(e,r,a)=>{let o="";for(let c=r-1;c>=0;--c)o+=`
            k = i32(${e.indicesGet("indices",c)}) - ${Yt("uniforms.pads",c,a)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${Yt("uniforms.x_shape",c,r)})) {
              break;
            }
            offset += k * i32(${Yt("uniforms.x_strides",c,r)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${o}
            value = x[offset];
          }
      `},Gy=(e,r,a)=>{let o="";for(let c=r-1;c>=0;--c)o+=`
                k = i32(${e.indicesGet("indices",c)}) - ${Yt("uniforms.pads",c,a)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${Yt("uniforms.x_shape",c,r)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${Yt("uniforms.x_shape",c,r)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${Yt("uniforms.x_strides",c,r)});
            `;return`
              var offset = 0;
              var k = 0;
              ${o}
              value = x[offset];
          `},Vy=(e,r,a)=>{let o="";for(let c=r-1;c>=0;--c)o+=`
                k = i32(${e.indicesGet("indices",c)}) - ${Yt("uniforms.pads",c,a)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${Yt("uniforms.x_shape",c,r)})) {
                  k = i32(${Yt("uniforms.x_shape",c,r)}) - 1;
                }
                offset += k * i32(${Yt("uniforms.x_strides",c,r)});
            `;return`
              var offset = 0;
              var k = 0;
              ${o}
              value = x[offset];
          `},qy=(e,r,a)=>{let o="";for(let c=r-1;c>=0;--c)o+=`
                k = i32(${e.indicesGet("indices",c)}) - ${Yt("uniforms.pads",c,a)};
                if (k < 0)  {
                  k += i32(${Yt("uniforms.x_shape",c,r)}]);
                }
                if (k >= i32(${Yt("uniforms.x_shape",c,r)})) {
                  k -= i32(${Yt("uniforms.x_shape",c,r)});
                }
                offset += k * i32(${Yt("uniforms.x_strides",c,r)});
            `;return`
              var offset = 0;
              var k = 0;
              ${o}
              value = x[offset];
          `},jy=(e,r,a)=>{switch(a.mode){case 0:return Fy(e,r,a.pads.length);case 1:return Gy(e,r,a.pads.length);case 2:return Vy(e,r,a.pads.length);case 3:return qy(e,r,a.pads.length);default:throw new Error("Invalid mode")}},Hy=(e,r)=>{let a=Ve.padShape(e[0].dims.slice(),r.pads),o=e[0].dims,c=Ve.size(a),h=[{type:12,data:c},{type:6,data:r.pads}],m=e.length>=3&&e[2].data;r.mode===0&&h.push({type:m?e[2].dataType:1,data:r.value}),h.push(...Kt(e[0].dims,a));let x=["rank"],_=y=>{let S=Pt("output",e[0].dataType,a.length),R=Ke("x",e[0].dataType,o.length),B=R.type.value,N=jy(S,o.length,r),k=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:r.pads.length}];return r.mode===0&&k.push({name:"constant_value",type:m?B:"f32"}),`
            ${y.registerUniforms(k).declareVariables(R,S)}
            ${y.mainStart()}
            ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${S.offsetToIndices("global_idx")};

            var value = ${B}(0);
            ${N}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${r.mode}${m}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(Ve.size(a)/64)},programUniforms:h}),getShaderSource:_}},Yy=(e,r)=>{if(e.length>1){let a=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].dataType===10?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,c=e[0].dims.length,h=new Int32Array(2*c).fill(0);if(e.length>=4){let x=e[3].getBigInt64Array();for(let _=0;_<x.length;_++)h[Number(x[_])]=Number(a[_]),h[Number(x[_])+c]=Number(a[_+x.length])}else a.forEach((x,_)=>h[Number(_)]=Number(x));let m=[];return h.forEach(x=>m.push(x)),{mode:r.mode,value:o,pads:m}}else return r},k_=(e,r)=>{Py(e.inputs);let a=Yy(e.inputs,r);e.compute(Hy(e.inputs,a),{inputs:[0]})}}),lu,q0,j0,H0,Y0,Wy,Ky,W0,K0,$_,L_,Q0,z_,U_,X0,P_,F_,G_,V_,AT=gt(()=>{Aa(),fn(),vn(),An(),lu=e=>{if(Ar.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},q0=(e,r,a)=>{let o=r.format==="NHWC",c=e.dims.slice();o&&c.splice(1,0,c.pop());let h=Object.hasOwnProperty.call(r,"dilations"),m=r.kernelShape.slice(),x=r.strides.slice(),_=h?r.dilations.slice():[],y=r.pads.slice();rf.adjustPoolAttributes(a,c,m,x,_,y);let S=rf.computePoolOutputShape(a,c,x,_,m,y,r.autoPad),R=Object.assign({},r);h?Object.assign(R,{kernelShape:m,strides:x,pads:y,dilations:_,cacheKey:r.cacheKey}):Object.assign(R,{kernelShape:m,strides:x,pads:y,cacheKey:r.cacheKey});let B=S.slice();return B.push(B.splice(1,1)[0]),[R,o?B:S]},j0=(e,r)=>{let a=r.format==="NHWC",o=Ve.size(e),c=Ve.size(r.kernelShape),h=[{type:12,data:o},{type:12,data:c}],m=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(r.kernelShape.length<=2){let x=r.kernelShape[r.kernelShape.length-1],_=r.strides[r.strides.length-1],y=r.pads[r.pads.length/2-1],S=r.pads[r.pads.length-1],R=!!(y+S);h.push({type:12,data:x},{type:12,data:_},{type:12,data:y},{type:12,data:S}),m.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let B=!1;if(r.kernelShape.length===2){let N=r.kernelShape[r.kernelShape.length-2],k=r.strides[r.strides.length-2],z=r.pads[r.pads.length/2-2],X=r.pads[r.pads.length-2];B=!!(z+X),h.push({type:12,data:N},{type:12,data:k},{type:12,data:z},{type:12,data:X}),m.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[h,m,!0,R,B]}else{if(a)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let x=Ve.computeStrides(r.kernelShape);h.push({type:12,data:x},{type:12,data:r.pads},{type:12,data:r.strides}),m.push({name:"kernelStrides",type:"u32",length:x.length},{name:"pads",type:"u32",length:r.pads.length},{name:"strides",type:"u32",length:r.strides.length});let _=r.pads.reduce((y,S)=>y+S);return[h,m,!!_,!1,!1]}},H0=(e,r,a,o,c,h,m,x,_,y,S,R)=>{let B=c.format==="NHWC",N=r.type.value,k=Pt("output",r.type.tensor,o);if(c.kernelShape.length<=2){let z="",X="",j="",F=a-(B?2:1);if(S?z=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${F}] = indices[${F}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${F}] < 0 || xIndices[${F}]
                      >= uniforms.x_shape[${F}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${r.indicesToOffset("xIndices")}];
                  ${h}
                }`:z=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${F}] = indices[${F}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${r.indicesToOffset("xIndices")}];
                  ${h}
                }`,c.kernelShape.length===2){let te=a-(B?3:2);R?X=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${te}] = indices[${te}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${te}] < 0 || xIndices[${te}] >= uniforms.x_shape[${te}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:X=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${te}] = indices[${te}] * uniforms.sh - uniforms.phStart + j;
                `,j=`
              }
            `}return`
            ${e.registerUniforms(_).declareVariables(r,k)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${k.offsetToIndices("global_idx")};
              var xIndices = ${k.offsetToIndices("global_idx")};

              var value = ${N}(${x});
              var pad = 0;
              ${X}
              ${z}
              ${j}
              ${m}

              output[global_idx] = value;
            }`}else{if(B)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let z=c.kernelShape.length,X=c.pads.length,j="";return y?j=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${r.indicesToOffset("xIndices")}];
                ${h}
              }`:j=`
              }
              let x_val = x[${r.indicesToOffset("xIndices")}];
              ${h}
            `,`
            ${e.registerUniforms(_).declareVariables(r,k)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${k.offsetToIndices("global_idx")};
              var xIndices = ${k.offsetToIndices("global_idx")};

              var offsets: array<u32, ${z}>;

              var value = ${N}(${x});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${z-1}u; j++) {
                  offsets[j] = offset / ${Yt("uniforms.kernelStrides","j",z)};
                  offset -= offsets[j] * ${Yt("uniforms.kernelStrides","j",z)};
                }
                offsets[${z-1}] = offset;

                isPad = false;
                for (var j = ${a-z}u; j < ${a}u; j++) {
                  xIndices[j] = indices[j] * ${Yt("uniforms.strides",`j - ${a-z}u`,z)}
                    + offsets[j - ${a-z}u] - ${Yt("uniforms.pads","j - 2u",X)};
                  ${j}
              }
              ${m}

              output[global_idx] = value;
            }`}},Y0=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,Wy=e=>`${Y0(e)};${e.countIncludePad}`,Ky=e=>`${Y0(e)};${e.storageOrder};${e.dilations}`,W0=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),K0=(e,r,a,o)=>{let[c,h]=q0(r,o,a),m=Ke("x",r.dataType,r.dims.length),x=m.type.value,_="value += x_val;",y="";c.countIncludePad?y+=`value /= ${x}(uniforms.kernelSize);`:y+=`value /= ${x}(i32(uniforms.kernelSize) - pad);`;let[S,R,B,N,k]=j0(h,c);S.push(...Kt(r.dims,h));let z=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${B};${N};${k}`,inputDependencies:z},getRunData:()=>({outputs:[{dims:h,dataType:r.dataType}],dispatchGroup:{x:Math.ceil(Ve.size(h)/64)},programUniforms:S}),getShaderSource:X=>H0(X,m,r.dims.length,h.length,c,_,y,0,R,B,N,k)}},$_=e=>{let r=e.count_include_pad!==0,a=W0(e);if(a.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:r,...a,cacheKey:""};return{...o,cacheKey:Wy(o)}},L_=(e,r)=>{lu(e.inputs),e.compute(K0("AveragePool",e.inputs[0],!1,r))},Q0={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},z_=e=>{let r=e.format;return{format:r,...Q0,cacheKey:r}},U_=(e,r)=>{lu(e.inputs),e.compute(K0("GlobalAveragePool",e.inputs[0],!0,r))},X0=(e,r,a,o)=>{let[c,h]=q0(r,o,a),m=`
      value = max(x_val, value);
    `,x="",_=Ke("x",r.dataType,r.dims.length),y=["rank"],[S,R,B,N,k]=j0(h,c);return S.push(...Kt(r.dims,h)),{name:e,shaderCache:{hint:`${o.cacheKey};${B};${N};${k}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:h,dataType:r.dataType}],dispatchGroup:{x:Math.ceil(Ve.size(h)/64)},programUniforms:S}),getShaderSource:z=>H0(z,_,r.dims.length,h.length,c,m,x,r.dataType===10?-65504:-1e5,R,B,N,k)}},P_=(e,r)=>{lu(e.inputs),e.compute(X0("MaxPool",e.inputs[0],!1,r))},F_=e=>{let r=e.storage_order,a=e.dilations,o=W0(e);if(r!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let c={storageOrder:r,dilations:a,...o,cacheKey:""};return{...c,cacheKey:Ky(c)}},G_=e=>{let r=e.format;return{format:r,...Q0,cacheKey:r}},V_=(e,r)=>{lu(e.inputs),e.compute(X0("GlobalMaxPool",e.inputs[0],!0,r))}}),Qy,Xy,q_,j_,ET=gt(()=>{fn(),vn(),Ur(),An(),Qy=(e,r)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(e.length===3&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[0].dataType===6&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(e[1].dims.length!==0&&e[1].dims.length!==1&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((a,o)=>a===e[2].dims[o]).reduce((a,o)=>a&&o,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(r.blockSize>0){if(e[1].dims.length===0||e[1].dims.length===1&&e[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((c,h)=>h===r.axis||c===e[0].dims[h]).reduce((c,h)=>c&&h,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let a=e[0].dims[r.axis],o=e[1].dims[r.axis];if(r.blockSize<Math.ceil(a/o)||r.blockSize>Math.ceil(a/(o-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},Xy=(e,r)=>{let a=Ve.normalizeAxis(r.axis,e[0].dims.length),o=e[0].dataType,c=o===3,h=e[0].dims,m=e[1].dataType,x=Ve.size(h),_=o===3||o===2,y=_?[Math.ceil(Ve.size(e[0].dims)/4)]:e[0].dims,S=e[1].dims,R=e.length>2?e[2]:void 0,B=R?_?[Math.ceil(Ve.size(R.dims)/4)]:R.dims:void 0,N=S.length===0||S.length===1&&S[0]===1,k=N===!1&&S.length===1,z=$r(x),X=N&&(!_||z===4),j=X?z:1,F=X&&!_?z:1,te=Ke("input",_?12:o,y.length,F),Q=Ke("scale",m,S.length),oe=R?Ke("zero_point",_?12:o,B.length):void 0,ue=Pt("output",m,h.length,j),ee=[te,Q];oe&&ee.push(oe);let ce=[y,S];R&&ce.push(B);let le=[{type:12,data:x/j},{type:12,data:a},{type:12,data:r.blockSize},...Kt(...ce,h)],Qe=Je=>{let ke=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${Je.registerUniforms(ke).declareVariables(...ee,ue)}
      ${Je.mainStart()}
          ${Je.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${ue.offsetToIndices("global_idx")};

          // Set input x
          ${_?`
            let input = ${te.getByOffset("global_idx / 4")};
            let x_vec = ${c?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${j===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${te.getByOffset("global_idx")};`};

          // Set scale input
          ${N?`let scale_value= ${Q.getByOffset("0")}`:k?`
            let scale_index = ${ue.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${Q.getByOffset("scale_index")};`:`
            var scale_indices: ${Q.type.indices} = output_indices;
            let index = ${Q.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${Q.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${Q.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${oe?N?_?`
                let zero_point_input = ${oe.getByOffset("0")};
                let zero_point_vec =  ${c?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${oe.getByOffset("0")}`:k?_?`
                let zero_point_index = ${ue.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${oe.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${c?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${ue.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${oe.getByOffset("zero_point_index")};`:_?`
                let zero_point_offset = ${Q.indicesToOffset("scale_indices")};
                let zero_point_input = ${oe.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${c?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${oe.getByIndices("scale_indices")};`:`let zero_point_value = ${_?c?"i32":"u32":te.type.value}(0);`};
      // Compute and write output
      ${ue.setByOffset("global_idx",`${ue.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:r.cacheKey,inputDependencies:oe?["rank","rank","rank"]:["rank","rank"]},getShaderSource:Qe,getRunData:()=>({outputs:[{dims:h,dataType:m}],dispatchGroup:{x:Math.ceil(x/j/64),y:1,z:1},programUniforms:le})}},q_=(e,r)=>{Qy(e.inputs,r),e.compute(Xy(e.inputs,r))},j_=e=>tr({axis:e.axis,blockSize:e.blockSize})}),Zy,Jy,H_,TT=gt(()=>{Aa(),fn(),An(),Zy=(e,r,a)=>{let o=e===r,c=e<r&&a<0,h=e>r&&a>0;if(o||c||h)throw new Error("Range these inputs' contents are invalid.")},Jy=(e,r,a,o)=>{let c=Math.abs(Math.ceil((r-e)/a)),h=[c],m=c,x=[{type:12,data:m},{type:o,data:e},{type:o,data:a},...Kt(h)],_=y=>{let S=Pt("output",o,h.length),R=S.type.value,B=[{name:"outputSize",type:"u32"},{name:"start",type:R},{name:"delta",type:R}];return`
        ${y.registerUniforms(B).declareVariables(S)}
        ${y.mainStart()}
        ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${R}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:_,getRunData:()=>({outputs:[{dims:h,dataType:o}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:x})}},H_=e=>{let r=0,a=0,o=0;e.inputs[0].dataType===6?(r=e.inputs[0].getInt32Array()[0],a=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(r=e.inputs[0].getFloat32Array()[0],a=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),Ar.webgpu.validateInputContent&&Zy(r,a,o),e.compute(Jy(r,a,o,e.inputs[0].dataType),{inputs:[]})}}),ew,tw,Y_,W_,ST=gt(()=>{fn(),vn(),Ur(),An(),ew=(e,r,a,o)=>{if(e!=="none"&&o!=="i32"&&o!=="u32"&&o!=="f32")throw new Error(`Input ${o} is not supported with reduction ${e}.`);let c=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,h=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${r}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${r}=${a};`;case"add":return o==="i32"||o==="u32"?`atomicAdd(&${r}, bitcast<${o}>(${a}));`:`
              ${c}bitcast<${o}>(oldValue) + (${a})${h}`;case"max":return o==="i32"||o==="u32"?`atomicMax(&${r}, bitcast<${o}>(${a}));`:`
                ${c}max(bitcast<f32>(oldValue), (${a}))${h}`;case"min":return o==="i32"||o==="u32"?`atomicMin(&${r}, bitcast<${o}>(${a}));`:`${c}min(bitcast<${o}>(oldValue), (${a}))${h}`;case"mul":return`${c}(bitcast<${o}>(oldValue) * (${a}))${h}`;default:throw new Error(`Reduction ${e} is not supported.`)}},tw=(e,r)=>{let a=e[0].dims,o=e[1].dims,c=a,h=1,m=Math.ceil(Ve.sizeToDimension(o,o.length-1)/h),x=o[o.length-1],_=Ve.sizeFromDimension(a,x),y=[{type:12,data:m},{type:12,data:x},{type:12,data:_},...Kt(e[1].dims,e[2].dims,c)],S=R=>{let B=Ke("indices",e[1].dataType,e[1].dims.length),N=Ke("updates",e[2].dataType,e[2].dims.length,h),k=r.reduction!=="none"&&r.reduction!==""?_3("output",e[0].dataType,c.length):Pt("output",e[0].dataType,c.length,h);return`
      ${R.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(B,N,k)}
      ${R.mainStart()}
        ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var data_offset = 0u;
  let indices_start = uniforms.last_index_dimension * global_idx;
  let indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${e[0].dims.length===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[i - indices_start];
    let dim_value = uniforms.output_shape[i - indices_start];`}
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));
  }

  for (var i = 0u; i < uniforms.num_updates_elements; i++) {
    let value = updates[uniforms.num_updates_elements * global_idx + i];
    ${ew(r.reduction,"output[data_offset + i]","value",k.type.value)}
  }

      }`};return{name:"ScatterND",shaderCache:{hint:`${r.cacheKey}_${r.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:y}),getShaderSource:S}},Y_=e=>tr({reduction:e.reduction}),W_=(e,r)=>{e.compute(tw(e.inputs,r),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),nw,rw,iw,Z0,aw,sw,ow,lw,uw,cw,fw,dw,J0,hw,pw,gw,mw,xw,K_,Q_,IT=gt(()=>{fn(),vn(),Ur(),An(),nw=(e,r)=>{if(e.every(a=>a>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(r.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(r.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},rw=(e,r,a)=>{r.every(c=>c>=0&&c<a||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(a).fill(1);return r.forEach((c,h)=>o[c]=e[h]),o},iw=(e,r,a,o,c,h)=>{let[m,x,_]=a>10?[1,2,3]:[-1,e.length>1?1:-1,-1],y=e[0].dims.length;if(m>0&&e.length>m&&e[m].dims.length>0)e[m].getFloat32Array().forEach(S=>h.push(S));else if(r.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(x>0&&e.length>x&&e[x].dims.length===1&&e[x].dims[0]>0){if(e[x].getFloat32Array().forEach(S=>o.push(S)),o.length!==0&&o.length!==y&&a>=18&&o.length!==r.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");nw(o,r),r.axes.length>0&&rw(o,r.axes,y).forEach((S,R)=>o[R]=S)}if(_>0&&e.length>_&&e[_].dims.length===1&&e[_].dims[0]>0&&(e[_].getBigInt64Array().forEach(S=>c.push(Number(S))),c.length!==0&&c.length!==y&&a>=18&&c.length!==r.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(r.axes.length>0){if(o.length!==0&&o.length!==r.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(c.length!==0&&c.length!==r.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof o<"u"&&typeof c<"u"&&o.length>0&&c.length>y)throw new Error("Resize requires only of scales or sizes to be specified")},Z0=(e,r,a,o)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${r});
  let whole = ${o}(big / (${a}));
  let fract = ${o}(big % (${a})) / ${o}(${a});
  return whole + fract;
`,aw=(e,r)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${r} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${r}(xResized) / ${r}(xScale);
          } else {
            ${Z0("xResized","lengthOriginal","lengthResized",r)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${r}(xResized) + 0.5) / ${r}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${r}(xResized) + 0.5) / ${r}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${Z0("xResized","lengthOriginal - 1","lengthResized - 1",r)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${r}(roiStart) * ${r}(lengthOriginal - 1) +
                        (${r}(xResized) * ${r}(roiEnd - roiStart) * ${r}(lengthOriginal - 1)) /
                        ${r}(lengthResized - 1);
                  } else {
                    return 0.5 * ${r}(roiStart + roiEnd) * ${r}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${r}xScale * ${r}(lengthResized);
                  const adjustment = ${r}(lengthResized) / outputWidth;
                  const center = ${r}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${r}(xResized) + 0.5) / ${r}(xScale)) - 0.5;`;case"half_pixel":return`return ((${r}(xResized) + 0.5) / ${r}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",sw=(e,r,a)=>`fn getNearestPixelFromOriginal(xOriginal: ${a}, isDownSample: bool) -> ${a} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(r<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",ow=(e,r,a)=>{let o=new Array(a).fill(0).concat(new Array(a).fill(1)),c=e.length===0?o:e.slice();return r.length>0?(r.forEach((h,m)=>{o[h]=c[m],o[m+a]=c[r.length+m]}),o):c},lw=(e,r,a,o)=>{let c=[];if(a.length>0)if(o.length>0){if(e.forEach(h=>c.push(h)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((h,m)=>c[h]=a[m])}else a.forEach(h=>c.push(h));else{if(r.length===0)throw new Error("Resize requires either scales or sizes.");c=e.map((h,m)=>Math.round(h*r[m]))}return c},uw=(e,r,a)=>{let o=(()=>{switch(a.keepAspectRatioPolicy){case"not_larger":return a.axes.length>0?Math.min(...a.axes.map(h=>r[h]),Number.MAX_VALUE):Math.min(...r,Number.MAX_VALUE);case"not_smaller":return a.axes.length>0?Math.max(...a.axes.map(h=>r[h]),Number.MIN_VALUE):Math.max(...r,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${a.keepAspectRatioPolicy} is not supported`)}})();r.fill(1,0,r.length);let c=e.slice();return a.axes.length>0?(a.axes.forEach(h=>r[h]=o),a.axes.forEach(h=>c[h]=Math.round(e[h]*r[h]))):(r.fill(o,0,r.length),c.forEach((h,m)=>c[m]=Math.round(h*r[m]))),c},cw=(e,r,a,o,c)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${a.length}> {
      var original_indices: array<${e.type.value}, ${a.length}>;
      for (var i:u32 = 0; i < ${a.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${Yt("uniforms.scales","i",o)};
        var roi_low = ${Yt("uniforms.roi","i",c)};
        var roi_hi = ${Yt("uniforms.roi",`i + ${r.length}`,c)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${Yt("uniforms.input_shape","i",r.length)};
          var output_shape_i = ${Yt("uniforms.output_shape","i",a.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,fw=(e,r,a,o,c,h,m)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${r.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${o.length}; i++) {
        var output_index = ${r.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${Yt("uniforms.scales","i",c)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${Yt("uniforms.roi","i",h)};
          var roi_hi = ${Yt("uniforms.roi",`i + ${a.length}`,h)};
          var input_shape_i = ${Yt("uniforms.input_shape","i",a.length)};
          var output_shape_i = ${Yt("uniforms.output_shape","i",o.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${m} || (original_idx >= 0 && original_idx < ${r.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${r.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,dw=(e,r)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${Yt("uniforms.input_shape","i",r.length)}) {
          return false;
        }
      }
      return true;
    }`,J0=(e,r,a,o)=>e.rank>o?`
    ${e.indicesSet("input_indices",r,"channel")};
    ${e.indicesSet("input_indices",a,"batch")};
`:"",hw=(e,r,a,o,c)=>{let[h,m,x,_]=a.length===2?[-1,0,1,-1]:[0,2,3,1],y=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${y} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",m,`max(0, min(row, ${a[m]} - 1))`)};
      ${e.indicesSet("input_indices",x,`max(0, min(col, ${a[x]} - 1))`)};
      ${J0(e,_,h,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${r.type.indices}) -> ${y} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${y} = originalIndices[${m}];
      var col:${y} = originalIndices[${x}];
      ${o?`if (row < 0 || row > (${a[m]} - 1) || col < 0 || col > (${a[x]} - 1)) {
        return ${c};
      }`:""};
      row = max(0, min(row, ${a[m]} - 1));
      col = max(0, min(col, ${a[x]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${a.length>2?`u32(originalIndices[${_}])`:"0"};
      var batch: u32 =  ${a.length>2?`u32(originalIndices[${h}])`:"0"};
      var x11: ${y} = getInputValue(batch, channel, row1, col1);
      var x12: ${y} = getInputValue(batch, channel, row1, col2);
      var x21: ${y} = getInputValue(batch, channel, row2, col1);
      var x22: ${y} = getInputValue(batch, channel, row2, col2);
      var dx1: ${y} = abs(row - ${y}(row1));
      var dx2: ${y} = abs(${y}(row2) - row);
      var dy1: ${y} = abs(col - ${y}(col1));
      var dy2: ${y} = abs(${y}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},pw=(e,r,a,o,c,h,m,x,_,y)=>{let S=a.length===2,[R,B]=S?[0,1]:[2,3],N=e.type.value,k=z=>{let X=z===R?"row":"col";return`
      fn ${X}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${r.type.indices}) -> ${N} {
        var output_index = ${r.indicesGet("output_indices",z)};
        var originalIdx: ${N} = getOriginalCoordinateFromResizedCoordinate(output_index, ${c[z]},
        ${o[z]}, ${a[z]}, ${h[z]}, ${h[z]} + ${a.length});
        var fractOriginalIdx: ${N} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${x} && (originalIdx < 0 || originalIdx > (${a[z]} - 1))) {
          return ${_};
        }
        var data: array<${N}, 4> = array<${N}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${X}: ${N} = originalIdx + ${N}(i);
          if (${X} < 0 || ${X} >= ${a[z]}) {
            ${y?`coefs[i + 1] = 0.0;
                        continue;`:x?`return ${_};`:`${X} = max(0, min(${X}, ${a[z]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",z,`u32(${X})`)};
          data[i + 1] = ${z===R?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${k(R)};
    ${k(B)};
  fn getCubicInterpolationCoefs(s: ${N}) -> array<${N}, 4> {
    var absS = abs(s);
    var coeffs: array<${N}, 4> = array<${N}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${N} = 1.0 - absS;
    var twoMinusAbsS: ${N} = 2.0 - absS;
    var onePlusAbsS: ${N} = 1.0 + absS;
    coeffs[0] = ((${m} * onePlusAbsS - 5 * ${m}) * onePlusAbsS + 8 * ${m}) * onePlusAbsS - 4 * ${m};
    coeffs[1] = ((${m} + 2) * absS - (${m} + 3)) * absS * absS + 1;
    coeffs[2] = ((${m} + 2) * oneMinusAbsS - (${m} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${m} * twoMinusAbsS - 5 * ${m}) * twoMinusAbsS + 8 * ${m}) * twoMinusAbsS - 4 * ${m};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${N}, 4>, coefs: array<${N}, 4>) -> ${N} {
    var coefsSum: ${N} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${r.type.indices}) -> ${N} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},gw=(e,r,a,o,c)=>{let[h,m,x,_,y]=a.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],S=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${S} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",m,`max(0, min(depth, ${a[m]} - 1))`)};
      ${e.indicesSet("input_indices",x,`max(0, min(height, ${a[x]} - 1))`)};
      ${e.indicesSet("input_indices",_,`max(0, min(width, ${a[_]} - 1))`)};
      ${J0(e,y,h,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${r.type.indices}) -> ${S} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${S} = originalIndices[${m}];
      var height:${S} = originalIndices[${x}];
      var width:${S} = originalIndices[${_}];
      ${o?`if (depth < 0 || depth > (${a[m]} - 1) || height < 0 || height > (${a[x]} - 1) || width < 0 || (width > ${a[_]} - 1)) {
      return ${c};
        }`:""};

    depth = max(0, min(depth, ${a[m]} - 1));
      height = max(0, min(height, ${a[x]} - 1));
      width = max(0, min(width, ${a[_]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${a.length>3?`u32(originalIndices[${y}])`:"0"};
      var batch: u32 =  ${a.length>3?`u32(originalIndices[${h}])`:"0"};

      var x111: ${S} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${S} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${S} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${S} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${S} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${S} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${S} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${S} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${S} = abs(depth - ${S}(depth1));
      var dx2: ${S} = abs(${S}(depth2) - depth);
      var dy1: ${S} = abs(height - ${S}(height1));
      var dy2: ${S} = abs(${S}(height2) - height);
      var dz1: ${S} = abs(width - ${S}(width1));
      var dz2: ${S} = abs(${S}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},mw=(e,r,a,o,c,h)=>{let m=e.dims,x=ow(h,r.axes,m.length),_=lw(m,o,c,r.axes),y=o.slice();o.length===0&&(y=m.map((F,te)=>F===0?1:_[te]/F),r.keepAspectRatioPolicy!=="stretch"&&(_=uw(m,y,r)));let S=Pt("output",e.dataType,_.length),R=Ke("input",e.dataType,m.length),B=Ve.size(_),N=m.length===_.length&&m.every((F,te)=>F===_[te]),k=r.coordinateTransformMode==="tf_crop_and_resize",z=r.extrapolationValue,X=R.type.value,j=F=>`
      ${N?"":`
      ${aw(r.coordinateTransformMode,X)};
      ${(()=>{switch(r.mode){case"nearest":return`
              ${dw(R,m)};
              ${sw(r.nearestMode,a,X)};
              ${fw(R,S,m,_,y.length,x.length,k)};
              `;case"linear":return`
              ${cw(S,m,_,y.length,x.length)};
              ${(()=>{if(m.length===2||m.length===4)return`${hw(R,S,m,k,z)}`;if(m.length===3||m.length===5)return`${gw(R,S,m,k,z)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(m.length===2||m.length===4)return`${pw(R,S,m,_,y,x,r.cubicCoeffA,k,r.extrapolationValue,r.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${F.registerUniform("output_size","u32").registerUniform("scales","f32",y.length).registerUniform("roi","f32",x.length).declareVariables(R,S)}
      ${F.mainStart()}
        ${F.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${N?"output[global_idx] = input[global_idx];":`
        let output_indices = ${S.offsetToIndices("global_idx")};
        var input_indices: ${R.type.indices};
        ${(()=>{switch(r.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${R.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${r.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${m.length===2||m.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${r.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${r.cacheKey}|${a}|${y.length>0?r.mode==="cubic"?y:y.length:""}|${c.length>0?c:""}|${x.length>0?x:""}|${N}|${r.mode==="nearest"?m.length:m}`,inputDependencies:["rank"]},getShaderSource:j,getRunData:()=>({outputs:[{dims:_,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(B/64)},programUniforms:[{type:12,data:B},{type:1,data:y},{type:1,data:x},...Kt(m,_)]})}},xw=e=>{let r=e.customDataBuffer;return new Uint32Array(r,r.byteOffset,1)[0]},K_=(e,r)=>{let a=[],o=[],c=[],h=xw(e);if(r.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");iw(e.inputs,r,h,a,o,c),e.compute(mw(e.inputs[0],r,h,a,o,c),{inputs:[0]})},Q_=e=>{let r=e.antialias,a=e.axes,o=e.coordinateTransformMode,c=e.cubicCoeffA,h=e.excludeOutside!==0,m=e.extrapolationValue,x=e.keepAspectRatioPolicy,_=e.mode,y=e.nearestMode===""?"simple":e.nearestMode;return tr({antialias:r,axes:a,coordinateTransformMode:o,cubicCoeffA:c,excludeOutside:h,extrapolationValue:m,keepAspectRatioPolicy:x,mode:_,nearestMode:y})}}),yw,ww,X_,RT=gt(()=>{fn(),vn(),An(),yw=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let r=e[0],a=e[1],o=e[2];if(r.dataType!==a.dataType||r.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Input must be 2D or 3D");if(a.dims.length!==3&&a.dims.length!==2)throw new Error("Skip must be 2D or 3D");let c=r.dims[r.dims.length-1],h=r.dims[r.dims.length-2];if(a.dims[a.dims.length-1]!==c)throw new Error("Skip must have the same hidden size as input");if(a.dims[a.dims.length-2]!==h)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==c)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let m=e[3];if(m.dims.length!==1)throw new Error("Beta must be 1D");if(m.dims[m.dims.length-1]!==c)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let m=e[4];if(m.dims.length!==1)throw new Error("Bias must be 1D");if(m.dims[m.dims.length-1]!==c)throw new Error("Bias must have the same hidden size as input")}},ww=(e,r,a,o)=>{let c=r.simplified,h=e[0].dims,m=Ve.size(h),x=h,_=m,y=h.slice(-1)[0],S=o?h.slice(0,-1).concat(1):[],R=!c&&e.length>3,B=e.length>4,N=o&&a>1,k=o&&a>2,z=a>3,X=64,j=$r(y),F=[{type:12,data:_},{type:12,data:j},{type:12,data:y},{type:1,data:r.epsilon}],te=oe=>{let ue=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],ee=[Ke("x",e[0].dataType,e[0].dims,j),Ke("skip",e[1].dataType,e[1].dims,j),Ke("gamma",e[2].dataType,e[2].dims,j)];R&&ee.push(Ke("beta",e[3].dataType,e[3].dims,j)),B&&ee.push(Ke("bias",e[4].dataType,e[4].dims,j)),ee.push(Pt("output",e[0].dataType,x,j)),N&&ee.push(Pt("mean_output",1,S)),k&&ee.push(Pt("inv_std_output",1,S)),z&&ee.push(Pt("input_skip_bias_sum",e[0].dataType,x,j));let ce=ii(e[0].dataType),le=ii(1,j);return`

      ${oe.registerUniforms(ue).declareVariables(...ee)}
      var<workgroup> sum_shared : array<${le}, ${X}>;
      var<workgroup> sum_squared_shared : array<${le}, ${X}>;

      ${oe.mainStart([X,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${X};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${X};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${X-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${B?"bias[offset1d + i]":ce+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${z?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${pl(ce,j,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${X};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${oo("sum",j)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${oo("square_sum",j)} / f32(uniforms.hidden_size) ${c?"":"- mean * mean"} + uniforms.epsilon);
        ${N?"mean_output[global_idx] = mean;":""}
        ${k?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${c?"":`- ${ce}(mean)`}) *
            ${ce}(inv_std_dev) * gamma[offset1d + i]
            ${R?"+ beta[offset1d + i]":""};
        }
      }`},Q=[{dims:x,dataType:e[0].dataType}];return a>1&&Q.push({dims:S,dataType:1}),a>2&&Q.push({dims:S,dataType:1}),a>3&&Q.push({dims:h,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${j};${N};${k};${z}`,inputDependencies:e.map((oe,ue)=>"type")},getShaderSource:te,getRunData:()=>({outputs:Q,dispatchGroup:{x:Math.ceil(_/y)},programUniforms:F})}},X_=(e,r)=>{yw(e.inputs);let a=[0];e.outputCount>1&&a.push(-3),e.outputCount>2&&a.push(-3),e.outputCount>3&&a.push(3),e.compute(ww(e.inputs,r,e.outputCount,!1),{outputs:a})}}),bw,uu,vw,eh,_w,Cw,Z_,J_,OT=gt(()=>{fn(),vn(),Ur(),An(),bw=(e,r)=>{if(!e||e.length<1)throw new Error("too few inputs");if(r.axes.length!==0){if(r.axes.length!==r.starts.length||r.axes.length!==r.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(r.starts.length!==r.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((a,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},uu=(e,r)=>{let a=[];if(e.length>r)if(e[r].dataType===7)e[r].getBigInt64Array().forEach(o=>a.push(Number(o)));else if(e[r].dataType===6)e[r].getInt32Array().forEach(o=>a.push(Number(o)));else throw new Error(`Input ${r} must be an array of int32 or int64`);return a},vw=(e,r)=>{if(e.length>1){let a=uu(e,1),o=uu(e,2),c=uu(e,3);return c.length===0&&(c=[...Array(e[0].dims.length).keys()]),tr({starts:a,ends:o,axes:c})}else return r},eh=(e,r,a,o,c)=>{let h=e;return e<0&&(h+=a[o[r]]),c[r]<0?Math.max(0,Math.min(h,a[o[r]]-1)):Math.max(0,Math.min(h,a[o[r]]))},_w=(e,r,a)=>`fn calculateInputIndices(output_indices: ${r.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${a.length-1}; i >= 0; i--) {
            let input_shape_i = ${Yt("uniforms.input_shape","i",a.length)};
            let steps_i = ${Yt("uniforms.steps","i",a.length)};
            let signs_i = ${Yt("uniforms.signs","i",a.length)};
            let starts_i = ${Yt("uniforms.starts","i",a.length)};
            var output_index = ${r.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,Cw=(e,r)=>{let a=e[0].dims,o=Ve.size(a),c=r.axes.length>0?Ve.normalizeAxes(r.axes,a.length):[...Array(a.length).keys()],h=uu(e,4);h.forEach(j=>j!==0||(()=>{throw new Error("step cannot be 0")})),h.length===0&&(h=Array(c.length).fill(1));let m=r.starts.map((j,F)=>eh(j,F,a,c,h)),x=r.ends.map((j,F)=>eh(j,F,a,c,h));if(c.length!==m.length||c.length!==x.length)throw new Error("start, ends and axes should have the same number of elements");if(c.length!==a.length)for(let j=0;j<a.length;++j)c.includes(j)||(m.splice(j,0,0),x.splice(j,0,a[j]),h.splice(j,0,1));let _=h.map(j=>Math.sign(j));h.forEach((j,F,te)=>{if(j<0){let Q=(x[F]-m[F])/j,oe=m[F],ue=oe+Q*h[F];m[F]=ue,x[F]=oe,te[F]=-j}});let y=a.slice(0);c.forEach((j,F)=>{y[j]=Math.ceil((x[j]-m[j])/h[j])});let S={dims:y,dataType:e[0].dataType},R=Pt("output",e[0].dataType,y.length),B=Ke("input",e[0].dataType,e[0].dims.length),N=Ve.size(y),k=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:m.length},{name:"signs",type:"i32",length:_.length},{name:"steps",type:"u32",length:h.length}],z=[{type:12,data:N},{type:12,data:m},{type:6,data:_},{type:12,data:h},...Kt(e[0].dims,y)],X=j=>`
      ${j.registerUniforms(k).declareVariables(B,R)}
        ${_w(B,R,a)}
        ${j.mainStart()}
          ${j.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${R.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${R.setByOffset("global_idx",B.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${_.length}_${m.length}_${h.length}`,inputDependencies:["rank"]},getShaderSource:X,getRunData:()=>({outputs:[S],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:z})}},Z_=(e,r)=>{bw(e.inputs,r);let a=vw(e.inputs,r);e.compute(Cw(e.inputs,a),{inputs:[0]})},J_=e=>{let r=e.starts,a=e.ends,o=e.axes;return tr({starts:r,ends:a,axes:o})}}),Aw,Ew,eC,tC,DT=gt(()=>{fn(),vn(),Ur(),lo(),An(),Aw=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Ew=(e,r)=>{let a=e.inputs[0],o=a.dims,c=Ve.size(o),h=o.length,m=Ve.normalizeAxis(r.axis,h),x=m<o.length-1,_,y=[];x?(y=Array.from({length:h},(ee,ce)=>ce),y[m]=h-1,y[h-1]=m,_=e.compute(la(a,y),{inputs:[a],outputs:[-1]})[0]):_=a;let S=_.dims,R=S[h-1],B=c/R,N=$r(R),k=R/N,z=64;B===1&&(z=256);let X=(ee,ce)=>ce===4?`max(max(${ee}.x, ${ee}.y), max(${ee}.z, ${ee}.w))`:ce===2?`max(${ee}.x, ${ee}.y)`:ce===3?`max(max(${ee}.x, ${ee}.y), ${ee}.z)`:ee,j=Ke("x",_.dataType,_.dims,N),F=Pt("result",_.dataType,_.dims,N),te=j.type.value,Q=ii(_.dataType)==="f32"?`var threadMax = ${te}(-3.402823e+38f);`:`var threadMax = ${te}(-65504.0h);`,oe=ee=>`
      var<workgroup> rowMaxShared : ${te};
      var<workgroup> rowSumShared : ${te};
      var<workgroup> threadShared : array<${te}, ${z}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${te} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${te}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${ee.registerUniform("packedCols","i32").declareVariables(j,F)}
      ${ee.mainStart(z)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${z};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${Q}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${te}(${X("threadShared[0]",N)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${te}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${te}(${oo("threadShared[0]",N)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          var value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          // max operation protects against NaN since all values should be >=0
          value = max(value, ${te}(0.0));
          setValue(row, col, row_stride, value);
        }
      }`,ue=e.compute({name:"Softmax",shaderCache:{hint:`${N};${z}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:S,dataType:_.dataType}],dispatchGroup:{x:B},programUniforms:[{type:6,data:k}]}),getShaderSource:oe},{inputs:[_],outputs:[x?-1:0]})[0];x&&e.compute(la(ue,y),{inputs:[ue]})},eC=(e,r)=>{Aw(e.inputs),Ew(e,r)},tC=e=>tr({axis:e.axis})}),th,Tw,Sw,Iw,nC,MT=gt(()=>{fn(),vn(),An(),th=e=>Array.from(e.getBigInt64Array(),Number),Tw=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==10&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(th(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Sw=(e,r)=>{let a=[];for(let o=0;o<e.length;++o)a.push(e[o]*r[o]);return a},Iw=(e,r)=>{let a=e[0].dims,o=r??th(e[1]),c=Sw(a,o),h=Ve.size(c),m=e[0].dataType,x=Ke("input",m,a.length),_=Pt("output",m,c.length),y=S=>`
      const inputShape = ${x.indices(...a)};
      ${S.registerUniform("output_size","u32").declareVariables(x,_)}
      ${S.mainStart()}
      ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${_.offsetToIndices("global_idx")};
      var input_indices: ${x.type.indices};
      for (var i = 0; i < ${a.length}; i++) {
        let input_dim_i = ${x.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${_.indicesGet("output_indices","i")}  % input_dim_i;

        ${x.indicesSet("input_indices","i","input_dim_value")}
      }
      ${_.setByOffset("global_idx",x.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${o}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:[{type:12,data:h},...Kt(e[0].dims,c)]}),getShaderSource:y}},nC=e=>{Tw(e.inputs),e.compute(Iw(e.inputs),{inputs:[0]})}}),Rw,Ow,rC,BT=gt(()=>{fn(),vn(),An(),Rw=(e,r,a,o,c)=>{let h=Pt("output_data",c,a.length,4),m=Ke("a_data",r[1].dataType,r[1].dims.length,4),x=Ke("b_data",r[2].dataType,r[2].dims.length,4),_=Ke("c_data",r[0].dataType,r[0].dims.length,4),y,S=(R,B,N)=>`select(${B}, ${R}, ${N})`;if(!o)y=h.setByOffset("global_idx",S(m.getByOffset("global_idx"),x.getByOffset("global_idx"),_.getByOffset("global_idx")));else{let R=(B,N,k="")=>{let z=`a_data[index_a${N}][component_a${N}]`,X=`b_data[index_b${N}][component_b${N}]`,j=`bool(c_data[index_c${N}] & (0xffu << (component_c${N} * 8)))`;return`
            let output_indices${N} = ${h.offsetToIndices(`global_idx * 4u + ${N}u`)};
            let offset_a${N} = ${m.broadcastedIndicesToOffset(`output_indices${N}`,h)};
            let offset_b${N} = ${x.broadcastedIndicesToOffset(`output_indices${N}`,h)};
            let offset_c${N} = ${_.broadcastedIndicesToOffset(`output_indices${N}`,h)};
            let index_a${N} = offset_a${N} / 4u;
            let index_b${N} = offset_b${N} / 4u;
            let index_c${N} = offset_c${N} / 4u;
            let component_a${N} = offset_a${N} % 4u;
            let component_b${N} = offset_b${N} % 4u;
            let component_c${N} = offset_c${N} % 4u;
            ${B}[${N}] = ${k}(${S(z,X,j)});
          `};c===9?y=`
            var data = vec4<u32>(0);
            ${R("data",0,"u32")}
            ${R("data",1,"u32")}
            ${R("data",2,"u32")}
            ${R("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:y=`
            ${R("output_data[global_idx]",0)}
            ${R("output_data[global_idx]",1)}
            ${R("output_data[global_idx]",2)}
            ${R("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(_,m,x,h)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${y}
      }`},Ow=e=>{let r=e[1].dims,a=e[2].dims,o=e[0].dims,c=e[1].dataType,h=!(Ve.areEqual(r,a)&&Ve.areEqual(a,o)),m=r,x=Ve.size(r);if(h){let y=xl.calcShape(xl.calcShape(r,a,!1),o,!1);if(!y)throw new Error("Can't perform where op on the given tensors");m=y,x=Ve.size(m)}let _=Math.ceil(x/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:y=>Rw(y,e,m,h,c),getRunData:()=>({outputs:[{dims:m,dataType:c}],dispatchGroup:{x:Math.ceil(x/64/4)},programUniforms:[{type:12,data:_},...Kt(o,r,a,m)]})}},rC=e=>{e.compute(Ow(e.inputs))}}),iC,NT=gt(()=>{W8(),i1(),K8(),Q8(),X8(),Z8(),J8(),iT(),sT(),oT(),lT(),uT(),cT(),fT(),dT(),hT(),pT(),gT(),mT(),xT(),yT(),wT(),bT(),vT(),_T(),C_(),CT(),AT(),ET(),TT(),ST(),r1(),IT(),I_(),RT(),OT(),DT(),T_(),MT(),lo(),a1(),BT(),iC=new Map([["Abs",[X3]],["Acos",[Z3]],["Acosh",[J3]],["Add",[Bv]],["ArgMax",[Y3,Th]],["ArgMin",[H3,Th]],["Asin",[ev]],["Asinh",[tv]],["Atan",[nv]],["Atanh",[rv]],["Attention",[W3]],["AveragePool",[L_,$_]],["BatchNormalization",[K3]],["BiasAdd",[Q3]],["BiasSplitGelu",[Mv]],["Cast",[av,iv]],["Ceil",[ov]],["Clip",[sv]],["Concat",[Vv,qv]],["Conv",[Mh,Dh]],["ConvTranspose",[e_,Jv]],["Cos",[lv]],["Cosh",[uv]],["CumSum",[t_,n_]],["DepthToSpace",[r_,i_]],["DequantizeLinear",[q_,j_]],["Div",[Nv]],["Einsum",[a_,s_]],["Elu",[cv,wu]],["Equal",[kv]],["Erf",[fv]],["Exp",[dv]],["Expand",[o_]],["FastGelu",[l_]],["Floor",[hv]],["FusedConv",[Mh,Dh]],["Gather",[c_,u_]],["GatherElements",[m_,g_]],["GatherBlockQuantized",[h_,p_]],["GatherND",[f_,d_]],["Gelu",[pv]],["Gemm",[y_,x_]],["GlobalAveragePool",[U_,z_]],["GlobalMaxPool",[V_,G_]],["Greater",[Uv]],["GreaterOrEqual",[Fv]],["GridSample",[w_,b_]],["GroupQueryAttention",[R_]],["HardSigmoid",[_v,vv]],["InstanceNormalization",[O_]],["LayerNormalization",[D_]],["LeakyRelu",[gv,wu]],["Less",[Pv]],["LessOrEqual",[Gv]],["Log",[Ov]],["MatMul",[M_]],["MatMulNBits",[B_,N_]],["MaxPool",[P_,F_]],["Mul",[$v]],["MultiHeadAttention",[__,v_]],["Neg",[xv]],["Not",[mv]],["Pad",[k_]],["Pow",[Lv]],["QuickGelu",[Dv,wu]],["Range",[H_]],["Reciprocal",[yv]],["ReduceMin",[F3]],["ReduceMean",[$3]],["ReduceMax",[P3]],["ReduceSum",[V3]],["ReduceProd",[G3]],["ReduceL1",[L3]],["ReduceL2",[z3]],["ReduceLogSum",[j3]],["ReduceLogSumExp",[U3]],["ReduceSumSquare",[q3]],["Relu",[wv]],["Resize",[K_,Q_]],["RotaryEmbedding",[S_]],["ScatterND",[W_,Y_]],["Sigmoid",[bv]],["Sin",[Cv]],["Sinh",[Av]],["Slice",[Z_,J_]],["SkipLayerNormalization",[X_]],["Split",[A_,E_]],["Sqrt",[Ev]],["Softmax",[eC,tC]],["Sub",[zv]],["Tan",[Tv]],["Tanh",[Sv]],["ThresholdedRelu",[Rv,wu]],["Tile",[nC]],["Transpose",[A3,E3]],["Where",[rC]]])}),aC,kT=gt(()=>{Aa(),Ss(),An(),aC=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,r){this.repo.set(e,r)}run(e,r,a,o,c){is(e.programInfo.name);let h=this.backend.device,m=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let x=[];for(let y of r)x.push({binding:x.length,resource:{buffer:y.buffer}});for(let y of a)x.push({binding:x.length,resource:{buffer:y.buffer}});c&&x.push({binding:x.length,resource:c});let _=h.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:x,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let y={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:_,dispatchGroup:o};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(y)}m.setPipeline(e.computePipeline),m.setBindGroup(0,_),m.dispatchWorkgroups(...o),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Ga(e.programInfo.name)}dispose(){}build(e,r){is(e.name);let a=this.backend.device,o=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(y=>{a.features.has(y.feature)&&o.push(`enable ${y.extension};`)});let c=C3(r,this.backend.device.limits),h=e.getShaderSource(c),m=`${o.join(`
`)}
${c.additionalImplementations}
${h}`,x=a.createShaderModule({code:m,label:e.name});Fn("verbose",()=>`[WebGPU] ${e.name} shader code: ${m}`);let _=a.createComputePipeline({compute:{module:x,entryPoint:"main"},layout:"auto",label:e.name});return Ga(e.name),{programInfo:e,computePipeline:_,uniformVariablesInfo:c.variablesInfo}}normalizeDispatchGroupSize(e){let r=typeof e=="number"?e:e.x,a=typeof e=="number"?1:e.y||1,o=typeof e=="number"?1:e.z||1,c=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(r<=c&&a<=c&&o<=c)return[r,a,o];let h=r*a*o,m=Math.ceil(Math.sqrt(h));if(m>c){if(m=Math.ceil(Math.cbrt(h)),m>c)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[m,m,m]}else return[m,m,1]}}}),sC={};bl(sC,{WebGpuBackend:()=>oC});var Dw,Mw,Bw,oC,$T=gt(()=>{Aa(),fn(),Ss(),y3(),H8(),NT(),kT(),Dw=(e,r)=>{if(r.length!==e.length)throw new Error(`inputDependencies length ${r.length} is not equal to inputTensors length ${e.length}.`);let a=[];for(let o=0;o<e.length;++o){let c=e[o].dataType;switch(r[o]){case"none":{a.push("");break}case"type":{a.push(`${c}`);break}case"rank":{let h=e[o].dims.length;a.push(`${c};${h}`);break}case"dims":{let h=e[o].dims.join(",");a.push(`${c};${h}`);break}default:throw new Error(`unsupported input dependency: ${r[o]}`)}}return a.join("|")},Mw=(e,r,a)=>{let o=e.name;return e.shaderCache?.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+a+`:${Dw(r,e.shaderCache?.inputDependencies??new Array(r.length).fill("dims"))}`,o},Bw=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},oC=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,r){this.env=e;let a=[],o={requiredLimits:{maxComputeWorkgroupStorageSize:r.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:r.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:r.limits.maxStorageBufferBindingSize,maxBufferSize:r.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:r.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:r.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:r.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:r.limits.maxComputeWorkgroupSizeZ},requiredFeatures:a},c=h=>r.features.has(h)&&a.push(h)&&!0;c("chromium-experimental-timestamp-query-inside-passes")||c("timestamp-query"),c("shader-f16"),c("subgroups"),this.device=await r.requestDevice(o),this.adapterInfo=new Bw(r.info||await r.requestAdapterInfo()),this.gpuDataManager=v3(this),this.programManager=new aC(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Jh(e.logLevel,!!e.debug),this.device.onuncapturederror=h=>{h.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${h.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:r,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),r={};this.queryType==="at-passes"&&(r.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(r)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;is(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{let r=new BigUint64Array(e.getMappedRange()),a=this.pendingQueries.get(e);for(let o=0;o<r.length/2;o++){let c=a[o],h=c.kernelId,m=this.kernels.get(h),x=m.kernelType,_=m.kernelName,y=c.programName,S=c.inputTensorViews,R=c.outputTensorViews,B=r[o*2],N=r[o*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=B);let k=Number(B-this.queryTimeBase),z=Number(N-this.queryTimeBase);if(!Number.isSafeInteger(k)||!Number.isSafeInteger(z))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:S.map(X=>({dims:X.dims,dataType:Ts(X.dataType)})),outputsMetadata:R.map(X=>({dims:X.dims,dataType:Ts(X.dataType)})),kernelId:h,kernelType:x,kernelName:_,programName:y,startTime:k,endTime:z});else{let X="";S.forEach((F,te)=>{X+=`input[${te}]: [${F.dims}] | ${Ts(F.dataType)}, `});let j="";R.forEach((F,te)=>{j+=`output[${te}]: [${F.dims}] | ${Ts(F.dataType)}, `}),console.log(`[profiling] kernel "${h}|${x}|${_}|${y}" ${X}${j}start time: ${k} ns, execution time: ${z-k} ns`)}ef("GPU",`${y}::${B}::${N}`)}e.unmap(),this.pendingQueries.delete(e)}),Ga()}run(e,r,a,o,c,h){is(e.name);let m=[];for(let F=0;F<r.length;++F){let te=r[F].data;if(te===0)continue;let Q=this.gpuDataManager.get(te);if(!Q)throw new Error(`no GPU data for input: ${te}`);m.push(Q)}let{outputs:x,dispatchGroup:_,programUniforms:y}=e.getRunData(r),S=a.length===0?x.map((F,te)=>te):a;if(S.length!==x.length)throw new Error(`Output size ${S.length} must be equal to ${x.length}.`);let R=[],B=[];for(let F=0;F<x.length;++F){if(!Number.isInteger(S[F])||S[F]<-3||S[F]>=h)throw new Error(`Invalid output index: ${S[F]}`);if(S[F]===-3)continue;let te=S[F]===-1,Q=S[F]===-2,oe=te||Q?c(x[F].dataType,x[F].dims):o(S[F],x[F].dataType,x[F].dims);if(R.push(oe),oe.data===0)continue;let ue=this.gpuDataManager.get(oe.data);if(!ue)throw new Error(`no GPU data for output: ${oe.data}`);if(te&&this.temporaryData.push(ue),Q){let ee=this.kernelPersistentData.get(this.currentKernelId);ee||(ee=[],this.kernelPersistentData.set(this.currentKernelId,ee)),ee.push(ue)}B.push(ue)}if(m.length!==r.length||B.length!==R.length){if(B.length===0)return Ga(e.name),R;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let N;if(y){let F=0,te=[];y.forEach(ee=>{let ce=typeof ee.data=="number"?[ee.data]:ee.data;if(ce.length===0)return;let le=ee.type===10?2:4,Qe,Je;ee.type===10?(Je=ce.length>4?16:ce.length>2?8:ce.length*le,Qe=ce.length>4?16:le*ce.length):(Je=ce.length<=2?ce.length*le:16,Qe=16),F=Math.ceil(F/Je)*Je,te.push(F);let ke=ee.type===10?8:4;F+=ce.length>4?Math.ceil(ce.length/ke)*Qe:ce.length*le});let Q=16;F=Math.ceil(F/Q)*Q;let oe=new ArrayBuffer(F);y.forEach((ee,ce)=>{let le=te[ce],Qe=typeof ee.data=="number"?[ee.data]:ee.data;if(ee.type===6)new Int32Array(oe,le,Qe.length).set(Qe);else if(ee.type===12)new Uint32Array(oe,le,Qe.length).set(Qe);else if(ee.type===10)new Uint16Array(oe,le,Qe.length).set(Qe);else if(ee.type===1)new Float32Array(oe,le,Qe.length).set(Qe);else throw new Error(`Unsupported uniform type: ${Ts(ee.type)}`)});let ue=this.gpuDataManager.create(F,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(ue.buffer,0,oe,0,F),this.gpuDataManager.release(ue.id),N={offset:0,size:F,buffer:ue.buffer}}let k=this.programManager.normalizeDispatchGroupSize(_),z=k[1]===1&&k[2]===1,X=Mw(e,r,z),j=this.programManager.getArtifact(X);if(j||(j=this.programManager.build(e,k),this.programManager.setArtifact(X,j),Fn("info",()=>`[artifact] key: ${X}, programName: ${e.name}`)),y&&j.uniformVariablesInfo){if(y.length!==j.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${j.uniformVariablesInfo.length}, got ${y.length} in program "${j.programInfo.name}".`);for(let F=0;F<y.length;F++){let te=y[F],Q=te.type,oe=typeof te.data=="number"?1:te.data.length,[ue,ee]=j.uniformVariablesInfo[F];if(Q!==ue||oe!==ee)throw new Error(`Uniform variable ${F} mismatch: expect type ${ue} with size ${ee}, got type ${Q} with size ${oe} in program "${j.programInfo.name}".`)}}if(Fn("info",()=>`[ProgramManager] run "${e.name}" (key=${X}) with ${k[0]}x${k[1]}x${k[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let F={kernelId:this.currentKernelId,programName:j.programInfo.name,inputTensorViews:r,outputTensorViews:R};this.pendingKernels.push(F),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(F)}return this.programManager.run(j,m,B,k,N),Ga(e.name),R}upload(e,r){this.gpuDataManager.upload(e,r)}memcpy(e,r){this.gpuDataManager.memcpy(e,r)}async download(e,r){await this.gpuDataManager.download(e,r)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,r,a,o){let c=iC.get(e);if(!c)throw new Error(`kernel not implemented: ${e}`);let h={kernelType:e,kernelName:o,kernelEntry:c[0],attributes:[c[1],a]};this.kernels.set(r,h)}releaseKernel(e){let r=this.kernelPersistentData.get(e);if(r){for(let a of r)this.gpuDataManager.release(a.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,r,a){let o=this.kernels.get(e);if(!o)throw new Error(`kernel not created: ${e}`);let c=o.kernelType,h=o.kernelName,m=o.kernelEntry,x=o.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${c}] ${h}" is not allowed to be called recursively`);this.currentKernelId=e,x[0]&&(x[1]=x[0](x[1]),x[0]=void 0),Fn("info",()=>`[WebGPU] Start to run kernel "[${c}] ${h}"...`);let _=this.env.debug;this.temporaryData=[];try{return _&&this.device.pushErrorScope("validation"),m(r,x[1]),0}catch(y){return a.push(Promise.resolve(`[WebGPU] Kernel "[${c}] ${h}" failed. ${y}`)),1}finally{_&&a.push(this.device.popErrorScope().then(y=>y?`GPU validation error for kernel "[${c}] ${h}": ${y.message}`:null));for(let y of this.temporaryData)this.gpuDataManager.release(y.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,r,a,o){let c=this.sessionExternalDataMapping.get(e);c||(c=new Map,this.sessionExternalDataMapping.set(e,c));let h=c.get(r),m=this.gpuDataManager.registerExternalBuffer(a,o,h);return c.set(r,[m,a]),m}unregisterBuffers(e){let r=this.sessionExternalDataMapping.get(e);r&&(r.forEach(a=>this.gpuDataManager.unregisterExternalBuffer(a[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let r=this.gpuDataManager.get(e);if(!r)throw new Error(`no GPU data for buffer: ${e}`);return r.buffer}createDownloader(e,r,a){return async()=>{let o=await Ch(this,e,r);return e1(o.buffer,a)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Fn("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Fn("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Fn("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),r=this.capturedPendingKernels.get(this.currentSessionId),a=e.length;this.pendingKernels=[];for(let o=0;o<a;o++){let c=this.getComputePassEncoder(),h=e[o];this.writeTimestamp(this.pendingDispatchNumber*2),c.setPipeline(h.computePipeline),c.setBindGroup(0,h.bindGroup),c.dispatchWorkgroups(...h.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(r[o]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),lC={};bl(lC,{init:()=>uC});var kc,Nw,uC,LT=gt(()=>{fn(),Ss(),vn(),j8(),kc=class cC{constructor(r,a,o,c){this.module=r,this.dataType=a,this.data=o,this.dims=c}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let r=Ve.size(this.dims);return r===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,r)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let r=Ve.size(this.dims);return r===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,r)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let r=Ve.size(this.dims);return r===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,r)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let r=Ve.size(this.dims);return r===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,r)}reshape(r){if(Ve.size(r)!==Ve.size(this.dims))throw new Error("Invalid new shape");return new cC(this.module,this.dataType,this.data,r)}},Nw=class{constructor(e,r,a){this.module=e,this.backend=r,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=r.adapterInfo;let o=e.PTR_SIZE,c=a/e.PTR_SIZE,h=o===4?"i32":"i64";this.opKernelContext=Number(e.getValue(o*c++,h));let m=Number(e.getValue(o*c++,h));this.outputCount=Number(e.getValue(o*c++,h)),this.customDataOffset=Number(e.getValue(o*c++,"*")),this.customDataSize=Number(e.getValue(o*c++,h));let x=[];for(let _=0;_<m;_++){let y=Number(e.getValue(o*c++,h)),S=Number(e.getValue(o*c++,"*")),R=Number(e.getValue(o*c++,h)),B=[];for(let N=0;N<R;N++)B.push(Number(e.getValue(o*c++,h)));x.push(new kc(e,y,S,B))}this.inputs=x}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,r){let a=r?.inputs?.map(m=>typeof m=="number"?this.inputs[m]:m)??this.inputs,o=r?.outputs??[],c=(m,x,_)=>new kc(this.module,x,this.output(m,_),_),h=(m,x)=>{let _=Do(m,x);if(!_)throw new Error(`Unsupported data type: ${m}`);let y=_>0?this.backend.gpuDataManager.create(_).id:0;return new kc(this.module,m,y,x)};return this.backend.run(e,a,o,c,h,this.outputCount)}output(e,r){let a=this.module.stackSave();try{let o=this.module.PTR_SIZE,c=o===4?"i32":"i64",h=this.module.stackAlloc((1+r.length)*o);this.module.setValue(h,r.length,c);for(let m=0;m<r.length;m++)this.module.setValue(h+o*(m+1),r[m],c);return this.module._JsepOutput(this.opKernelContext,e,h)}catch(o){throw new Error(`Failed to generate kernel's output[${e}] with dims [${r}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${o}`)}finally{this.module.stackRestore(a)}}},uC=async(e,r,a,o)=>{let c=r.jsepInit;if(!c)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let h=($T(),_u(sC)).WebGpuBackend,m=new h;await m.initialize(a,o),c("webgpu",[m,x=>m.alloc(Number(x)),x=>m.free(x),(x,_,y,S=!1)=>{if(S)Fn("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(x)}, dst=${Number(_)}, size=${Number(y)}`),m.memcpy(Number(x),Number(_));else{Fn("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(x)}, gpuDataId=${Number(_)}, size=${Number(y)}`);let R=r.HEAPU8.subarray(Number(x>>>0),Number(x>>>0)+Number(y));m.upload(Number(_),R)}},async(x,_,y)=>{Fn("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${x}, dataOffset=${_}, size=${y}`),await m.download(Number(x),()=>r.HEAPU8.subarray(Number(_)>>>0,Number(_+y)>>>0))},(x,_,y)=>m.createKernel(x,Number(_),y,r.UTF8ToString(r._JsepGetNodeName(Number(_)))),x=>m.releaseKernel(x),(x,_,y,S)=>{Fn("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${y}, kernel=${x}, contextDataOffset=${_}`);let R=new Nw(r,m,Number(_));return m.computeKernel(Number(x),R,S)},()=>m.captureBegin(),()=>m.captureEnd(),()=>m.replay()])}else{let h=new b3(a);c("webnn",[h,()=>h.reserveTensorId(),m=>h.releaseTensorId(m),async(m,x,_,y,S)=>h.ensureTensor(m,x,_,y,S),(m,x)=>{h.uploadTensor(m,x)},async(m,x)=>h.downloadTensor(m,x),(m,x)=>h.registerMLContext(m,x),!!a.trace])}}}),kw,f1,d1,ao,$w,nh,lf,h1,p1,rh,g1,m1,x1,fC=gt(()=>{Aa(),G8(),V8(),fn(),zo(),Kh(),p3(),kw=(e,r)=>{br()._OrtInit(e,r)!==0&&ur("Can't initialize onnxruntime.")},f1=async e=>{kw(e.wasm.numThreads,nf(e.logLevel))},d1=async(e,r)=>{br().asyncInit?.();let a=e.webgpu.adapter;if(r==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");if(a){if(typeof a.limits!="object"||typeof a.features!="object"||typeof a.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let o=e.webgpu.powerPreference;if(o!==void 0&&o!=="low-power"&&o!=="high-performance")throw new Error(`Invalid powerPreference setting: "${o}"`);let c=e.webgpu.forceFallbackAdapter;if(c!==void 0&&typeof c!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${c}"`);if(a=await navigator.gpu.requestAdapter({powerPreference:o,forceFallbackAdapter:c}),!a)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}}if(r==="webnn"&&(typeof navigator>"u"||!navigator.ml))throw new Error("WebNN is not supported in current environment");{let o=(LT(),_u(lC)).init;r==="webgpu"&&await o("webgpu",br(),e,a),r==="webnn"&&await o("webnn",br(),e)}},ao=new Map,$w=e=>{let r=br(),a=r.stackSave();try{let o=r.PTR_SIZE,c=r.stackAlloc(2*o);r._OrtGetInputOutputCount(e,c,c+o)!==0&&ur("Can't get session input/output count.");let h=o===4?"i32":"i64";return[Number(r.getValue(c,h)),Number(r.getValue(c+o,h))]}finally{r.stackRestore(a)}},nh=(e,r)=>{let a=br(),o=a.stackSave(),c=0;try{let h=a.PTR_SIZE,m=a.stackAlloc(2*h);a._OrtGetInputOutputMetadata(e,r,m,m+h)!==0&&ur("Can't get session input/output metadata.");let x=Number(a.getValue(m,"*"));c=Number(a.getValue(m+h,"*"));let _=a.HEAP32[c/4];if(_===0)return[x,0];let y=a.HEAPU32[c/4+1],S=[];for(let R=0;R<y;R++){let B=Number(a.getValue(c+8+R*h,"*"));S.push(B!==0?a.UTF8ToString(B):Number(a.getValue(c+8+(R+y)*h,"*")))}return[x,_,S]}finally{a.stackRestore(o),c!==0&&a._OrtFree(c)}},lf=e=>{let r=br(),a=r._malloc(e.byteLength);if(a===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return r.HEAPU8.set(e,a),[a,e.byteLength]},h1=async(e,r)=>{let a,o,c=br();Array.isArray(e)?[a,o]=e:e.buffer===c.HEAPU8.buffer?[a,o]=[e.byteOffset,e.byteLength]:[a,o]=lf(e);let h=0,m=0,x=0,_=[],y=[],S=[];try{if([m,_]=await h3(r),r?.externalData&&c.mountExternalData){let Q=[];for(let oe of r.externalData){let ue=typeof oe=="string"?oe:oe.path;Q.push(Zh(typeof oe=="string"?oe:oe.data).then(ee=>{c.mountExternalData(ue,ee)}))}await Promise.all(Q)}for(let Q of r?.executionProviders??[])if((typeof Q=="string"?Q:Q.name)==="webnn"){if(c.shouldTransferToMLTensor=!1,typeof Q!="string"){let oe=Q,ue=oe?.context,ee=oe?.gpuDevice,ce=oe?.deviceType,le=oe?.powerPreference;ue?c.currentContext=ue:ee?c.currentContext=await c.webnnCreateMLContext(ee):c.currentContext=await c.webnnCreateMLContext({deviceType:ce,powerPreference:le})}else c.currentContext=await c.webnnCreateMLContext();break}h=await c._OrtCreateSession(a,o,m),c.webgpuOnCreateSession?.(h),h===0&&ur("Can't create a session."),c.jsepOnCreateSession?.(),c.currentContext&&(c.webnnRegisterMLContext(h,c.currentContext),c.currentContext=void 0,c.shouldTransferToMLTensor=!0);let[R,B]=$w(h),N=!!r?.enableGraphCapture,k=[],z=[],X=[],j=[],F=[];for(let Q=0;Q<R;Q++){let[oe,ue,ee]=nh(h,Q);oe===0&&ur("Can't get an input name."),y.push(oe);let ce=c.UTF8ToString(oe);k.push(ce),X.push(ue===0?{name:ce,isTensor:!1}:{name:ce,isTensor:!0,type:Ts(ue),shape:ee})}for(let Q=0;Q<B;Q++){let[oe,ue,ee]=nh(h,Q+R);oe===0&&ur("Can't get an output name."),S.push(oe);let ce=c.UTF8ToString(oe);z.push(ce),j.push(ue===0?{name:ce,isTensor:!1}:{name:ce,isTensor:!0,type:Ts(ue),shape:ee});{if(N&&r?.preferredOutputLocation===void 0){F.push("gpu-buffer");continue}let le=typeof r?.preferredOutputLocation=="string"?r.preferredOutputLocation:r?.preferredOutputLocation?.[ce]??"cpu",Qe=c.webnnIsGraphOutput;if(le==="cpu"&&Qe&&Qe(h,ce)){F.push("ml-tensor-cpu-output");continue}if(le!=="cpu"&&le!=="cpu-pinned"&&le!=="gpu-buffer"&&le!=="ml-tensor")throw new Error(`Not supported preferred output location: ${le}.`);if(N&&le!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${le}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);F.push(le)}}let te=null;return F.some(Q=>Q==="gpu-buffer"||Q==="ml-tensor"||Q==="ml-tensor-cpu-output")&&(x=c._OrtCreateBinding(h),x===0&&ur("Can't create IO binding."),te={handle:x,outputPreferredLocations:F,outputPreferredLocationsEncoded:F.map(Q=>Q==="ml-tensor-cpu-output"?"ml-tensor":Q).map(Q=>vh(Q))}),ao.set(h,[h,y,S,te,N,!1]),[h,k,z,X,j]}catch(R){throw y.forEach(B=>c._OrtFree(B)),S.forEach(B=>c._OrtFree(B)),x!==0&&c._OrtReleaseBinding(x)!==0&&ur("Can't release IO binding."),h!==0&&c._OrtReleaseSession(h)!==0&&ur("Can't release session."),R}finally{c._free(a),m!==0&&c._OrtReleaseSessionOptions(m)!==0&&ur("Can't release session options."),_.forEach(R=>c._free(R)),c.unmountExternalData?.()}},p1=e=>{let r=br(),a=ao.get(e);if(!a)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,c,h,m,x]=a;m&&(x&&r._OrtClearBoundOutputs(m.handle)!==0&&ur("Can't clear bound outputs."),r._OrtReleaseBinding(m.handle)!==0&&ur("Can't release IO binding.")),r.jsepOnReleaseSession?.(e),r.webnnOnReleaseSession?.(e),r.webgpuOnReleaseSession?.(e),c.forEach(_=>r._OrtFree(_)),h.forEach(_=>r._OrtFree(_)),r._OrtReleaseSession(o)!==0&&ur("Can't release session."),ao.delete(e)},rh=async(e,r,a,o,c,h,m=!1)=>{if(!e){r.push(0);return}let x=br(),_=x.PTR_SIZE,y=e[0],S=e[1],R=e[3],B=R,N,k;if(y==="string"&&(R==="gpu-buffer"||R==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(m&&R!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${h} when enableGraphCapture is true.`);if(R==="gpu-buffer"){let j=e[2].gpuBuffer;k=Do(Oo(y),S);{let F=x.jsepRegisterBuffer;if(!F)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');N=F(o,h,j,k)}}else if(R==="ml-tensor"){let j=e[2].mlTensor;k=Do(Oo(y),S);let F=x.webnnRegisterMLTensor;if(!F)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');N=F(o,j,Oo(y),S)}else{let j=e[2];if(Array.isArray(j)){k=_*j.length,N=x._malloc(k),a.push(N);for(let F=0;F<j.length;F++){if(typeof j[F]!="string")throw new TypeError(`tensor data at index ${F} is not a string`);x.setValue(N+F*_,Pa(j[F],a),"*")}}else{let F=x.webnnIsGraphInput,te=x.webnnIsGraphOutput;if(y!=="string"&&F&&te){let Q=x.UTF8ToString(c);if(F(o,Q)||te(o,Q)){let oe=Oo(y);k=Do(oe,S),B="ml-tensor";let ue=x.webnnCreateTemporaryTensor,ee=x.webnnUploadTensor;if(!ue||!ee)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let ce=await ue(o,oe,S);ee(ce,new Uint8Array(j.buffer,j.byteOffset,j.byteLength)),N=ce}else k=j.byteLength,N=x._malloc(k),a.push(N),x.HEAPU8.set(new Uint8Array(j.buffer,j.byteOffset,k),N)}else k=j.byteLength,N=x._malloc(k),a.push(N),x.HEAPU8.set(new Uint8Array(j.buffer,j.byteOffset,k),N)}}let z=x.stackSave(),X=x.stackAlloc(4*S.length);try{S.forEach((F,te)=>x.setValue(X+te*_,F,_===4?"i32":"i64"));let j=x._OrtCreateTensor(Oo(y),N,k,X,S.length,vh(B));j===0&&ur(`Can't create tensor for input/output. session=${o}, index=${h}.`),r.push(j)}finally{x.stackRestore(z)}},g1=async(e,r,a,o,c,h)=>{let m=br(),x=m.PTR_SIZE,_=ao.get(e);if(!_)throw new Error(`cannot run inference. invalid session id: ${e}`);let y=_[0],S=_[1],R=_[2],B=_[3],N=_[4],k=_[5],z=r.length,X=o.length,j=0,F=[],te=[],Q=[],oe=[],ue=m.stackSave(),ee=m.stackAlloc(z*x),ce=m.stackAlloc(z*x),le=m.stackAlloc(X*x),Qe=m.stackAlloc(X*x);try{[j,F]=d3(h),Mo("wasm prepareInputOutputTensor");for(let et=0;et<z;et++)await rh(a[et],te,oe,e,S[r[et]],r[et],N);for(let et=0;et<X;et++)await rh(c[et],Q,oe,e,R[o[et]],z+o[et],N);Bo("wasm prepareInputOutputTensor");for(let et=0;et<z;et++)m.setValue(ee+et*x,te[et],"*"),m.setValue(ce+et*x,S[r[et]],"*");for(let et=0;et<X;et++)m.setValue(le+et*x,Q[et],"*"),m.setValue(Qe+et*x,R[o[et]],"*");if(B&&!k){let{handle:et,outputPreferredLocations:ve,outputPreferredLocationsEncoded:xe}=B;if(S.length!==z)throw new Error(`input count from feeds (${z}) is expected to be always equal to model's input count (${S.length}).`);Mo("wasm bindInputsOutputs");for(let _e=0;_e<z;_e++){let Ge=r[_e];await m._OrtBindInput(et,S[Ge],te[_e])!==0&&ur(`Can't bind input[${_e}] for session=${e}.`)}for(let _e=0;_e<X;_e++){let Ge=o[_e];c[_e]?.[3]?m._OrtBindOutput(et,R[Ge],Q[_e],0)!==0&&ur(`Can't bind pre-allocated output[${_e}] for session=${e}.`):m._OrtBindOutput(et,R[Ge],0,xe[Ge])!==0&&ur(`Can't bind output[${_e}] to ${ve[_e]} for session=${e}.`)}Bo("wasm bindInputsOutputs"),ao.set(e,[y,S,R,B,N,!0])}m.jsepOnRunStart?.(y),m.webnnOnRunStart?.(y);let Je;B?Je=await m._OrtRunWithBinding(y,B.handle,X,le,j):Je=await m._OrtRun(y,ce,ee,z,Qe,X,le,j),Je!==0&&ur("failed to call OrtRun().");let ke=[],at=[];Mo("wasm ProcessOutputTensor");for(let et=0;et<X;et++){let ve=Number(m.getValue(le+et*x,"*"));if(ve===Q[et]){ke.push(c[et]);continue}let xe=m.stackSave(),_e=m.stackAlloc(4*x),Ge=!1,qe,ft=0;try{m._OrtGetTensorData(ve,_e,_e+x,_e+2*x,_e+3*x)!==0&&ur(`Can't access output tensor data on index ${et}.`);let ne=x===4?"i32":"i64",fe=Number(m.getValue(_e,ne));ft=m.getValue(_e+x,"*");let De=m.getValue(_e+x*2,"*"),Le=Number(m.getValue(_e+x*3,ne)),pe=[];for(let At=0;At<Le;At++)pe.push(Number(m.getValue(De+At*x,ne)));m._OrtFree(De)!==0&&ur("Can't free memory for tensor dims.");let Me=pe.reduce((At,It)=>At*It,1);qe=Ts(fe);let Bt=B?.outputPreferredLocations[o[et]];if(qe==="string"){if(Bt==="gpu-buffer"||Bt==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let At=[];for(let It=0;It<Me;It++){let Rt=m.getValue(ft+It*x,"*"),ht=m.getValue(ft+(It+1)*x,"*"),mt=It===Me-1?void 0:ht-Rt;At.push(m.UTF8ToString(Rt,mt))}ke.push([qe,pe,At,"cpu"])}else if(Bt==="gpu-buffer"&&Me>0){let At=m.jsepGetBuffer;if(!At)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let It=At(ft),Rt=Do(fe,Me);if(Rt===void 0||!Qh(qe))throw new Error(`Unsupported data type: ${qe}`);Ge=!0,ke.push([qe,pe,{gpuBuffer:It,download:m.jsepCreateDownloader(It,Rt,qe),dispose:()=>{m._OrtReleaseTensor(ve)!==0&&ur("Can't release tensor.")}},"gpu-buffer"])}else if(Bt==="ml-tensor"&&Me>0){let At=m.webnnEnsureTensor,It=m.webnnIsGraphInputOutputTypeSupported;if(!At||!It)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(Do(fe,Me)===void 0||!Xh(qe))throw new Error(`Unsupported data type: ${qe}`);if(!It(e,qe,!1))throw new Error(`preferredLocation "ml-tensor" for ${qe} output is not supported by current WebNN Context.`);let Rt=await At(e,ft,fe,pe,!1);Ge=!0,ke.push([qe,pe,{mlTensor:Rt,download:m.webnnCreateMLTensorDownloader(ft,qe),dispose:()=>{m.webnnReleaseTensorId(ft),m._OrtReleaseTensor(ve)}},"ml-tensor"])}else if(Bt==="ml-tensor-cpu-output"&&Me>0){let At=m.webnnCreateMLTensorDownloader(ft,qe)(),It=ke.length;Ge=!0,at.push((async()=>{let Rt=[It,await At];return m.webnnReleaseTensorId(ft),m._OrtReleaseTensor(ve),Rt})()),ke.push([qe,pe,[],"cpu"])}else{let At=gf(qe),It=new At(Me);new Uint8Array(It.buffer,It.byteOffset,It.byteLength).set(m.HEAPU8.subarray(ft,ft+It.byteLength)),ke.push([qe,pe,It,"cpu"])}}finally{m.stackRestore(xe),qe==="string"&&ft&&m._free(ft),Ge||m._OrtReleaseTensor(ve)}}B&&!N&&(m._OrtClearBoundOutputs(B.handle)!==0&&ur("Can't clear bound outputs."),ao.set(e,[y,S,R,B,N,!1]));for(let[et,ve]of await Promise.all(at))ke[et][2]=ve;return Bo("wasm ProcessOutputTensor"),ke}finally{m.webnnOnRunEnd?.(y),m.stackRestore(ue),te.forEach(Je=>m._OrtReleaseTensor(Je)),Q.forEach(Je=>m._OrtReleaseTensor(Je)),oe.forEach(Je=>m._free(Je)),j!==0&&m._OrtReleaseRunOptions(j),F.forEach(Je=>m._free(Je))}},m1=e=>{let r=br(),a=ao.get(e);if(!a)throw new Error("invalid session id");let o=a[0],c=r._OrtEndProfiling(o);c===0&&ur("Can't get an profile file name."),r._OrtFree(c)},x1=e=>{let r=[];for(let a of e){let o=a[2];!Array.isArray(o)&&"buffer"in o&&r.push(o.buffer)}return r}}),so,Ca,fl,cu,fu,$c,ih,Lc,So,Io,Lw,dC,hC,pC,gC,mC,xC,yC,wC=gt(()=>{Aa(),fC(),zo(),Yh(),so=()=>!!Ar.wasm.proxy&&typeof document<"u",fl=!1,cu=!1,fu=!1,Lc=new Map,So=(e,r)=>{let a=Lc.get(e);a?a.push(r):Lc.set(e,[r])},Io=()=>{if(fl||!cu||fu||!Ca)throw new Error("worker not ready")},Lw=e=>{switch(e.data.type){case"init-wasm":fl=!1,e.data.err?(fu=!0,ih[1](e.data.err)):(cu=!0,ih[0]()),$c&&(URL.revokeObjectURL($c),$c=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let r=Lc.get(e.data.type);e.data.err?r.shift()[1](e.data.err):r.shift()[0](e.data.out);break}}},dC=async()=>{if(!cu){if(fl)throw new Error("multiple calls to 'initWasm()' detected.");if(fu)throw new Error("previous call to 'initWasm()' failed.");if(fl=!0,so())return new Promise((e,r)=>{Ca?.terminate(),c3().then(([a,o])=>{try{Ca=o,Ca.onerror=h=>r(h),Ca.onmessage=Lw,ih=[e,r];let c={type:"init-wasm",in:Ar};!c.in.wasm.wasmPaths&&(a||bh)&&(c.in.wasm.wasmPaths={wasm:new URL(""+new URL("ort-wasm-simd-threaded.jsep-BGTZ4Y7F.wasm",import.meta.url).href,import.meta.url).href}),Ca.postMessage(c),$c=a}catch(c){r(c)}},r)});try{await Wh(Ar.wasm),await f1(Ar),cu=!0}catch(e){throw fu=!0,e}finally{fl=!1}}},hC=async e=>{if(so())return Io(),new Promise((r,a)=>{So("init-ep",[r,a]);let o={type:"init-ep",in:{epName:e,env:Ar}};Ca.postMessage(o)});await d1(Ar,e)},pC=async e=>so()?(Io(),new Promise((r,a)=>{So("copy-from",[r,a]);let o={type:"copy-from",in:{buffer:e}};Ca.postMessage(o,[e.buffer])})):lf(e),gC=async(e,r)=>{if(so()){if(r?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Io(),new Promise((a,o)=>{So("create",[a,o]);let c={type:"create",in:{model:e,options:{...r}}},h=[];e instanceof Uint8Array&&h.push(e.buffer),Ca.postMessage(c,h)})}else return h1(e,r)},mC=async e=>{if(so())return Io(),new Promise((r,a)=>{So("release",[r,a]);let o={type:"release",in:e};Ca.postMessage(o)});p1(e)},xC=async(e,r,a,o,c,h)=>{if(so()){if(a.some(m=>m[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(c.some(m=>m))throw new Error("pre-allocated output tensor is not supported for proxy.");return Io(),new Promise((m,x)=>{So("run",[m,x]);let _=a,y={type:"run",in:{sessionId:e,inputIndices:r,inputs:_,outputIndices:o,options:h}};Ca.postMessage(y,x1(_))})}else return g1(e,r,a,o,c,h)},yC=async e=>{if(so())return Io(),new Promise((r,a)=>{So("end-profiling",[r,a]);let o={type:"end-profiling",in:e};Ca.postMessage(o)});m1(e)}}),ah,zw,bC,zT=gt(()=>{Aa(),wC(),fn(),Hh(),p3(),ah=(e,r)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${e.location} for ${r()}`)}},zw=e=>{switch(e[3]){case"cpu":return new Fa(e[0],e[2],e[1]);case"gpu-buffer":{let r=e[0];if(!Qh(r))throw new Error(`not supported data type: ${r} for deserializing GPU tensor`);let{gpuBuffer:a,download:o,dispose:c}=e[2];return Fa.fromGpuBuffer(a,{dataType:r,dims:e[1],download:o,dispose:c})}case"ml-tensor":{let r=e[0];if(!Xh(r))throw new Error(`not supported data type: ${r} for deserializing MLTensor tensor`);let{mlTensor:a,download:o,dispose:c}=e[2];return Fa.fromMLTensor(a,{dataType:r,dims:e[1],download:o,dispose:c})}default:throw new Error(`invalid data location: ${e[3]}`)}},bC=class{async fetchModelAndCopyToWasmMemory(e){return pC(await Zh(e))}async loadModel(e,r){is();let a;typeof e=="string"?a=await this.fetchModelAndCopyToWasmMemory(e):a=e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await gC(a,r),Ga()}async dispose(){return mC(this.sessionId)}async run(e,r,a){is();let o=[],c=[];Object.entries(e).forEach(R=>{let B=R[0],N=R[1],k=this.inputNames.indexOf(B);if(k===-1)throw new Error(`invalid input '${B}'`);o.push(N),c.push(k)});let h=[],m=[];Object.entries(r).forEach(R=>{let B=R[0],N=R[1],k=this.outputNames.indexOf(B);if(k===-1)throw new Error(`invalid output '${B}'`);h.push(N),m.push(k)});let x=o.map((R,B)=>ah(R,()=>`input "${this.inputNames[c[B]]}"`)),_=h.map((R,B)=>R?ah(R,()=>`output "${this.outputNames[m[B]]}"`):null),y=await xC(this.sessionId,c,x,m,_,a),S={};for(let R=0;R<y.length;R++)S[this.outputNames[m[R]]]=h[R]??zw(y[R]);return Ga(),S}startProfiling(){}endProfiling(){yC(this.sessionId)}}}),vC={};bl(vC,{OnnxruntimeWebAssemblyBackend:()=>kh,initializeFlags:()=>Nh,wasmBackend:()=>_C});var Nh,kh,_C,UT=gt(()=>{Aa(),wC(),zT(),Nh=()=>{(typeof Ar.wasm.initTimeout!="number"||Ar.wasm.initTimeout<0)&&(Ar.wasm.initTimeout=0);let e=Ar.wasm.simd;if(typeof e!="boolean"&&e!==void 0&&e!=="fixed"&&e!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),Ar.wasm.simd=!1),typeof Ar.wasm.proxy!="boolean"&&(Ar.wasm.proxy=!1),typeof Ar.wasm.trace!="boolean"&&(Ar.wasm.trace=!1),typeof Ar.wasm.numThreads!="number"||!Number.isInteger(Ar.wasm.numThreads)||Ar.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)Ar.wasm.numThreads=1;else{let r=typeof navigator>"u"?A8("node:os").cpus().length:navigator.hardwareConcurrency;Ar.wasm.numThreads=Math.min(4,Math.ceil((r||1)/2))}},kh=class{async init(e){Nh(),await dC(),await hC(e)}async createInferenceSessionHandler(e,r){let a=new bC;return await a.loadModel(e,r),a}},_C=new kh});Aa();Aa();Aa();var PT="1.23.2";{let e=(UT(),_u(vC)).wasmBackend;hl("webgpu",e,5),hl("webnn",e,5),hl("cpu",e,10),hl("wasm",e,10)}Object.defineProperty(Ar.versions,"web",{value:PT,enumerable:!0});const FT=.5,du="GeoCodeModel",hu="1.0.0";let uf=null,Uw=!1,Yc=null;async function GT(){if(Uw&&uf)return!0;if(Yc)return!1;try{return uf=await jh.create("./GeoCodeModel.onnx"),Uw=!0,console.log("[AI] GeoCodeModel.onnx  "),!0}catch(e){return Yc=e instanceof Error?e.message:"MODEL_LOAD_FAIL",console.warn("[AI]   :",Yc),!1}}async function VT(e){return new Promise((r,a)=>{const o=new Image;o.crossOrigin="anonymous",o.onload=()=>{const c=document.createElement("canvas");c.width=224,c.height=224;const h=c.getContext("2d");if(!h){a(new Error("Canvas context failed"));return}h.drawImage(o,0,0,224,224);const m=h.getImageData(0,0,224,224),{data:x}=m,_=new Float32Array(672*224);for(let S=0;S<50176;S++)_[S]=x[S*4]/255,_[50176+S]=x[S*4+1]/255,_[448*224+S]=x[S*4+2]/255;const y=new Fa("float32",_,[1,3,224,224]);r(y)},o.onerror=()=>a(new Error("Image load failed")),o.src=e})}async function qT(e){if(!e||e==="scan-mode-no-image")return{status:"NOT_DETECTED",geocodeId:null,confidence:null,reason:"NO_IMAGE",ai_mode:"real",ai_status:"skipped",model_name:du,model_version:hu};if(!await GT()||!uf)return console.warn("[AI]    -  "),{status:"SKIPPED",geocodeId:null,confidence:null,reason:Yc||"MODEL_UNAVAILABLE",ai_mode:"real",ai_status:"unavailable",model_name:du,model_version:hu};try{const o={input:await VT(e)},c=await uf.run(o),m=(c.output||c[Object.keys(c)[0]]).data[0];return console.log("[AI]   - confidence:",m),m>=FT?{status:"DETECTED",geocodeId:jT(),confidence:m,ai_mode:"real",ai_status:"success",model_name:du,model_version:hu}:{status:"NOT_DETECTED",geocodeId:null,confidence:m,ai_mode:"real",ai_status:"success",model_name:du,model_version:hu}}catch(a){const o=a instanceof Error?a.message:"INFER_FAIL";return console.warn("[AI]   -  :",o),{status:"SKIPPED",geocodeId:null,confidence:null,reason:o,ai_mode:"real",ai_status:"skipped",model_name:du,model_version:hu}}}function jT(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let r="GEO-";for(let a=0;a<12;a++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}async function HT(e){return await qT(e)}const YT=e=>{const r=new Map;r.set("web",{name:"web"});const a=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:r},o=(h,m)=>{a.platforms.set(h,m)},c=h=>{a.platforms.has(h)&&(a.currentPlatform=a.platforms.get(h))};return a.addPlatform=o,a.setPlatform=c,a},WT=e=>e.CapacitorPlatforms=YT(e),CC=WT(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});CC.addPlatform;CC.setPlatform;var wl;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(wl||(wl={}));class sh extends Error{constructor(r,a){super(r),this.message=r,this.code=a}}const KT=e=>{var r,a;return e?.androidBridge?"android":!((a=(r=e?.webkit)===null||r===void 0?void 0:r.messageHandlers)===null||a===void 0)&&a.bridge?"ios":"web"},QT=e=>{var r,a,o,c,h;const m=e.CapacitorCustomPlatform||null,x=e.Capacitor||{},_=x.Plugins=x.Plugins||{},y=e.CapacitorPlatforms,S=()=>m!==null?m.name:KT(e),R=((r=y?.currentPlatform)===null||r===void 0?void 0:r.getPlatform)||S,B=()=>R()!=="web",N=((a=y?.currentPlatform)===null||a===void 0?void 0:a.isNativePlatform)||B,k=ee=>{const ce=Q.get(ee);return!!(ce?.platforms.has(R())||j(ee))},z=((o=y?.currentPlatform)===null||o===void 0?void 0:o.isPluginAvailable)||k,X=ee=>{var ce;return(ce=x.PluginHeaders)===null||ce===void 0?void 0:ce.find(le=>le.name===ee)},j=((c=y?.currentPlatform)===null||c===void 0?void 0:c.getPluginHeader)||X,F=ee=>e.console.error(ee),te=(ee,ce,le)=>Promise.reject(`${le} does not have an implementation of "${ce}".`),Q=new Map,oe=(ee,ce={})=>{const le=Q.get(ee);if(le)return console.warn(`Capacitor plugin "${ee}" already registered. Cannot register plugins twice.`),le.proxy;const Qe=R(),Je=j(ee);let ke;const at=async()=>(!ke&&Qe in ce?ke=typeof ce[Qe]=="function"?ke=await ce[Qe]():ke=ce[Qe]:m!==null&&!ke&&"web"in ce&&(ke=typeof ce.web=="function"?ke=await ce.web():ke=ce.web),ke),et=(ft,ne)=>{var fe,De;if(Je){const Le=Je?.methods.find(pe=>ne===pe.name);if(Le)return Le.rtype==="promise"?pe=>x.nativePromise(ee,ne.toString(),pe):(pe,Me)=>x.nativeCallback(ee,ne.toString(),pe,Me);if(ft)return(fe=ft[ne])===null||fe===void 0?void 0:fe.bind(ft)}else{if(ft)return(De=ft[ne])===null||De===void 0?void 0:De.bind(ft);throw new sh(`"${ee}" plugin is not implemented on ${Qe}`,wl.Unimplemented)}},ve=ft=>{let ne;const fe=(...De)=>{const Le=at().then(pe=>{const Me=et(pe,ft);if(Me){const Bt=Me(...De);return ne=Bt?.remove,Bt}else throw new sh(`"${ee}.${ft}()" is not implemented on ${Qe}`,wl.Unimplemented)});return ft==="addListener"&&(Le.remove=async()=>ne()),Le};return fe.toString=()=>`${ft.toString()}() { [capacitor code] }`,Object.defineProperty(fe,"name",{value:ft,writable:!1,configurable:!1}),fe},xe=ve("addListener"),_e=ve("removeListener"),Ge=(ft,ne)=>{const fe=xe({eventName:ft},ne),De=async()=>{const pe=await fe;_e({eventName:ft,callbackId:pe},ne)},Le=new Promise(pe=>fe.then(()=>pe({remove:De})));return Le.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await De()},Le},qe=new Proxy({},{get(ft,ne){switch(ne){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Je?Ge:xe;case"removeListener":return _e;default:return ve(ne)}}});return _[ee]=qe,Q.set(ee,{name:ee,proxy:qe,platforms:new Set([...Object.keys(ce),...Je?[Qe]:[]])}),qe},ue=((h=y?.currentPlatform)===null||h===void 0?void 0:h.registerPlugin)||oe;return x.convertFileSrc||(x.convertFileSrc=ee=>ee),x.getPlatform=R,x.handleError=F,x.isNativePlatform=N,x.isPluginAvailable=z,x.pluginMethodNoop=te,x.registerPlugin=ue,x.Exception=sh,x.DEBUG=!!x.DEBUG,x.isLoggingEnabled=!!x.isLoggingEnabled,x.platform=x.getPlatform(),x.isNative=x.isNativePlatform(),x},XT=e=>e.Capacitor=QT(e),cf=XT(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ZT=cf.registerPlugin;cf.Plugins;class uS{constructor(r){this.listeners={},this.windowListeners={},r&&(console.warn(`Capacitor WebPlugin "${r.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=r)}addListener(r,a){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(a);const c=this.windowListeners[r];c&&!c.registered&&this.addWindowListener(c);const h=async()=>this.removeListener(r,a),m=Promise.resolve({remove:h});return Object.defineProperty(m,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await h()}}),m}async removeAllListeners(){this.listeners={};for(const r in this.windowListeners)this.removeWindowListener(this.windowListeners[r]);this.windowListeners={}}notifyListeners(r,a){const o=this.listeners[r];o&&o.forEach(c=>c(a))}hasListeners(r){return!!this.listeners[r].length}registerWindowListener(r,a){this.windowListeners[a]={registered:!1,windowEventName:r,pluginEventName:a,handler:o=>{this.notifyListeners(a,o)}}}unimplemented(r="not implemented"){return new cf.Exception(r,wl.Unimplemented)}unavailable(r="not available"){return new cf.Exception(r,wl.Unavailable)}async removeListener(r,a){const o=this.listeners[r];if(!o)return;const c=o.indexOf(a);this.listeners[r].splice(c,1),this.listeners[r].length||this.removeWindowListener(this.windowListeners[r])}addWindowListener(r){window.addEventListener(r.windowEventName,r.handler),r.registered=!0}removeWindowListener(r){r&&(window.removeEventListener(r.windowEventName,r.handler),r.registered=!1)}}const $h=ZT("Http",{web:()=>Jc(()=>import("./web-DrZb8bl-.js"),[],import.meta.url).then(e=>new e.HttpWeb),electron:()=>Jc(()=>import("./web-DrZb8bl-.js"),[],import.meta.url).then(e=>new e.HttpWeb)}),Lh="https://geostudio-api-production.up.railway.app";function JT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})}async function eS(e){const a=new TextEncoder().encode(e),o=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(o)).map(h=>h.toString(16).padStart(2,"0")).join("")}async function tS(e){try{if(e.startsWith("data:image"))return e.replace(/^data:image\/\w+;base64,/,"");const a=await(await fetch(e)).blob();return new Promise((o,c)=>{const h=new FileReader;h.onloadend=()=>{const m=h.result.replace(/^data:image\/\w+;base64,/,"");o(m)},h.onerror=c,h.readAsDataURL(a)})}catch(r){throw console.error("[imageUriToBase64] Error:",r),new Error("IMAGE_CONVERT_FAILED: "+(r instanceof Error?r.message:String(r)))}}async function nS(e,r,a,o){try{console.log("[verifyWithServer] Starting scan for:",e);const h=(await $h.request({method:"POST",url:Lh+"/api/geocam/scan/start",headers:{"Content-Type":"application/json"},data:{qr_payload:e,device_id:r}})).data;if(console.log("[verifyWithServer] scan/start response:",h.success,h.asset_status),!h.success)return{success:!1,isAuthentic:!1,status:"UNKNOWN",error:h.error||"SCAN_START_FAILED"};const m=h.asset_info?.dina_id||e;let x=null;try{x=await zb(h.nonce,m),console.log("[verifyWithServer] Gate A signature created, ts:",x.client_timestamp)}catch(N){console.warn("[verifyWithServer] Gate A signature failed:",N)}let _=null;try{_=await Ub(),console.log("[verifyWithServer] Gate B payload ready, platform:",_.device_info.platform)}catch(N){console.warn("[verifyWithServer] Gate B payload failed:",N)}let y=null;try{y=await Pb(),y&&console.log("[verifyWithServer] Gate C GPS:",y.gps.latitude,y.gps.longitude)}catch(N){console.warn("[verifyWithServer] Gate C GPS failed:",N)}const R=(await $h.request({method:"POST",url:Lh+"/api/geocam/verify",headers:{"Content-Type":"application/json"},data:{session_token:h.session_token,nonce:h.nonce,image_data:a,client_confidence:o,device_info:_?.device_info||{platform:"web",model:navigator.platform||"Unknown",os_version:navigator.userAgent.substring(0,50)},app_attestation:_?.app_attestation,...x&&{signature:x.signature,public_key:x.public_key,client_timestamp:x.client_timestamp},...y&&{gps:y.gps}}})).data;console.log("[verifyWithServer] verify response:",R.success,R.result,R.confidence,"trust:",R.trust_level);let B=R.error||void 0;if(R.trust_level==="L1_OBSERVATION"&&R.gate_results){const N=R.gate_results.filter(k=>!k.passed);N.length>0&&(B=B||"WRITE_GATE_FAILED",console.warn("[verifyWithServer] Gate failures:",N.map(k=>k.gate+":"+k.reason).join(", ")))}return{success:R.success,isAuthentic:R.result==="VALID",status:R.result||"UNKNOWN",confidence:R.confidence,sessionToken:h.session_token,nonce:h.nonce,dinaId:R.matched_dina_id||h.asset_info?.dina_id,assetInfo:h.asset_info,error:R.error,error_code:B}}catch(c){console.error("[verifyWithServer] Error:",c);const h=c?.status||0;let m=c instanceof Error?c.message:String(c);return h===429&&(m="RATE_LIMIT_EXCEEDED"),{success:!1,isAuthentic:!1,status:"ERROR",error:m,error_code:m,httpStatus:h}}}async function rS(e,r,a){try{let o={};try{const _=await zb(a,r);o={signature:_.signature,public_key:_.public_key,client_timestamp:_.client_timestamp}}catch(_){console.warn("[registerWithServer] Gate A failed:",_)}let c={};try{const _=await Ub();c={device_info:_.device_info,app_attestation:_.app_attestation}}catch(_){console.warn("[registerWithServer] Gate B failed:",_)}let h={};try{const _=await Pb();_&&(h={gps:_.gps})}catch(_){console.warn("[registerWithServer] Gate C failed:",_)}const x=(await $h.request({method:"POST",url:Lh+"/api/geocam/register",headers:{"Content-Type":"application/json"},data:{session_token:e,nonce:a,dina_id:r,...o,...c,...h}})).data;return{success:x.success,status:x.status,error:x.error,error_code:x.error}}catch(o){const c=o?.status||0;let h=o instanceof Error?o.message:String(o);return c===429&&(h="RATE_LIMIT_EXCEEDED"),{success:!1,status:"ERROR",error:h,error_code:h}}}async function iS(e){try{const r=z4(e.qrRaw);if(L4(r))return{ok:!1,error:"QR_PARSE_FAILED: "+r.error,qr_status:"invalid",verify_status:"INVALID"};const a=r.status,o=Zm(r)?null:r.dina_code,c=Zm(r)?null:r.otp||null;console.log("[Pipeline] QR:",a,"| DINA:",o);const h=await HT(e.imageUri);console.log("[Pipeline] Local AI:",h.status,"| confidence:",h.confidence);let m=null;try{m=await tS(e.imageUri),console.log("[Pipeline] Image converted to Base64, length:",m?.length||0)}catch(F){console.error("[Pipeline] Image conversion failed:",F)}let x=null;if(o&&m){const F=h.confidence!==null?Math.round(h.confidence*100):void 0;x=await nS(o,e.deviceFingerprintHash,m,F),console.log("[Pipeline] Server verify:",x.status,"| confidence:",x.confidence)}if(x&&!x.success&&x.error_code){const F=x.error_code;if(F==="BATCH_NOT_SHIPPED"||F==="BATCH_TEMPORARILY_LOCKED"||F==="RATE_LIMIT_EXCEEDED")return{ok:!1,error:F,error_code:F,verify_status:"INVALID"}}let _,y=null;if(x&&x.success)x.status==="VALID"?_="VALID":x.status==="UNCERTAIN"?_="SUSPECT":x.status==="INVALID"?_="INVALID":_="UNKNOWN",y=x.confidence||null;else{const F=h.confidence;h.status==="DETECTED"?(F!==null&&F>=.8?_="VALID":(F!==null&&F>=.5,_="SUSPECT"),y=F!==null?Math.round(F*100):null):h.status==="NOT_DETECTED"?_="INVALID":_="UNKNOWN"}const S={version:"2.0",qr_status:a,dinaCode:o,otp:c,imageUri:e.imageUri,geoBucket:e.geoBucket||null,deviceFingerprintHash:e.deviceFingerprintHash,geocode:{status:h.status,geocodeId:h.geocodeId||null,confidence:h.confidence||null,ai_mode:h.ai_mode,ai_status:h.ai_status,model_name:h.model_name,model_version:h.model_version},server:x?{success:x.success,status:x.status,confidence:x.confidence,dinaId:x.dinaId,sessionToken:x.sessionToken}:null,timestamp:new Date().toISOString()},R=U4(S),B=await eS(R),N=await Lb(),k=await Q4(R);let z=!1;try{z=X4(R,k.signatureBase64,N.publicKeyHex)}catch(F){console.warn("[Pipeline] Local signature verification failed:",F)}const X=JT();return{ok:_==="VALID"||_==="SUSPECT",recordId:X,packHash:B,qr_status:a,verify_status:_,confidence:y,error_code:x?.error_code,sessionToken:x?.sessionToken,nonce:x?.nonce,dinaId:x?.dinaId,signatureVerified:z}}catch(r){return console.error("[Pipeline] Error:",r),{ok:!1,error:"PIPELINE_ERROR: "+(r instanceof Error?r.message:String(r)),verify_status:"UNKNOWN"}}}function aS(){const[e,r]=Ct.useState("home"),[a,o]=Ct.useState("camera"),[c,h]=Ct.useState(!1),[m,x]=Ct.useState(null),[_,y]=Ct.useState(null),[S,R]=Ct.useState(""),[B,N]=Ct.useState(null),[k,z]=Ct.useState(null),[X,j]=Ct.useState(null),[F,te]=Ct.useState(!1),[,Q]=Ct.useState(null),[oe,ue]=Ct.useState(null),[ee,ce]=Ct.useState(!1),[le,Qe]=Ct.useState(null),[Je,ke]=Ct.useState(null),[at,et]=Ct.useState(null),[ve,xe]=Ct.useState(null),[_e,Ge]=Ct.useState(null),[qe,ft]=Ct.useState(null),[ne,fe]=Ct.useState(!1),[De,Le]=Ct.useState(null),[pe,Me]=Ct.useState(null),[Bt,At]=Ct.useState(""),It=Ct.useRef(null),Rt=()=>{const Nt=navigator,Wt=`${Nt.userAgent}-${Nt.language}-${window.screen.width}x${window.screen.height}`;return btoa(Wt).slice(0,32)},ht=()=>ie.jsx("svg",{style:{width:"20px",height:"20px",color:"rgba(255,255,255,0.8)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:ie.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),mt=Ct.useCallback(()=>{try{h(!1),x(null),y(null),N(null),Q(null),ue(null),te(!1),ce(!1),z(null),j(null),Qe(null),ke(null),et(null),xe(null),Ge(null),ft(null),fe(!1),Le(null),Me(null),At(""),r("home")}catch(Nt){console.error("error:",Nt),r("home")}},[]),qt=Ct.useCallback(()=>{try{o("camera"),h(!1),x(null),y(null),N(null),Q(null),ue(null),te(!1),ce(!1),j(null),Qe(null),r("camera")}catch(Nt){console.error("error:",Nt),r("camera")}},[]),Sn=Ct.useCallback(()=>{try{o("scan"),h(!1),x(null),y(null),N(null),Q(null),te(!1),ce(!1),z(null),r("scan")}catch(Nt){console.error("error:",Nt),r("scan")}},[]),Zn=async(Nt,Wt)=>{te(!0),Q(null),ue(null),ce(!1);try{const Lt=await iS({qrRaw:Nt,imageUri:Wt,geoBucket:null,deviceFingerprintHash:Rt()});console.log("pipeline result:",Lt),Lt.error_code&&ue(Lt.error_code),Lt.sessionToken&&ke(Lt.sessionToken),Lt.nonce&&et(Lt.nonce),Lt.dinaId&&xe(Lt.dinaId),Lt.signatureVerified!==void 0&&Ge(Lt.signatureVerified),Lt.confidence!==void 0&&Lt.confidence!==null&&ft(Lt.confidence),Lt.ok&&Lt.recordId&&Lt.packHash?(N({recordId:Lt.recordId,packHash:Lt.packHash,createdAt:new Date().toISOString()}),j(Lt.verify_status||"VALID"),r("result")):(Q(Lt.error||"UNKNOWN_ERROR"),j(Lt.verify_status||"UNKNOWN"),r("result"))}catch(Lt){Lt instanceof Error&&(Lt.message.includes("fetch")||Lt.message.includes("network"))&&ce(!0),Q(Lt instanceof Error?Lt.message:"PIPELINE_ERROR"),j("UNKNOWN"),r("result")}finally{te(!1)}},_n=Ct.useCallback(async()=>{console.log("capturePhoto called");try{const Nt=new(window.AudioContext||window.webkitAudioContext),Wt=Nt.createOscillator(),Lt=Nt.createGain();Wt.connect(Lt),Lt.connect(Nt.destination),Wt.frequency.value=800,Wt.type="sine",Lt.gain.setValueAtTime(.5,Nt.currentTime),Lt.gain.exponentialRampToValueAtTime(.01,Nt.currentTime+.15),Wt.start(),Wt.stop(Nt.currentTime+.15)}catch{}if(It.current){const Nt=It.current.getScreenshot();Nt&&(y(Nt),await Zn(m||null,Nt))}},[m]),zn=Nt=>{if(Nt&&Nt[0]?.rawValue&&!c){const Wt=Nt[0].rawValue;Wt.includes("DINA-")&&(x(Wt),h(!0))}},mn=()=>ie.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",padding:"0 32px",backgroundColor:"#0a0a0c"},children:[ie.jsxs("div",{style:{paddingTop:"120px",textAlign:"center"},children:[ie.jsx("h1",{style:{fontSize:"2.25rem",fontWeight:"200",letterSpacing:"0.25em",marginBottom:"8px",color:"rgba(255,255,255,0.9)"},children:"Geo Cam"}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"12px",letterSpacing:"0.2em"},children:"  "})]}),ie.jsxs("div",{style:{marginTop:"100px",width:"260px"},children:[ie.jsx("button",{onClick:qt,style:{width:"100%",padding:"16px",borderRadius:"16px",background:"rgba(255,255,255,0.07)",border:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)",fontWeight:"300",letterSpacing:"0.1em",cursor:"pointer"},children:"Camera"}),ie.jsx("div",{style:{height:"50px"}}),ie.jsx("button",{onClick:Sn,style:{width:"100%",padding:"16px",borderRadius:"16px",background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.06)",color:"rgba(255,255,255,0.6)",fontWeight:"300",letterSpacing:"0.1em",cursor:"pointer"},children:"Scan"}),ie.jsx("div",{style:{height:"30px"}}),ie.jsx("button",{onClick:()=>r("gallery"),style:{width:"100%",padding:"12px",borderRadius:"12px",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.04)",color:"rgba(255,255,255,0.6)",fontWeight:"300",letterSpacing:"0.1em",fontSize:"14px",cursor:"pointer"},children:"Gallery"})]}),ie.jsx("div",{style:{position:"absolute",bottom:"max(40px, env(safe-area-inset-bottom))",textAlign:"center",left:0,right:0},children:ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"10px",letterSpacing:"0.2em"},children:"Powered by Artion"})})]}),Qt=()=>ie.jsxs("div",{style:{position:"fixed",inset:0,backgroundColor:"#000",display:"flex",flexDirection:"column"},children:[ie.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:20,padding:"16px",paddingTop:"max(48px, env(safe-area-inset-top))",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ie.jsx("button",{onClick:mt,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.5)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:ie.jsx(ht,{})}),ie.jsx("span",{style:{color:"rgba(255,255,255,0.8)",fontSize:"16px",fontWeight:"300",letterSpacing:"0.1em"},children:""}),ie.jsx("div",{style:{width:"40px"}})]}),ie.jsxs("div",{style:{flex:1,position:"relative"},children:[ie.jsx(tE,{ref:It,audio:!1,onUserMediaError:()=>Qe("  .      ."),screenshotFormat:"image/jpeg",videoConstraints:{facingMode:"environment",width:1280,height:720},style:{position:"absolute",width:"100%",height:"100%",objectFit:"cover"}}),le&&ie.jsxs("div",{style:{position:"absolute",inset:0,zIndex:30,background:"#0a0a0c",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"24px"},children:[ie.jsx("p",{style:{color:"#f87171",fontSize:"16px",marginBottom:"12px"},children:"  "}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"14px",textAlign:"center",marginBottom:"24px"},children:le}),ie.jsx("button",{onClick:mt,style:{padding:"12px 24px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",cursor:"pointer"},children:""})]}),!c&&ie.jsx("div",{style:{position:"absolute",inset:0,opacity:0,pointerEvents:"none"},children:ie.jsx(l4,{onScan:zn,constraints:{facingMode:"environment"},styles:{container:{width:"100%",height:"100%"},video:{width:"100%",height:"100%",objectFit:"cover"}}})}),ie.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"200px",height:"200px",zIndex:10},children:[ie.jsx("div",{style:{position:"absolute",top:0,left:0,width:"40px",height:"40px",borderTop:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderLeft:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderTopLeftRadius:"12px"}}),ie.jsx("div",{style:{position:"absolute",top:0,right:0,width:"40px",height:"40px",borderTop:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderRight:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderTopRightRadius:"12px"}}),ie.jsx("div",{style:{position:"absolute",bottom:0,left:0,width:"40px",height:"40px",borderBottom:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderLeft:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderBottomLeftRadius:"12px"}}),ie.jsx("div",{style:{position:"absolute",bottom:0,right:0,width:"40px",height:"40px",borderBottom:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderRight:`3px solid ${c?"#4ade80":"rgba(255,255,255,0.6)"}`,borderBottomRightRadius:"12px"}}),c&&ie.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"8px 16px",background:"rgba(34,197,94,0.2)",border:"1px solid rgba(34,197,94,0.4)",borderRadius:"8px"},children:ie.jsx("span",{style:{color:"#4ade80",fontSize:"12px"},children:"QR "})})]})]}),ie.jsxs("div",{style:{padding:"24px",paddingBottom:"max(60px, env(safe-area-inset-bottom))",textAlign:"center",background:"linear-gradient(to top, rgba(0,0,0,0.8), transparent)",position:"relative",zIndex:10},children:[ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"14px",marginBottom:"20px"},children:F?" ...":c?"QR  - ":"  "}),ie.jsx("button",{onClick:_n,disabled:F,style:{width:"72px",height:"72px",borderRadius:"50%",background:F?"rgba(255,255,255,0.6)":"rgba(255,255,255,0.9)",border:"4px solid rgba(255,255,255,0.6)",cursor:F?"not-allowed":"pointer"}})]})]}),nr=()=>{const Nt=Ct.useRef(null),[Wt,Lt]=Ct.useState(!1),[an,tt]=Ct.useState(null),xn=Ct.useRef(!1),Xt=In=>{const on=In.match(/DINA-[A-Z0-9]{12,13}/);return on?on[0]:null},En=async In=>{te(!0),ce(!1),ue(null);try{const Ft=await(await fetch("https://geostudio-api-production.up.railway.app/api/geocam/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dinaId:In,deviceFingerprint:Rt()})})).json();Ft.success||Ft.status==="VALID"?(xe(In),Ft.sessionToken&&ke(Ft.sessionToken),z({status:"CLAIMED",message:" ."})):Ft.status==="ALREADY_ACTIVATED"||Ft.error_code==="ALREADY_ACTIVATED"?z({status:"ALREADY_CLAIMED",message:"  ."}):Ft.status==="NOT_FOUND"||Ft.error_code==="ASSET_NOT_FOUND"?z({status:"ERROR",message:"  ."}):Ft.error_code==="RATE_LIMIT_EXCEEDED"?(ue("RATE_LIMIT_EXCEEDED"),z({status:"ERROR",message:"  .     ."})):z({status:"ERROR",message:Ft.error||Ft.message||" ."})}catch{ce(!0),z({status:"ERROR",message:"  .   ."})}te(!1),r("scanResult")},Nn=async In=>{if(xn.current||F)return;xn.current=!0;const on=Xt(In);if(on){if(x(In),Nt.current)try{await Nt.current.stop()}catch{}await En(on)}else xn.current=!1,tt("DINA    QR"),setTimeout(()=>tt(null),2e3)};Ct.useEffect(()=>{let In=!0;return(async()=>{try{const Ft=new N4("qr-reader");Nt.current=Ft,await Ft.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1},Nn,()=>{}),In&&Lt(!0)}catch(Ft){console.error("Scanner init error:",Ft),In&&tt("   .   .")}})(),()=>{In=!1,Nt.current&&Nt.current.stop().catch(()=>{})}},[]);const Jr=async()=>{if(Nt.current)try{await Nt.current.stop()}catch{}mt()};return ie.jsxs("div",{style:{position:"fixed",inset:0,backgroundColor:"#000",display:"flex",flexDirection:"column"},children:[ie.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:20,padding:"16px",paddingTop:"max(48px, env(safe-area-inset-top))",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ie.jsx("button",{onClick:Jr,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.5)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:ie.jsx(ht,{})}),ie.jsx("span",{style:{color:"rgba(255,255,255,0.8)",fontSize:"16px",fontWeight:"300",letterSpacing:"0.1em"},children:"QR "}),ie.jsx("div",{style:{width:"40px"}})]}),ie.jsxs("div",{style:{flex:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[ie.jsx("div",{id:"qr-reader",style:{width:"100%",height:"100%"}}),ie.jsxs("div",{style:{position:"absolute",inset:0,pointerEvents:"none"},children:[ie.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.6)"},children:ie.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"260px",height:"260px",background:"transparent",boxShadow:"0 0 0 9999px rgba(0,0,0,0.6)"}})}),ie.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"260px",height:"260px",zIndex:10},children:[ie.jsx("div",{style:{position:"absolute",top:0,left:0,width:"50px",height:"50px",borderTop:"4px solid #4ade80",borderLeft:"4px solid #4ade80",borderTopLeftRadius:"16px"}}),ie.jsx("div",{style:{position:"absolute",top:0,right:0,width:"50px",height:"50px",borderTop:"4px solid #4ade80",borderRight:"4px solid #4ade80",borderTopRightRadius:"16px"}}),ie.jsx("div",{style:{position:"absolute",bottom:0,left:0,width:"50px",height:"50px",borderBottom:"4px solid #4ade80",borderLeft:"4px solid #4ade80",borderBottomLeftRadius:"16px"}}),ie.jsx("div",{style:{position:"absolute",bottom:0,right:0,width:"50px",height:"50px",borderBottom:"4px solid #4ade80",borderRight:"4px solid #4ade80",borderBottomRightRadius:"16px"}}),Wt&&!F&&ie.jsx("div",{style:{position:"absolute",top:"10%",left:"10%",right:"10%",height:"2px",background:"linear-gradient(90deg, transparent, #4ade80, transparent)",animation:"scanLine 2s ease-in-out infinite"}})]})]}),an&&ie.jsx("div",{style:{position:"absolute",top:"25%",left:"50%",transform:"translateX(-50%)",padding:"12px 24px",background:"rgba(248,113,113,0.9)",borderRadius:"12px",zIndex:30},children:ie.jsx("p",{style:{color:"white",fontSize:"14px",margin:0},children:an})})]}),ie.jsxs("div",{style:{padding:"24px",paddingBottom:"max(60px, env(safe-area-inset-bottom))",textAlign:"center",background:"linear-gradient(to top, rgba(0,0,0,0.9), transparent)",position:"relative",zIndex:10},children:[ie.jsx("p",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",fontWeight:"500",marginBottom:"8px"},children:F?" ...":"DINA QR  "}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.5)",fontSize:"13px",margin:0},children:"    QR    "})]}),ie.jsx("style",{children:`
          @keyframes scanLine {
            0%, 100% { top: 10%; opacity: 0; }
            50% { top: 85%; opacity: 1; }
          }
          #qr-reader video {
            width: 100% !important;
            height: 100% !important;
            object-fit: cover !important;
          }
          #qr-reader {
            border: none !important;
          }
          #qr-reader__scan_region {
            display: none !important;
          }
          #qr-reader__dashboard {
            display: none !important;
          }
        `})]})},wt=()=>{const Wt=(()=>{if(!k)return{color:"rgba(255,255,255,0.6)",text:"",icon:null};switch(k.status){case"PENDING":return{color:"#fbbf24",text:" ",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#fbbf24",strokeWidth:"2.5"}),ie.jsx("path",{d:"M24 14v12",stroke:"#fbbf24",strokeWidth:"3",strokeLinecap:"round"}),ie.jsx("circle",{cx:"24",cy:"33",r:"2",fill:"#fbbf24"})]})};case"CLAIMED":return{color:"#4ade80",text:"  ",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#4ade80",strokeWidth:"2.5"}),ie.jsx("path",{d:"M15 24l6 6 12-12",stroke:"#4ade80",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})};case"ALREADY_CLAIMED":return{color:"#f97316",text:"  ",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#f97316",strokeWidth:"2.5"}),ie.jsx("path",{d:"M24 14v12",stroke:"#f97316",strokeWidth:"3",strokeLinecap:"round"}),ie.jsx("circle",{cx:"24",cy:"33",r:"2",fill:"#f97316"})]})};case"EXPIRED":return{color:"#6b7280",text:"",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#6b7280",strokeWidth:"2.5"}),ie.jsx("path",{d:"M17 17l14 14M31 17l-14 14",stroke:"#6b7280",strokeWidth:"3",strokeLinecap:"round"})]})};case"ERROR":return{color:"#f87171",text:" ",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#f87171",strokeWidth:"2.5"}),ie.jsx("path",{d:"M17 17l14 14M31 17l-14 14",stroke:"#f87171",strokeWidth:"3",strokeLinecap:"round"})]})};default:return{color:"rgba(255,255,255,0.6)",text:"",icon:null}}})();return ie.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#0a0a0c",padding:"20px",paddingTop:"max(48px, env(safe-area-inset-top))"},children:[ie.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"40px"},children:[ie.jsx("button",{onClick:mt,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:ie.jsx(ht,{})}),ie.jsx("span",{style:{color:"rgba(255,255,255,0.8)",fontSize:"16px",fontWeight:"300",marginLeft:"16px",letterSpacing:"0.05em"},children:" "})]}),ie.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[ie.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:`${Wt.color}15`,border:`2px solid ${Wt.color}40`,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"28px"},children:Wt.icon}),ie.jsx("h2",{style:{color:Wt.color,fontSize:"22px",fontWeight:"600",marginBottom:"12px",letterSpacing:"0.02em"},children:Wt.text}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"15px",textAlign:"center",maxWidth:"300px",lineHeight:"1.6"},children:k?.message}),ve&&ie.jsxs("div",{style:{marginTop:"24px",padding:"14px 20px",background:"rgba(255,255,255,0.04)",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.08)"},children:[ie.jsx("p",{style:{color:"rgba(255,255,255,0.4)",fontSize:"11px",marginBottom:"4px"},children:"DINA "}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.9)",fontSize:"14px",fontFamily:"monospace",letterSpacing:"0.05em",margin:0},children:ve})]}),ee&&ie.jsx("button",{onClick:Sn,style:{marginTop:"24px",padding:"14px 28px",borderRadius:"12px",background:"rgba(251,191,36,0.1)",border:"1px solid rgba(251,191,36,0.3)",color:"#fbbf24",fontSize:"15px",cursor:"pointer"},children:" "})]}),ie.jsxs("div",{style:{display:"flex",gap:"12px",paddingBottom:"max(60px, env(safe-area-inset-bottom))"},children:[k?.status==="PENDING"&&ie.jsxs(ie.Fragment,{children:[ie.jsx("button",{onClick:qt,style:{flex:1,padding:"14px",borderRadius:"12px",fontSize:"15px",fontWeight:"500",background:"rgba(74,222,128,0.1)",border:"1px solid rgba(74,222,128,0.3)",color:"#4ade80",cursor:"pointer"},children:" "}),ie.jsx("button",{onClick:mt,style:{flex:1,padding:"14px",borderRadius:"12px",fontSize:"15px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.06)",color:"white",cursor:"pointer"},children:""})]}),k?.status==="CLAIMED"&&ie.jsx("button",{onClick:mt,style:{flex:1,padding:"14px",borderRadius:"12px",fontSize:"15px",fontWeight:"500",background:"rgba(74,222,128,0.1)",border:"1px solid rgba(74,222,128,0.3)",color:"#4ade80",cursor:"pointer"},children:""}),k?.status==="ALREADY_CLAIMED"&&ie.jsxs(ie.Fragment,{children:[ie.jsx("button",{onClick:mt,style:{flex:1,padding:"14px",borderRadius:"12px",fontSize:"15px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.06)",color:"white",cursor:"pointer"},children:""}),ie.jsx("button",{onClick:()=>window.open("mailto:support@artion.com"),style:{flex:1,padding:"14px",borderRadius:"12px",fontSize:"15px",background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.1)",color:"white",cursor:"pointer"},children:""})]}),(k?.status==="EXPIRED"||k?.status==="ERROR")&&ie.jsxs(ie.Fragment,{children:[ie.jsx("button",{onClick:Sn,style:{flex:1,padding:"14px",borderRadius:"12px",fontSize:"15px",background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.1)",color:"white",cursor:"pointer"},children:" "}),ie.jsx("button",{onClick:mt,style:{flex:1,padding:"14px",borderRadius:"12px",fontSize:"15px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.06)",color:"white",cursor:"pointer"},children:""})]})]})]})},Er=Nt=>{switch(Nt){case"BATCH_NOT_SHIPPED":return{title:" ",message:"   .     .",color:"#f97316"};case"BATCH_TEMPORARILY_LOCKED":return{title:"  ",message:"     .     .",color:"#f97316"};case"RATE_LIMIT_EXCEEDED":return{title:" ",message:"    . 1    .",color:"#fbbf24"};case"WRITE_GATE_FAILED":return{title:"  ",message:"   .      .",color:"#f87171"};default:return null}},Bn=()=>{const Nt=a==="camera",Wt=Er(oe),Lt=()=>{if(Wt)return Wt.color;switch(X){case"VALID":return"#4ade80";case"SUSPECT":return"#fbbf24";case"INVALID":return"#f87171";case"UNKNOWN":return"#f97316";default:return"rgba(255,255,255,0.6)"}},an=()=>{if(Wt)return Wt.title;switch(X){case"VALID":return"  (AUTHENTIC)";case"SUSPECT":return"  (SUSPICIOUS)";case"INVALID":return"  (MISMATCH)";case"UNKNOWN":return"  (UNREGISTERED)";default:return""}},tt=()=>{if(Wt)return Wt.message;switch(X){case"VALID":return"   .    .";case"SUSPECT":return"  .      .";case"INVALID":return"      .    .";case"UNKNOWN":return"      .    .";default:return""}},xn=()=>{const Nn=Lt();switch(X){case"VALID":return ie.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[ie.jsx("circle",{cx:"16",cy:"16",r:"15",stroke:Nn,strokeWidth:"2"}),ie.jsx("path",{d:"M10 16l4 4 8-8",stroke:Nn,strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})]});case"SUSPECT":return ie.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[ie.jsx("path",{d:"M16 3L2 28h28L16 3z",stroke:Nn,strokeWidth:"2",strokeLinejoin:"round"}),ie.jsx("path",{d:"M16 13v7",stroke:Nn,strokeWidth:"2.5",strokeLinecap:"round"}),ie.jsx("circle",{cx:"16",cy:"24",r:"1.5",fill:Nn})]});case"INVALID":return ie.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[ie.jsx("circle",{cx:"16",cy:"16",r:"15",stroke:Nn,strokeWidth:"2"}),ie.jsx("path",{d:"M11 11l10 10M21 11l-10 10",stroke:Nn,strokeWidth:"2.5",strokeLinecap:"round"})]});case"UNKNOWN":return ie.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[ie.jsx("circle",{cx:"16",cy:"16",r:"15",stroke:Nn,strokeWidth:"2"}),ie.jsx("path",{d:"M12 12a4 4 0 014-4 4 4 0 014 4c0 2-2 3-3 4s-1 2-1 3",stroke:Nn,strokeWidth:"2.5",strokeLinecap:"round"}),ie.jsx("circle",{cx:"16",cy:"24",r:"1.5",fill:Nn})]});default:return null}},Xt=Ct.useCallback(()=>{try{h(!1),x(null),y(null),N(null),Q(null),te(!1),j(null),r(Nt?"camera":"preview")}catch(Nn){console.error("retry error:",Nn),r(Nt?"camera":"preview")}},[Nt]),En=async()=>{if(!(!Je||!ve||!at)){fe(!0);try{const Nn=await rS(Je,ve,at);Le(Nn.status),Nn.success||Me(Nn.error_code||Nn.error||"UNKNOWN"),r("registerResult")}catch{Le("FAILED"),Me("NETWORK_ERROR"),r("registerResult")}fe(!1)}};return ie.jsxs("div",{style:{height:"100dvh",display:"flex",flexDirection:"column",backgroundColor:"#0a0a0c",overflow:"hidden"},children:[ie.jsxs("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:[_&&ie.jsx("img",{src:_,alt:"captured",style:{width:"100%",height:"100%",objectFit:"cover"}}),S&&!_&&ie.jsx("img",{src:S,alt:"preview",style:{width:"100%",height:"100%",objectFit:"cover"}}),ie.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"48px",background:"linear-gradient(to top, #0a0a0c, transparent)"}}),ie.jsx("button",{onClick:mt,style:{position:"absolute",top:"max(48px, env(safe-area-inset-top))",left:"16px",width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:ie.jsx(ht,{})}),ie.jsx("div",{style:{position:"absolute",top:"max(52px, calc(env(safe-area-inset-top) + 4px))",right:"16px",padding:"6px 14px",borderRadius:"9999px",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",fontSize:"11px",color:"rgba(255,255,255,0.6)"},children:Nt?" ":""})]}),ie.jsxs("div",{style:{padding:"8px 16px",display:"flex",flexDirection:"column",gap:"6px",background:"#0a0a0c"},children:[ie.jsxs("div",{style:{background:`${Lt()}10`,border:`1px solid ${Lt()}30`,borderRadius:"12px",padding:"12px"},children:[ie.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"8px 14px",borderRadius:"9999px",background:`${Lt()}15`,border:`1px solid ${Lt()}40`,marginBottom:"8px"},children:[xn(),ie.jsx("span",{style:{fontSize:"13px",fontWeight:"500",color:Lt()},children:an()})]}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.7)",fontSize:"14px",marginBottom:"8px",lineHeight:"1.4"},children:tt()}),qe!==null&&ie.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[ie.jsx("span",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px"},children:""}),ie.jsxs("span",{style:{color:Lt(),fontSize:"12px",fontWeight:"500"},children:[qe,"%"]})]}),_e!==null&&ie.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[ie.jsx("span",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px"},children:" "}),ie.jsx("span",{style:{color:_e?"#4ade80":"#f87171",fontSize:"12px",fontWeight:"500"},children:_e?"PASS":"FAIL"})]}),B&&X==="VALID"&&ie.jsxs("div",{style:{paddingTop:"12px",borderTop:"1px solid rgba(255,255,255,0.06)"},children:[ie.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[ie.jsx("span",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px"},children:"Record ID"}),ie.jsxs("span",{style:{color:"rgba(255,255,255,0.7)",fontSize:"10px",fontFamily:"monospace"},children:[B.recordId.slice(0,18),"..."]})]}),ie.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[ie.jsx("span",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px"},children:"Pack Hash"}),ie.jsxs("span",{style:{color:"rgba(255,255,255,0.7)",fontSize:"10px",fontFamily:"monospace"},children:[B.packHash.slice(0,16),"..."]})]}),ie.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ie.jsx("span",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px"},children:" "}),ie.jsx("span",{style:{color:"rgba(255,255,255,0.7)",fontSize:"11px"},children:new Date(B.createdAt).toLocaleString("ko-KR")})]})]}),ee&&ie.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(251,191,36,0.1)",borderRadius:"8px",border:"1px solid rgba(251,191,36,0.2)"},children:[ie.jsx("p",{style:{color:"#fbbf24",fontSize:"12px",margin:0},children:"  ."}),ie.jsx("button",{onClick:Xt,style:{marginTop:"8px",padding:"8px 16px",borderRadius:"8px",background:"rgba(251,191,36,0.2)",border:"none",color:"#fbbf24",fontSize:"12px",cursor:"pointer"},children:""})]})]}),ie.jsxs("div",{style:{display:"flex",gap:"12px",paddingBottom:"max(60px, env(safe-area-inset-bottom))"},children:[ie.jsx("button",{onClick:mt,style:{flex:1,padding:"12px",borderRadius:"12px",fontSize:"14px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.06)",color:"white",cursor:"pointer"},children:""}),X==="VALID"&&Je&&ie.jsx("button",{onClick:En,disabled:ne,style:{flex:1,padding:"12px",borderRadius:"12px",fontSize:"14px",background:ne?"rgba(74,222,128,0.3)":"rgba(74,222,128,0.1)",border:"1px solid rgba(74,222,128,0.3)",color:"#4ade80",fontWeight:"500",cursor:ne?"default":"pointer"},children:ne?" ...":" "}),(X==="SUSPECT"||X==="UNKNOWN"||X==="INVALID")&&ie.jsx("button",{onClick:Xt,style:{flex:1,padding:"12px",borderRadius:"12px",fontSize:"14px",background:X==="SUSPECT"?"rgba(251,191,36,0.1)":"rgba(255,255,255,0.06)",border:`1px solid ${X==="SUSPECT"?"rgba(251,191,36,0.3)":"rgba(255,255,255,0.1)"}`,color:X==="SUSPECT"?"#fbbf24":"white",cursor:"pointer"},children:" "})]})]})]})},kn=()=>{const Nt=Ct.useRef(null);Ct.useEffect(()=>{Nt.current?.click()},[]);const Wt=Lt=>{const an=Lt.target.files?.[0];if(an){const tt=new FileReader;tt.onload=xn=>{R(xn.target?.result),o("scan"),r("preview")},tt.readAsDataURL(an)}else r("home")};return ie.jsxs("div",{style:{minHeight:"100vh",background:"#0a0a0c",padding:"20px",paddingTop:"max(48px, env(safe-area-inset-top))"},children:[ie.jsx("input",{ref:Nt,type:"file",accept:"image/*",onChange:Wt,style:{display:"none"}}),ie.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"24px"},children:[ie.jsx("button",{onClick:mt,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",marginRight:"16px"},children:ie.jsx(ht,{})}),ie.jsx("h2",{style:{color:"rgba(255,255,255,0.9)",fontSize:"18px",margin:0},children:"Gallery"})]}),ie.jsxs("div",{style:{textAlign:"center",paddingTop:"80px"},children:[ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"14px",marginBottom:"8px"},children:"  "}),ie.jsx("p",{style:{color:"rgba(251,191,36,0.8)",fontSize:"12px",marginBottom:"24px"},children:"/     ."}),ie.jsx("button",{onClick:()=>Nt.current?.click(),style:{padding:"12px 24px",borderRadius:"12px",background:"rgba(74,222,128,0.1)",border:"1px solid rgba(74,222,128,0.3)",color:"#4ade80",fontSize:"14px",cursor:"pointer"},children:" "})]})]})},ai=()=>{const[Nt,Wt]=Ct.useState(!1),[Lt,an]=Ct.useState(null),[tt,xn]=Ct.useState(!1),Xt=async()=>{if(Wt(!0),an(null),S)try{y(S),await Zn(null,S)}catch{an("    ."),Wt(!1)}},En=()=>{Nt?xn(!0):r("gallery")},Nn=()=>{xn(!1),Wt(!1),r("gallery")};return ie.jsxs("div",{style:{minHeight:"100vh",background:"#0a0a0c",display:"flex",flexDirection:"column"},children:[ie.jsxs("div",{style:{padding:"16px",paddingTop:"max(48px, env(safe-area-inset-top))",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ie.jsx("button",{onClick:En,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.5)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:ie.jsx(ht,{})}),ie.jsx("span",{style:{color:"rgba(255,255,255,0.8)",fontSize:"16px",fontWeight:"300",letterSpacing:"0.1em"},children:""}),ie.jsx("div",{style:{width:"40px"}})]}),ie.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:ie.jsx("img",{src:S,alt:"",style:{maxWidth:"100%",maxHeight:"60vh",borderRadius:"12px"}})}),ie.jsxs("div",{style:{padding:"20px",paddingBottom:"max(60px, env(safe-area-inset-bottom))"},children:[Lt&&ie.jsx("p",{style:{color:"#f87171",fontSize:"14px",marginBottom:"8px",textAlign:"center"},children:Lt}),ie.jsxs("div",{style:{display:"flex",gap:"12px"},children:[ie.jsx("button",{onClick:()=>r("gallery"),style:{flex:1,padding:"16px",borderRadius:"12px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.06)",color:"white",fontSize:"14px",cursor:"pointer"},children:" "}),ie.jsx("button",{onClick:Xt,disabled:Nt,style:{flex:1,padding:"16px",borderRadius:"12px",background:Nt?"rgba(74,222,128,0.3)":"rgba(74,222,128,0.1)",border:"1px solid rgba(74,222,128,0.3)",color:"#4ade80",fontSize:"16px",fontWeight:"500",cursor:Nt?"default":"pointer"},children:Nt?" ...":""})]})]}),tt&&ie.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:ie.jsxs("div",{style:{background:"#1a1a1c",borderRadius:"16px",padding:"24px",maxWidth:"300px",textAlign:"center"},children:[ie.jsx("p",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",marginBottom:"20px"},children:"  . ?"}),ie.jsxs("div",{style:{display:"flex",gap:"12px"},children:[ie.jsx("button",{onClick:()=>xn(!1),style:{flex:1,padding:"12px",borderRadius:"12px",background:"rgba(74,222,128,0.1)",border:"1px solid rgba(74,222,128,0.3)",color:"#4ade80",cursor:"pointer"},children:""}),ie.jsx("button",{onClick:Nn,style:{flex:1,padding:"12px",borderRadius:"12px",background:"rgba(239,68,68,0.1)",border:"1px solid rgba(239,68,68,0.3)",color:"#f87171",cursor:"pointer"},children:""})]})]})})]})},hr=()=>{const Nt=()=>{if(Bt.length===8){const an=(m||"")+" OTP-"+Bt.toUpperCase();x(an),o("camera"),h(!0),y(null),N(null),Q(null),ue(null),te(!1),ce(!1),j(null),Qe(null),r("camera")}},Wt=m?.match(/DINA-[A-Z0-9]{13}/),Lt=Wt?Wt[0]:m||"";return ie.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#0a0a0c",padding:"20px",paddingTop:"max(48px, env(safe-area-inset-top))"},children:[ie.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"40px"},children:[ie.jsx("button",{onClick:Sn,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:ie.jsx(ht,{})}),ie.jsx("span",{style:{color:"rgba(255,255,255,0.8)",fontSize:"16px",fontWeight:"300",marginLeft:"16px",letterSpacing:"0.1em"},children:"OTP "})]}),ie.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"40px"},children:[ie.jsxs("div",{style:{marginBottom:"32px",padding:"12px 20px",background:"rgba(255,255,255,0.04)",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.08)"},children:[ie.jsx("p",{style:{color:"rgba(255,255,255,0.5)",fontSize:"11px",marginBottom:"4px"},children:"DINA "}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",fontFamily:"monospace",letterSpacing:"0.1em",margin:0},children:Lt})]}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"14px",textAlign:"center",marginBottom:"24px",maxWidth:"280px",lineHeight:"1.5"},children:"  OTP  8  "}),ie.jsx("input",{type:"text",value:Bt,onChange:an=>At(an.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,8)),maxLength:8,placeholder:"OTP  8",style:{width:"240px",padding:"16px",fontSize:"20px",fontFamily:"monospace",letterSpacing:"0.3em",textAlign:"center",background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.15)",borderRadius:"12px",color:"rgba(255,255,255,0.9)",outline:"none",textTransform:"uppercase"}}),ie.jsxs("p",{style:{color:"rgba(255,255,255,0.4)",fontSize:"12px",marginTop:"8px"},children:[Bt.length,"/8"]}),ie.jsx("button",{onClick:Nt,disabled:Bt.length!==8,style:{marginTop:"24px",width:"240px",padding:"14px",borderRadius:"12px",fontSize:"15px",fontWeight:"500",background:Bt.length===8?"rgba(74,222,128,0.15)":"rgba(255,255,255,0.04)",border:`1px solid ${Bt.length===8?"rgba(74,222,128,0.4)":"rgba(255,255,255,0.06)"}`,color:Bt.length===8?"#4ade80":"rgba(255,255,255,0.3)",cursor:Bt.length===8?"pointer":"not-allowed"},children:""})]}),ie.jsx("div",{style:{paddingBottom:"max(40px, env(safe-area-inset-bottom))"}})]})},Or=()=>{const Wt=De==="ACTIVATED"?{color:"#4ade80",title:"  ",message:"   .",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#4ade80",strokeWidth:"2.5"}),ie.jsx("path",{d:"M15 24l6 6 12-12",stroke:"#4ade80",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})}:De==="ALREADY_ACTIVATED"?{color:"#fbbf24",title:"  ",message:"     .",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#fbbf24",strokeWidth:"2.5"}),ie.jsx("path",{d:"M24 14v12",stroke:"#fbbf24",strokeWidth:"3",strokeLinecap:"round"}),ie.jsx("circle",{cx:"24",cy:"33",r:"2",fill:"#fbbf24"})]})}:{color:"#f87171",title:" ",message:pe&&{SESSION_NOT_VERIFIED:" .   .",DINA_MISMATCH:"   .",ASSET_NOT_FOUND:"  .",BATCH_NOT_SHIPPED:"   .",NETWORK_ERROR:"  .   ."}[pe]||" .   .",icon:ie.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[ie.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"#f87171",strokeWidth:"2.5"}),ie.jsx("path",{d:"M17 17l14 14M31 17l-14 14",stroke:"#f87171",strokeWidth:"3",strokeLinecap:"round"})]})};return ie.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#0a0a0c",padding:"20px",paddingTop:"max(48px, env(safe-area-inset-top))"},children:[ie.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[ie.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:`${Wt.color}10`,border:`2px solid ${Wt.color}30`,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px"},children:Wt.icon}),ie.jsx("h2",{style:{color:Wt.color,fontSize:"22px",fontWeight:"500",marginBottom:"12px"},children:Wt.title}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"14px",textAlign:"center",maxWidth:"280px",lineHeight:"1.5"},children:Wt.message})]}),ie.jsx("div",{style:{paddingBottom:"max(60px, env(safe-area-inset-bottom))"},children:ie.jsx("button",{onClick:mt,style:{width:"100%",padding:"14px",borderRadius:"12px",fontSize:"15px",background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.06)",color:"white",cursor:"pointer"},children:""})})]})},vr=()=>ie.jsxs("div",{style:{minHeight:"100vh",background:"#0a0a0c",padding:"20px",paddingTop:"max(48px, env(safe-area-inset-top))"},children:[ie.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"24px"},children:[ie.jsx("button",{onClick:mt,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(0,0,0,0.4)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",marginRight:"16px"},children:ie.jsx(ht,{})}),ie.jsx("h2",{style:{color:"rgba(255,255,255,0.9)",fontSize:"18px",margin:0},children:""})]}),ie.jsxs("div",{style:{marginTop:"40px",padding:"16px",background:"rgba(255,255,255,0.02)",borderRadius:"12px"},children:[ie.jsx("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"12px",margin:0},children:"GeoCam V2.1"}),ie.jsx("p",{style:{color:"rgba(255,255,255,0.4)",fontSize:"11px",margin:"4px 0 0 0"},children:"Powered by Artion"})]})]}),cr=()=>ie.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#0a0a0c"},children:[ie.jsxs("div",{style:{padding:"16px",paddingTop:"max(48px, env(safe-area-inset-top))",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[ie.jsx("button",{onClick:mt,style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:ie.jsx(ht,{})}),ie.jsx("span",{style:{color:"rgba(255,255,255,0.8)",fontSize:"16px",fontWeight:"300"},children:" "}),ie.jsx("div",{style:{width:"40px"}})]}),ie.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:ie.jsx("p",{style:{color:"rgba(255,255,255,0.5)",fontSize:"14px"},children:"  "})})]});return ie.jsxs(ie.Fragment,{children:[e==="home"&&ie.jsx(mn,{}),e==="camera"&&ie.jsx(Qt,{}),e==="scan"&&ie.jsx(nr,{}),e==="scanResult"&&ie.jsx(wt,{}),e==="result"&&ie.jsx(Bn,{}),e==="records"&&ie.jsx(cr,{}),e==="gallery"&&ie.jsx(kn,{}),e==="preview"&&ie.jsx(ai,{}),e==="otpInput"&&ie.jsx(hr,{}),e==="registerResult"&&ie.jsx(Or,{}),e==="settings"&&ie.jsx(vr,{})]})}XA.createRoot(document.getElementById("root")).render(ie.jsx(Ct.StrictMode,{children:ie.jsx(aS,{})}));export{uS as W,Gh as a};
